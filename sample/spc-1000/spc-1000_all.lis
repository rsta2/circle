;Z80-Assembler		Release 1.6				Page 1
;Source file: spc-1000_all.asm
;Title:       

;SOURCE CODE   LOC   OBJECT CODE   
                                        ;                       1      1 ;
                                        ;                       2      2 ; IOCS
                                        ;                       3      3 ;
                                        ;                       4      4 ; SAMSUNG 8bit Personal Computer SPC-1000
                                        ;                       5      5 ; Old ROM Assembler Source 
                                        ;                       6      6 ; Reconstructed by Miso Kim
                                        ;                       7      7 ;
                                        ;                       8      8 ; 2014.04.16 1st Released
                                        ;                       9      9 ; 
        ORG 0                           ;                      10     10 
ENTRY   EQU 0FB00H                      ;fb00                  11     11 
BOOT:                                   ;                      12     12 
JT1:    JP  ENTRY                       ;0000  c3 00 fb        13     13 
JT2:    JP  INPUTF                      ;0003  c3 a4 06        14     14 
JT3:    JP  CR1                         ;0006  c3 43 08        15     15 
JT4:    JP  CR2                         ;0009  c3 23 08        16     16 
JT5:    JP  SPPRT                       ;000c  c3 62 08        17     17 
JT6:    JP  TABPRT                      ;000f  c3 02 08        18     18 
JT7:    JP  ACCPRT                      ;0012  c3 64 08        19     19 
JT8:    JP  DEPRT                       ;0015  c3 f3 07        20     20 
JT9:    JP  DEPRT                       ;0018  c3 f3 07        21     21 
JT10:   JP  ASCGET                      ;001b  c3 62 0c        22     22 
JT11:   JP  BRKEY                       ;001e  c3 5b 0c        23     23 ;ZERO=1 RET
JT12:   JP  FSAVE                       ;0021  c3 80 00        24     24 
JT13:   JP  MSAVE                       ;0024  c3 b6 00        25     25 
JT14:   JP  FLOAD                       ;0027  c3 10 01        26     26 
JT15:   JP  MLOAD                       ;002a  c3 30 01        27     27 
JT16:   JP  MVRFY                       ;002d  c3 af 01        28     28 
JT17:   JP  MUSIC                       ;0030  c3 cd 0e        29     29 ;MELDY
JT18:   JP  NOPRET                      ;0033  c3 61 00        30     30 ;CLKSET
TICONT: DEFW    17                      ;0036  11 00           31     31 
JT19:   JP  COUNTR                      ;0038  c3 74 00        32     32 
JT20:   JP  NOPRET                      ;003b  c3 61 00        33     33 ;CLKRD
JT21:   JP  BELL                        ;003e  c3 ca 06        34     34 ;BELL
JT22:   JP  XTEMPO                      ;0041  c3 95 10        35     35 ;TEMPO
JT23:   JP  SOUNDS                      ;0044  c3 99 10        36     36 ;MSTA
JT24:   JP  SOUNDS                      ;0047  c3 99 10        37     37 ;MSTAS
                                        ;                      38     38 ;004A
MAIN:   LD  SP,00000h                   ;004a  31 00 00        39     39 
    IM  1                               ;004d  ed 56           40     40 
    EI                                  ;004f  fb              41     41 
    CALL    INITSB                      ;0050  cd 56 00        42     42 
    JP  $BASIC                          ;0053  c3 18 14        43     43 
                                        ;                      44     44 ;
INITSB: LD  A,0                         ;0056  3e 00           45     45 
    CALL    IO20SB                      ;0058  cd 62 00        46     46 
    CALL    IO60SB                      ;005b  cd 6b 00        47     47 
    CALL    CLR2                        ;005e  cd d5 0a        48     48 
NOPRET: RET                             ;0061  c9              49     49 
                                        ;                      50     50 ;
IO20SB: LD  BC,02000h                   ;0062  01 00 20        51     51 
    OUT (C),A                           ;0065  ed 79           52     52 
    LD  (IO2000),A                      ;0067  32 ea 11        53     53 
    RET                                 ;006a  c9              54     54 
                                        ;                      55     55 ;
IO60SB: LD  BC,06000h                   ;006b  01 00 60        56     56 
    OUT (C),A                           ;006e  ed 79           57     57 
    LD  (IO6000),A                      ;0070  32 e9 11        58     58 
    RET                                 ;0073  c9              59     59 
                                        ;                      60     60 ;
                                        ;                      61     61 ;
COUNTR: PUSH    HL                      ;0074  e5              62     62 
    LD  HL,(TICONT)                     ;0075  2a 36 00        63     63 
    INC HL                              ;0078  23              64     64 
    LD  (TICONT),HL                     ;0079  22 36 00        65     65 
    POP HL                              ;007c  e1              66     66 
    EI                                  ;007d  fb              67     67 
    RETI                                ;007e  ed 4d           68     68 
                                        ;                      69     69 ;
                                        ;                      70     70 ;
                                        ;                      71     71 ;
                                        ;                      72     72 ; FILE INFORMATION SAVE
                                        ;                      73     73 ;
                                        ;                      74     74 ; START ADR=FILMOD
                                        ;                      75     75 ; LENGTH   =128 BYTES
                                        ;                      76     76 ;   CARRY FLAG: BREAK KEY IN
                                        ;                      77     77 ;
FSAVE:  DI                              ;0080  f3              78     78 
    PUSH    DE                          ;0081  d5              79     79 
    PUSH    BC                          ;0082  c5              80     80 
    PUSH    HL                          ;0083  e5              81     81 
    LD  D,0D7h                          ;0084  16 d7           82     82 
    LD  E,0CCh                          ;0086  1e cc           83     83 
    LD  HL,FILMOD                       ;0088  21 96 13        84     84 
    LD  BC,00080H                       ;008b  01 80 00        85     85 
                                        ;                      86     86 ;
FSAVE0: CALL    CKSUM                   ;008e  cd 9e 03        87     87 
    CALL    MOTON                       ;0091  cd e0 02        88     88 
    JP  C,CLOAD4                        ;0094  da 93 01        89     89 
    LD  A,E                             ;0097  7b              90     90 
    CP  0CCh                            ;0098  fe cc           91     91 
    JR  NZ,FSAVE1                       ;009a  20 11           92     92 
    CALL    CR2                         ;009c  cd 23 08        93     93 
    PUSH    DE                          ;009f  d5              94     94 
    LD  DE,WRITEM                       ;00a0  11 75 03        95     95 
    CALL    DEPRT                       ;00a3  cd f3 07        96     96 ;'WRITING '
    LD  DE,FILNAM                       ;00a6  11 97 13        97     97 
    CALL    DEPRT                       ;00a9  cd f3 07        98     98 ;FILE NAME
    POP DE                              ;00ac  d1              99     99 
                                        ;                     100    100 ;
FSAVE1: CALL    WRMRK                   ;00ad  cd 02 04       101    101 ;GAP
    CALL    SAVE                        ;00b0  cd ce 00       102    102 ;STADR=HL/LEN=BC
    JP  CLOAD4                          ;00b3  c3 93 01       103    103 
                                        ;                     104    104 ;
                                        ;                     105    105 ;
                                        ;                     106    106 ;
                                        ;                     107    107 ; BODY SAVE
                                        ;                     108    108 ; START ADR	= (MTADRS=13AAH)
                                        ;                     109    109 ; LENGTH	= (MTBYTE=13A8H)
                                        ;                     110    110 ; CARRY FLAG	= 0... OK
                                        ;                     111    111 ; CARRY FLAG	= 1... BREAK IN
                                        ;                     112    112 ;
MSAVE:  DI                              ;00b6  f3             113    113 
    PUSH    DE                          ;00b7  d5             114    114 
    PUSH    BC                          ;00b8  c5             115    115 
    PUSH    HL                          ;00b9  e5             116    116 
    LD  D,0D7h                          ;00ba  16 d7          117    117 
    LD  E,053h                          ;00bc  1e 53          118    118 
    LD  HL,(MTBYTE)                     ;00be  2a a8 13       119    119 
    PUSH    HL                          ;00c1  e5             120    120 
    POP BC                              ;00c2  c1             121    121 
    LD  HL,(MTADRS)                     ;00c3  2a aa 13       122    122 
    LD  A,B                             ;00c6  78             123    123 
    OR  C                               ;00c7  b1             124    124 
    JP  Z,SAVE4                         ;00c8  ca 0c 01       125    125 
    JP  FSAVE0                          ;00cb  c3 8e 00       126    126 
                                        ;                     127    127 ;
SAVE:   PUSH    DE                      ;00ce  d5             128    128 
    PUSH    BC                          ;00cf  c5             129    129 
    PUSH    HL                          ;00d0  e5             130    130 
    LD  D,001h                          ;00d1  16 01          131    131 ;원래값은 002h
SAVE1:  LD  A,(HL)                      ;00d3  7e             132    132 ;~
    CALL    WRACC                       ;00d4  cd ef 03       133    133 ;1BYTE WRITE
    LD  A,080h                          ;00d7  3e 80          134    134 ;8000H
    IN  A,(000h)                        ;00d9  db 00          135    135 
    AND 012h                            ;00db  e6 12          136    136 ;BREAK+SHIFT
    JR  NZ,SAVE0                        ;00dd  20 04          137    137 
    SCF                                 ;00df  37             138    138 
    JP  SAVE4                           ;00e0  c3 0c 01       139    139 
                                        ;                     140    140 ;
SAVE0:  INC HL                          ;00e3  23             141    141 
    DEC BC                              ;00e4  0b             142    142 ;BC BYTES CHECK
    LD  A,B                             ;00e5  78             143    143 
    OR  C                               ;00e6  b1             144    144 
    JP  NZ,SAVE1                        ;00e7  c2 d3 00       145    145 
    LD  HL,(CKSMF1)                     ;00ea  2a e3 11       146    146 ;CHECK SUM WRITE
    LD  A,H                             ;00ed  7c             147    147 
    CALL    WRACC                       ;00ee  cd ef 03       148    148 
    LD  A,L                             ;00f1  7d             149    149 
    CALL    WRACC                       ;00f2  cd ef 03       150    150 
    CALL    WRITEL                      ;00f5  cd dd 03       151    151 ;BIT 1 WRITE
    DEC D                               ;00f8  15             152    152 
    JP  NZ,SAVE2                        ;00f9  c2 00 01       153    153 
    OR  A                               ;00fc  b7             154    154 
    JP  SAVE4                           ;00fd  c3 0c 01       155    155 
                                        ;                     156    156 ;
SAVE2:                                  ;                     157    157 
    LD  BC, 04005h                      ;0100  01 05 40       158    158 
    OUT (C), A                          ;0103  ed 79          159    159 
    POP HL                              ;0105  e1             160    160 
    POP BC                              ;0106  c1             161    161 
    PUSH    BC                          ;0107  c5             162    162 
    PUSH    HL                          ;0108  e5             163    163 
    JP  SAVE1                           ;0109  c3 d3 00       164    164 
                                        ;                     165    165 ;
SAVE4:  POP HL                          ;010c  e1             166    166 
    POP BC                              ;010d  c1             167    167 
    POP DE                              ;010e  d1             168    168 
    RET                                 ;010f  c9             169    169 
                                        ;                     170    170 ;
FLOAD:  DI                              ;0110  f3             171    171 
    PUSH    DE                          ;0111  d5             172    172 
    PUSH    BC                          ;0112  c5             173    173 
    PUSH    HL                          ;0113  e5             174    174 
    LD  D,0D2h                          ;0114  16 d2          175    175 
    LD  E,0CCh                          ;0116  1e cc          176    176 
    LD  BC,FSAVE                        ;0118  01 80 00       177    177 
    LD  HL,FILMOD                       ;011b  21 96 13       178    178 
                                        ;                     179    179 ;
FLOAD1: CALL    MOTON                   ;011e  cd e0 02       180    180 
    JP  C,CLOAD5                        ;0121  da a9 01       181    181 
    CALL    MKRD                        ;0124  cd 8b 02       182    182 
    JP  C,CLOAD5                        ;0127  da a9 01       183    183 
    CALL    CLOAD                       ;012a  cd 48 01       184    184 
    JP  CLOAD4                          ;012d  c3 93 01       185    185 
                                        ;                     186    186 ;
MLOAD:  DI                              ;0130  f3             187    187 
    PUSH    DE                          ;0131  d5             188    188 
    PUSH    BC                          ;0132  c5             189    189 
    PUSH    HL                          ;0133  e5             190    190 
    LD  D,0D2h                          ;0134  16 d2          191    191 
    LD  E,053h                          ;0136  1e 53          192    192 
    LD  HL,(MTBYTE)                     ;0138  2a a8 13       193    193 
    PUSH    HL                          ;013b  e5             194    194 
    POP BC                              ;013c  c1             195    195 
    LD  HL,(MTADRS)                     ;013d  2a aa 13       196    196 
    LD  A,B                             ;0140  78             197    197 
    OR  C                               ;0141  b1             198    198 
    JP  Z,CLOAD4                        ;0142  ca 93 01       199    199 
    JP  FLOAD1                          ;0145  c3 1e 01       200    200 
                                        ;                     201    201 ;
CLOAD:  PUSH    DE                      ;0148  d5             202    202 
    PUSH    BC                          ;0149  c5             203    203 
    PUSH    HL                          ;014a  e5             204    204 
    LD  H,002h                          ;014b  26 02          205    205 ;원래값은 002h - 소스 수정
                                        ;                     206    206 ;
CLOAD7: LD  BC,04000h                   ;014d  01 00 40       207    207 
    LD  A,14                            ;0150  3e 0e          208    208 
    OUT (C),A                           ;0152  ed 79          209    209 
                                        ;                     210    210 ;
CLOAD0: CALL    EDGE                    ;0154  cd 3f 02       211    211 
    JP  C,CLOAD5                        ;0157  da a9 01       212    212 
    CALL    WAITR                       ;015a  cd c4 03       213    213 
                                        ;                     214    214 ;	LD	A,040h
                                        ;                     215    215 ;	IN	A,(1)	;IN A,(4001H)
                                        ;                     216    216 ;	AND	080h
    JP  Z,CLOAD0                        ;015d  ca 54 01       217    217 
    LD  D,H                             ;0160  54             218    218 
    LD  HL,00000h                       ;0161  21 00 00       219    219 
    LD  (CKSMF1),HL                     ;0164  22 e3 11       220    220 
    POP HL                              ;0167  e1             221    221 
    POP BC                              ;0168  c1             222    222 
    PUSH    BC                          ;0169  c5             223    223 
    PUSH    HL                          ;016a  e5             224    224 
                                        ;                     225    225 ;
CLOAD1: CALL    VBLOAD                  ;016b  cd 59 02       226    226 
    JP  C,CLOAD5                        ;016e  da a9 01       227    227 
    LD  (HL),A                          ;0171  77             228    228 
    INC HL                              ;0172  23             229    229 
    DEC BC                              ;0173  0b             230    230 
    LD  A,B                             ;0174  78             231    231 
    OR  C                               ;0175  b1             232    232 
    JP  NZ,CLOAD1                       ;0176  c2 6b 01       233    233 
    LD  HL,(CKSMF1)                     ;0179  2a e3 11       234    234 
    CALL    VBLOAD                      ;017c  cd 59 02       235    235 
    JP  C,CLOAD5                        ;017f  da a9 01       236    236 
    LD  E,A                             ;0182  5f             237    237 
    CALL    VBLOAD                      ;0183  cd 59 02       238    238 
    JP  C,CLOAD5                        ;0186  da a9 01       239    239 
    CP  L                               ;0189  bd             240    240 
    JP  NZ,CLOAD2                       ;018a  c2 9b 01       241    241 
    LD  A,E                             ;018d  7b             242    242 
    CP  H                               ;018e  bc             243    243 
    JP  NZ,CLOAD2                       ;018f  c2 9b 01       244    244 
                                        ;                     245    245 ;
CLOAD8: XOR A                           ;0192  af             246    246 
                                        ;                     247    247 ;
CLOAD4: POP HL                          ;0193  e1             248    248 
    POP BC                              ;0194  c1             249    249 
    POP DE                              ;0195  d1             250    250 
    CALL    MOTCH                       ;0196  cd 44 03       251    251 
    EI                                  ;0199  fb             252    252 
    RET                                 ;019a  c9             253    253 
                                        ;                     254    254 ;
CLOAD2: DEC D                           ;019b  15             255    255 
    JP  Z,CLOAD3                        ;019c  ca a3 01       256    256 
    LD  H,D                             ;019f  62             257    257 
    JP  CLOAD7                          ;01a0  c3 4d 01       258    258 
                                        ;                     259    259 ;
CLOAD3: LD  A,001h                      ;01a3  3e 01          260    260 
    SCF                                 ;01a5  37             261    261 
    JP  CLOAD4                          ;01a6  c3 93 01       262    262 
                                        ;                     263    263 ;
CLOAD5: LD  A,002h                      ;01a9  3e 02          264    264 
    SCF                                 ;01ab  37             265    265 
    JP  CLOAD4                          ;01ac  c3 93 01       266    266 
                                        ;                     267    267 ;
MVRFY:  DI                              ;01af  f3             268    268 
    PUSH    DE                          ;01b0  d5             269    269 
    PUSH    BC                          ;01b1  c5             270    270 
    PUSH    HL                          ;01b2  e5             271    271 
    LD  HL,(MTBYTE)                     ;01b3  2a a8 13       272    272 
    PUSH    HL                          ;01b6  e5             273    273 
    POP BC                              ;01b7  c1             274    274 
    LD  HL,(MTADRS)                     ;01b8  2a aa 13       275    275 
    LD  D,0D2h                          ;01bb  16 d2          276    276 
    LD  E,053h                          ;01bd  1e 53          277    277 
    LD  A,B                             ;01bf  78             278    278 
    OR  C                               ;01c0  b1             279    279 
    JP  Z,CLOAD4                        ;01c1  ca 93 01       280    280 
    CALL    CKSUM                       ;01c4  cd 9e 03       281    281 
    CALL    MOTON                       ;01c7  cd e0 02       282    282 
    JP  C,CLOAD5                        ;01ca  da a9 01       283    283 
    CALL    MKRD                        ;01cd  cd 8b 02       284    284 
    JP  C,CLOAD5                        ;01d0  da a9 01       285    285 
    CALL    MVRFY1                      ;01d3  cd d9 01       286    286 
    JP  CLOAD4                          ;01d6  c3 93 01       287    287 
                                        ;                     288    288 ;
MVRFY1: PUSH    DE                      ;01d9  d5             289    289 
    PUSH    BC                          ;01da  c5             290    290 
    PUSH    HL                          ;01db  e5             291    291 
    LD  H,002h                          ;01dc  26 02          292    292 
                                        ;                     293    293 ;
MVRFYN: LD  BC,04000h                   ;01de  01 00 40       294    294 
    LD  A,14                            ;01e1  3e 0e          295    295 
    OUT (C),A                           ;01e3  ed 79          296    296 
                                        ;                     297    297 ;
MVRFY2: CALL    EDGE                    ;01e5  cd 3f 02       298    298 
    JP  C,CLOAD5                        ;01e8  da a9 01       299    299 
    CALL    WAITR                       ;01eb  cd c4 03       300    300 
                                        ;                     301    301 ;	LD	A,040h
                                        ;                     302    302 ;	IN	A,(1)
                                        ;                     303    303 ;	AND	080h
    JP  Z,MVRFY2                        ;01ee  ca e5 01       304    304 
    LD  D,H                             ;01f1  54             305    305 
    POP HL                              ;01f2  e1             306    306 
    POP BC                              ;01f3  c1             307    307 
    PUSH    BC                          ;01f4  c5             308    308 
    PUSH    HL                          ;01f5  e5             309    309 
                                        ;                     310    310 ;
MVRFY3: CALL    VBLOAD                  ;01f6  cd 59 02       311    311 
    JP  C,CLOAD5                        ;01f9  da a9 01       312    312 
    CP  (HL)                            ;01fc  be             313    313 
    JP  NZ,CLOAD3                       ;01fd  c2 a3 01       314    314 
    INC HL                              ;0200  23             315    315 
    DEC BC                              ;0201  0b             316    316 
    LD  A,B                             ;0202  78             317    317 
    OR  C                               ;0203  b1             318    318 
    JP  NZ,MVRFY3                       ;0204  c2 f6 01       319    319 
    LD  HL,(CKSMF2)                     ;0207  2a e5 11       320    320 
    CALL    VBLOAD                      ;020a  cd 59 02       321    321 
    CP  H                               ;020d  bc             322    322 
    JP  NZ,CLOAD3                       ;020e  c2 a3 01       323    323 
    CALL    VBLOAD                      ;0211  cd 59 02       324    324 
    CP  L                               ;0214  bd             325    325 
    JP  NZ,CLOAD3                       ;0215  c2 a3 01       326    326 
    DEC D                               ;0218  15             327    327 
    JP  Z,CLOAD8                        ;0219  ca 92 01       328    328 
    LD  H,D                             ;021c  62             329    329 
    JP  MVRFYN                          ;021d  c3 de 01       330    330 
                                        ;                     331    331 ;
MVRFY4: LD  A,080h                      ;0220  3e 80          332    332 
    IN  A,(0)                           ;0222  db 00          333    333 ;IN A,(8000H)
    AND 012h                            ;0224  e6 12          334    334 
    JP  NZ,MVRFY5                       ;0226  c2 2b 02       335    335 
    SCF                                 ;0229  37             336    336 
    RET                                 ;022a  c9             337    337 
                                        ;                     338    338 ;
MVRFY5:                                 ;                     339    339 
    LD  A,040h                          ;022b  3e 40          340    340 
    IN  A,(1)                           ;022d  db 01          341    341 ;IN A,(4001H)
    AND 080h                            ;022f  e6 80          342    342 
    JP  NZ,MVRFY4                       ;0231  c2 20 02       343    343 
                                        ;                     344    344 ;
MVRFY6: LD  A,080h                      ;0234  3e 80          345    345 
    IN  A,(0)                           ;0236  db 00          346    346 ;IN A,(8001H)
    AND 012h                            ;0238  e6 12          347    347 
    JP  NZ,MVRFY7                       ;023a  c2 3f 02       348    348 
    SCF                                 ;023d  37             349    349 
    RET                                 ;023e  c9             350    350 
                                        ;                     351    351 ;
EDGE:                                   ;                     352    352 
MVRFY7: LD  A,040h                      ;023f  3e 40          353    353 
    IN  A,(1)                           ;0241  db 01          354    354 ;IN A,(4001H)
    AND 080h                            ;0243  e6 80          355    355 
                                        ;                     356    356 ;	JP	Z,MVRFY6
    RET                                 ;0245  c9             357    357 
                                        ;                     358    358 ;
    ORG 0259H                           ;                     359    359 
VBLOAD: PUSH    BC                      ;0259  c5             360    360 
    PUSH    DE                          ;025a  d5             361    361 
    PUSH    HL                          ;025b  e5             362    362 
    LD  HL,00800h                       ;025c  21 00 08       363    363 
    LD  BC,04000h                       ;025f  01 00 40       364    364 
    LD  A,14                            ;0262  3e 0e          365    365 
    OUT (C),A                           ;0264  ed 79          366    366 
VBLOD1: CALL    EDGE                    ;0266  cd 3f 02       367    367 
    JP  C,VBLOD3                        ;0269  da 87 02       368    368 
    CALL    WAITR                       ;026c  cd c4 03       369    369 
                                        ;                     370    370 ;	LD	A,040h
                                        ;                     371    371 ;	IN	A,(1)		;IN A,(4001H)
                                        ;                     372    372 ;	AND	080h
    JP  Z,VBLOD2                        ;026f  ca 7c 02       373    373 
    PUSH    HL                          ;0272  e5             374    374 
    LD  HL,(CKSMF1)                     ;0273  2a e3 11       375    375 
    INC HL                              ;0276  23             376    376 
    LD  (CKSMF1),HL                     ;0277  22 e3 11       377    377 
    POP HL                              ;027a  e1             378    378 
    SCF                                 ;027b  37             379    379 
                                        ;                     380    380 ;
VBLOD2: LD  A,L                         ;027c  7d             381    381 
    RLA                                 ;027d  17             382    382 
    LD  L,A                             ;027e  6f             383    383 
    DEC H                               ;027f  25             384    384 
    JP  NZ,VBLOD1                       ;0280  c2 66 02       385    385 
    CALL    EDGE                        ;0283  cd 3f 02       386    386 
    LD  A,L                             ;0286  7d             387    387 
                                        ;                     388    388 ;
VBLOD3: POP HL                          ;0287  e1             389    389 
    POP DE                              ;0288  d1             390    390 
    POP BC                              ;0289  c1             391    391 
    RET                                 ;028a  c9             392    392 
                                        ;                     393    393 ;
MKRD:   PUSH    BC                      ;028b  c5             394    394 
    PUSH    DE                          ;028c  d5             395    395 
    PUSH    HL                          ;028d  e5             396    396 
    LD  HL,02828h                       ;028e  21 28 28       397    397 
    LD  A,E                             ;0291  7b             398    398 
    CP  0CCh                            ;0292  fe cc          399    399 
    JP  Z,MKRD1                         ;0294  ca 9a 02       400    400 
    LD  HL,01414h                       ;0297  21 14 14       401    401 
                                        ;                     402    402 ;
MKRD1:  LD  (MKLEN),HL                  ;029a  22 e7 11       403    403 
    LD  BC,04000h                       ;029d  01 00 40       404    404 
    LD  A,14                            ;02a0  3e 0e          405    405 
    OUT (C),A                           ;02a2  ed 79          406    406 
MKRD4:  LD  HL,(MKLEN)                  ;02a4  2a e7 11       407    407 
                                        ;                     408    408 ;
MKRD5:  CALL    EDGE                    ;02a7  cd 3f 02       409    409 
    JP  C,MKRD3                         ;02aa  da ca 02       410    410 
    CALL    WAITR                       ;02ad  cd c4 03       411    411 
                                        ;                     412    412 ;	LD	A,040h
                                        ;                     413    413 ;	IN	A,(1)		;IN A,(4001H)
                                        ;                     414    414 ;	AND	080h
    JP  Z,MKRD4                         ;02b0  ca a4 02       415    415 
    DEC H                               ;02b3  25             416    416 
    JP  NZ,MKRD5                        ;02b4  c2 a7 02       417    417 
                                        ;                     418    418 ;
MKRD2:  CALL    EDGE                    ;02b7  cd 3f 02       419    419 
    JP  C,MKRD3                         ;02ba  da ca 02       420    420 
    CALL    WAITR                       ;02bd  cd c4 03       421    421 
                                        ;                     422    422 ;	LD	A,040h
                                        ;                     423    423 ;	IN	A,(1)		;IN A,(4001H)
                                        ;                     424    424 ;	AND	080h
    JP  NZ,MKRD4                        ;02c0  c2 a4 02       425    425 
    DEC L                               ;02c3  2d             426    426 
    JP  NZ,MKRD2                        ;02c4  c2 b7 02       427    427 
    CALL    EDGE                        ;02c7  cd 3f 02       428    428 
                                        ;                     429    429 ;
MKRD3:  POP HL                          ;02ca  e1             430    430 
    POP DE                              ;02cb  d1             431    431 
    POP BC                              ;02cc  c1             432    432 
    RET                                 ;02cd  c9             433    433 
                                        ;                     434    434 ;
    ORG 2E0h                            ;                     435    435 
MOTON:  PUSH    BC                      ;02e0  c5             436    436 
    PUSH    DE                          ;02e1  d5             437    437 
    PUSH    HL                          ;02e2  e5             438    438 
    LD  BC,04000h                       ;02e3  01 00 40       439    439 
    LD  A,14                            ;02e6  3e 0e          440    440 ;A PORT SELECT
    OUT (C),A                           ;02e8  ed 79          441    441 
    LD  L,00Ah                          ;02ea  2e 0a          442    442 
    LD  BC,06000h                       ;02ec  01 00 60       443    443 
MOTON1: LD  A,040h                      ;02ef  3e 40          444    444 
    IN  A,(1)                           ;02f1  db 01          445    445 ;IN A,(4001H)
    AND 040h                            ;02f3  e6 40          446    446 
    JP  NZ,MOTON5                       ;02f5  c2 fd 02       447    447 
                                        ;                     448    448 ;
MOTON6: XOR A                           ;02f8  af             449    449 
                                        ;                     450    450 ;
MOTON4: POP HL                          ;02f9  e1             451    451 
    POP DE                              ;02fa  d1             452    452 
    POP BC                              ;02fb  c1             453    453 
    RET                                 ;02fc  c9             454    454 
                                        ;                     455    455 ;
MOTON5: LD  A,(IO6000)                  ;02fd  3a e9 11       456    456 
    RES 1,A                             ;0300  cb 8f          457    457 
    OUT (C),A                           ;0302  ed 79          458    458 
    SET 1,A                             ;0304  cb cf          459    459 
    OUT (C),A                           ;0306  ed 79          460    460 
    LD  (IO6000),A                      ;0308  32 e9 11       461    461 
    DEC L                               ;030b  2d             462    462 
    JP  NZ,MOTON1                       ;030c  c2 ef 02       463    463 
    CALL    CR2                         ;030f  cd 23 08       464    464 
    LD  A,D                             ;0312  7a             465    465 
    CP  0D7h                            ;0313  fe d7          466    466 
    JR  Z,MOTON2                        ;0315  28 08          467    467 
    LD  DE,MBUF6                        ;0317  11 7e 03       468    468 
    CALL    DEPRT                       ;031a  cd f3 07       469    469 
    JR  MOTON3                          ;031d  18 0c          470    470 
                                        ;                     471    471 ;
MOTON2: LD  DE,MBUF7                    ;031f  11 8f 03       472    472 
    CALL    DEPRT                       ;0322  cd f3 07       473    473 
    LD  DE,MBUF6A                       ;0325  11 83 03       474    474 
    CALL    DEPRT                       ;0328  cd f3 07       475    475 
                                        ;                     476    476 ;
MOTON3: CALL    CR2                     ;032b  cd 23 08       477    477 
    LD  A,040h                          ;032e  3e 40          478    478 
    IN  A,(1)                           ;0330  db 01          479    479 ;IN A,(4001H)
    AND 040h                            ;0332  e6 40          480    480 
    JP  Z,MOTON6                        ;0334  ca f8 02       481    481 
    LD  A,080h                          ;0337  3e 80          482    482 
    IN  A,(0)                           ;0339  db 00          483    483 ;IN A,(8000H)
    AND 012h                            ;033b  e6 12          484    484 
    JP  NZ,MOTON3                       ;033d  c2 2b 03       485    485 
    SCF                                 ;0340  37             486    486 
    JP  MOTON4                          ;0341  c3 f9 02       487    487 
                                        ;                     488    488 ;
MOTCH:  PUSH    AF                      ;0344  f5             489    489 
    PUSH    BC                          ;0345  c5             490    490 
    PUSH    DE                          ;0346  d5             491    491 
    LD  D,00Ah                          ;0347  16 0a          492    492 
    LD  BC,04000h                       ;0349  01 00 40       493    493 
    LD  A,14                            ;034c  3e 0e          494    494 
    OUT (C),A                           ;034e  ed 79          495    495 
    LD  BC,06000h                       ;0350  01 00 60       496    496 
MOTCH1: LD  A,040h                      ;0353  3e 40          497    497 
    IN  A,(1)                           ;0355  db 01          498    498 ;IN A,(4001H)
    AND 040h                            ;0357  e6 40          499    499 
    JR  Z,MOTCH2                        ;0359  28 04          500    500 
    POP DE                              ;035b  d1             501    501 
    POP BC                              ;035c  c1             502    502 
    POP AF                              ;035d  f1             503    503 
    RET                                 ;035e  c9             504    504 
                                        ;                     505    505 ;
MOTCH2: LD  A,(IO6000)                  ;035f  3a e9 11       506    506 
    RES 1,A                             ;0362  cb 8f          507    507 
    OUT (C),A                           ;0364  ed 79          508    508 
    SET 1,A                             ;0366  cb cf          509    509 
    OUT (C),A                           ;0368  ed 79          510    510 
    LD  (IO6000),A                      ;036a  32 e9 11       511    511 
    DEC D                               ;036d  15             512    512 
    JP  NZ,MOTCH1                       ;036e  c2 53 03       513    513 
    POP DE                              ;0371  d1             514    514 
    POP BC                              ;0372  c1             515    515 
    POP AF                              ;0373  f1             516    516 
    RET                                 ;0374  c9             517    517 
                                        ;                     518    518 ;
                                        ;                     519    519 ;
WRITEM: DEFM    'WRITING '              ;0375  57 52 49 54    520    520 
                                        ;0379  49 4e 47 20    520    521
    DEFB    0                           ;037d  00             521    522 
                                        ;                     522    523 ;
MBUF6:  DEFM    'PUSH '                 ;037e  50 55 53 48    523    524 
                                        ;0382  20             523    525
MBUF6A: DEFM    'PLAY BUTTON'           ;0383  50 4c 41 59    524    526 
                                        ;0387  20 42 55 54    524    527
                                        ;038b  54 4f 4e       524    528
    DEFB    0                           ;038e  00             525    529 
                                        ;                     526    530 ;
MBUF7:  DEFM    'PUSH '                 ;038f  50 55 53 48    527    531 
                                        ;0393  20             527    532
    DEFM    'RECORD & '                 ;0394  52 45 43 4f    528    533 
                                        ;0398  52 44 20 26    528    534
                                        ;039c  20             528    535
                                        ;                     529    536 
    DEFB    0                           ;039d  00             530    537 
                                        ;                     531    538 ;
CKSUM:  PUSH    BC                      ;039e  c5             532    539 
    PUSH    DE                          ;039f  d5             533    540 
    PUSH    HL                          ;03a0  e5             534    541 
    LD  DE,00000h                       ;03a1  11 00 00       535    542 
                                        ;                     536    543 ;
SUM1:   LD  A,B                         ;03a4  78             537    544 
    OR  C                               ;03a5  b1             538    545 
    JR  NZ,SUM2                         ;03a6  20 0b          539    546 
    EX  DE,HL                           ;03a8  eb             540    547 
    LD  (CKSMF1),HL                     ;03a9  22 e3 11       541    548 
    LD  (CKSMF2),HL                     ;03ac  22 e5 11       542    549 
    POP HL                              ;03af  e1             543    550 
    POP DE                              ;03b0  d1             544    551 
    POP BC                              ;03b1  c1             545    552 
    RET                                 ;03b2  c9             546    553 
                                        ;                     547    554 ;
SUM2:   LD  A,(HL)                      ;03b3  7e             548    555 
    PUSH    HL                          ;03b4  e5             549    556 
    LD  H,008h                          ;03b5  26 08          550    557 
                                        ;                     551    558 ;
SUM3:   RLCA                            ;03b7  07             552    559 
    JR  NC,SUM4                         ;03b8  30 01          553    560 
    INC DE                              ;03ba  13             554    561 
                                        ;                     555    562 ;
SUM4:   DEC H                           ;03bb  25             556    563 
    JR  NZ,SUM3                         ;03bc  20 f9          557    564 
    POP HL                              ;03be  e1             558    565 
    INC HL                              ;03bf  23             559    566 
    DEC BC                              ;03c0  0b             560    567 
    JP  SUM1                            ;03c1  c3 a4 03       561    568 
                                        ;                     562    569 ;
                                        ;                     563    570 ;
                                        ;                     564    571 ;WAITR:	RET			;★원래는 이 자리가 3E
                                        ;                     565    572 ;	LD	E,D			;★원래는 LD A,90
WAITR:                                  ;                     566    573 
    RET                                 ;03c4  c9             567    574 
                                        ;                     568    575 ;	LD  A,1		; 원래는 90
    RET                                 ;03c5  c9             569    576 
WAIT2:  DEC A                           ;03c6  3d             570    577 
    JP  NZ,WAIT2                        ;03c7  c2 c6 03       571    578 
    RET                                 ;03ca  c9             572    579 
                                        ;                     573    580 ;
WRITES: PUSH    AF                      ;03cb  f5             574    581 
    PUSH    BC                          ;03cc  c5             575    582 
    LD  BC,06000h                       ;03cd  01 00 60       576    583 
    LD  A,(IO6000)                      ;03d0  3a e9 11       577    584 
                                        ;                     578    585 ;	SET	0,A
                                        ;                     579    586 ;	OUT	(C),A
                                        ;                     580    587 ;	PUSH	AF
                                        ;                     581    588 ;	LD	A,60		;MSX는 38
                                        ;                     582    589 ;	CALL	WAIT2
                                        ;                     583    590 ;	POP	AF
    RES 0,A                             ;03d3  cb 87          584    591 
    OUT (C),A                           ;03d5  ed 79          585    592 
    LD  (IO6000),A                      ;03d7  32 e9 11       586    593 
                                        ;                     587    594 ;	LD	A,55		;MSX는 45
                                        ;                     588    595 ;	CALL	WAIT2
    POP BC                              ;03da  c1             589    596 
    POP AF                              ;03db  f1             590    597 
    RET                                 ;03dc  c9             591    598 
                                        ;                     592    599 ;
WRITEL: PUSH    AF                      ;03dd  f5             593    600 
    PUSH    BC                          ;03de  c5             594    601 
    LD  BC,06000h                       ;03df  01 00 60       595    602 
    LD  A,(IO6000)                      ;03e2  3a e9 11       596    603 
    SET 0,A                             ;03e5  cb c7          597    604 
    OUT (C),A                           ;03e7  ed 79          598    605 
                                        ;                     599    606 ;	PUSH	AF
                                        ;                     600    607 ;	LD	A,120		;MSX는 83
                                        ;                     601    608 ;	CALL	WAIT2
                                        ;                     602    609 ;	POP	AF
                                        ;                     603    610 ;	RES	0,A
                                        ;                     604    611 ;	OUT	(C),A
    LD  (IO6000),A                      ;03e9  32 e9 11       605    612 
                                        ;                     606    613 ;	LD	A,115		;MSX는 92
                                        ;                     607    614 ;	CALL	WAIT2
    POP BC                              ;03ec  c1             608    615 
    POP AF                              ;03ed  f1             609    616 
    RET                                 ;03ee  c9             610    617 
                                        ;                     611    618 ;
WRACC:  PUSH    BC                      ;03ef  c5             612    619 
    LD  B,008h                          ;03f0  06 08          613    620 
    CALL    WRITEL                      ;03f2  cd dd 03       614    621 ;BIT 1 WRITE
                                        ;                     615    622 ;
WRACC1: RLCA                            ;03f5  07             616    623 
    CALL    C,WRITEL                    ;03f6  dc dd 03       617    624 
    CALL    NC,WRITES                   ;03f9  d4 cb 03       618    625 
    DEC B                               ;03fc  05             619    626 
    JP  NZ,WRACC1                       ;03fd  c2 f5 03       620    627 
    POP BC                              ;0400  c1             621    628 
    RET                                 ;0401  c9             622    629 
                                        ;                     623    630 ;
WRMRK:  PUSH    BC                      ;0402  c5             624    631 
    PUSH    DE                          ;0403  d5             625    632 
    LD  A,E                             ;0404  7b             626    633 
    LD  BC,010h                         ;0405  01 10 00       627    634 
    LD  DE,02828h                       ;0408  11 28 28       628    635 
    CP  0CCh                            ;040b  fe cc          629    636 
    JP  Z,WMRK1                         ;040d  ca 16 04       630    637 
    LD  BC,010h                         ;0410  01 10 00       631    638 
    LD  DE,01414h                       ;0413  11 14 14       632    639 
                                        ;                     633    640 ;
WMRK1:  CALL    WRITES                  ;0416  cd cb 03       634    641 
    DEC BC                              ;0419  0b             635    642 
    LD  A,B                             ;041a  78             636    643 
    OR  C                               ;041b  b1             637    644 
    JR  NZ,WMRK1                        ;041c  20 f8          638    645 
                                        ;                     639    646 ;
WMRK2:  CALL    WRITEL                  ;041e  cd dd 03       640    647 
    DEC D                               ;0421  15             641    648 
    JR  NZ,WMRK2                        ;0422  20 fa          642    649 
                                        ;                     643    650 ;
WMRK3:  CALL    WRITES                  ;0424  cd cb 03       644    651 
    DEC E                               ;0427  1d             645    652 
    JR  NZ,WMRK3                        ;0428  20 fa          646    653 
    CALL    WRITEL                      ;042a  cd dd 03       647    654 
    POP DE                              ;042d  d1             648    655 
    POP BC                              ;042e  c1             649    656 
    RET                                 ;042f  c9             650    657 
                                        ;                     651    658 ;
                                        ;                     652    659 ;    MON (MONITOR)
                                        ;                     653    660 ;
                                        ;                     654    661 ;
    ORG 0450H                           ;                     655    662 
MONOP:  PUSH    HL                      ;0450  e5             656    663 
    LD  (MONSTK),SP                     ;0451  ed 73 83 04    657    664 
MONCOM: CALL    CR2                     ;0455  cd 23 08       658    665 
    LD  A,'*'                           ;0458  3e 2a          659    666 ;02AH
    CALL    ACCPRT                      ;045a  cd 64 08       660    667 
MONINP: CALL    MONEDT                  ;045d  cd e1 04       661    668 
    JR  NC,MONINP                       ;0460  30 fb          662    669 
    LD  BC,MONCOM                       ;0462  01 55 04       663    670 
    PUSH    BC                          ;0465  c5             664    671 
    LD  A,(DE)                          ;0466  1a             665    672 
    INC DE                              ;0467  13             666    673 
    CP  '*'                             ;0468  fe 2a          667    674 ;02AH
    RET NZ                              ;046a  c0             668    675 
    CALL    DESMAL                      ;046b  cd 53 05       669    676 
    CP  'G'                             ;046e  fe 47          670    677 ;047H
    JR  Z,CALLAD                        ;0470  28 2c          671    678 ;★원래는 ADJUMP
    CP  'D'                             ;0472  fe 44          672    679 ;044H
    JR  Z,MEMDMP                        ;0474  28 2d          673    680 
    CP  'M'                             ;0476  fe 4d          674    681 ;04DH
    JR  Z,MEMWRT                        ;0478  28 0d          675    682 
    CP  'S'                             ;047a  fe 53          676    683 ;053H
    JP  Z,MONSAH                        ;047c  ca 8e 05       677    684 
    CP  'R'                             ;047f  fe 52          678    685 ;052H
    RET NZ                              ;0481  c0             679    686 
    DEFB    031h                        ;0482  31             680    687 ;LD SP,HHHH
MONSTK: DEFW    00000h                  ;0483  00 00          681    688 
    POP HL                              ;0485  e1             682    689 
    RET                                 ;0486  c9             683    690 
                                        ;                     684    691 ;
MEMWRT: CALL    HLSET                   ;0487  cd 09 05       685    692 
WRTLP:  CALL    CRHLDS                  ;048a  cd 80 05       686    693 
    CALL    HLINDS                      ;048d  cd 5e 05       687    694 
    PUSH    HL                          ;0490  e5             688    695 
    CALL    LEFT                        ;0491  cd 48 0b       689    696 
    CALL    LEFT                        ;0494  cd 48 0b       690    697 
    POP HL                              ;0497  e1             691    698 
    CALL    MONEDT                      ;0498  cd e1 04       692    699 
    JR  NC,WRTLP                        ;049b  30 ed          693    700 
    RET                                 ;049d  c9             694    701 
                                        ;                     695    702 ;
CALLAD: CALL    HLSET                   ;049e  cd 09 05       696    703 ;★원래는 ADJUMP
    RET C                               ;04a1  d8             697    704 
    JP  (HL)                            ;04a2  e9             698    705 
                                        ;                     699    706 ;
                                        ;                     700    707 ;
MEMDMP: CALL    HLSET                   ;04a3  cd 09 05       701    708 
    PUSH    HL                          ;04a6  e5             702    709 
    CALL    HLSET                       ;04a7  cd 09 05       703    710 
    JR  NC,HLSTOK                       ;04aa  30 06          704    711 
    POP HL                              ;04ac  e1             705    712 
    PUSH    HL                          ;04ad  e5             706    713 
    LD  BC,0003Fh                       ;04ae  01 3f 00       707    714 
    ADD HL,BC                           ;04b1  09             708    715 
HLSTOK: LD  (HLEND),HL                  ;04b2  22 bb 04       709    716 
    POP HL                              ;04b5  e1             710    717 
MEMDPL: CALL    DMPSUB                  ;04b6  cd c8 04       711    718 
    RET Z                               ;04b9  c8             712    719 
    DEFB    011h                        ;04ba  11             713    720 ;LD DE,HHHH
HLEND:  DEFW    0FFFFh                  ;04bb  ff ff          714    721 ;★원래는 0000H
    EX  DE,HL                           ;04bd  eb             715    722 
    OR  A                               ;04be  b7             716    723 
    SBC HL,DE                           ;04bf  ed 52          717    724 
    EX  DE,HL                           ;04c1  eb             718    725 
    JR  NC,MEMDPL                       ;04c2  30 f2          719    726 
    RET                                 ;04c4  c9             720    727 
                                        ;                     721    728 ;
                                        ;                     722    729 ;
MONDPS: LD  B,C                         ;04c5  41             723    730 
    JR  DMPSB2                          ;04c6  18 02          724    731 
DMPSUB: DEFB    006h                    ;04c8  06             725    732 ;LD B,008H
LINCNT: DEFB    008h                    ;04c9  08             726    733 
DMPSB2: CALL    CRHLDS                  ;04ca  cd 80 05       727    734 
MEMLP2: CALL    HLINDS                  ;04cd  cd 5e 05       728    735 
    INC HL                              ;04d0  23             729    736 
    DJNZ    MEMLP2                      ;04d1  10 fa          730    737 
SPCSTP: LD  A,080h                      ;04d3  3e 80          731    738 
    IN  A,(001h)                        ;04d5  db 01          732    739 
    AND 004h                            ;04d7  e6 04          733    740 
    JR  Z,SPCSTP                        ;04d9  28 f8          734    741 
    CALL    CR2                         ;04db  cd 23 08       735    742 
    JP  BRKEY                           ;04de  c3 5b 0c       736    743 
                                        ;                     737    744 ;
MONEDT: LD  DE,KEYBUF                   ;04e1  11 4f 7a       738    745 
    CALL    INPUTF                      ;04e4  cd a4 06       739    746 
    CALL    HLSET                       ;04e7  cd 09 05       740    747 
    RET C                               ;04ea  d8             741    748 
    INC DE                              ;04eb  13             742    749 
DATAST: INC DE                          ;04ec  13             743    750 
    CALL    ACCSET                      ;04ed  cd f6 04       744    751 
    CCF                                 ;04f0  3f             745    752 
    RET NC                              ;04f1  d0             746    753 
    LD  (HL),A                          ;04f2  77             747    754 
    INC HL                              ;04f3  23             748    755 
    JR  DATAST                          ;04f4  18 f6          749    756 
                                        ;                     750    757 ;
ACCSET: LD  A,(DE)                      ;04f6  1a             751    758 
    CP  '                               ;04f7  fe 3b          752    759 ;'		;03BH
    JR  NZ,AHEXIN                       ;04f9  20 05          753    760 
    INC DE                              ;04fb  13             754    761 
    LD  A,(DE)                          ;04fc  1a             755    762 
    INC DE                              ;04fd  13             756    763 
    OR  A                               ;04fe  b7             757    764 
    RET                                 ;04ff  c9             758    765 
AHEXIN: PUSH    DE                      ;0500  d5             759    766 
    CALL    HEX2IN                      ;0501  cd 2c 05       760    767 ;★원래는 2HEXIN인데 라벨이 숫자부터 시작이 가능했었나보다.
    POP DE                              ;0504  d1             761    768 
    RET C                               ;0505  d8             762    769 
    INC DE                              ;0506  13             763    770 
    INC DE                              ;0507  13             764    771 
    RET                                 ;0508  c9             765    772 
                                        ;                     766    773 ;
HLSET:  LD  A,(DE)                      ;0509  1a             767    774 
    INC DE                              ;050a  13             768    775 
    CP  020h                            ;050b  fe 20          769    776 
    JR  Z,HLSET                         ;050d  28 fa          770    777 
    DEC DE                              ;050f  1b             771    778 
    PUSH    HL                          ;0510  e5             772    779 
    CALL    HEX4IN                      ;0511  cd 1f 05       773    780 ;★원래는 4HEXIN인데 라벨이 숫자부터 시작이 가능했었나보다.
    JR  C,HLHOLD                        ;0514  38 07          774    781 
    POP AF                              ;0516  f1             775    782 
    INC DE                              ;0517  13             776    783 
    INC DE                              ;0518  13             777    784 
    INC DE                              ;0519  13             778    785 
    INC DE                              ;051a  13             779    786 
    OR  A                               ;051b  b7             780    787 
    RET                                 ;051c  c9             781    788 
HLHOLD: POP HL                          ;051d  e1             782    789 
    RET                                 ;051e  c9             783    790 
                                        ;                     784    791 ;
HEX4IN: PUSH    DE                      ;051f  d5             785    792 
    CALL    HEX2IN                      ;0520  cd 2c 05       786    793 
    JR  C,HEX4ER                        ;0523  38 05          787    794 ;★원래는 4HEXER인데 라벨이 숫자부터 시작이 가능했었나보다.
    LD  H,A                             ;0525  67             788    795 
    CALL    HEX2IN                      ;0526  cd 2c 05       789    796 
    LD  L,A                             ;0529  6f             790    797 
HEX4ER: POP DE                          ;052a  d1             791    798 
    RET                                 ;052b  c9             792    799 
                                        ;                     793    800 ;
HEX2IN: CALL    BHEXIN                  ;052c  cd 40 05       794    801 
    RET C                               ;052f  d8             795    802 
    PUSH    BC                          ;0530  c5             796    803 
    RLCA                                ;0531  07             797    804 
    RLCA                                ;0532  07             798    805 
    RLCA                                ;0533  07             799    806 
    RLCA                                ;0534  07             800    807 
    LD  C,A                             ;0535  4f             801    808 
    CALL    BHEXIN                      ;0536  cd 40 05       802    809 
    PUSH    AF                          ;0539  f5             803    810 
    OR  C                               ;053a  b1             804    811 
    LD  C,A                             ;053b  4f             805    812 
    POP AF                              ;053c  f1             806    813 
    LD  A,C                             ;053d  79             807    814 
    POP BC                              ;053e  c1             808    815 
    RET                                 ;053f  c9             809    816 
                                        ;                     810    817 ;
BHEXIN: CALL    DESMAL                  ;0540  cd 53 05       811    818 
    SUB 030h                            ;0543  d6 30          812    819 
    RET C                               ;0545  d8             813    820 
    CP  00Ah                            ;0546  fe 0a          814    821 
    CCF                                 ;0548  3f             815    822 
    RET NC                              ;0549  d0             816    823 
    CP  011h                            ;054a  fe 11          817    824 
    RET C                               ;054c  d8             818    825 
    SUB 007h                            ;054d  d6 07          819    826 
    CP  010h                            ;054f  fe 10          820    827 
    CCF                                 ;0551  3f             821    828 
    RET                                 ;0552  c9             822    829 
                                        ;                     823    830 ;
DESMAL: LD  A,(DE)                      ;0553  1a             824    831 
    INC DE                              ;0554  13             825    832 
    CP  'a'                             ;0555  fe 61          826    833 ;061h
    RET C                               ;0557  d8             827    834 
    CP  'z'+1                           ;0558  fe 7b          828    835 ;07Bh
    RET NC                              ;055a  d0             829    836 
    SUB ' '                             ;055b  d6 20          830    837 ;020h
    RET                                 ;055d  c9             831    838 
                                        ;                     832    839 ;
                                        ;                     833    840 ;
                                        ;                     834    841 ;
HLINDS: CALL    SPPRT                   ;055e  cd 62 08       835    842 
    LD  A,(HL)                          ;0561  7e             836    843 
HEX2PR: PUSH    AF                      ;0562  f5             837    844 ;★원래는 2HEXPR인데 라벨이 숫자부터 시작이 가능했었나보다.
    AND 0F0h                            ;0563  e6 f0          838    845 
    RRCA                                ;0565  0f             839    846 
    RRCA                                ;0566  0f             840    847 
    RRCA                                ;0567  0f             841    848 
    RRCA                                ;0568  0f             842    849 
    CALL    ASCSET                      ;0569  cd 78 05       843    850 
    CALL    ACCPRT                      ;056c  cd 64 08       844    851 
    POP AF                              ;056f  f1             845    852 
    AND 00Fh                            ;0570  e6 0f          846    853 
    CALL    ASCSET                      ;0572  cd 78 05       847    854 
    JP  ACCPRT                          ;0575  c3 64 08       848    855 
ASCSET: ADD A,'0'                       ;0578  c6 30          849    856 ;030h
    CP  '9'+1                           ;057a  fe 3a          850    857 ;03Ah
    RET C                               ;057c  d8             851    858 
    ADD A,007h                          ;057d  c6 07          852    859 
    RET                                 ;057f  c9             853    860 
                                        ;                     854    861 ;
CRHLDS: CALL    CR2                     ;0580  cd 23 08       855    862 
    LD  A,H                             ;0583  7c             856    863 
    CALL    HEX2PR                      ;0584  cd 62 05       857    864 
    LD  A,L                             ;0587  7d             858    865 
    CALL    HEX2PR                      ;0588  cd 62 05       859    866 
    JP  SPPRT                           ;058b  c3 62 08       860    867 
MONSAH: CALL    HLSET                   ;058e  cd 09 05       861    868 
    RET C                               ;0591  d8             862    869 
    PUSH    HL                          ;0592  e5             863    870 
    CALL    HLSET                       ;0593  cd 09 05       864    871 
    POP BC                              ;0596  c1             865    872 
    RET C                               ;0597  d8             866    873 
    PUSH    HL                          ;0598  e5             867    874 
    PUSH    BC                          ;0599  c5             868    875 
    LD  HL,KEYBUF                       ;059a  21 4f 7a       869    876 
    CALL    DATAST                      ;059d  cd ec 04       870    877 
    LD  DE,KEYBUF                       ;05a0  11 4f 7a       871    878 
    OR  A                               ;05a3  b7             872    879 
    SBC HL,DE                           ;05a4  ed 52          873    880 
    LD  C,L                             ;05a6  4d             874    881 
    POP HL                              ;05a7  e1             875    882 
    PUSH    HL                          ;05a8  e5             876    883 
    EXX                                 ;05a9  d9             877    884 
    POP HL                              ;05aa  e1             878    885 
    POP DE                              ;05ab  d1             879    886 
    EXX                                 ;05ac  d9             880    887 
    RET Z                               ;05ad  c8             881    888 
MNSHLP: CALL    HLDECK                  ;05ae  cd c2 05       882    889 
    CALL    Z,MONDPS                    ;05b1  cc c5 04       883    890 
    RET Z                               ;05b4  c8             884    891 
    EXX                                 ;05b5  d9             885    892 
    INC HL                              ;05b6  23             886    893 
    PUSH    HL                          ;05b7  e5             887    894 
    SCF                                 ;05b8  37             888    895 
    SBC HL,DE                           ;05b9  ed 52          889    896 
    POP HL                              ;05bb  e1             890    897 
    RET NC                              ;05bc  d0             891    898 
    PUSH    HL                          ;05bd  e5             892    899 
    EXX                                 ;05be  d9             893    900 
    POP HL                              ;05bf  e1             894    901 
    JR  MNSHLP                          ;05c0  18 ec          895    902 
                                        ;                     896    903 ;
HLDECK: LD  A,(DE)                      ;05c2  1a             897    904 
    CP  (HL)                            ;05c3  be             898    905 
    RET NZ                              ;05c4  c0             899    906 
    PUSH    BC                          ;05c5  c5             900    907 
    PUSH    DE                          ;05c6  d5             901    908 
    PUSH    HL                          ;05c7  e5             902    909 
    LD  B,C                             ;05c8  41             903    910 
HLDEC1: LD  A,(DE)                      ;05c9  1a             904    911 
    CP  (HL)                            ;05ca  be             905    912 
    JR  NZ,HLDEC2                       ;05cb  20 05          906    913 
    INC DE                              ;05cd  13             907    914 
    INC HL                              ;05ce  23             908    915 
    DJNZ    HLDEC1                      ;05cf  10 f8          909    916 
    XOR A                               ;05d1  af             910    917 
HLDEC2: POP HL                          ;05d2  e1             911    918 
    POP DE                              ;05d3  d1             912    919 
    POP BC                              ;05d4  c1             913    920 
    RET                                 ;05d5  c9             914    921 
                                        ;                     915    922 ;
SCRNBC: LD  A,C                         ;05d6  79             916    923 ;SCREEN B,C
    CP  5                               ;05d7  fe 05          917    924 
    RET NC                              ;05d9  d0             918    925 
    OR  A                               ;05da  b7             919    926 
    LD  HL,SCRN00                       ;05db  21 68 06       920    927 
    JR  Z,SCRNS0                        ;05de  28 13          921    928 
    LD  A,B                             ;05e0  78             922    929 
    LD  B,0                             ;05e1  06 00          923    930 
    DEC C                               ;05e3  0d             924    931 
    LD  HL,SCRNTB                       ;05e4  21 60 06       925    932 
    RL  C                               ;05e7  cb 11          926    933 
    ADD HL,BC                           ;05e9  09             927    934 
    LD  E,(HL)                          ;05ea  5e             928    935 
    INC HL                              ;05eb  23             929    936 
    LD  D,(HL)                          ;05ec  56             930    937 
    EX  DE,HL                           ;05ed  eb             931    938 
    DEC A                               ;05ee  3d             932    939 
PATCH4:                                 ;                     933    940 
    RLCA                                ;05ef  07             934    941 
    RLCA                                ;05f0  07             935    942 
    RLCA                                ;05f1  07             936    943 
    RLCA                                ;05f2  07             937    944 
SCRNS0: LD  E,A                         ;05f3  5f             938    945 
    LD  A,(IO2000)                      ;05f4  3a ea 11       939    946 
    AND 0CFh                            ;05f7  e6 cf          940    947 
    OR  E                               ;05f9  b3             941    948 
    CALL    IO20SB                      ;05fa  cd 62 00       942    949 
    LD  E,(HL)                          ;05fd  5e             943    950 
    INC HL                              ;05fe  23             944    951 
    LD  D,(HL)                          ;05ff  56             945    952 
    INC HL                              ;0600  23             946    953 
    EX  DE,HL                           ;0601  eb             947    954 
    LD  (LINEFR),HL                     ;0602  22 fa 0a       948    955 
    EX  DE,HL                           ;0605  eb             949    956 
    LD  E,(HL)                          ;0606  5e             950    957 
    INC HL                              ;0607  23             951    958 
    LD  D,(HL)                          ;0608  56             952    959 
    INC HL                              ;0609  23             953    960 
    EX  DE,HL                           ;060a  eb             954    961 
    LD  (PAGE16+1),HL                   ;060b  22 02 0a       955    962 
    EX  DE,HL                           ;060e  eb             956    963 
    LD  E,(HL)                          ;060f  5e             957    964 
    INC HL                              ;0610  23             958    965 
    LD  D,(HL)                          ;0611  56             959    966 
    INC HL                              ;0612  23             960    967 
    EX  DE,HL                           ;0613  eb             961    968 
    LD  (PAGE11+1),HL                   ;0614  22 b3 09       962    969 
    LD  (PAGE17+1),HL                   ;0617  22 08 0a       963    970 
    LD  BC,2                            ;061a  01 02 00       964    971 ;★이 2줄 4바이트는
    ADD HL,BC                           ;061d  09             965    972 ;INC HL 두 번 2바이트면 가능하다.
    LD  A,L                             ;061e  7d             966    973 
    LD  (PAGE23+1),A                    ;061f  32 fd 0a       967    974 
    EX  DE,HL                           ;0622  eb             968    975 
    LD  E,(HL)                          ;0623  5e             969    976 
    INC HL                              ;0624  23             970    977 
    LD  D,(HL)                          ;0625  56             971    978 
    INC HL                              ;0626  23             972    979 
    EX  DE,HL                           ;0627  eb             973    980 
    LD  (CHRSTA),HL                     ;0628  22 d6 0a       974    981 
    LD  (PAGE05+1),HL                   ;062b  22 47 09       975    982 
    PUSH    HL                          ;062e  e5             976    983 
    SET 3,H                             ;062f  cb dc          977    984 
    LD  (ATRSTA),HL                     ;0631  22 e6 0a       978    985 
    EX  DE,HL                           ;0634  eb             979    986 
    LD  E,(HL)                          ;0635  5e             980    987 
    INC HL                              ;0636  23             981    988 
    LD  D,(HL)                          ;0637  56             982    989 
    INC HL                              ;0638  23             983    990 
    EX  DE,HL                           ;0639  eb             984    991 
    LD  (CHRLEN),HL                     ;063a  22 e9 0a       985    992 
    LD  BC,0FFE0h                       ;063d  01 e0 ff       986    993 
    ADD HL,BC                           ;0640  09             987    994 
    LD  (CHRLE2),HL                     ;0641  22 fc 09       988    995 
    POP BC                              ;0644  c1             989    996 
    ADD HL,BC                           ;0645  09             990    997 
    LD  BC,0001Fh                       ;0646  01 1f 00       991    998 
    ADD HL,BC                           ;0649  09             992    999 
    LD  (PAGE12+1),HL                   ;064a  22 ef 09       993   1000 
    SET 3,H                             ;064d  cb dc          994   1001 
    LD  (PAGE14+1),HL                   ;064f  22 f9 09       995   1002 
    EX  DE,HL                           ;0652  eb             996   1003 
    LD  E,(HL)                          ;0653  5e             997   1004 
    INC HL                              ;0654  23             998   1005 
    LD  D,(HL)                          ;0655  56             999   1006 
    EX  DE,HL                           ;0656  eb            1000   1007 
    LD  (PAGE02+1),HL                   ;0657  22 09 09      1001   1008 
    SET 3,H                             ;065a  cb dc         1002   1009 
    LD  (PAGE04+1),HL                   ;065c  22 16 09      1003   1010 
    RET                                 ;065f  c9            1004   1011 
                                        ;                    1005   1012 ;
                                        ;                    1006   1013 ;
                                        ;                    1007   1014 ;
SCRNTB: DEFW    SCRN01                  ;0660  74 06         1008   1015 
    DEFW    SCRN02                      ;0662  80 06         1009   1016 
    DEFW    SCRN03                      ;0664  8c 06         1010   1017 
    DEFW    SCRN04                      ;0666  98 06         1011   1018 
                                        ;                    1012   1019 ;
SCRN00: DEFW    LINEF                   ;0668  a2 11         1013   1020 ;LINEFR
    DEFW    LINEF+63                    ;066a  e1 11         1014   1021 ;PAGE16
    DEFW    63                          ;066c  3f 00         1015   1022 ;PAGE11
    DEFW    00000h                      ;066e  00 00         1016   1023 ;CHRSTA
    DEFW    00800h                      ;0670  00 08         1017   1024 ;CHRLEN
    DEFW    00200h                      ;0672  00 02         1018   1025 ;PAGE02
                                        ;                    1019   1026 ;
SCRN01: DEFW    LINEF                   ;0674  a2 11         1020   1027 ;LINEFR
    DEFW    LINEF+15                    ;0676  b1 11         1021   1028 ;PAGE16
    DEFW    15                          ;0678  0f 00         1022   1029 ;PAGE11
    DEFW    00000h                      ;067a  00 00         1023   1030 ;CHRSTA
    DEFW    00200h                      ;067c  00 02         1024   1031 ;CHRLEN
    DEFW    00000h                      ;067e  00 00         1025   1032 ;PAGE02
                                        ;                    1026   1033 ;
SCRN02: DEFW    LINEF+16                ;0680  b2 11         1027   1034 ;LINEFR
    DEFW    LINEF+31                    ;0682  c1 11         1028   1035 ;PAGE16
    DEFW    15                          ;0684  0f 00         1029   1036 ;PAGE11
    DEFW    00200h                      ;0686  00 02         1030   1037 ;CHRSTA
    DEFW    00200h                      ;0688  00 02         1031   1038 ;CHRLEN
    DEFW    00200h                      ;068a  00 02         1032   1039 ;PAGE02
                                        ;                    1033   1040 ;
SCRN03: DEFW    LINEF+32                ;068c  c2 11         1034   1041 ;LINEFR
    DEFW    LINEF+47                    ;068e  d1 11         1035   1042 ;PAGE16
    DEFW    015                         ;0690  0f 00         1036   1043 ;PAGE11
    DEFW    00400h                      ;0692  00 04         1037   1044 ;CHRSTA
    DEFW    00200h                      ;0694  00 02         1038   1045 ;CHRLEN
    DEFW    00400h                      ;0696  00 04         1039   1046 ;PAGE02
                                        ;                    1040   1047 ;
SCRN04: DEFW    LINEF+48                ;0698  d2 11         1041   1048 ;LINEFR
    DEFW    LINEF+63                    ;069a  e1 11         1042   1049 ;PAGE16
    DEFW    015                         ;069c  0f 00         1043   1050 ;PAGE11
    DEFW    00600h                      ;069e  00 06         1044   1051 ;CHRSTA
    DEFW    00200h                      ;06a0  00 02         1045   1052 ;CHRLEN
    DEFW    00600h                      ;06a2  00 06         1046   1053 ;PAGE02
                                        ;                    1047   1054 ;DE INPUT ASCII(END=0D 00)
INPUTF: PUSH    AF                      ;06a4  f5            1048   1055 
    PUSH    BC                          ;06a5  c5            1049   1056 
    PUSH    HL                          ;06a6  e5            1050   1057 
    PUSH    DE                          ;06a7  d5            1051   1058 
    LD  A,1                             ;06a8  3e 01         1052   1059 
    LD  (FLASHF),A                      ;06aa  32 7f 0c      1053   1060 
INKYLP: LD  HL,INKYLP                   ;06ad  21 ad 06      1054   1061 
    PUSH    HL                          ;06b0  e5            1055   1062 
    CALL    ASCGET                      ;06b1  cd 62 0c      1056   1063 
    PUSH    AF                          ;06b4  f5            1057   1064 
    LD  A,(BELLFG)                      ;06b5  3a 7f 11      1058   1065 
    OR  A                               ;06b8  b7            1059   1066 
    CALL    NZ,BELL2                    ;06b9  c4 d2 06      1060   1067 
    POP AF                              ;06bc  f1            1061   1068 
    DEFB    0FEh                        ;06bd  fe            1062   1069 ;CP 03H
BREAKI: DEFB    003h                    ;06be  03            1063   1070 
    JP  Z,BRKJOB                        ;06bf  ca 4c 07      1064   1071 
    CP  00Dh                            ;06c2  fe 0d         1065   1072 
    JP  Z,CRJOB                         ;06c4  ca 5f 07      1066   1073 
    JP  ACCOUT                          ;06c7  c3 d9 08      1067   1074 
                                        ;                    1068   1075 ;
BELL:   LD  DE,BELLT2                   ;06ca  11 48 07      1069   1076 
    LD  HL,01000h                       ;06cd  21 00 10      1070   1077 
    JR  BELL3                           ;06d0  18 06         1071   1078 
                                        ;                    1072   1079 ;
BELL2:  LD  DE,BELLTB                   ;06d2  11 44 07      1073   1080 
    LD  HL,000C0h                       ;06d5  21 c0 00      1074   1081 
BELL3:  LD  BC,04000h                   ;06d8  01 00 40      1075   1082 
    PUSH    HL                          ;06db  e5            1076   1083 
    LD  HL,BELLBF                       ;06dc  21 40 07      1077   1084 
    XOR A                               ;06df  af            1078   1085 
    OUT (C),A                           ;06e0  ed 79         1079   1086 
    INC C                               ;06e2  0c            1080   1087 
    IN  A,(C)                           ;06e3  ed 78         1081   1088 
    LD  (HL),A                          ;06e5  77            1082   1089 
    LD  A,(DE)                          ;06e6  1a            1083   1090 
    OUT (C),A                           ;06e7  ed 79         1084   1091 
    DEC C                               ;06e9  0d            1085   1092 
    INC DE                              ;06ea  13            1086   1093 
    INC HL                              ;06eb  23            1087   1094 
    LD  A,1                             ;06ec  3e 01         1088   1095 
    OUT (C),A                           ;06ee  ed 79         1089   1096 
    INC C                               ;06f0  0c            1090   1097 
    IN  A,(C)                           ;06f1  ed 78         1091   1098 
    LD  (HL),A                          ;06f3  77            1092   1099 
    LD  A,(DE)                          ;06f4  1a            1093   1100 
    OUT (C),A                           ;06f5  ed 79         1094   1101 
    DEC C                               ;06f7  0d            1095   1102 
    INC DE                              ;06f8  13            1096   1103 
    INC HL                              ;06f9  23            1097   1104 
    LD  A,8                             ;06fa  3e 08         1098   1105 
    OUT (C),A                           ;06fc  ed 79         1099   1106 
    INC C                               ;06fe  0c            1100   1107 
    IN  A,(C)                           ;06ff  ed 78         1101   1108 
    LD  (HL),A                          ;0701  77            1102   1109 
    LD  A,(DE)                          ;0702  1a            1103   1110 
    OUT (C),A                           ;0703  ed 79         1104   1111 
    DEC C                               ;0705  0d            1105   1112 
    INC DE                              ;0706  13            1106   1113 
    INC HL                              ;0707  23            1107   1114 
    LD  A,7                             ;0708  3e 07         1108   1115 
    OUT (C),A                           ;070a  ed 79         1109   1116 
    INC C                               ;070c  0c            1110   1117 
    IN  A,(C)                           ;070d  ed 78         1111   1118 
    LD  (HL),A                          ;070f  77            1112   1119 
    LD  A,(DE)                          ;0710  1a            1113   1120 
    OUT (C),A                           ;0711  ed 79         1114   1121 
    DEC C                               ;0713  0d            1115   1122 
    POP DE                              ;0714  d1            1116   1123 
L0715:  DEC DE                          ;0715  1b            1117   1124 
    LD  A,D                             ;0716  7a            1118   1125 
    OR  E                               ;0717  b3            1119   1126 
    JR  NZ,L0715                        ;0718  20 fb         1120   1127 
    LD  A,7                             ;071a  3e 07         1121   1128 
    OUT (C),A                           ;071c  ed 79         1122   1129 
    INC C                               ;071e  0c            1123   1130 
    LD  A,(HL)                          ;071f  7e            1124   1131 
    OUT (C),A                           ;0720  ed 79         1125   1132 
    DEC C                               ;0722  0d            1126   1133 
    DEC HL                              ;0723  2b            1127   1134 
    LD  A,8                             ;0724  3e 08         1128   1135 
    OUT (C),A                           ;0726  ed 79         1129   1136 
    INC C                               ;0728  0c            1130   1137 
    LD  A,(HL)                          ;0729  7e            1131   1138 
    OUT (C),A                           ;072a  ed 79         1132   1139 
    DEC C                               ;072c  0d            1133   1140 
    DEC HL                              ;072d  2b            1134   1141 
    LD  A,1                             ;072e  3e 01         1135   1142 
    OUT (C),A                           ;0730  ed 79         1136   1143 
    INC C                               ;0732  0c            1137   1144 
    LD  A,(HL)                          ;0733  7e            1138   1145 
    OUT (C),A                           ;0734  ed 79         1139   1146 
    DEC C                               ;0736  0d            1140   1147 
    DEC HL                              ;0737  2b            1141   1148 
    XOR A                               ;0738  af            1142   1149 
    OUT (C),A                           ;0739  ed 79         1143   1150 
    INC C                               ;073b  0c            1144   1151 
    LD  A,(HL)                          ;073c  7e            1145   1152 
    OUT (C),A                           ;073d  ed 79         1146   1153 
    RET                                 ;073f  c9            1147   1154 
                                        ;                    1148   1155 ;
BELLBF: DEFS    4                       ;0740                1149   1156 
BELLTB: DEFB    208                     ;0744  d0            1150   1157 
    DEFB    0                           ;0745  00            1151   1158 
    DEFB    00Ch                        ;0746  0c            1152   1159 
    DEFB    07Eh                        ;0747  7e            1153   1160 
                                        ;                    1154   1161 ;
BELLT2: DEFW    0007Fh                  ;0748  7f 00         1155   1162 
    DEFB    00Fh                        ;074a  0f            1156   1163 
    DEFB    07Eh                        ;074b  7e            1157   1164 
                                        ;                    1158   1165 ;
BRKJOB: POP AF                          ;074c  f1            1159   1166 
    POP HL                              ;074d  e1            1160   1167 
    PUSH    HL                          ;074e  e5            1161   1168 
    LD  (HL),003h                       ;074f  36 03         1162   1169 
CRJOB2: INC HL                          ;0751  23            1163   1170 
    LD  (HL),00Dh                       ;0752  36 0d         1164   1171 
    INC HL                              ;0754  23            1165   1172 
    LD  (HL),000h                       ;0755  36 00         1166   1173 
INPEND: CALL    CTRLM                   ;0757  cd 62 0b      1167   1174 
ACCEND: POP DE                          ;075a  d1            1168   1175 
    POP HL                              ;075b  e1            1169   1176 
    POP BC                              ;075c  c1            1170   1177 
    POP AF                              ;075d  f1            1171   1178 
    RET                                 ;075e  c9            1172   1179 
                                        ;                    1173   1180 ;
CRJOB:  POP AF                          ;075f  f1            1174   1181 
    CALL    BCUYST                      ;0760  cd ba 07      1175   1182 
    PUSH    DE                          ;0763  d5            1176   1183 
    CALL    ECUYS2                      ;0764  cd c8 07      1177   1184 
    LD  A,E                             ;0767  7b            1178   1185 
    POP DE                              ;0768  d1            1179   1186 
    SUB E                               ;0769  93            1180   1187 
    CP  8                               ;076a  fe 08         1181   1188 
    JR  C,L0770                         ;076c  38 02         1182   1189 
    LD  A,7                             ;076e  3e 07         1183   1190 
L0770:  RLCA                            ;0770  07            1184   1191 
    RLCA                                ;0771  07            1185   1192 
    RLCA                                ;0772  07            1186   1193 
    RLCA                                ;0773  07            1187   1194 
    RLCA                                ;0774  07            1188   1195 
    LD  D,A                             ;0775  57            1189   1196 
    LD  H,E                             ;0776  63            1190   1197 
    LD  L,0                             ;0777  2e 00         1191   1198 
    CALL    ADRCA2                      ;0779  cd 3b 09      1192   1199 
    POP HL                              ;077c  e1            1193   1200 
    PUSH    HL                          ;077d  e5            1194   1201 
CRJOBL: CALL    AINBC                   ;077e  cd 94 07      1195   1202 
    OR  A                               ;0781  b7            1196   1203 
    JR  NZ,L0786                        ;0782  20 02         1197   1204 
    LD  A,020h                          ;0784  3e 20         1198   1205 
L0786:  LD  (HL),A                      ;0786  77            1199   1206 
    INC HL                              ;0787  23            1200   1207 
    INC BC                              ;0788  03            1201   1208 
    DEC D                               ;0789  15            1202   1209 
    JR  NZ,CRJOBL                       ;078a  20 f2         1203   1210 
    LD  A,020h                          ;078c  3e 20         1204   1211 
CRJOBP: DEC HL                          ;078e  2b            1205   1212 
    CP  (HL)                            ;078f  be            1206   1213 
    JR  Z,CRJOBP                        ;0790  28 fc         1207   1214 
    JR  CRJOB2                          ;0792  18 bd         1208   1215 
                                        ;                    1209   1216 ;
AINBC:  PUSH    BC                      ;0794  c5            1210   1217 ;INSERT키가 눌리면 그 라인의 TEXT 끝부터 32번
    IN  A,(C)                           ;0795  ed 78         1211   1218 ;COLUMN 사이에 BLANK가 있는지 확인
    AND 07Fh                            ;0797  e6 7f         1212   1219 
    SET 3,B                             ;0799  cb d8         1213   1220 
    IN  C,(C)                           ;079b  ed 48         1214   1221 
    BIT 2,C                             ;079d  cb 51         1215   1222 
    JR  Z,ALPHA                         ;079f  28 0a         1216   1223 
    BIT 3,C                             ;07a1  cb 59         1217   1224 
    JR  NZ,SEMI6                        ;07a3  20 12         1218   1225 
    AND 00Fh                            ;07a5  e6 0f         1219   1226 
    ADD A,0E0h                          ;07a7  c6 e0         1220   1227 
    JR  AINOK                           ;07a9  18 0a         1221   1228 
ALPHA:  BIT 3,C                         ;07ab  cb 59         1222   1229 
    JR  Z,AINOK                         ;07ad  28 06         1223   1230 
    CP  060h                            ;07af  fe 60         1224   1231 
    JR  NC,AINOK                        ;07b1  30 02         1225   1232 
    ADD A,080h                          ;07b3  c6 80         1226   1233 
AINOK:  POP BC                          ;07b5  c1            1227   1234 
    RET                                 ;07b6  c9            1228   1235 
SEMI6:  POP BC                          ;07b7  c1            1229   1236 
    XOR A                               ;07b8  af            1230   1237 
    RET                                 ;07b9  c9            1231   1238 
                                        ;                    1232   1239 ;
BCUYST: CALL    CUTBHL                  ;07ba  cd d3 07      1233   1240 
    XOR A                               ;07bd  af            1234   1241 
LPBNST: CP  (HL)                        ;07be  be            1235   1242 
    RET Z                               ;07bf  c8            1236   1243 
    DEC HL                              ;07c0  2b            1237   1244 
    DEC E                               ;07c1  1d            1238   1245 
    JR  NZ,LPBNST                       ;07c2  20 fa         1239   1246 
    RET                                 ;07c4  c9            1240   1247 
                                        ;                    1241   1248 ;
ECUYST: CALL    CUTBHL                  ;07c5  cd d3 07      1242   1249 
ECUYS2: INC HL                          ;07c8  23            1243   1250 
    INC E                               ;07c9  1c            1244   1251 
    LD  A,E                             ;07ca  7b            1245   1252 
    CP  16                              ;07cb  fe 10         1246   1253 ;16라인(1페이지)를 통과했는지 체크
    RET NC                              ;07cd  d0            1247   1254 
    XOR A                               ;07ce  af            1248   1255 
    CP  (HL)                            ;07cf  be            1249   1256 
    JR  NZ,ECUYS2                       ;07d0  20 f6         1250   1257 
    RET                                 ;07d2  c9            1251   1258 
                                        ;                    1252   1259 ;
CUTBHL: LD  A,(CURY)                    ;07d3  3a ee 11      1253   1260 
ATBHL:  LD  E,A                         ;07d6  5f            1254   1261 
    LD  D,0                             ;07d7  16 00         1255   1262 
    LD  HL,(LINEFR)                     ;07d9  2a fa 0a      1256   1263 
    ADD HL,DE                           ;07dc  19            1257   1264 ;CURY+LINEFR(01 OR 00)
    RET                                 ;07dd  c9            1258   1265 
                                        ;                    1259   1266 ;
                                        ;                    1260   1267 ; OUTPUT
CR1DEP: CALL    CR1                     ;07de  cd 43 08      1261   1268 
                                        ;                    1262   1269 ;
PRTSDC: PUSH    AF                      ;07e1  f5            1263   1270 
    PUSH    BC                          ;07e2  c5            1264   1271 
    PUSH    DE                          ;07e3  d5            1265   1272 
    LD  A,B                             ;07e4  78            1266   1273 
    OR  A                               ;07e5  b7            1267   1274 
    JR  Z,PRTSDE                        ;07e6  28 07         1268   1275 
PRTSDL: LD  A,(DE)                      ;07e8  1a            1269   1276 
    INC DE                              ;07e9  13            1270   1277 
    CALL    ACCPRT                      ;07ea  cd 64 08      1271   1278 
    DJNZ    PRTSDL                      ;07ed  10 f9         1272   1279 
PRTSDE: POP DE                          ;07ef  d1            1273   1280 
    POP BC                              ;07f0  c1            1274   1281 
    POP AF                              ;07f1  f1            1275   1282 
    RET                                 ;07f2  c9            1276   1283 
                                        ;                    1277   1284 ;
DEPRT:  PUSH    AF                      ;07f3  f5            1278   1285 
    PUSH    DE                          ;07f4  d5            1279   1286 
DEPRTL: LD  A,(DE)                      ;07f5  1a            1280   1287 
    OR  A                               ;07f6  b7            1281   1288 
    JR  Z,DEPRTR                        ;07f7  28 06         1282   1289 
    CALL    ACCPRT                      ;07f9  cd 64 08      1283   1290 
    INC DE                              ;07fc  13            1284   1291 
    JR  DEPRTL                          ;07fd  18 f6         1285   1292 
DEPRTR: POP DE                          ;07ff  d1            1286   1293 
    POP AF                              ;0800  f1            1287   1294 
    RET                                 ;0801  c9            1288   1295 
                                        ;                    1289   1296 ;
                                        ;                    1290   1297 ;
TABPRT: PUSH    HL                      ;0802  e5            1291   1298 
    LD  A,(DISFLG)                      ;0803  3a eb 11      1292   1299 
    CP  2                               ;0806  fe 02         1293   1300 
    LD  HL,CURX                         ;0808  21 ed 11      1294   1301 
    JR  C,TABPRL                        ;080b  38 0c         1295   1302 
    LD  HL,PRINTN                       ;080d  21 ec 11      1296   1303 
    JR  Z,TABPRL                        ;0810  28 07         1297   1304 
    LD  A,','                           ;0812  3e 2c         1298   1305 ;02Ch
    CALL    ACCPRT                      ;0814  cd 64 08      1299   1306 
    POP HL                              ;0817  e1            1300   1307 
    RET                                 ;0818  c9            1301   1308 
                                        ;                    1302   1309 ;
TABPRL: CALL    SPPRT                   ;0819  cd 62 08      1303   1310 
    LD  A,(HL)                          ;081c  7e            1304   1311 
    AND 7                               ;081d  e6 07         1305   1312 
    JR  NZ,TABPRL                       ;081f  20 f8         1306   1313 
    POP HL                              ;0821  e1            1307   1314 
    RET                                 ;0822  c9            1308   1315 
                                        ;                    1309   1316 ;
CR2:    LD  A,(DISFLG)                  ;0823  3a eb 11      1310   1317 
    CP  2                               ;0826  fe 02         1311   1318 
    JR  C,CCR2                          ;0828  38 09         1312   1319 
    JR  NZ,CR1                          ;082a  20 17         1313   1320 
    LD  A,(PRINTN)                      ;082c  3a ec 11      1314   1321 
    OR  A                               ;082f  b7            1315   1322 
    RET Z                               ;0830  c8            1316   1323 
    JR  CR1                             ;0831  18 10         1317   1324 
CCR2:   LD  A,(CURX)                    ;0833  3a ed 11      1318   1325 
    OR  A                               ;0836  b7            1319   1326 
    JR  NZ,CR1                          ;0837  20 0a         1320   1327 
    PUSH    HL                          ;0839  e5            1321   1328 
    PUSH    DE                          ;083a  d5            1322   1329 
    CALL    CUTBHL                      ;083b  cd d3 07      1323   1330 
    LD  A,(HL)                          ;083e  7e            1324   1331 
    POP DE                              ;083f  d1            1325   1332 
    POP HL                              ;0840  e1            1326   1333 
    OR  A                               ;0841  b7            1327   1334 
    RET Z                               ;0842  c8            1328   1335 
                                        ;                    1329   1336 ;
CR1:    LD  A,(DISFLG)                  ;0843  3a eb 11      1330   1337 
    OR  A                               ;0846  b7            1331   1338 
    JR  Z,CR1CTM                        ;0847  28 0f         1332   1339 
    CP  2                               ;0849  fe 02         1333   1340 
    LD  A,00Dh                          ;084b  3e 0d         1334   1341 
    JR  NZ,ACCPRT                       ;084d  20 15         1335   1342 
    LD  A,0FFh                          ;084f  3e ff         1336   1343 
    LD  (PRINTN),A                      ;0851  32 ec 11      1337   1344 
    LD  A,00Ah                          ;0854  3e 0a         1338   1345 
    JR  ACCPRT                          ;0856  18 0c         1339   1346 
                                        ;                    1340   1347 ;
CR1CTM: PUSH    BC                      ;0858  c5            1341   1348 
    PUSH    DE                          ;0859  d5            1342   1349 
    PUSH    HL                          ;085a  e5            1343   1350 
    CALL    CTRLM                       ;085b  cd 62 0b      1344   1351 
    POP HL                              ;085e  e1            1345   1352 
    POP DE                              ;085f  d1            1346   1353 
    POP BC                              ;0860  c1            1347   1354 
    RET                                 ;0861  c9            1348   1355 
                                        ;                    1349   1356 ;
SPPRT:  LD  A,' '                       ;0862  3e 20         1350   1357 ;020h
                                        ;                    1351   1358 ;
ACCPRT: PUSH    AF                      ;0864  f5            1352   1359 
    PUSH    BC                          ;0865  c5            1353   1360 
    PUSH    DE                          ;0866  d5            1354   1361 
    PUSH    HL                          ;0867  e5            1355   1362 
    CALL    ACCOUS                      ;0868  cd 70 08      1356   1363 
    POP HL                              ;086b  e1            1357   1364 
    POP DE                              ;086c  d1            1358   1365 
    POP BC                              ;086d  c1            1359   1366 
    POP AF                              ;086e  f1            1360   1367 
    RET                                 ;086f  c9            1361   1368 
                                        ;                    1362   1369 ;
ACCOUS: LD  HL,(DISFLG)                 ;0870  2a eb 11      1363   1370 
    INC L                               ;0873  2c            1364   1371 
    DEC L                               ;0874  2d            1365   1372 
    JP  Z,ACCDIS                        ;0875  ca de 08      1366   1373 
    DEC L                               ;0878  2d            1367   1374 
    JP  Z,ACCOUT                        ;0879  ca d9 08      1368   1375 
    DEC L                               ;087c  2d            1369   1376 
    JP  NZ,CTOUT                        ;087d  c2 58 45      1370   1377 
    LD  HL,(PRINTN)                     ;0880  2a ec 11      1371   1378 
    INC L                               ;0883  2c            1372   1379 
    LD  (PRINTN),HL                     ;0884  22 ec 11      1373   1380 
                                        ;                    1374   1381 ;
PRINTR: PUSH    AF                      ;0887  f5            1375   1382 
    CALL    PSGST                       ;0888  cd a9 08      1376   1383 
    LD  E,000h                          ;088b  1e 00         1377   1384 
    CALL    PRTRDY                      ;088d  cd bb 08      1378   1385 
    LD  A,15                            ;0890  3e 0f         1379   1386 
    OUT (C),A                           ;0892  ed 79         1380   1387 
    INC C                               ;0894  0c            1381   1388 
    POP AF                              ;0895  f1            1382   1389 
    OUT (C),A                           ;0896  ed 79         1383   1390 
    DEC C                               ;0898  0d            1384   1391 
    LD  A,(IO6000)                      ;0899  3a e9 11      1385   1392 
    OR  004h                            ;089c  f6 04         1386   1393 
    CALL    IO60SB                      ;089e  cd 6b 00      1387   1394 
    LD  A,(IO6000)                      ;08a1  3a e9 11      1388   1395 
    AND 0FBh                            ;08a4  e6 fb         1389   1396 
    JP  IO60SB                          ;08a6  c3 6b 00      1390   1397 
                                        ;                    1391   1398 ;
PSGST:  LD  BC,04000h                   ;08a9  01 00 40      1392   1399 
    LD  A,7                             ;08ac  3e 07         1393   1400 
    OUT (C),A                           ;08ae  ed 79         1394   1401 
    INC C                               ;08b0  0c            1395   1402 
    IN  A,(C)                           ;08b1  ed 78         1396   1403 
    AND 03Fh                            ;08b3  e6 3f         1397   1404 
    OR  080h                            ;08b5  f6 80         1398   1405 
    OUT (C),A                           ;08b7  ed 79         1399   1406 
    DEC C                               ;08b9  0d            1400   1407 
    RET                                 ;08ba  c9            1401   1408 
                                        ;                    1402   1409 ;
PRTRDY: LD  HL,01000h                   ;08bb  21 00 10      1403   1410 
    LD  D,0                             ;08be  16 00         1404   1411 
    LD  A,14                            ;08c0  3e 0e         1405   1412 
    OUT (C),A                           ;08c2  ed 79         1406   1413 
WAITLP: INC C                           ;08c4  0c            1407   1414 
    IN  A,(C)                           ;08c5  ed 78         1408   1415 
    DEC C                               ;08c7  0d            1409   1416 
    AND 020h                            ;08c8  e6 20         1410   1417 
    CP  E                               ;08ca  bb            1411   1418 
    RET Z                               ;08cb  c8            1412   1419 
    DEC D                               ;08cc  15            1413   1420 
    JR  NZ,WAITLP                       ;08cd  20 f5         1414   1421 
    DEC HL                              ;08cf  2b            1415   1422 
    LD  A,H                             ;08d0  7c            1416   1423 
    OR  L                               ;08d1  b5            1417   1424 
    JR  NZ,WAITLP                       ;08d2  20 f0         1418   1425 
    LD  A,28                            ;08d4  3e 1c         1419   1426 
    JP  ERROR                           ;08d6  c3 96 21      1420   1427 
                                        ;                    1421   1428 ;
ACCOUT: CP  ' '                         ;08d9  fe 20         1422   1429 ;020h
    JP  C,CTRLSB                        ;08db  da 81 0a      1423   1430 
ACCDIS: PUSH    AF                      ;08de  f5            1424   1431 
    LD  A,(GMODEF)                      ;08df  3a 06 1c      1425   1432 ;GMODEF 2,3 X
    CP  2                               ;08e2  fe 02         1426   1433 
    JR  C,ACCOL1                        ;08e4  38 09         1427   1434 
    CP  4                               ;08e6  fe 04         1428   1435 
    POP BC                              ;08e8  c1            1429   1436 
    RET C                               ;08e9  d8            1430   1437 
    CALL    GACPRT                      ;08ea  cd 4f 09      1431   1438 
    JR  ACCOL2                          ;08ed  18 07         1432   1439 
ACCOL1: CALL    ADRCAL                  ;08ef  cd 38 09      1433   1440 
    POP AF                              ;08f2  f1            1434   1441 
    CALL    BCOUTA                      ;08f3  cd 3f 0a      1435   1442 ; 0a3fh
ACCOL2: LD  HL,(CURX)                   ;08f6  2a ed 11      1436   1443 
    INC L                               ;08f9  2c            1437   1444 
    LD  A,L                             ;08fa  7d            1438   1445 
    CP  020h                            ;08fb  fe 20         1439   1446 ;다음줄 체크
    JR  C,CURSET                        ;08fd  38 35         1440   1447 
    INC H                               ;08ff  24            1441   1448 
    LD  B,1                             ;0900  06 01         1442   1449 
CTRLM?: LD  A,H                         ;0902  7c            1443   1450 
    CP  16                              ;0903  fe 10         1444   1451 
    JR  C,CURSE?                        ;0905  38 24         1445   1452 
    PUSH    BC                          ;0907  c5            1446   1453 ;16줄(1페이지) 체크
PAGE02: LD  BC,00200h                   ;0908  01 00 02      1447   1454 ;CLR CHR
    LD  A,000h                          ;090b  3e 00         1448   1455 ; 소스는 020h
    LD  D,020h                          ;090d  16 20         1449   1456 
SCRLC1: OUT (C),A                       ;090f  ed 79         1450   1457 
    INC BC                              ;0911  03            1451   1458 
    DEC D                               ;0912  15            1452   1459 
    JR  NZ,SCRLC1                       ;0913  20 fa         1453   1460 
PAGE04: LD  BC,00A00h                   ;0915  01 00 0a      1454   1461 
    LD  A,(COLORF)                      ;0918  3a 80 11      1455   1462 
    AND 003h                            ;091b  e6 03         1456   1463 
    LD  D,020h                          ;091d  16 20         1457   1464 
SCRLC2: OUT (C),A                       ;091f  ed 79         1458   1465 
    INC BC                              ;0921  03            1459   1466 
    DEC D                               ;0922  15            1460   1467 
    JR  NZ,SCRLC2                       ;0923  20 fa         1461   1468 
    CALL    SCRLUP                      ;0925  cd 91 09      1462   1469 
    LD  H,15                            ;0928  26 0f         1463   1470 
    POP BC                              ;092a  c1            1464   1471 
CURSE?: LD  A,H                         ;092b  7c            1465   1472 
    PUSH    HL                          ;092c  e5            1466   1473 
    CALL    ATBHL                       ;092d  cd d6 07      1467   1474 
    LD  (HL),B                          ;0930  70            1468   1475 
    POP HL                              ;0931  e1            1469   1476 
    LD  L,0                             ;0932  2e 00         1470   1477 
CURSET: LD  (CURX),HL                   ;0934  22 ed 11      1471   1478 
    RET                                 ;0937  c9            1472   1479 
                                        ;                    1473   1480 ;
                                        ;                    1474   1481 ; VIDEO RAM ADDRESS CALCULATION
ADRCAL: LD  HL,(CURX)                   ;0938  2a ed 11      1475   1482 
ADRCA2: XOR A                           ;093b  af            1476   1483 
    SRL H                               ;093c  cb 3c         1477   1484 
    RRA                                 ;093e  1f            1478   1485 
    SRL H                               ;093f  cb 3c         1479   1486 
    RRA                                 ;0941  1f            1480   1487 
    SRL H                               ;0942  cb 3c         1481   1488 
    RRA                                 ;0944  1f            1482   1489 
    OR  L                               ;0945  b5            1483   1490 
PAGE05: LD  BC,0                        ;0946  01 00 00      1484   1491 ;OFSET
    ADD A,C                             ;0949  81            1485   1492 
    LD  C,A                             ;094a  4f            1486   1493 
    LD  A,B                             ;094b  78            1487   1494 
    ADC A,H                             ;094c  8c            1488   1495 
    LD  B,A                             ;094d  47            1489   1496 
    RET                                 ;094e  c9            1490   1497 
                                        ;                    1491   1498 ;
                                        ;                    1492   1499 ;SEMI GRAPHIC
GACPRT: LD  A,B                         ;094f  78            1493   1500 
    CP  060h                            ;0950  fe 60         1494   1501 
    JR  C,ROMACP                        ;0952  38 07         1495   1502 
    AND 07Fh                            ;0954  e6 7f         1496   1503 
    LD  DE,$CGBUF                       ;0956  11 4a 55      1497   1504 ;LD DE,0554Ah
    JR  GACPR1                          ;0959  18 05         1498   1505 
ROMACP: SUB ' '                         ;095b  d6 20         1499   1506 ;020h
    LD  DE,CGCHR                        ;095d  11 4a 52      1500   1507 ;LD DE,0524Ah
GACPR1: LD  L,A                         ;0960  6f            1501   1508 
    LD  H,0                             ;0961  26 00         1502   1509 
    ADD HL,HL                           ;0963  29            1503   1510 
    ADD HL,HL                           ;0964  29            1504   1511 
    LD  C,L                             ;0965  4d            1505   1512 ;BC=A*4
    LD  B,H                             ;0966  44            1506   1513 
    ADD HL,HL                           ;0967  29            1507   1514 ;HL=A*8
    ADD HL,BC                           ;0968  09            1508   1515 ;HL=A*12
    ADD HL,DE                           ;0969  19            1509   1516 ;HL=A*12+BASE
    EX  DE,HL                           ;096a  eb            1510   1517 ;DE=A*12+BASE
    LD  HL,(CURX)                       ;096b  2a ed 11      1511   1518 
    LD  A,L                             ;096e  7d            1512   1519 
    LD  L,0                             ;096f  2e 00         1513   1520 
    LD  C,L                             ;0971  4d            1514   1521 
    LD  B,H                             ;0972  44            1515   1522 
    SRL B                               ;0973  cb 38         1516   1523 
    RR  C                               ;0975  cb 19         1517   1524 
    ADD HL,BC                           ;0977  09            1518   1525 
    LD  C,A                             ;0978  4f            1519   1526 
    LD  B,0                             ;0979  06 00         1520   1527 
    ADD HL,BC                           ;097b  09            1521   1528 
    LD  C,L                             ;097c  4d            1522   1529 
    LD  B,H                             ;097d  44            1523   1530 
    EX  DE,HL                           ;097e  eb            1524   1531 
    LD  E,12                            ;097f  1e 0c         1525   1532 
GACPRL: LD  D,(HL)                      ;0981  56            1526   1533 
    OUT (C),D                           ;0982  ed 51         1527   1534 
    INC HL                              ;0984  23            1528   1535 
    LD  A,020h                          ;0985  3e 20         1529   1536 
    ADD A,C                             ;0987  81            1530   1537 
    LD  C,A                             ;0988  4f            1531   1538 
    LD  A,0                             ;0989  3e 00         1532   1539 
    ADC A,B                             ;098b  88            1533   1540 
    LD  B,A                             ;098c  47            1534   1541 
    DEC E                               ;098d  1d            1535   1542 
    JR  NZ,GACPRL                       ;098e  20 f1         1536   1543 
    RET                                 ;0990  c9            1537   1544 
                                        ;                    1538   1545 ;
                                        ;                    1539   1546 ;
SCRLUP: EXX                             ;0991  d9            1540   1547 
    PUSH    BC                          ;0992  c5            1541   1548 
    PUSH    DE                          ;0993  d5            1542   1549 
    PUSH    HL                          ;0994  e5            1543   1550 
    LD  BC,(CHRSTA)                     ;0995  ed 4b d6 0a   1544   1551 
    LD  DE,(CHRLE2)                     ;0999  ed 5b fc 09   1545   1552 
    CALL    BCLDIR                      ;099d  cd be 09      1546   1553 
    LD  BC,(ATRSTA)                     ;09a0  ed 4b e6 0a   1547   1554 
    LD  DE,(CHRLE2)                     ;09a4  ed 5b fc 09   1548   1555 
    CALL    BCLDIR                      ;09a8  cd be 09      1549   1556 
                                        ;                    1550   1557 ;LINE FLG SCROLL
    LD  DE,(LINEFR)                     ;09ab  ed 5b fa 0a   1551   1558 
    LD  H,D                             ;09af  62            1552   1559 
    LD  L,E                             ;09b0  6b            1553   1560 
    INC HL                              ;09b1  23            1554   1561 
PAGE11: LD  BC,63                       ;09b2  01 3f 00      1555   1562 
    LD  A,(DE)                          ;09b5  1a            1556   1563 
    LDIR                                ;09b6  ed b0         1557   1564 
    LD  (DE),A                          ;09b8  12            1558   1565 
    POP HL                              ;09b9  e1            1559   1566 
    POP DE                              ;09ba  d1            1560   1567 
    POP BC                              ;09bb  c1            1561   1568 
    EXX                                 ;09bc  d9            1562   1569 
    RET                                 ;09bd  c9            1563   1570 
                                        ;                    1564   1571 ;
BCLDIR: PUSH    BC                      ;09be  c5            1565   1572 
    EXX                                 ;09bf  d9            1566   1573 
    POP BC                              ;09c0  c1            1567   1574 
    LD  HL,SCRLBF                       ;09c1  21 82 11      1568   1575 
    LD  E,020h                          ;09c4  1e 20         1569   1576 
BCLDL1: IN  A,(C)                       ;09c6  ed 78         1570   1577 
    LD  (HL),A                          ;09c8  77            1571   1578 
    INC BC                              ;09c9  03            1572   1579 
    INC HL                              ;09ca  23            1573   1580 
    DEC E                               ;09cb  1d            1574   1581 
    JR  NZ,BCLDL1                       ;09cc  20 f8         1575   1582 
BCLDL2: IN  A,(C)                       ;09ce  ed 78         1576   1583 
    INC BC                              ;09d0  03            1577   1584 
    EXX                                 ;09d1  d9            1578   1585 
    OUT (C),A                           ;09d2  ed 79         1579   1586 
    INC BC                              ;09d4  03            1580   1587 
    DEC DE                              ;09d5  1b            1581   1588 
    LD  A,D                             ;09d6  7a            1582   1589 
    OR  E                               ;09d7  b3            1583   1590 
    EXX                                 ;09d8  d9            1584   1591 
    JR  NZ,BCLDL2                       ;09d9  20 f3         1585   1592 
    EXX                                 ;09db  d9            1586   1593 
    LD  HL,SCRLBF                       ;09dc  21 82 11      1587   1594 
    LD  E,020h                          ;09df  1e 20         1588   1595 
BCLDL3: LD  A,(HL)                      ;09e1  7e            1589   1596 
    OUT (C),A                           ;09e2  ed 79         1590   1597 
    INC HL                              ;09e4  23            1591   1598 
    INC BC                              ;09e5  03            1592   1599 
    DEC E                               ;09e6  1d            1593   1600 
    JR  NZ,BCLDL3                       ;09e7  20 f8         1594   1601 
    RET                                 ;09e9  c9            1595   1602 
                                        ;                    1596   1603 ;
                                        ;                    1597   1604 ;
                                        ;                    1598   1605 ;SCROLL DOWN
SCRLDW: EXX                             ;09ea  d9            1599   1606 
    PUSH    BC                          ;09eb  c5            1600   1607 
    PUSH    DE                          ;09ec  d5            1601   1608 
    PUSH    HL                          ;09ed  e5            1602   1609 
PAGE12: LD  BC,007FFh                   ;09ee  01 ff 07      1603   1610 ;★원래는 DEPRTR
    LD  DE,(CHRLE2)                     ;09f1  ed 5b fc 09   1604   1611 
    CALL    BCLDDR                      ;09f5  cd 13 0a      1605   1612 
PAGE14: LD  BC,00FFFh                   ;09f8  01 ff 0f      1606   1613 
    DEFB    11h                         ;09fb  11            1607   1614 ; LD DE,
CHRLE2: DEFW    007E0h                  ;09fc  e0 07         1608   1615 
    CALL    BCLDDR                      ;09fe  cd 13 0a      1609   1616 
                                        ;                    1610   1617 ;LINE FLG SCROLL
PAGE16: LD  DE,LINEF+63                 ;0a01  11 e1 11      1611   1618 
    LD  L,E                             ;0a04  6b            1612   1619 
    LD  H,D                             ;0a05  62            1613   1620 
    DEC HL                              ;0a06  2b            1614   1621 
PAGE17: LD  BC,63                       ;0a07  01 3f 00      1615   1622 
    LD  A,(DE)                          ;0a0a  1a            1616   1623 
    LDDR                                ;0a0b  ed b8         1617   1624 
    LD  (DE),A                          ;0a0d  12            1618   1625 
    POP HL                              ;0a0e  e1            1619   1626 
    POP DE                              ;0a0f  d1            1620   1627 
    POP BC                              ;0a10  c1            1621   1628 
    EXX                                 ;0a11  d9            1622   1629 
    RET                                 ;0a12  c9            1623   1630 
                                        ;                    1624   1631 ;
BCLDDR: PUSH    BC                      ;0a13  c5            1625   1632 
    EXX                                 ;0a14  d9            1626   1633 
    POP BC                              ;0a15  c1            1627   1634 
    LD  HL,SCRLBF+01Fh                  ;0a16  21 a1 11      1628   1635 
    LD  E,020h                          ;0a19  1e 20         1629   1636 
BCLDD1: IN  A,(C)                       ;0a1b  ed 78         1630   1637 
    LD  (HL),A                          ;0a1d  77            1631   1638 
    DEC BC                              ;0a1e  0b            1632   1639 
    DEC HL                              ;0a1f  2b            1633   1640 
    DEC E                               ;0a20  1d            1634   1641 
    JR  NZ,BCLDD1                       ;0a21  20 f8         1635   1642 
BCLDD2: IN  A,(C)                       ;0a23  ed 78         1636   1643 
    DEC BC                              ;0a25  0b            1637   1644 
    EXX                                 ;0a26  d9            1638   1645 
    OUT (C),A                           ;0a27  ed 79         1639   1646 
    DEC BC                              ;0a29  0b            1640   1647 
    DEC DE                              ;0a2a  1b            1641   1648 
    LD  A,D                             ;0a2b  7a            1642   1649 
    OR  E                               ;0a2c  b3            1643   1650 
    EXX                                 ;0a2d  d9            1644   1651 
    JR  NZ,BCLDD2                       ;0a2e  20 f3         1645   1652 
    EXX                                 ;0a30  d9            1646   1653 
    LD  HL,SCRLBF+01Fh                  ;0a31  21 a1 11      1647   1654 
    LD  E,020h                          ;0a34  1e 20         1648   1655 
BCLDD3: LD  A,(HL)                      ;0a36  7e            1649   1656 
    OUT (C),A                           ;0a37  ed 79         1650   1657 
    DEC HL                              ;0a39  2b            1651   1658 
    DEC BC                              ;0a3a  0b            1652   1659 
    DEC E                               ;0a3b  1d            1653   1660 
    JR  NZ,BCLDD3                       ;0a3c  20 f8         1654   1661 
    RET                                 ;0a3e  c9            1655   1662 
                                        ;                    1656   1663 ;
                                        ;                    1657   1664 ; 화면에 문자 출력
BCOUTA: CP  'a'-1                       ;0a3f  fe 60         1658   1665 ;060h
    JR  C,BCOTOK                        ;0a41  38 14         1659   1666 
    CP  0E0h                            ;0a43  fe e0         1660   1667 
    JR  NC,SEMIOT                       ;0a45  30 1c         1661   1668 
    AND 07Fh                            ;0a47  e6 7f         1662   1669 
    OUT (C),A                           ;0a49  ed 79         1663   1670 
    SET 3,B                             ;0a4b  cb d8         1664   1671 
    LD  A,(COLORF)                      ;0a4d  3a 80 11      1665   1672 
    AND 3                               ;0a50  e6 03         1666   1673 
    OR  8                               ;0a52  f6 08         1667   1674 
    OUT (C),A                           ;0a54  ed 79         1668   1675 
    RET                                 ;0a56  c9            1669   1676 
                                        ;                    1670   1677 ;
BCOTOK: OUT (C),A                       ;0a57  ed 79         1671   1678 
    SET 3,B                             ;0a59  cb d8         1672   1679 
    LD  A,(COLORF)                      ;0a5b  3a 80 11      1673   1680 
    AND 3                               ;0a5e  e6 03         1674   1681 
    OUT (C),A                           ;0a60  ed 79         1675   1682 
    RET                                 ;0a62  c9            1676   1683 
                                        ;                    1677   1684 ;
SEMIOT: AND 00Fh                        ;0a63  e6 0f         1678   1685 
    PUSH    DE                          ;0a65  d5            1679   1686 
    LD  D,A                             ;0a66  57            1680   1687 
    LD  A,(COLORF)                      ;0a67  3a 80 11      1681   1688 
    DEC A                               ;0a6a  3d            1682   1689 
    AND 7                               ;0a6b  e6 07         1683   1690 
    RLCA                                ;0a6d  07            1684   1691 
    RLCA                                ;0a6e  07            1685   1692 
    RLCA                                ;0a6f  07            1686   1693 
    RLCA                                ;0a70  07            1687   1694 
    OR  D                               ;0a71  b2            1688   1695 
    POP DE                              ;0a72  d1            1689   1696 
    OUT (C),A                           ;0a73  ed 79         1690   1697 
    SET 3,B                             ;0a75  cb d8         1691   1698 
    LD  A,(COLORF)                      ;0a77  3a 80 11      1692   1699 
    AND 3                               ;0a7a  e6 03         1693   1700 
    OR  4                               ;0a7c  f6 04         1694   1701 
    OUT (C),A                           ;0a7e  ed 79         1695   1702 
    RET                                 ;0a80  c9            1696   1703 
                                        ;                    1697   1704 ;
CTRLSB: LD  L,A                         ;0a81  6f            1698   1705 
    LD  H,0                             ;0a82  26 00         1699   1706 
    ADD HL,HL                           ;0a84  29            1700   1707 
    LD  BC,CTRLTB                       ;0a85  01 3f 11      1701   1708 
    ADD HL,BC                           ;0a88  09            1702   1709 
    LD  A,(HL)                          ;0a89  7e            1703   1710 
    INC HL                              ;0a8a  23            1704   1711 
    LD  H,(HL)                          ;0a8b  66            1705   1712 
    LD  L,A                             ;0a8c  6f            1706   1713 
    JP  (HL)                            ;0a8d  e9            1707   1714 
                                        ;                    1708   1715 ;
DELETE: CALL    ADRCAL                  ;0a8e  cd 38 09      1709   1716 
    PUSH    BC                          ;0a91  c5            1710   1717 
    CALL    ECUYST                      ;0a92  cd c5 07      1711   1718 
    LD  H,E                             ;0a95  63            1712   1719 
    LD  L,0                             ;0a96  2e 00         1713   1720 
    CALL    ADRCA2                      ;0a98  cd 3b 09      1714   1721 
    POP DE                              ;0a9b  d1            1715   1722 
    LD  L,C                             ;0a9c  69            1716   1723 
    LD  H,B                             ;0a9d  60            1717   1724 
    OR  A                               ;0a9e  b7            1718   1725 
    SBC HL,DE                           ;0a9f  ed 52         1719   1726 
    LD  D,000h                          ;0aa1  16 00         1720   1727 ;★구버전,신버전 00H,20H ???
    LD  A,(COLORF)                      ;0aa3  3a 80 11      1721   1728 
    AND 3                               ;0aa6  e6 03         1722   1729 
    LD  E,A                             ;0aa8  5f            1723   1730 
DELLP1: DEC BC                          ;0aa9  0b            1724   1731 
    IN  A,(C)                           ;0aaa  ed 78         1725   1732 
    OUT (C),D                           ;0aac  ed 51         1726   1733 
    LD  D,A                             ;0aae  57            1727   1734 
    SET 3,B                             ;0aaf  cb d8         1728   1735 
    IN  A,(C)                           ;0ab1  ed 78         1729   1736 
    OUT (C),E                           ;0ab3  ed 59         1730   1737 
    LD  E,A                             ;0ab5  5f            1731   1738 
    RES 3,B                             ;0ab6  cb 98         1732   1739 
    DEC HL                              ;0ab8  2b            1733   1740 
    LD  A,H                             ;0ab9  7c            1734   1741 
    OR  L                               ;0aba  b5            1735   1742 
    JR  NZ,DELLP1                       ;0abb  20 ec         1736   1743 
    LD  A,(CURX)                        ;0abd  3a ed 11      1737   1744 
    OR  A                               ;0ac0  b7            1738   1745 
    JR  NZ,DELLP2                       ;0ac1  20 08         1739   1746 
    PUSH    DE                          ;0ac3  d5            1740   1747 
    CALL    CUTBHL                      ;0ac4  cd d3 07      1741   1748 
    LD  A,(HL)                          ;0ac7  7e            1742   1749 
    POP DE                              ;0ac8  d1            1743   1750 
    OR  A                               ;0ac9  b7            1744   1751 
    RET Z                               ;0aca  c8            1745   1752 
DELLP2: DEC BC                          ;0acb  0b            1746   1753 
    OUT (C),D                           ;0acc  ed 51         1747   1754 
    SET 3,B                             ;0ace  cb d8         1748   1755 
    OUT (C),E                           ;0ad0  ed 59         1749   1756 
    JP  LEFT                            ;0ad2  c3 48 0b      1750   1757 
                                        ;                    1751   1758 ;
CLR2:   DEFB    001h                    ;0ad5  01            1752   1759 ;LD BC,(CHRSTA)
CHRSTA: DEFW    00000h                  ;0ad6  00 00         1753   1760 ;SEMIGRAPHIC ADR.+
    LD  HL,(CHRLEN)                     ;0ad8  2a e9 0a      1754   1761 
    LD  D,000h                          ;0adb  16 00         1755   1762 ;★구버전,신버전 00H,20H ???
CLRLP:  OUT (C),D                       ;0add  ed 51         1756   1763 
    INC BC                              ;0adf  03            1757   1764 
    DEC HL                              ;0ae0  2b            1758   1765 
    LD  A,H                             ;0ae1  7c            1759   1766 
    OR  L                               ;0ae2  b5            1760   1767 
    JR  NZ,CLRLP                        ;0ae3  20 f8         1761   1768 
    DEFB    001h                        ;0ae5  01            1762   1769 ;LD BC,(ATRSTA)
ATRSTA: DEFW    00800h                  ;0ae6  00 08         1763   1770 
    DEFB    021h                        ;0ae8  21            1764   1771 ;LD HL,(CHRLEN)
CHRLEN: DEFW    00800h                  ;0ae9  00 08         1765   1772 
    LD  A,(COLORF)                      ;0aeb  3a 80 11      1766   1773 
    AND 3                               ;0aee  e6 03         1767   1774 
    LD  D,A                             ;0af0  57            1768   1775 
ATRCLS: OUT (C),D                       ;0af1  ed 51         1769   1776 
    INC BC                              ;0af3  03            1770   1777 
    DEC HL                              ;0af4  2b            1771   1778 
    LD  A,H                             ;0af5  7c            1772   1779 
    OR  L                               ;0af6  b5            1773   1780 
    JR  NZ,ATRCLS                       ;0af7  20 f8         1774   1781 
    DEFB    021h                        ;0af9  21            1775   1782 ;LD HL,(LINEFR)
LINEFR: DEFW    LINEF                   ;0afa  a2 11         1776   1783 
PAGE23: LD  B,65                        ;0afc  06 41         1777   1784 
LINCLS: LD  (HL),0                      ;0afe  36 00         1778   1785 
    INC HL                              ;0b00  23            1779   1786 
    DJNZ    LINCLS                      ;0b01  10 fb         1780   1787 
HOME:   LD  HL,0                        ;0b03  21 00 00      1781   1788 
    JP  CURST2                          ;0b06  c3 83 0b      1782   1789 
                                        ;                    1783   1790 ;
INST:   CALL    ECUYST                  ;0b09  cd c5 07      1784   1791 
    LD  H,E                             ;0b0c  63            1785   1792 
    LD  L,0                             ;0b0d  2e 00         1786   1793 
    CALL    ADRCA2                      ;0b0f  cd 3b 09      1787   1794 
    DEC BC                              ;0b12  0b            1788   1795 
    CALL    AINBC                       ;0b13  cd 94 07      1789   1796 
    CP  021h                            ;0b16  fe 21         1790   1797 
    RET NC                              ;0b18  d0            1791   1798 
    PUSH    BC                          ;0b19  c5            1792   1799 
    CALL    ADRCAL                      ;0b1a  cd 38 09      1793   1800 
    POP HL                              ;0b1d  e1            1794   1801 
    OR  A                               ;0b1e  b7            1795   1802 
    SBC HL,BC                           ;0b1f  ed 42         1796   1803 
    LD  D,000h                          ;0b21  16 00         1797   1804 ;★구버전,신버전 00H,20H ???
    LD  A,(COLORF)                      ;0b23  3a 80 11      1798   1805 
    AND 3                               ;0b26  e6 03         1799   1806 
    LD  E,A                             ;0b28  5f            1800   1807 
    INC HL                              ;0b29  23            1801   1808 
INSTL1: IN  A,(C)                       ;0b2a  ed 78         1802   1809 
    OUT (C),D                           ;0b2c  ed 51         1803   1810 
    LD  D,A                             ;0b2e  57            1804   1811 
    SET 3,B                             ;0b2f  cb d8         1805   1812 
    IN  A,(C)                           ;0b31  ed 78         1806   1813 
    OUT (C),E                           ;0b33  ed 59         1807   1814 
    LD  E,A                             ;0b35  5f            1808   1815 
    RES 3,B                             ;0b36  cb 98         1809   1816 
    INC BC                              ;0b38  03            1810   1817 
    DEC HL                              ;0b39  2b            1811   1818 
    LD  A,H                             ;0b3a  7c            1812   1819 
    OR  L                               ;0b3b  b5            1813   1820 
    JR  NZ,INSTL1                       ;0b3c  20 ec         1814   1821 
    RET                                 ;0b3e  c9            1815   1822 
                                        ;                    1816   1823 ;
LOCK:   LD  A,1                         ;0b3f  3e 01         1817   1824 
LOCKST: LD  (LOCKMD),A                  ;0b41  32 03 12      1818   1825 
    RET                                 ;0b44  c9            1819   1826 
                                        ;                    1820   1827 ;
UNLOCK: XOR A                           ;0b45  af            1821   1828 
    JR  LOCKST                          ;0b46  18 f9         1822   1829 
                                        ;                    1823   1830 ;
LEFT:   LD  HL,(CURX)                   ;0b48  2a ed 11      1824   1831 
    DEC L                               ;0b4b  2d            1825   1832 
    LD  A,L                             ;0b4c  7d            1826   1833 
    CP  0FFh                            ;0b4d  fe ff         1827   1834 
    JR  NZ,CURST2                       ;0b4f  20 32         1828   1835 
    LD  L,01Fh                          ;0b51  2e 1f         1829   1836 
UPCUR:  DEC H                           ;0b53  25            1830   1837 
    LD  A,H                             ;0b54  7c            1831   1838 
    CP  0FFh                            ;0b55  fe ff         1832   1839 
    JR  NZ,CURST2                       ;0b57  20 2a         1833   1840 
    PUSH    HL                          ;0b59  e5            1834   1841 
    CALL    SCRLDW                      ;0b5a  cd ea 09      1835   1842 
    POP HL                              ;0b5d  e1            1836   1843 
    LD  H,0                             ;0b5e  26 00         1837   1844 
    JR  CURST2                          ;0b60  18 21         1838   1845 
                                        ;                    1839   1846 ;
CTRLM:  CALL    ECUYST                  ;0b62  cd c5 07      1840   1847 
    LD  H,E                             ;0b65  63            1841   1848 
    LD  B,0                             ;0b66  06 00         1842   1849 
    JP  CTRLM?                          ;0b68  c3 02 09      1843   1850 
                                        ;                    1844   1851 ;
RIGHT:  LD  HL,(CURX)                   ;0b6b  2a ed 11      1845   1852 
    INC L                               ;0b6e  2c            1846   1853 
    LD  A,L                             ;0b6f  7d            1847   1854 
    CP  020h                            ;0b70  fe 20         1848   1855 
    JR  C,CURST2                        ;0b72  38 0f         1849   1856 
    LD  L,0                             ;0b74  2e 00         1850   1857 
DOWNLB: INC H                           ;0b76  24            1851   1858 
    LD  A,H                             ;0b77  7c            1852   1859 
    CP  16                              ;0b78  fe 10         1853   1860 
    JR  C,CURST2                        ;0b7a  38 07         1854   1861 
    PUSH    HL                          ;0b7c  e5            1855   1862 
    CALL    SCRLUP                      ;0b7d  cd 91 09      1856   1863 
    POP HL                              ;0b80  e1            1857   1864 
    LD  H,15                            ;0b81  26 0f         1858   1865 
CURST2: LD  (CURX),HL                   ;0b83  22 ed 11      1859   1866 
    RET                                 ;0b86  c9            1860   1867 
                                        ;                    1861   1868 ;
UP: LD  HL,(CURX)                       ;0b87  2a ed 11      1862   1869 
    JR  UPCUR                           ;0b8a  18 c7         1863   1870 
                                        ;                    1864   1871 ;
DOWN:   LD  HL,(CURX)                   ;0b8c  2a ed 11      1865   1872 
    JR  DOWNLB                          ;0b8f  18 e5         1866   1873 
                                        ;                    1867   1874 ;
CTRLG:  LD  A,(BELLFG)                  ;0b91  3a 7f 11      1868   1875 
    XOR 1                               ;0b94  ee 01         1869   1876 
    LD  (BELLFG),A                      ;0b96  32 7f 11      1870   1877 
    JP  BELL                            ;0b99  c3 ca 06      1871   1878 
                                        ;                    1872   1879 ;
CTRLB:  LD  DE,00000h                   ;0b9c  11 00 00      1873   1880 
    LD  HL,LEFT                         ;0b9f  21 48 0b      1874   1881 
    LD  (CTRLBF+1),HL                   ;0ba2  22 d3 0b      1875   1882 
CTRLB1: CALL    CBFCEK                  ;0ba5  cd ca 0b      1876   1883 
    RET Z                               ;0ba8  c8            1877   1884 
    JR  C,CTRLB1                        ;0ba9  38 fa         1878   1885 
CTRLB2: CALL    CBFCEK                  ;0bab  cd ca 0b      1879   1886 
    RET Z                               ;0bae  c8            1880   1887 
    JR  NC,CTRLB2                       ;0baf  30 fa         1881   1888 
    JP  RIGHT                           ;0bb1  c3 6b 0b      1882   1889 
                                        ;                    1883   1890 ;
CTRLF:  LD  DE,00F1Fh                   ;0bb4  11 1f 0f      1884   1891 
    LD  HL,RIGHT                        ;0bb7  21 6b 0b      1885   1892 
    LD  (CTRLBF+1),HL                   ;0bba  22 d3 0b      1886   1893 
CTRLF1: CALL    CBFCEK                  ;0bbd  cd ca 0b      1887   1894 
    RET Z                               ;0bc0  c8            1888   1895 
    JR  NC,CTRLF1                       ;0bc1  30 fa         1889   1896 
CTRLF2: CALL    CBFCEK                  ;0bc3  cd ca 0b      1890   1897 
    RET Z                               ;0bc6  c8            1891   1898 
    JR  C,CTRLF2                        ;0bc7  38 fa         1892   1899 
    RET                                 ;0bc9  c9            1893   1900 
                                        ;                    1894   1901 ;
CBFCEK: LD  HL,(CURX)                   ;0bca  2a ed 11      1895   1902 
    OR  A                               ;0bcd  b7            1896   1903 
    SBC HL,DE                           ;0bce  ed 52         1897   1904 
    RET Z                               ;0bd0  c8            1898   1905 
    PUSH    DE                          ;0bd1  d5            1899   1906 
CTRLBF: CALL    RIGHT                   ;0bd2  cd 6b 0b      1900   1907 
    CALL    ADRCAL                      ;0bd5  cd 38 09      1901   1908 
    CALL    AINBC                       ;0bd8  cd 94 07      1902   1909 
    POP DE                              ;0bdb  d1            1903   1910 
    CP  '0'                             ;0bdc  fe 30         1904   1911 ;030h
    RET C                               ;0bde  d8            1905   1912 
    CP  '9'+1                           ;0bdf  fe 3a         1906   1913 ;03Ah
    CCF                                 ;0be1  3f            1907   1914 
    RET NC                              ;0be2  d0            1908   1915 
    CP  'A'                             ;0be3  fe 41         1909   1916 ;041h
    RET C                               ;0be5  d8            1910   1917 
    CP  080h                            ;0be6  fe 80         1911   1918 
    JR  C,L0BEC                         ;0be8  38 02         1912   1919 
    OR  A                               ;0bea  b7            1913   1920 
    RET                                 ;0beb  c9            1914   1921 
L0BEC:  AND 01Fh                        ;0bec  e6 1f         1915   1922 
    JR  Z,L0BF4                         ;0bee  28 04         1916   1923 
    CP  01Bh                            ;0bf0  fe 1b         1917   1924 
    CCF                                 ;0bf2  3f            1918   1925 
    RET NC                              ;0bf3  d0            1919   1926 
L0BF4:  AND 1                           ;0bf4  e6 01         1920   1927 
    RET                                 ;0bf6  c9            1921   1928 
                                        ;                    1922   1929 ;
CTRLY:  LD  D,0                         ;0bf7  16 00         1923   1930 ;★라벨이 빠져있었음
    JR  CTRLYT                          ;0bf9  18 02         1924   1931 
                                        ;                    1925   1932 ;
CTRLT:  LD  D,1                         ;0bfb  16 01         1926   1933 
CTRLYT: LD  HL,(CURX)                   ;0bfd  2a ed 11      1927   1934 
    LD  H,0                             ;0c00  26 00         1928   1935 
    LD  BC,TABBUF                       ;0c02  01 46 12      1929   1936 
    ADD HL,BC                           ;0c05  09            1930   1937 
    LD  (HL),D                          ;0c06  72            1931   1938 
    RET                                 ;0c07  c9            1932   1939 
                                        ;                    1933   1940 ;
CTRLI:  CALL    RIGHT                   ;0c08  cd 6b 0b      1934   1941 
    LD  A,(CURX)                        ;0c0b  3a ed 11      1935   1942 
    CP  31                              ;0c0e  fe 1f         1936   1943 
    RET Z                               ;0c10  c8            1937   1944 
    LD  L,A                             ;0c11  6f            1938   1945 
    LD  H,0                             ;0c12  26 00         1939   1946 
    LD  BC,TABBUF                       ;0c14  01 46 12      1940   1947 
    ADD HL,BC                           ;0c17  09            1941   1948 
    LD  A,(HL)                          ;0c18  7e            1942   1949 
    OR  A                               ;0c19  b7            1943   1950 
    JR  Z,CTRLI                         ;0c1a  28 ec         1944   1951 
    RET                                 ;0c1c  c9            1945   1952 
                                        ;                    1946   1953 ;
CTRLE:  CALL    ECUYST                  ;0c1d  cd c5 07      1947   1954 
    LD  H,E                             ;0c20  63            1948   1955 
    LD  L,0                             ;0c21  2e 00         1949   1956 
    JR  CTRLEZ                          ;0c23  18 10         1950   1957 
                                        ;                    1951   1958 ;
CTRLZ   CALL    CUTBHL                  ;0c25  cd d3 07      1952   1959 
    LD  A,16                            ;0c28  3e 10         1953   1960 
    SUB E                               ;0c2a  93            1954   1961 
    LD  B,A                             ;0c2b  47            1955   1962 
    INC HL                              ;0c2c  23            1956   1963 
CTRLZ1: LD  (HL),0                      ;0c2d  36 00         1957   1964 
    INC HL                              ;0c2f  23            1958   1965 
    DJNZ    CTRLZ1                      ;0c30  10 fb         1959   1966 
    LD  HL,01000h                       ;0c32  21 00 10      1960   1967 
CTRLEZ: CALL    ADRCA2                  ;0c35  cd 3b 09      1961   1968 
    DEC BC                              ;0c38  0b            1962   1969 
    PUSH    BC                          ;0c39  c5            1963   1970 
    CALL    ADRCAL                      ;0c3a  cd 38 09      1964   1971 
    POP HL                              ;0c3d  e1            1965   1972 
    LD  D,B                             ;0c3e  50            1966   1973 
    LD  E,C                             ;0c3f  59            1967   1974 
    OR  A                               ;0c40  b7            1968   1975 
    SBC HL,DE                           ;0c41  ed 52         1969   1976 
    INC HL                              ;0c43  23            1970   1977 
    LD  D,000h                          ;0c44  16 00         1971   1978 ;구버전,신버전
    LD  A,(COLORF)                      ;0c46  3a 80 11      1972   1979 
    AND 003h                            ;0c49  e6 03         1973   1980 
    LD  E,A                             ;0c4b  5f            1974   1981 
CTRLZE: OUT (C),D                       ;0c4c  ed 51         1975   1982 
    SET 3,B                             ;0c4e  cb d8         1976   1983 
    OUT (C),E                           ;0c50  ed 59         1977   1984 
    RES 3,B                             ;0c52  cb 98         1978   1985 
    INC BC                              ;0c54  03            1979   1986 
    DEC HL                              ;0c55  2b            1980   1987 
    LD  A,H                             ;0c56  7c            1981   1988 
    OR  L                               ;0c57  b5            1982   1989 
    JR  NZ,CTRLZE                       ;0c58  20 f2         1983   1990 
    RET                                 ;0c5a  c9            1984   1991 
                                        ;                    1985   1992 ;
                                        ;                    1986   1993 ; KEY GET
BRKEY:  LD  A,080h                      ;0c5b  3e 80         1987   1994 
    IN  A,(0)                           ;0c5d  db 00         1988   1995 
    AND 012h                            ;0c5f  e6 12         1989   1996 
    RET                                 ;0c61  c9            1990   1997 
                                        ;                    1991   1998 ;
ASCGET: PUSH    BC                      ;0c62  c5            1992   1999 
    PUSH    DE                          ;0c63  d5            1993   2000 
    PUSH    HL                          ;0c64  e5            1994   2001 
    LD  HL,(POINT1)                     ;0c65  2a 04 12      1995   2002 
    LD  A,L                             ;0c68  7d            1996   2003 
    CP  H                               ;0c69  bc            1997   2004 
    JR  Z,BUFSET                        ;0c6a  28 12         1998   2005 
BUFCEK: INC A                           ;0c6c  3c            1999   2006 
    AND 03Fh                            ;0c6d  e6 3f         2000   2007 
    LD  (POINT1),A                      ;0c6f  32 04 12      2001   2008 
    LD  L,A                             ;0c72  6f            2002   2009 
    LD  H,0                             ;0c73  26 00         2003   2010 
    LD  DE,INKYBF                       ;0c75  11 06 12      2004   2011 
    ADD HL,DE                           ;0c78  19            2005   2012 
    LD  A,(HL)                          ;0c79  7e            2006   2013 
GETRET: POP HL                          ;0c7a  e1            2007   2014 
    POP DE                              ;0c7b  d1            2008   2015 
    POP BC                              ;0c7c  c1            2009   2016 
    RET                                 ;0c7d  c9            2010   2017 
                                        ;                    2011   2018 ;
BUFSET: DEFB    03Eh                    ;0c7e  3e            2012   2019 ; LD A,
FLASHF: DEFB    001h                    ;0c7f  01            2013   2020 ;
    OR  A                               ;0c80  b7            2014   2021 
    JR  NZ,FLGET                        ;0c81  20 24         2015   2022 
    CALL    KEYSEN                      ;0c83  cd 7a 0d      2016   2023 
    CALL    BRKEY                       ;0c86  cd 5b 0c      2017   2024 
    JR  NZ,KEYGT                        ;0c89  20 07         2018   2025 
BRKGTR: CALL    NEWFLG                  ;0c8b  cd e1 0d      2019   2026 
    LD  A,3                             ;0c8e  3e 03         2020   2027 
    JR  GETRET                          ;0c90  18 e8         2021   2028 
KEYGT:  CALL    KEYSEN                  ;0c92  cd 7a 0d      2022   2029 
    JR  Z,ZERORT                        ;0c95  28 0a         2023   2030 
    CALL    NEWCEK                      ;0c97  cd bb 0d      2024   2031 
    JR  NZ,NEWKYS                       ;0c9a  20 29         2025   2032 
    CALL    SAMECK                      ;0c9c  cd d1 0d      2026   2033 
    JR  Z,REPETS                        ;0c9f  28 16         2027   2034 
ZERORT: CALL    NEWFLG                  ;0ca1  cd e1 0d      2028   2035 
ZEROR2: XOR A                           ;0ca4  af            2029   2036 
    JR  GETRET                          ;0ca5  18 d3         2030   2037 
FLGET:  CALL    FLSHGT                  ;0ca7  cd 3c 0d      2031   2038 
    LD  C,A                             ;0caa  4f            2032   2039 
    LD  A,080h                          ;0cab  3e 80         2033   2040 
    IN  A,(0)                           ;0cad  db 00         2034   2041 
    AND 012h                            ;0caf  e6 12         2035   2042 
    JR  Z,BRKGTR                        ;0cb1  28 d8         2036   2043 
    LD  A,C                             ;0cb3  79            2037   2044 
    OR  A                               ;0cb4  b7            2038   2045 
    JR  Z,NEWKYS                        ;0cb5  28 0e         2039   2046 
REPETS: CALL    NEWFLG                  ;0cb7  cd e1 0d      2040   2047 
    DEFB    021h                        ;0cba  21            2041   2048 ; LD HL,(KEYBFA)
KEYBFA: DEFW    0FFFEh                  ;0cbb  fe ff         2042   2049 ;
    DEFB    03Eh                        ;0cbd  3e            2043   2050 ; LD A,(KEYBFD)
KEYBFD: DEFB    000h                    ;0cbe  00            2044   2051 
    LD  (HL),A                          ;0cbf  77            2045   2052 
    LD  HL,30                           ;0cc0  21 1e 00      2046   2053 
    JR  KEYST2                          ;0cc3  18 06         2047   2054 
NEWKYS: CALL    NEWFLG                  ;0cc5  cd e1 0d      2048   2055 
    DEFB    021h                        ;0cc8  21            2049   2056 ; LD HL,300
REPTSW: DEFW    200                     ;0cc9  c8 00         2050   2057 ; auto repeat key duration
KEYST2: LD  (REPETF),HL                 ;0ccb  22 57 0d      2051   2058 
    LD  HL,NEWBUF                       ;0cce  21 f9 11      2052   2059 
    LD  D,0                             ;0cd1  16 00         2053   2060 
    LD  C,9                             ;0cd3  0e 09         2054   2061 
SETLP1: LD  B,8                         ;0cd5  06 08         2055   2062 
    LD  A,(HL)                          ;0cd7  7e            2056   2063 
    CPL                                 ;0cd8  2f            2057   2064 
    OR  A                               ;0cd9  b7            2058   2065 
    JR  Z,SETPL3                        ;0cda  28 09         2059   2066 
SETPL2: RRCA                            ;0cdc  0f            2060   2067 
    JP  C,KYBFST                        ;0cdd  da 35 0e      2061   2068 
    INC D                               ;0ce0  14            2062   2069 
    DJNZ    SETPL2                      ;0ce1  10 f9         2063   2070 
    JR  SETPL4                          ;0ce3  18 04         2064   2071 
SETPL3: LD  A,D                         ;0ce5  7a            2065   2072 
    ADD A,8                             ;0ce6  c6 08         2066   2073 
    LD  D,A                             ;0ce8  57            2067   2074 
SETPL4: INC HL                          ;0ce9  23            2068   2075 
    DEC C                               ;0cea  0d            2069   2076 
    JR  NZ,SETLP1                       ;0ceb  20 e8         2070   2077 
KYBFSR: LD  HL,(POINT1)                 ;0ced  2a 04 12      2071   2078 
    LD  A,L                             ;0cf0  7d            2072   2079 
    CP  H                               ;0cf1  bc            2073   2080 
    JP  Z,ZEROR2                        ;0cf2  ca a4 0c      2074   2081 
    JP  BUFCEK                          ;0cf5  c3 6c 0c      2075   2082 
                                        ;                    2076   2083 ;
FLASHS: CALL    ADRCAL                  ;0cf8  cd 38 09      2077   2084 
    SET 3,B                             ;0cfb  cb d8         2078   2085 
    LD  (FLASHA),BC                     ;0cfd  ed 43 15 0d   2079   2086 
    IN  A,(C)                           ;0d01  ed 78         2080   2087 
    LD  (FLASHD),A                      ;0d03  32 18 0d      2081   2088 
    OR  1                               ;0d06  f6 01         2082   2089 
    OUT (C),A                           ;0d08  ed 79         2083   2090 
    LD  (FLASHO),A                      ;0d0a  32 2a 0d      2084   2091 
    LD  A,(TICONT)                      ;0d0d  3a 36 00      2085   2092 
    LD  (FLASHC+1),A                    ;0d10  32 20 0d      2086   2093 ;★"+1"이 빠져있었음.
    RET                                 ;0d13  c9            2087   2094 ;
                                        ;                    2088   2095 ;
                                        ;                    2089   2096 ;
FLASHG: DEFB    001h                    ;0d14  01            2090   2097 
FLASHA: DEFW    0                       ;0d15  00 00         2091   2098 
    DEFB    03Eh                        ;0d17  3e            2092   2099 ; LD A,
FLASHD: DEFB    000h                    ;0d18  00            2093   2100 ;
    AND 0FEh                            ;0d19  e6 fe         2094   2101 
    LD  E,A                             ;0d1b  5f            2095   2102 
    LD  A,(TICONT)                      ;0d1c  3a 36 00      2096   2103 
FLASHC: SUB 0                           ;0d1f  d6 00         2097   2104 ; cursor blink time
    AND 010h                            ;0d21  e6 10         2098   2105 
    LD  A,001h                          ;0d23  3e 01         2099   2106 
    JR  Z,L0D28                         ;0d25  28 01         2100   2107 
    XOR A                               ;0d27  af            2101   2108 
L0D28:  OR  E                           ;0d28  b3            2102   2109 
    DEFB    0FEh                        ;0d29  fe            2103   2110 ;CP
FLASHO: DEFB    000h                    ;0d2a  00            2104   2111 
    RET Z                               ;0d2b  c8            2105   2112 
    OUT (C),A                           ;0d2c  ed 79         2106   2113 
    LD  (FLASHO),A                      ;0d2e  32 2a 0d      2107   2114 
    RET                                 ;0d31  c9            2108   2115 
                                        ;                    2109   2116 ;
FLASHE: LD  BC,(FLASHA)                 ;0d32  ed 4b 15 0d   2110   2117 
    LD  A,(FLASHD)                      ;0d36  3a 18 0d      2111   2118 
    OUT (C),A                           ;0d39  ed 79         2112   2119 
    RET                                 ;0d3b  c9            2113   2120 
                                        ;                    2114   2121 ;
                                        ;                    2115   2122 ;
FLSHGT: PUSH    BC                      ;0d3c  c5            2116   2123 
    PUSH    DE                          ;0d3d  d5            2117   2124 
    PUSH    HL                          ;0d3e  e5            2118   2125 
    CALL    FLASHS                      ;0d3f  cd f8 0c      2119   2126 
FLGTLP: CALL    FLASHG                  ;0d42  cd 14 0d      2120   2127 
    CALL    KEYSEN                      ;0d45  cd 7a 0d      2121   2128 
    JR  Z,FLSHL3                        ;0d48  28 1b         2122   2129 
    CALL    NEWCEK                      ;0d4a  cd bb 0d      2123   2130 
    LD  A,0                             ;0d4d  3e 00         2124   2131 
    JR  NZ,FLSHRT                       ;0d4f  20 20         2125   2132 
    CALL    SAMECK                      ;0d51  cd d1 0d      2126   2133 
    JR  NZ,FLGTLP                       ;0d54  20 ec         2127   2134 
    DEFB    021h                        ;0d56  21            2128   2135 ; LD HL,
REPETF: DEFW    00000h                  ;0d57  00 00         2129   2136 ;
    DEC HL                              ;0d59  2b            2130   2137 ;+
    LD  (REPETF),HL                     ;0d5a  22 57 0d      2131   2138 
    LD  A,H                             ;0d5d  7c            2132   2139 
    OR  L                               ;0d5e  b5            2133   2140 
    JR  NZ,FLGTLP                       ;0d5f  20 e1         2134   2141 
    LD  A,1                             ;0d61  3e 01         2135   2142 
    JR  FLSHRT                          ;0d63  18 0c         2136   2143 
FLSHL3: CALL    NEWFLG                  ;0d65  cd e1 0d      2137   2144 
FLGTL2: CALL    FLASHG                  ;0d68  cd 14 0d      2138   2145 
    CALL    KEYSEN                      ;0d6b  cd 7a 0d      2139   2146 
    JR  Z,FLGTL2                        ;0d6e  28 f8         2140   2147 
    XOR A                               ;0d70  af            2141   2148 
FLSHRT: PUSH    AF                      ;0d71  f5            2142   2149 
    CALL    FLASHE                      ;0d72  cd 32 0d      2143   2150 
    POP AF                              ;0d75  f1            2144   2151 
    POP HL                              ;0d76  e1            2145   2152 
    POP DE                              ;0d77  d1            2146   2153 
    POP BC                              ;0d78  c1            2147   2154 
    RET                                 ;0d79  c9            2148   2155 
                                        ;                    2149   2156 ;
                                        ;                    2150   2157 ;
                                        ;                    2151   2158 ;
KEYSEN: CALL    KEYSN2                  ;0d7a  cd 8c 0d      2152   2159 
KEYSN0: LD  B,4                         ;0d7d  06 04         2153   2160 
KEYSN1: CALL    KEYSN2                  ;0d7f  cd 8c 0d      2154   2161 
    BIT 1,E                             ;0d82  cb 4b         2155   2162 
    JR  NZ,KEYSN0                       ;0d84  20 f7         2156   2163 
    DJNZ    KEYSN1                      ;0d86  10 f7         2157   2164 
    LD  A,E                             ;0d88  7b            2158   2165 
    AND 1                               ;0d89  e6 01         2159   2166 
    RET                                 ;0d8b  c9            2160   2167 
                                        ;                    2161   2168 ;
KEYSN2: LD  HL,NEWBUF                   ;0d8c  21 f9 11      2162   2169 
    PUSH    BC                          ;0d8f  c5            2163   2170 
    LD  BC,08009h                       ;0d90  01 09 80      2164   2171 ;KEYIO
    LD  DE,00900h                       ;0d93  11 00 09      2165   2172 
KEYSN3: IN  A,(C)                       ;0d96  ed 78         2166   2173 
    XOR (HL)                            ;0d98  ae            2167   2174 
    JR  Z,L0D9D                         ;0d99  28 02         2168   2175 
    SET 1,E                             ;0d9b  cb cb         2169   2176 
L0D9D:  XOR (HL)                        ;0d9d  ae            2170   2177 
    LD  (HL),A                          ;0d9e  77            2171   2178 
    CPL                                 ;0d9f  2f            2172   2179 
    OR  A                               ;0da0  b7            2173   2180 
    JR  Z,L0DA5                         ;0da1  28 02         2174   2181 
    SET 0,E                             ;0da3  cb c3         2175   2182 
L0DA5:  INC HL                          ;0da5  23            2176   2183 
    DEC BC                              ;0da6  0b            2177   2184 
    DEC D                               ;0da7  15            2178   2185 
    JR  NZ,KEYSN3                       ;0da8  20 ec         2179   2186 
    IN  A,(C)                           ;0daa  ed 78         2180   2187 
    XOR (HL)                            ;0dac  ae            2181   2188 
    JR  Z,L0DB1                         ;0dad  28 02         2182   2189 
    SET 1,E                             ;0daf  cb cb         2183   2190 
L0DB1:  XOR (HL)                        ;0db1  ae            2184   2191 
    LD  (HL),A                          ;0db2  77            2185   2192 
    AND 012h                            ;0db3  e6 12         2186   2193 
    JR  NZ,L0DB9                        ;0db5  20 02         2187   2194 
    SET 0,E                             ;0db7  cb c3         2188   2195 
L0DB9:  POP BC                          ;0db9  c1            2189   2196 
    RET                                 ;0dba  c9            2190   2197 
                                        ;                    2191   2198 ;
NEWCEK: LD  HL,OLDBUF                   ;0dbb  21 ef 11      2192   2199 
    LD  DE,NEWBUF                       ;0dbe  11 f9 11      2193   2200 
    LD  B,9                             ;0dc1  06 09         2194   2201 
NEWPL1: LD  A,(DE)                      ;0dc3  1a            2195   2202 
    CPL                                 ;0dc4  2f            2196   2203 
    AND (HL)                            ;0dc5  a6            2197   2204 
    RET NZ                              ;0dc6  c0            2198   2205 
    INC DE                              ;0dc7  13            2199   2206 
    INC HL                              ;0dc8  23            2200   2207 
    DJNZ    NEWPL1                      ;0dc9  10 f8         2201   2208 
    LD  A,(DE)                          ;0dcb  1a            2202   2209 
    CPL                                 ;0dcc  2f            2203   2210 
    AND (HL)                            ;0dcd  a6            2204   2211 
    AND 010h                            ;0dce  e6 10         2205   2212 
    RET                                 ;0dd0  c9            2206   2213 
                                        ;                    2207   2214 ;
SAMECK: LD  HL,OLDBUF                   ;0dd1  21 ef 11      2208   2215 
    LD  DE,NEWBUF                       ;0dd4  11 f9 11      2209   2216 
    LD  B,10                            ;0dd7  06 0a         2210   2217 
SAMELP: LD  A,(DE)                      ;0dd9  1a            2211   2218 
    XOR (HL)                            ;0dda  ae            2212   2219 
    RET NZ                              ;0ddb  c0            2213   2220 
    INC DE                              ;0ddc  13            2214   2221 
    INC HL                              ;0ddd  23            2215   2222 
    DJNZ    SAMELP                      ;0dde  10 f9         2216   2223 
    RET                                 ;0de0  c9            2217   2224 
                                        ;                    2218   2225 ;
NEWFLG: LD  HL,NEWBUF                   ;0de1  21 f9 11      2219   2226 
    LD  DE,OLDBUF                       ;0de4  11 ef 11      2220   2227 
    LD  B,9                             ;0de7  06 09         2221   2228 
FLGLP1: LD  A,(DE)                      ;0de9  1a            2222   2229 
    CPL                                 ;0dea  2f            2223   2230 
    OR  (HL)                            ;0deb  b6            2224   2231 
    LD  C,(HL)                          ;0dec  4e            2225   2232 
    LD  (HL),A                          ;0ded  77            2226   2233 
    LD  A,C                             ;0dee  79            2227   2234 
    LD  (DE),A                          ;0def  12            2228   2235 
    INC DE                              ;0df0  13            2229   2236 
    INC HL                              ;0df1  23            2230   2237 
    DJNZ    FLGLP1                      ;0df2  10 f5         2231   2238 
    LD  A,(HL)                          ;0df4  7e            2232   2239 
    LD  (DE),A                          ;0df5  12            2233   2240 
    LD  DE,NEWBUF                       ;0df6  11 f9 11      2234   2241 
    LD  HL,OLDBUF                       ;0df9  21 ef 11      2235   2242 
    LD  BC,00900h                       ;0dfc  01 00 09      2236   2243 
FLGLP2: LD  A,(DE)                      ;0dff  1a            2237   2244 
    CPL                                 ;0e00  2f            2238   2245 
    OR  A                               ;0e01  b7            2239   2246 
    JR  Z,FLGLP3                        ;0e02  28 0a         2240   2247 
    DEC C                               ;0e04  0d            2241   2248 
    JR  NZ,FLGLP5                       ;0e05  20 0c         2242   2249 
    OR  (HL)                            ;0e07  b6            2243   2250 
    LD  (HL),A                          ;0e08  77            2244   2251 
    LD  A,0FFh                          ;0e09  3e ff         2245   2252 
    LD  (DE),A                          ;0e0b  12            2246   2253 
FLGLP4: LD  C,1                         ;0e0c  0e 01         2247   2254 
FLGLP3: INC DE                          ;0e0e  13            2248   2255 
    INC HL                              ;0e0f  23            2249   2256 
    DJNZ    FLGLP2                      ;0e10  10 ed         2250   2257 
    RET                                 ;0e12  c9            2251   2258 
FLGLP5: PUSH    BC                      ;0e13  c5            2252   2259 
    LD  BC,00801h                       ;0e14  01 01 08      2253   2260 
FLGLP6: RRCA                            ;0e17  0f            2254   2261 
    JR  C,FLGLP7                        ;0e18  38 0b         2255   2262 
    RLC C                               ;0e1a  cb 01         2256   2263 
    DJNZ    FLGLP6                      ;0e1c  10 f9         2257   2264 
    POP BC                              ;0e1e  c1            2258   2265 
    JR  FLGLP4                          ;0e1f  18 eb         2259   2266 
FLGLP9: RRCA                            ;0e21  0f            2260   2267 
    CALL    C,FLGLP8                    ;0e22  dc 2c 0e      2261   2268 
FLGLP7: RLC C                           ;0e25  cb 01         2262   2269 
    DJNZ    FLGLP9                      ;0e27  10 f8         2263   2270 
    POP BC                              ;0e29  c1            2264   2271 
    JR  FLGLP4                          ;0e2a  18 e0         2265   2272 
                                        ;                    2266   2273 ;
FLGLP8: PUSH    AF                      ;0e2c  f5            2267   2274 
    LD  A,C                             ;0e2d  79            2268   2275 
    OR  (HL)                            ;0e2e  b6            2269   2276 
    LD  (HL),A                          ;0e2f  77            2270   2277 
    LD  A,(DE)                          ;0e30  1a            2271   2278 
    OR  C                               ;0e31  b1            2272   2279 
    LD  (DE),A                          ;0e32  12            2273   2280 
    POP AF                              ;0e33  f1            2274   2281 
    RET                                 ;0e34  c9            2275   2282 
                                        ;                    2276   2283 ;
                                        ;                    2277   2284 ;
KYBFST: LD  A,(HL)                      ;0e35  7e            2278   2285 
    LD  (KEYBFA),HL                     ;0e36  22 bb 0c      2279   2286 
    LD  (KEYBFD),A                      ;0e39  32 be 0c      2280   2287 
    LD  C,D                             ;0e3c  4a            2281   2288 
    LD  B,0                             ;0e3d  06 00         2282   2289 
    LD  HL,KEYDT1                       ;0e3f  21 06 13      2283   2290 ;NORMAL DATA
    LD  A,(NEWMOD)                      ;0e42  3a 02 12      2284   2291 
    BIT 1,A                             ;0e45  cb 4f         2285   2292 
    JR  NZ,L0E4C                        ;0e47  20 03         2286   2293 
    LD  HL,KEYDT2                       ;0e49  21 4e 13      2287   2294 ;SHIFT DATA
L0E4C:  ADD HL,BC                       ;0e4c  09            2288   2295 
    LD  C,(HL)                          ;0e4d  4e            2289   2296 
    LD  B,A                             ;0e4e  47            2290   2297 
    BIT 2,B                             ;0e4f  cb 50         2291   2298 
    JR  NZ,CTRLNO                       ;0e51  20 09         2292   2299 
    LD  A,C                             ;0e53  79            2293   2300 
    SUB 040h                            ;0e54  d6 40         2294   2301 
    JR  C,NONKE?                        ;0e56  38 17         2295   2302 
    AND 01Fh                            ;0e58  e6 1f         2296   2303 
    JR  SETKY                           ;0e5a  18 0d         2297   2304 
CTRLNO: BIT 6,B                         ;0e5c  cb 70         2298   2305 
    JR  NZ,SETKY2                       ;0e5e  20 1a         2299   2306 
    LD  A,C                             ;0e60  79            2300   2307 
    SUB 040h                            ;0e61  d6 40         2301   2308 
    JR  C,NONKEY                        ;0e63  38 07         2302   2309 
    AND 01Fh                            ;0e65  e6 1f         2303   2310 
    ADD A,080h                          ;0e67  c6 80         2304   2311 
SETKY:  CALL    BFSTSB                  ;0e69  cd b1 0e      2305   2312 
NONKEY: JP  KYBFSR                      ;0e6c  c3 ed 0c      2306   2313 
NONKE?: ADD A,010h                      ;0e6f  c6 10         2307   2314 
    CP  004h                            ;0e71  fe 04         2308   2315 
    JR  NC,NONKEY                       ;0e73  30 f7         2309   2316 
    LD  (COLORF),A                      ;0e75  32 80 11      2310   2317 
    JR  NONKEY                          ;0e78  18 f2         2311   2318 
                                        ;                    2312   2319 ;
                                        ;                    2313   2320 ;
SETKY2: LD  A,C                         ;0e7a  79            2314   2321 
    CP  0F0h                            ;0e7b  fe f0         2315   2322 
    JR  NC,FUNCTN                       ;0e7d  30 16         2316   2323 
    LD  A,(LOCKMD)                      ;0e7f  3a 03 12      2317   2324 
    OR  A                               ;0e82  b7            2318   2325 
    LD  A,C                             ;0e83  79            2319   2326 
    JR  Z,SETKY                         ;0e84  28 e3         2320   2327 
    CP  041h                            ;0e86  fe 41         2321   2328 
    JR  C,SETKY                         ;0e88  38 df         2322   2329 
    AND 01Fh                            ;0e8a  e6 1f         2323   2330 
    CP  01Bh                            ;0e8c  fe 1b         2324   2331 
    LD  A,C                             ;0e8e  79            2325   2332 
    JR  NC,SETKY                        ;0e8f  30 d8         2326   2333 
    XOR 020h                            ;0e91  ee 20         2327   2334 
    JR  SETKY                           ;0e93  18 d4         2328   2335 
FUNCTN: SUB 0F1h                        ;0e95  d6 f1         2329   2336 
    LD  L,A                             ;0e97  6f            2330   2337 
    LD  H,0                             ;0e98  26 00         2331   2338 
    ADD HL,HL                           ;0e9a  29            2332   2339 
    ADD HL,HL                           ;0e9b  29            2333   2340 
    ADD HL,HL                           ;0e9c  29            2334   2341 
    ADD HL,HL                           ;0e9d  29            2335   2342 
    LD  BC,FUNBUF                       ;0e9e  01 66 12      2336   2343 
    ADD HL,BC                           ;0ea1  09            2337   2344 
    LD  B,(HL)                          ;0ea2  46            2338   2345 
    INC HL                              ;0ea3  23            2339   2346 
    LD  A,B                             ;0ea4  78            2340   2347 
    OR  A                               ;0ea5  b7            2341   2348 
    JR  Z,NONKEY                        ;0ea6  28 c4         2342   2349 
FUNCLP: LD  A,(HL)                      ;0ea8  7e            2343   2350 
    CALL    BFSTSB                      ;0ea9  cd b1 0e      2344   2351 
    INC HL                              ;0eac  23            2345   2352 
    DJNZ    FUNCLP                      ;0ead  10 f9         2346   2353 
    JR  NONKEY                          ;0eaf  18 bb         2347   2354 
BFSTSB: PUSH    HL                      ;0eb1  e5            2348   2355 
    PUSH    BC                          ;0eb2  c5            2349   2356 
    LD  C,A                             ;0eb3  4f            2350   2357 
    LD  HL,(POINT1)                     ;0eb4  2a 04 12      2351   2358 
    LD  A,H                             ;0eb7  7c            2352   2359 
    INC A                               ;0eb8  3c            2353   2360 
    AND 03Fh                            ;0eb9  e6 3f         2354   2361 
    CP  L                               ;0ebb  bd            2355   2362 
    JR  Z,NONSET                        ;0ebc  28 0c         2356   2363 
    LD  (POINT2),A                      ;0ebe  32 05 12      2357   2364 
    LD  L,A                             ;0ec1  6f            2358   2365 
    LD  H,0                             ;0ec2  26 00         2359   2366 
    LD  A,C                             ;0ec4  79            2360   2367 
    LD  BC,INKYBF                       ;0ec5  01 06 12      2361   2368 
    ADD HL,BC                           ;0ec8  09            2362   2369 
    LD  (HL),A                          ;0ec9  77            2363   2370 
NONSET: POP BC                          ;0eca  c1            2364   2371 
    POP HL                              ;0ecb  e1            2365   2372 
NORET:  RET                             ;0ecc  c9            2366   2373 
                                        ;                    2367   2374 ;
                                        ;                    2368   2375 ;
MUSIC:  PUSH    DE                      ;0ecd  d5            2369   2376 
MUSL1:  LD  A,(DE)                      ;0ece  1a            2370   2377 
    CP  ':'                             ;0ecf  fe 3a         2371   2378 ;03Ah
    INC DE                              ;0ed1  13            2372   2379 
    JR  Z,MUSL2                         ;0ed2  28 04         2373   2380 
    DJNZ    MUSL1                       ;0ed4  10 f8         2374   2381 
    JR  MUSL6                           ;0ed6  18 0e         2375   2382 
MUSL2:  LD  L,E                         ;0ed8  6b            2376   2383 
    LD  H,D                             ;0ed9  62            2377   2384 
MUSL4:  DJNZ    MUSL3                   ;0eda  10 02         2378   2385 
    JR  MUSL7                           ;0edc  18 0b         2379   2386 
MUSL3:  LD  A,(DE)                      ;0ede  1a            2380   2387 
    INC DE                              ;0edf  13            2381   2388 
    CP  ':'                             ;0ee0  fe 3a         2382   2389 ;03Ah
    JR  NZ,MUSL4                        ;0ee2  20 f6         2383   2390 
    JR  MUSL5                           ;0ee4  18 06         2384   2391 
MUSL6:  LD  HL,MUSNUL                   ;0ee6  21 00 11      2385   2392 
MUSL7:  LD  DE,MUSNUL                   ;0ee9  11 00 11      2386   2393 
MUSL5:  POP BC                          ;0eec  c1            2387   2394 
                                        ;                    2388   2395 ; BC=SOUND A
                                        ;                    2389   2396 ; HL=SOUND B
                                        ;                    2390   2397 ; DE=SOUND C
                                        ;                    2391   2398 ;
                                        ;                    2392   2399 
MUSLOP: PUSH    BC                      ;0eed  c5            2393   2400 
    EXX                                 ;0eee  d9            2394   2401 
    POP DE                              ;0eef  d1            2395   2402 
    LD  BC,LENG?A                       ;0ef0  01 11 11      2396   2403 
    CALL    SOUSET                      ;0ef3  cd 2e 0f      2397   2404 
    PUSH    DE                          ;0ef6  d5            2398   2405 
    EXX                                 ;0ef7  d9            2399   2406 
    POP BC                              ;0ef8  c1            2400   2407 
    PUSH    HL                          ;0ef9  e5            2401   2408 
    EXX                                 ;0efa  d9            2402   2409 
    POP DE                              ;0efb  d1            2403   2410 
    LD  BC,LENG?B                       ;0efc  01 19 11      2404   2411 
    CALL    SOUSET                      ;0eff  cd 2e 0f      2405   2412 
    PUSH    DE                          ;0f02  d5            2406   2413 
    EXX                                 ;0f03  d9            2407   2414 
    POP HL                              ;0f04  e1            2408   2415 
    PUSH    DE                          ;0f05  d5            2409   2416 
    EXX                                 ;0f06  d9            2410   2417 
    POP DE                              ;0f07  d1            2411   2418 
    LD  BC,LENG?C                       ;0f08  01 21 11      2412   2419 
    CALL    SOUSET                      ;0f0b  cd 2e 0f      2413   2420 
    PUSH    DE                          ;0f0e  d5            2414   2421 
    EXX                                 ;0f0f  d9            2415   2422 
    POP DE                              ;0f10  d1            2416   2423 
    EXX                                 ;0f11  d9            2417   2424 
                                        ;                    2418   2425 ;
    CALL    DELAYS                      ;0f12  cd 77 10      2419   2426 
                                        ;                    2420   2427 ;
    LD  BC,LENG?A                       ;0f15  01 11 11      2421   2428 
    CALL    SOUSTP                      ;0f18  cd 3b 10      2422   2429 
    LD  BC,LENG?B                       ;0f1b  01 19 11      2423   2430 
    CALL    SOUSTP                      ;0f1e  cd 3b 10      2424   2431 
    LD  BC,LENG?C                       ;0f21  01 21 11      2425   2432 
    CALL    SOUSTP                      ;0f24  cd 3b 10      2426   2433 
    EXX                                 ;0f27  d9            2427   2434 
                                        ;                    2428   2435 ;
    CALL    ENDCHK                      ;0f28  cd 52 10      2429   2436 
    JR  NZ,MUSLOP                       ;0f2b  20 c0         2430   2437 
    RET                                 ;0f2d  c9            2431   2438 
                                        ;                    2432   2439 ;
                                        ;                    2433   2440 ; SUB
SOUSET: LD  A,(BC)                      ;0f2e  0a            2434   2441 
    OR  A                               ;0f2f  b7            2435   2442 
    RET NZ                              ;0f30  c0            2436   2443 
    DEC BC                              ;0f31  0b            2437   2444 ;BC=OCT.A
                                        ;                    2438   2445 ;
SOUST2: LD  A,(DE)                      ;0f32  1a            2439   2446 
    CP  ':'                             ;0f33  fe 3a         2440   2447 ;03Ah
    RET Z                               ;0f35  c8            2441   2448 
                                        ;                    2442   2449 ;
    CP  'V'                             ;0f36  fe 56         2443   2450 ;056h VOLUME
    JR  NZ,VOLOK                        ;0f38  20 31         2444   2451 
    INC DE                              ;0f3a  13            2445   2452 
    LD  A,(DE)                          ;0f3b  1a            2446   2453 
    SUB '0'                             ;0f3c  d6 30         2447   2454 ;030h
    JR  C,SOUST2                        ;0f3e  38 f2         2448   2455 
    CP  10                              ;0f40  fe 0a         2449   2456 ;00Ah
    JR  NC,SOUST2                       ;0f42  30 ee         2450   2457 
    INC DE                              ;0f44  13            2451   2458 
    CP  1                               ;0f45  fe 01         2452   2459 
    JR  NZ,VOLST                        ;0f47  20 10         2453   2460 
    LD  A,(DE)                          ;0f49  1a            2454   2461 
    SUB '0'                             ;0f4a  d6 30         2455   2462 ;030h
    JR  C,VOLST2                        ;0f4c  38 09         2456   2463 
    CP  6                               ;0f4e  fe 06         2457   2464 
    JR  NC,VOLST2                       ;0f50  30 05         2458   2465 
    ADD A,10                            ;0f52  c6 0a         2459   2466 
    INC DE                              ;0f54  13            2460   2467 
    JR  VOLST                           ;0f55  18 02         2461   2468 
VOLST2: LD  A,1                         ;0f57  3e 01         2462   2469 
VOLST:  LD  L,A                         ;0f59  6f            2463   2470 
    INC BC                              ;0f5a  03            2464   2471 
    INC BC                              ;0f5b  03            2465   2472 
    LD  A,(BC)                          ;0f5c  0a            2466   2473 
    DEC BC                              ;0f5d  0b            2467   2474 
    DEC BC                              ;0f5e  0b            2468   2475 
    PUSH    BC                          ;0f5f  c5            2469   2476 
    LD  BC,04000h                       ;0f60  01 00 40      2470   2477 ;PSG ADR.
    OUT (C),A                           ;0f63  ed 79         2471   2478 
    INC C                               ;0f65  0c            2472   2479 ;PSG DATA AD.
    OUT (C),L                           ;0f66  ed 69         2473   2480 
    POP BC                              ;0f68  c1            2474   2481 
    JR  SOUST2                          ;0f69  18 c7         2475   2482 
                                        ;                    2476   2483 ;
VOLOK:  CP  'O'                         ;0f6b  fe 4f         2477   2484 ; OCTAVE
    JP  NZ,OCTOK                        ;0f6d  c2 7e 0f      2478   2485 
    INC DE                              ;0f70  13            2479   2486 
    LD  A,(DE)                          ;0f71  1a            2480   2487 
    SUB '1'                             ;0f72  d6 31         2481   2488 ;031h
    JR  C,SOUST2                        ;0f74  38 bc         2482   2489 
    CP  8                               ;0f76  fe 08         2483   2490 
    JR  NC,SOUST2                       ;0f78  30 b8         2484   2491 
    LD  (BC),A                          ;0f7a  02            2485   2492 ;OCT. SET
    INC DE                              ;0f7b  13            2486   2493 
    JR  SOUST2                          ;0f7c  18 b4         2487   2494 
                                        ;                    2488   2495 ;
OCTOK:  EX  AF,AF'                      ;0f7e  08            2489   2496 
    LD  A,(BC)                          ;0f7f  0a            2490   2497 ;OCT. READ
    EX  AF,AF'                          ;0f80  08            2491   2498 
OCTOK2: LD  A,(DE)                      ;0f81  1a            2492   2499 
    CP  '+'                             ;0f82  fe 2b         2493   2500 ;02Bh
    JR  NZ,OCTNOP                       ;0f84  20 0a         2494   2501 
    INC DE                              ;0f86  13            2495   2502 
    EX  AF,AF'                          ;0f87  08            2496   2503 
    CP  7                               ;0f88  fe 07         2497   2504 
    JR  Z,OCTNO                         ;0f8a  28 01         2498   2505 
    INC A                               ;0f8c  3c            2499   2506 
OCTNO:  EX  AF,AF'                      ;0f8d  08            2500   2507 
    JR  OCTOK2                          ;0f8e  18 f1         2501   2508 
OCTNOP: CP  '-'                         ;0f90  fe 2d         2502   2509 ;02Dh
    JR  NZ,OCTNOM                       ;0f92  20 08         2503   2510 
    INC DE                              ;0f94  13            2504   2511 
    EX  AF,AF'                          ;0f95  08            2505   2512 
    OR  A                               ;0f96  b7            2506   2513 
    JR  Z,L0F9A                         ;0f97  28 01         2507   2514 
    DEC A                               ;0f99  3d            2508   2515 
L0F9A:  JR  OCTNO                       ;0f9a  18 f1         2509   2516 
                                        ;                    2510   2517 ;
OCTNOM: LD  HL,NUMTBL                   ;0f9c  21 23 11      2511   2518 
    CP  '#'                             ;0f9f  fe 23         2512   2519 ;023h
    JR  NZ,NUMOK                        ;0fa1  20 05         2513   2520 
    INC DE                              ;0fa3  13            2514   2521 
    LD  HL,UPTBL                        ;0fa4  21 31 11      2515   2522 
    LD  A,(DE)                          ;0fa7  1a            2516   2523 
NUMOK:  INC DE                          ;0fa8  13            2517   2524 
    CP  'R'                             ;0fa9  fe 52         2518   2525 ;052h
    JR  Z,SOUOFF                        ;0fab  28 61         2519   2526 
    SUB 'A'                             ;0fad  d6 41         2520   2527 ;041h
    JP  C,SOUST2                        ;0faf  da 32 0f      2521   2528 
    CP  7                               ;0fb2  fe 07         2522   2529 
    JP  NC,SOUST2                       ;0fb4  d2 32 0f      2523   2530 
    PUSH    DE                          ;0fb7  d5            2524   2531 
    LD  E,A                             ;0fb8  5f            2525   2532 
    LD  D,0                             ;0fb9  16 00         2526   2533 
    EX  DE,HL                           ;0fbb  eb            2527   2534 
    ADD HL,HL                           ;0fbc  29            2528   2535 
    ADD HL,DE                           ;0fbd  19            2529   2536 
    DEC BC                              ;0fbe  0b            2530   2537 ;PSG DATA7
    DEC BC                              ;0fbf  0b            2531   2538 ;DATA HIGH
    LD  A,(HL)                          ;0fc0  7e            2532   2539 
    INC HL                              ;0fc1  23            2533   2540 
    LD  H,(HL)                          ;0fc2  66            2534   2541 
    LD  L,A                             ;0fc3  6f            2535   2542 
    EX  AF,AF'                          ;0fc4  08            2536   2543 
OCTDVL: OR  A                           ;0fc5  b7            2537   2544 
    JR  Z,OCTDIV                        ;0fc6  28 07         2538   2545 
    RR  H                               ;0fc8  cb 1c         2539   2546 
    RR  L                               ;0fca  cb 1d         2540   2547 
    DEC A                               ;0fcc  3d            2541   2548 
    JR  NZ,OCTDVL                       ;0fcd  20 f6         2542   2549 
OCTDIV: EX  DE,HL                       ;0fcf  eb            2543   2550 
    LD  L,C                             ;0fd0  69            2544   2551 
    LD  H,B                             ;0fd1  60            2545   2552 
    LD  (HL),D                          ;0fd2  72            2546   2553 
    DEC HL                              ;0fd3  2b            2547   2554 ;DATA LOW
    LD  (HL),E                          ;0fd4  73            2548   2555 
    DEC HL                              ;0fd5  2b            2549   2556 ;DATA ADR.
    DEC HL                              ;0fd6  2b            2550   2557 ;LEN.A
    POP DE                              ;0fd7  d1            2551   2558 
    LD  A,(DE)                          ;0fd8  1a            2552   2559 
    SUB '0'                             ;0fd9  d6 30         2553   2560 ;030h
    JR  C,SOUON                         ;0fdb  38 09         2554   2561 
    CP  10                              ;0fdd  fe 0a         2555   2562 ;
    JR  NC,SOUON                        ;0fdf  30 05         2556   2563 
    CALL    LENGSB                      ;0fe1  cd 88 10      2557   2564 
    INC DE                              ;0fe4  13            2558   2565 
    LD  (HL),A                          ;0fe5  77            2559   2566 
SOUON:  PUSH    DE                      ;0fe6  d5            2560   2567 
    LD  E,(HL)                          ;0fe7  5e            2561   2568 ;LENG.?
    INC HL                              ;0fe8  23            2562   2569 
    LD  D,(HL)                          ;0fe9  56            2563   2570 ;PSG ADR.
    INC HL                              ;0fea  23            2564   2571 
    LD  BC,04000h                       ;0feb  01 00 40      2565   2572 ;PSG ADR
    LD  A,(HL)                          ;0fee  7e            2566   2573 
    OUT (C),D                           ;0fef  ed 51         2567   2574 
    INC C                               ;0ff1  0c            2568   2575 
    OUT (C),A                           ;0ff2  ed 79         2569   2576 
    INC HL                              ;0ff4  23            2570   2577 
    DEC C                               ;0ff5  0d            2571   2578 
    INC D                               ;0ff6  14            2572   2579 
    LD  A,(HL)                          ;0ff7  7e            2573   2580 
    OUT (C),D                           ;0ff8  ed 51         2574   2581 
    INC C                               ;0ffa  0c            2575   2582 
    OUT (C),A                           ;0ffb  ed 79         2576   2583 
    INC HL                              ;0ffd  23            2577   2584 
    DEC C                               ;0ffe  0d            2578   2585 
    LD  D,7                             ;0fff  16 07         2579   2586 
    OUT (C),D                           ;1001  ed 51         2580   2587 
    INC C                               ;1003  0c            2581   2588 
    IN  A,(C)                           ;1004  ed 78         2582   2589 
    AND (HL)                            ;1006  a6            2583   2590 
    OUT (C),A                           ;1007  ed 79         2584   2591 
    INC HL                              ;1009  23            2585   2592 ;OCT.A
    INC HL                              ;100a  23            2586   2593 ;LENG.A
    LD  (HL),E                          ;100b  73            2587   2594 
    POP DE                              ;100c  d1            2588   2595 
    RET                                 ;100d  c9            2589   2596 
                                        ;                    2590   2597 ;
                                        ;                    2591   2598 ;
SOUOFF: DEC BC                          ;100e  0b            2592   2599 
    DEC BC                              ;100f  0b            2593   2600 
    DEC BC                              ;1010  0b            2594   2601 
    DEC BC                              ;1011  0b            2595   2602 
    DEC BC                              ;1012  0b            2596   2603 
    LD  A,(DE)                          ;1013  1a            2597   2604 
    SUB '0'                             ;1014  d6 30         2598   2605 ;030h
    JR  C,SOUOFE                        ;1016  38 09         2599   2606 
    CP  10                              ;1018  fe 0a         2600   2607 
    JR  NC,SOUOFE                       ;101a  30 05         2601   2608 
    CALL    LENGSB                      ;101c  cd 88 10      2602   2609 
    INC DE                              ;101f  13            2603   2610 
    LD  (BC),A                          ;1020  02            2604   2611 
SOUOFE: LD  A,(BC)                      ;1021  0a            2605   2612 
    INC BC                              ;1022  03            2606   2613 
    INC BC                              ;1023  03            2607   2614 
    INC BC                              ;1024  03            2608   2615 
    INC BC                              ;1025  03            2609   2616 
    INC BC                              ;1026  03            2610   2617 
    INC BC                              ;1027  03            2611   2618 
    LD  (BC),A                          ;1028  02            2612   2619 
SOUOFS: DEC BC                          ;1029  0b            2613   2620 
    DEC BC                              ;102a  0b            2614   2621 
    LD  A,(BC)                          ;102b  0a            2615   2622 
    CPL                                 ;102c  2f            2616   2623 
    LD  BC,04000h                       ;102d  01 00 40      2617   2624 ;PSG ADR.
    LD  L,7                             ;1030  2e 07         2618   2625 
    OUT (C),L                           ;1032  ed 69         2619   2626 
    INC C                               ;1034  0c            2620   2627 
    IN  H,(C)                           ;1035  ed 60         2621   2628 
    OR  H                               ;1037  b4            2622   2629 
    OUT (C),A                           ;1038  ed 79         2623   2630 
    RET                                 ;103a  c9            2624   2631 
                                        ;                    2625   2632 ;
SOUSTP: LD  A,(BC)                      ;103b  0a            2626   2633 
    OR  A                               ;103c  b7            2627   2634 
    JR  Z,SOUOFS                        ;103d  28 ea         2628   2635 
    DEC A                               ;103f  3d            2629   2636 
    LD  (BC),A                          ;1040  02            2630   2637 
    RET                                 ;1041  c9            2631   2638 
                                        ;                    2632   2639 ;
BRKRET: LD  BC,04000h                   ;1042  01 00 40      2633   2640 
    LD  L,7                             ;1045  2e 07         2634   2641 
    OUT (C),L                           ;1047  ed 69         2635   2642 
    INC C                               ;1049  0c            2636   2643 
    IN  A,(C)                           ;104a  ed 78         2637   2644 
    OR  7                               ;104c  f6 07         2638   2645 
    OUT (C),A                           ;104e  ed 79         2639   2646 
    XOR A                               ;1050  af            2640   2647 
    RET                                 ;1051  c9            2641   2648 
                                        ;                    2642   2649 ;
ENDCHK: LD  A,080h                      ;1052  3e 80         2643   2650 ;BREAK CHECK
    IN  A,(0)                           ;1054  db 00         2644   2651 
    AND 012h                            ;1056  e6 12         2645   2652 
    JR  Z,BRKRET                        ;1058  28 e8         2646   2653 
    LD  A,(BC)                          ;105a  0a            2647   2654 
    CP  ':'                             ;105b  fe 3a         2648   2655 
    RET NZ                              ;105d  c0            2649   2656 
    LD  A,(DE)                          ;105e  1a            2650   2657 
    CP  ':'                             ;105f  fe 3a         2651   2658 
    RET NZ                              ;1061  c0            2652   2659 
    LD  A,(HL)                          ;1062  7e            2653   2660 
    CP  ':'                             ;1063  fe 3a         2654   2661 
    RET NZ                              ;1065  c0            2655   2662 
    LD  A,(LENG?A)                      ;1066  3a 11 11      2656   2663 
    OR  A                               ;1069  b7            2657   2664 
    RET NZ                              ;106a  c0            2658   2665 
    LD  A,(LENG?B)                      ;106b  3a 19 11      2659   2666 
    OR  A                               ;106e  b7            2660   2667 
    RET NZ                              ;106f  c0            2661   2668 
    LD  A,(LENG?C)                      ;1070  3a 21 11      2662   2669 
    OR  A                               ;1073  b7            2663   2670 
    RET NZ                              ;1074  c0            2664   2671 
    JR  BRKRET                          ;1075  18 cb         2665   2672 
                                        ;                    2666   2673 ;
                                        ;                    2667   2674 ;
                                        ;                    2668   2675 ;
DELAYS: LD  HL,(MSDT32)                 ;1077  2a fe 10      2669   2676 
                                        ;                    2670   2677 ; DELAY1MS SUB
DELAY1: LD  DE,152                      ;107a  11 98 00      2671   2678 ;10
DELAY2: DEC DE                          ;107d  1b            2672   2679 ;6
    LD  A,D                             ;107e  7a            2673   2680 ;4
    OR  E                               ;107f  b3            2674   2681 ;4
    JR  NZ,DELAY2                       ;1080  20 fb         2675   2682 ;12
    DEC HL                              ;1082  2b            2676   2683 ;6
    LD  A,H                             ;1083  7c            2677   2684 ;4
    OR  L                               ;1084  b5            2678   2685 ;4
    JR  NZ,DELAY1                       ;1085  20 f3         2679   2686 ;12
    RET                                 ;1087  c9            2680   2687 
LENGSB: PUSH    BC                      ;1088  c5            2681   2688 
    PUSH    HL                          ;1089  e5            2682   2689 
    LD  C,A                             ;108a  4f            2683   2690 
    LD  B,0                             ;108b  06 00         2684   2691 
    LD  HL,LENGTB                       ;108d  21 01 11      2685   2692 
    ADD HL,BC                           ;1090  09            2686   2693 
    LD  A,(HL)                          ;1091  7e            2687   2694 
    POP HL                              ;1092  e1            2688   2695 
    POP BC                              ;1093  c1            2689   2696 
    RET                                 ;1094  c9            2690   2697 
                                        ;                    2691   2698 ;
                                        ;                    2692   2699 ;
XTEMPO: LD  (MSDT32),A                  ;1095  32 fe 10      2693   2700 
                                        ;                    2694   2701 ;
    RET                                 ;1098  c9            2695   2702 
                                        ;                    2696   2703 ;
                                        ;                    2697   2704 ;
SOUNDS: LD  A,E                         ;1099  7b            2698   2705 
    OR  A                               ;109a  b7            2699   2706 
    LD  HL,000FEh                       ;109b  21 fe 00      2700   2707 
    JR  Z,SOUND1                        ;109e  28 09         2701   2708 
    DEC A                               ;10a0  3d            2702   2709 
    LD  HL,002FDh                       ;10a1  21 fd 02      2703   2710 
    JR  Z,SOUND1                        ;10a4  28 03         2704   2711 
    LD  HL,004FBh                       ;10a6  21 fb 04      2705   2712 
SOUND1: LD  A,D                         ;10a9  7a            2706   2713 
    AND 7                               ;10aa  e6 07         2707   2714 
    JR  Z,SOUND2                        ;10ac  28 40         2708   2715 
    PUSH    HL                          ;10ae  e5            2709   2716 
    LD  BC,NUMTBL                       ;10af  01 23 11      2710   2717 
    BIT 3,D                             ;10b2  cb 5a         2711   2718 
    JR  Z,SOUND3                        ;10b4  28 03         2712   2719 
    LD  BC,UPTBL                        ;10b6  01 31 11      2713   2720 
SOUND3: DEC A                           ;10b9  3d            2714   2721 
    LD  L,A                             ;10ba  6f            2715   2722 
    LD  H,0                             ;10bb  26 00         2716   2723 
    ADD HL,HL                           ;10bd  29            2717   2724 
    ADD HL,BC                           ;10be  09            2718   2725 
    LD  A,D                             ;10bf  7a            2719   2726 
    LD  E,(HL)                          ;10c0  5e            2720   2727 
    INC HL                              ;10c1  23            2721   2728 
    LD  D,(HL)                          ;10c2  56            2722   2729 
    RRCA                                ;10c3  0f            2723   2730 
    RRCA                                ;10c4  0f            2724   2731 
    RRCA                                ;10c5  0f            2725   2732 
    RRCA                                ;10c6  0f            2726   2733 
    AND 00Fh                            ;10c7  e6 0f         2727   2734 
    JR  Z,SOUND4                        ;10c9  28 07         2728   2735 
SOUND5: SRL D                           ;10cb  cb 3a         2729   2736 
    RR  E                               ;10cd  cb 1b         2730   2737 
    DEC A                               ;10cf  3d            2731   2738 
    JR  NZ,SOUND5                       ;10d0  20 f9         2732   2739 
SOUND4: POP HL                          ;10d2  e1            2733   2740 
    LD  BC,04000h                       ;10d3  01 00 40      2734   2741 
    OUT (C),H                           ;10d6  ed 61         2735   2742 
    INC C                               ;10d8  0c            2736   2743 
    OUT (C),E                           ;10d9  ed 59         2737   2744 
    INC H                               ;10db  24            2738   2745 
    DEC C                               ;10dc  0d            2739   2746 
    OUT (C),H                           ;10dd  ed 61         2740   2747 
    INC C                               ;10df  0c            2741   2748 
    OUT (C),D                           ;10e0  ed 51         2742   2749 
    DEC C                               ;10e2  0d            2743   2750 
    LD  A,7                             ;10e3  3e 07         2744   2751 
    OUT (C),A                           ;10e5  ed 79         2745   2752 
    INC C                               ;10e7  0c            2746   2753 
    IN  A,(C)                           ;10e8  ed 78         2747   2754 
    AND L                               ;10ea  a5            2748   2755 
    OUT (C),A                           ;10eb  ed 79         2749   2756 
    RET                                 ;10ed  c9            2750   2757 
                                        ;                    2751   2758 ;
SOUND2: LD  BC,04000h                   ;10ee  01 00 40      2752   2759 
    LD  A,7                             ;10f1  3e 07         2753   2760 
    OUT (C),A                           ;10f3  ed 79         2754   2761 
    INC C                               ;10f5  0c            2755   2762 
    IN  H,(C)                           ;10f6  ed 60         2756   2763 
    LD  A,L                             ;10f8  7d            2757   2764 
    CPL                                 ;10f9  2f            2758   2765 
    OR  H                               ;10fa  b4            2759   2766 
    OUT (C),A                           ;10fb  ed 79         2760   2767 
    RET                                 ;10fd  c9            2761   2768 
                                        ;                    2762   2769 ;
                                        ;                    2763   2770 ;
                                        ;                    2764   2771 ; DATA TABLE
                                        ;                    2765   2772 ;
                                        ;                    2766   2773 ;
MSDT32: DEFW    62                      ;10fe  3e 00         2767   2774 
                                        ;                    2768   2775 ;
MUSNUL: DEFM    ':'                     ;1100  3a            2769   2776 ;:
                                        ;                    2770   2777 ;
LENGTB: DEFB    1                       ;1101  01            2771   2778 
    DEFB    2                           ;1102  02            2772   2779 
    DEFB    3                           ;1103  03            2773   2780 
    DEFB    4                           ;1104  04            2774   2781 
    DEFB    6                           ;1105  06            2775   2782 
    DEFB    8                           ;1106  08            2776   2783 
    DEFB    00CH                        ;1107  0c            2777   2784 
    DEFB    010h                        ;1108  10            2778   2785 
    DEFB    018h                        ;1109  18            2779   2786 
    DEFB    020h                        ;110a  20            2780   2787 
                                        ;                    2781   2788 ;
LEN?A:  DEFB    008h                    ;110b  08            2782   2789 ;R5
    DEFB    000h                        ;110c  00            2783   2790 
DATA?A: DEFW    00000h                  ;110d  00 00         2784   2791 
    DEFB    0FEh                        ;110f  fe            2785   2792 
OCT?A:  DEFB    003h                    ;1110  03            2786   2793 
LENG?A: DEFB    000h                    ;1111  00            2787   2794 
    DEFB    008h                        ;1112  08            2788   2795 
                                        ;                    2789   2796 ;
LEN?B:  DEFB    008h                    ;1113  08            2790   2797 
    DEFB    002h                        ;1114  02            2791   2798 
DATA?B: DEFW    00000h                  ;1115  00 00         2792   2799 
    DEFB    0FDh                        ;1117  fd            2793   2800 
OCT?B:  DEFB    3                       ;1118  03            2794   2801 
LENG?B: DEFB    0                       ;1119  00            2795   2802 
    DEFB    9                           ;111a  09            2796   2803 
                                        ;                    2797   2804 ;
LEN?C:  DEFB    8                       ;111b  08            2798   2805 
    DEFB    4                           ;111c  04            2799   2806 
DATA?C: DEFW    00000h                  ;111d  00 00         2800   2807 
    DEFB    0FBh                        ;111f  fb            2801   2808 
OCT?C:  DEFB    3                       ;1120  03            2802   2809 
LENG?C: DEFB    0                       ;1121  00            2803   2810 
    DEFB    10                          ;1122  0a            2804   2811 
                                        ;                    2805   2812 ;
                                        ;                    2806   2813 ;
NUMTBL: DEFW    007F2h                  ;1123  f2 07         2807   2814 ;A
    DEFW    00714h                      ;1125  14 07         2808   2815 ;B
    DEFW    00D5Dh                      ;1127  5d 0d         2809   2816 ;C
    DEFW    00BE7h                      ;1129  e7 0b         2810   2817 ;D
    DEFW    00A9Bh                      ;112b  9b 0a         2811   2818 ;E
    DEFW    00A02h                      ;112d  02 0a         2812   2819 ;F
    DEFW    008EBh                      ;112f  eb 08         2813   2820 ;G
                                        ;                    2814   2821 ;
UPTBL:  DEFW    00780h                  ;1131  80 07         2815   2822 ;A#
    DEFW    00714h                      ;1133  14 07         2816   2823 ;B
    DEFW    00C9Ch                      ;1135  9c 0c         2817   2824 ;C#
    DEFW    00B3Ch                      ;1137  3c 0b         2818   2825 ;D#
    DEFW    00A9Bh                      ;1139  9b 0a         2819   2826 ;E
    DEFW    00973h                      ;113b  73 09         2820   2827 ;F#
    DEFW    0086Bh                      ;113d  6b 08         2821   2828 ;G#
                                        ;                    2822   2829 ;
CTRLTB: DEFW    NORET                   ;113f  cc 0e         2823   2830 ;@
    DEFW    NORET                       ;1141  cc 0e         2824   2831 ;A
    DEFW    CTRLB                       ;1143  9c 0b         2825   2832 ;B
    DEFW    CTRLM                       ;1145  62 0b         2826   2833 ;C
    DEFW    SCRLDW                      ;1147  ea 09         2827   2834 ;D
    DEFW    CTRLE                       ;1149  1d 0c         2828   2835 ;E
    DEFW    CTRLF                       ;114b  b4 0b         2829   2836 ;F
    DEFW    CTRLG                       ;114d  91 0b         2830   2837 ;G
    DEFW    DELETE                      ;114f  8e 0a         2831   2838 ;H 315ah ?? 
    DEFW    CTRLI                       ;1151  08 0c         2832   2839 ;I
    DEFW    NORET                       ;1153  cc 0e         2833   2840 ;J
    DEFW    HOME                        ;1155  03 0b         2834   2841 ;K HOME
    DEFW    CLR2                        ;1157  d5 0a         2835   2842 ;L CLR
    DEFW    CTRLM                       ;1159  62 0b         2836   2843 ;M CR
    DEFW    NORET                       ;115b  cc 0e         2837   2844 ;N
    DEFW    NORET                       ;115d  cc 0e         2838   2845 ;O
    DEFW    NORET                       ;115f  cc 0e         2839   2846 ;P
    DEFW    NORET                       ;1161  cc 0e         2840   2847 ;Q
    DEFW    INST                        ;1163  09 0b         2841   2848 ;R INST
    DEFW    NORET                       ;1165  cc 0e         2842   2849 ;S
    DEFW    CTRLT                       ;1167  fb 0b         2843   2850 ;T
    DEFW    SCRLUP                      ;1169  91 09         2844   2851 ;U
    DEFW    LOCK                        ;116b  3f 0b         2845   2852 ;V LOCK
    DEFW    UNLOCK                      ;116d  45 0b         2846   2853 ;W UNLOCK
    DEFW    NORET                       ;116f  cc 0e         2847   2854 ;X
    DEFW    CTRLY                       ;1171  f7 0b         2848   2855 ;Y
    DEFW    CTRLZ                       ;1173  25 0c         2849   2856 ;Z
    DEFW    NORET                       ;1175  cc 0e         2850   2857 ;ESC
    DEFW    RIGHT                       ;1177  6b 0b         2851   2858 ;RIGHT
    DEFW    LEFT                        ;1179  48 0b         2852   2859 ;LEFT
    DEFW    UP                          ;117b  87 0b         2853   2860 ;UP
    DEFW    DOWN                        ;117d  8c 0b         2854   2861 ;DOWN
                                        ;                    2855   2862 
                                        ;                    2856   2863 
BELLFG: DEFB    0                       ;117f  00            2857   2864 ;CTRL-G
                                        ;                    2858   2865 ;
COLORF: DEFB    0                       ;1180  00            2859   2866 ; Color Flag
GCOLOR: DEFB    0                       ;1181  00            2860   2867 ; Graphic Color
SCRLBF: DEFS    020h                    ;1182                2861   2868 ; scroll buffer
LINEF:  DEFS    65                      ;11a2                2862   2869 ; line return flag
                                        ;                    2863   2870 ;
CKSMF1: DEFW    0                       ;11e3  00 00         2864   2871 ; checksum field
CKSMF2: DEFW    0                       ;11e5  00 00         2865   2872 ; checksum field
MKLEN:  DEFW    0                       ;11e7  00 00         2866   2873 
                                        ;                    2867   2874 ;
IO6000: DEFB    0                       ;11e9  00            2868   2875 ; 6000H I/O data
IO2000: DEFB    0                       ;11ea  00            2869   2876 ; 2000H I/O data
DISFLG: DEFB    1                       ;11eb  01            2870   2877 ; output flag (console=1, printer=2)
PRINTN: DEFB    0                       ;11ec  00            2871   2878 ; printer header
                                        ;                    2872   2879 ;
CURX:   DEFB    0                       ;11ed  00            2873   2880 ; cursor X
CURY:   DEFB    0                       ;11ee  00            2874   2881 ; cursor Y
OLDBUF: DEFS    10                      ;11ef                2875   2882 ; keyboard matrix old buffer
NEWBUF: DEFS    9                       ;11f9                2876   2883 ; keyboard matrix new buffer
NEWMOD: DEFB    0FFh                    ;1202  ff            2877   2884 ; keyboard matrix mode flag
                                        ;                    2878   2885 ;
LOCKMD: DEFB    0                       ;1203  00            2879   2886 ; LOCK mode
POINT1: DEFB    0                       ;1204  00            2880   2887 ; key input buffer 
POINT2: DEFB    0                       ;1205  00            2881   2888 ; key input buffer 
INKYBF: DEFS    040h                    ;1206                2882   2889 ; key input buffer
TABBUF: DEFS    32                      ;1246                2883   2890 ; TAB flag
                                        ;                    2884   2891 ;
                                        ;                    2885   2892 ;
FUNBUF: DEFB    5                       ;1266  05            2886   2893 ; function definition
    DEFM    'AUTO'                      ;1267  41 55 54 4f   2887   2894 
    DEFB    00Dh                        ;126b  0d            2888   2895 
    DEFS    10                          ;126c                2889   2896 
    DEFB    6                           ;1276  06            2890   2897 
    DEFM    'SCREEN'                    ;1277  53 43 52 45   2891   2898 
                                        ;127b  45 4e         2891   2899
                                        ;                    2892   2900 
    DEFB    0                           ;127d  00            2893   2901 
    DEFS    8                           ;127e                2894   2902 
    DEFB    3                           ;1286  03            2895   2903 
    DEFM    'KEY'                       ;1287  4b 45 59      2896   2904 
    DEFB    0                           ;128a  00            2897   2905 
    DEFS    11                          ;128b                2898   2906 
    DEFB    5                           ;1296  05            2899   2907 
    DEFM    'LIST'                      ;1297  4c 49 53 54   2900   2908 
    DEFB    00Dh                        ;129b  0d            2901   2909 
    DEFS    00Ah                        ;129c                2902   2910 
    DEFB    4                           ;12a6  04            2903   2911 
    DEFM    'RUN'                       ;12a7  52 55 4e      2904   2912 
    DEFB    00Dh                        ;12aa  0d            2905   2913 
    DEFS    11                          ;12ab                2906   2914 
    DEFB    5                           ;12b6  05            2907   2915 
    DEFM    'LOAD'                      ;12b7  4c 4f 41 44   2908   2916 
    DEFB    00Dh                        ;12bb  0d            2909   2917 
    DEFS    10                          ;12bc                2910   2918 
    DEFB    5                           ;12c6  05            2911   2919 
    DEFM    'BEEP'                      ;12c7  42 45 45 50   2912   2920 
    DEFB    00Dh                        ;12cb  0d            2913   2921 
    DEFS    10                          ;12cc                2914   2922 
    DEFB    5                           ;12d6  05            2915   2923 
    DEFM    'CHR$('                     ;12d7  43 48 52 24   2916   2924 
                                        ;12db  28            2916   2925
                                        ;                    2917   2926 
    DEFB    0                           ;12dc  00            2918   2927 
    DEFS    9                           ;12dd                2919   2928 
    DEFB    4                           ;12e6  04            2920   2929 
    DEFM    'EDIT'                      ;12e7  45 44 49 54   2921   2930 
    DEFB    0                           ;12eb  00            2922   2931 
    DEFS    10                          ;12ec                2923   2932 
    DEFB    5                           ;12f6  05            2924   2933 
    DEFM    'CONT'                      ;12f7  43 4f 4e 54   2925   2934 
    DEFB    00Dh                        ;12fb  0d            2926   2935 
    DEFS    10                          ;12fc                2927   2936 
                                        ;                    2928   2937 ;
KEYDT1: DEFW    0F500h                  ;1306  00 f5         2929   2938 ;8009  No Shift
    DEFM    '-0                         ;1308  2d 30 3b      2930   2939 ;'		;'
    DEFW    06F6Ch                      ;130b  6c 6f         2931   2940 ;LO
    DEFM    '9'                         ;130d  39            2932   2941 ;9
    DEFW    0F400h                      ;130e  00 f4         2933   2942 ;8008
    DEFB    01Fh                        ;1310  1f            2934   2943 
    DEFM    ':/'                        ;1311  3a 2f         2935   2944 ;/
    DEFW    0696Bh                      ;1313  6b 69         2936   2945 ;KI
    DEFM    '8'                         ;1315  38            2937   2946 
    DEFW    0F300h                      ;1316  00 f3         2938   2947 ;8007
    DEFW    0701Eh                      ;1318  1e 70         2939   2948 ;P
    DEFM    '.'                         ;131a  2e            2940   2949 ;★원래는3F(?)였음
    DEFW    0756Ah                      ;131b  6a 75         2941   2950 ;JU
    DEFM    '7'                         ;131d  37            2942   2951 
    DEFW    0F200h                      ;131e  00 f2         2943   2952 ;8006
    DEFW    07840h                      ;1320  40 78         2944   2953 ;X
    DEFM    ','                         ;1322  2c            2945   2954 
    DEFW    07968h                      ;1323  68 79         2946   2955 ;HV
    DEFM    '6'                         ;1325  36            2947   2956 
    DEFW    0F100h                      ;1326  00 f1         2948   2957 ;8005
    DEFW    05D1Dh                      ;1328  1d 5d         2949   2958 
    DEFW    0676Dh                      ;132a  6d 67         2950   2959 ;MG
    DEFW    03574h                      ;132c  74 35         2951   2960 ;T5
    DEFW    00000h                      ;132e  00 00         2952   2961 ;8004
    DEFW    07C1Ch                      ;1330  1c 7c         2953   2962 
    DEFW    0666Eh                      ;1332  6e 66         2954   2963 ;NF
    DEFW    03472h                      ;1334  72 34         2955   2964 ;R4
    DEFW    00008h                      ;1336  08 00         2956   2965 ;DEL ;8003
    DEFW    05B1Bh                      ;1338  1b 5b         2957   2966 
    DEFW    06462h                      ;133a  62 64         2958   2967 ;BD
    DEFW    03365h                      ;133c  65 33         2959   2968 ;E3
    DEFW    00016h                      ;133e  16 00         2960   2969 ;LOCK ;8002
    DEFW    05D7Ah                      ;1340  7a 5d         2961   2970 ;Z^
    DEFW    07376h                      ;1342  76 73         2962   2971 ;VS
    DEFW    03277h                      ;1344  77 32         2963   2972 ;W2
    DEFW    00B5Eh                      ;1346  5e 0b         2964   2973 ;HOME ;8001
    DEFW    00D20h                      ;1348  20 0d         2965   2974 
    DEFW    06163h                      ;134a  63 61         2966   2975 ;CA
    DEFW    03171h                      ;134c  71 31         2967   2976 ;Q1
                                        ;                    2968   2977 ;
                                        ;                    2969   2978 ;
                                        ;                    2970   2979 ;
KEYDT2: DEFW    0FA00h                  ;134e  00 fa         2971   2980 ; Shift
    DEFM    '=0+LO)'                    ;1350  3d 30 2b 4c   2972   2981 
                                        ;1354  4f 29         2972   2982
                                        ;                    2973   2983 
    DEFW    0F900h                      ;1356  00 f9         2974   2984 
    DEFB    01Fh                        ;1358  1f            2975   2985 
    DEFM    '*?KI('                     ;1359  2a 3f 4b 49   2976   2986 
                                        ;135d  28            2976   2987
                                        ;                    2977   2988 
    DEFW    0F800h                      ;135e  00 f8         2978   2989 
    DEFB    01Eh                        ;1360  1e            2979   2990 
    DEFM    'P>JU'                      ;1361  50 3e 4a 55   2980   2991 
    DEFB    027h                        ;1365  27            2981   2992 
    DEFW    0F700h                      ;1366  00 f7         2982   2993 
    DEFB    060h                        ;1368  60            2983   2994 
    DEFM    'X<HY&'                     ;1369  58 3c 48 59   2984   2995 
                                        ;136d  26            2984   2996
                                        ;                    2985   2997 
    DEFW    0F600h                      ;136e  00 f6         2986   2998 
    DEFW    07D1Dh                      ;1370  1d 7d         2987   2999 
    DEFM    'MGT%'                      ;1372  4d 47 54 25   2988   3000 
    DEFW    00000h                      ;1376  00 00         2989   3001 
    DEFW    07F1Ch                      ;1378  1c 7f         2990   3002 
    DEFM    'NFR$'                      ;137a  4e 46 52 24   2991   3003 
    DEFW    00012h                      ;137e  12 00         2992   3004 ;INST
    DEFW    07B1Bh                      ;1380  1b 7b         2993   3005 
    DEFM    'BDE#'                      ;1382  42 44 45 23   2994   3006 
    DEFW    00017h                      ;1386  17 00         2995   3007 ;LOCK
    DEFM    'Z'                         ;1388  5a            2996   3008 
    DEFB    07Dh                        ;1389  7d            2997   3009 
    DEFM    'VSW"'                      ;138a  56 53 57 22   2998   3010 
    DEFW    00C7Eh                      ;138e  7e 0c         2999   3011 ;CLR
    DEFW    00D20h                      ;1390  20 0d         3000   3012 
    DEFM    'CAQ!'                      ;1392  43 41 51 21   3001   3013 
                                        ;                    3002   3014 ;
                                        ;                    3003   3015 ; FILE
                                        ;                    3004   3016 ;  CONTROL
                                        ;                    3005   3017 ;   BLOCK
                                        ;                    3006   3018 ;
                                        ;                    3007   3019 ;
FILMOD: DEFB    0001h                   ;1396  01            3008   3020 ; 1=기계어, 2=베이직
FILNAM: DEFS    17                      ;1397                3009   3021 ; 프로그램 이름 17 BYTE
MTBYTE: DEFW    1                       ;13a8  01 00         3010   3022 ; 프로그램 크기
MTADRS: DEFW    0                       ;13aa  00 00         3011   3023 ; 프로그램 저장번지
MTEXEC: DEFW    0                       ;13ac  00 00         3012   3024 ; CP/M에서 시작번지
PROTCT: DEFW    0                       ;13ae  00 00         3013   3025 ; 3A 00 이 들어있으면 베이직 자동실행
    DEFS    01416h - $                  ;13b0                3014   3026 ; 102 BYTE
                                        ;                    3015   3027 
                                        ;                    3016   3028 ;
                                        ;                    3017   3029 ; HUDSON BASIC V1.0
                                        ;                    3018   3030 ;
                                        ;                    3019   3031 
                                        ;                    3020   3032 ;SPBUF   EQU  02232h
    JR  HOTENT                          ;1416  18 2e         3021   3033 
$BASIC:                                 ;                    3022   3034 
COLDST: LD  DE,KEYBUF                   ;1418  11 4f 7a      3023   3035 
    LD  B,64                            ;141b  06 40         3024   3036 
MESOFF: CALL    PRTSDC                  ;141d  cd e1 07      3025   3037 
    LD  A,001h                          ;1420  3e 01         3026   3038 
    LD  (MESOFF),A                      ;1422  32 1d 14      3027   3039 
PATCH1:                                 ;                    3028   3040 
    LD  HL,KEYBUF                       ;1425  21 4f 7a      3029   3041 
    LD  D,0FFh                          ;1428  16 ff         3030   3042 ;MEM.MAX
L0014:                                  ;                    3031   3043 
    XOR A                               ;142a  af            3032   3044 
    LD  (HL),A                          ;142b  77            3033   3045 
    CP  (HL)                            ;142c  be            3034   3046 
    JR  NZ,L001E                        ;142d  20 05         3035   3047 
    INC HL                              ;142f  23            3036   3048 
    LD  A,H                             ;1430  7c            3037   3049 
    CP  D                               ;1431  ba            3038   3050 
    JR  NZ,L0014                        ;1432  20 f6         3039   3051 
L001E:                                  ;                    3040   3052 
    LD  (MEMMAX),HL                     ;1434  22 49 7a      3041   3053 
    CALL    MEMSET                      ;1437  cd e9 33      3042   3054 
    CALL    GSAVES                      ;143a  cd ea 1b      3043   3055 ;PCG SET
START:  CALL    NEW                     ;143d  cd ac 39      3044   3056 
    LD  HL,00000h                       ;1440  21 00 00      3045   3057 
    LD  (PROTCT),HL                     ;1443  22 ae 13      3046   3058 ;CMT BUFF
HOTENT: CALL    CLR                     ;1446  cd 51 19      3047   3059 
    LD  SP,(STRTOP)                     ;1449  ed 7b 41 7a   3048   3060 
    LD  HL,0FFFFh                       ;144d  21 ff ff      3049   3061 
    PUSH    HL                          ;1450  e5            3050   3062 
    LD  (SPBUF),SP                      ;1451  ed 73 25 22   3051   3063 
    XOR A                               ;1455  af            3052   3064 
    LD  (CONTFG),A                      ;1456  32 08 22      3053   3065 
    LD  (ERRORF),A                      ;1459  32 50 22      3054   3066 
    LD  (FILEFG),A                      ;145c  32 83 33      3055   3067 
    CALL    TROFF                       ;145f  cd ea 32      3056   3068 
OK: CALL    CR2                         ;1462  cd 23 08      3057   3069 
    LD  A,1                             ;1465  3e 01         3058   3070 
    LD  (DISFLG),A                      ;1467  32 eb 11      3059   3071 
    LD  DE,OKMES                        ;146a  11 f7 21      3060   3072 
    LD  B,2                             ;146d  06 02         3061   3073 
    CALL    PRTSDC                      ;146f  cd e1 07      3062   3074 
    LD  B,020h                          ;1472  06 20         3063   3075 
    LD  A,(CONTFG)                      ;1474  3a 08 22      3064   3076 
    OR  A                               ;1477  b7            3065   3077 
    JR  Z,CONTDS                        ;1478  28 02         3066   3078 
    LD  B,02Eh                          ;147a  06 2e         3067   3079 
CONTDS: LD  A,B                         ;147c  78            3068   3080 
    CALL    ACCPRT                      ;147d  cd 64 08      3069   3081 
    LD  A,(GMODEF)                      ;1480  3a 06 1c      3070   3082 
    CP  2                               ;1483  fe 02         3071   3083 
PATCH6:                                 ;                    3072   3084 
    CALL    NC,GRAPHI                   ;1485  d4 93 1b      3073   3085 
                                        ;                    3074   3086 ;
NMESOK: CALL    CR2                     ;1488  cd 23 08      3075   3087 
AUTOBK: LD  SP,(SPBUF)                  ;148b  ed 7b 25 22   3076   3088 
    CALL    SETSSP                      ;148f  cd f9 21      3077   3089 
KEYINP: LD  HL,KEYINP                   ;1492  21 92 14      3078   3090 
    PUSH    HL                          ;1495  e5            3079   3091 
    CALL    AUTOVC                      ;1496  cd 37 22      3080   3092 
MERGEV: LD  DE,KEYBUF                   ;1499  11 4f 7a      3081   3093 
    DEFB    0CDH                        ;149c  cd            3082   3094 ;CALL
LODVEC: DEFW    LININP                  ;149d  93 15         3083   3095 
    JP  C,AUTOFF                        ;149f  da 2a 22      3084   3096 
BLNKSK: LD  A,(DE)                      ;14a2  1a            3085   3097 
    CP  020h                            ;14a3  fe 20         3086   3098 
    INC DE                              ;14a5  13            3087   3099 
    JR  Z,BLNKSK                        ;14a6  28 fa         3088   3100 
    DEC DE                              ;14a8  1b            3089   3101 
    OR  A                               ;14a9  b7            3090   3102 
    RET Z                               ;14aa  c8            3091   3103 
    CP  027h                            ;14ab  fe 27         3092   3104 
    RET Z                               ;14ad  c8            3093   3105 
    CP  030h                            ;14ae  fe 30         3094   3106 
    JR  NC,L00A5                        ;14b0  30 09         3095   3107 
    LD  HL,0FFFFh                       ;14b2  21 ff ff      3096   3108 
    LD  (LNOBUF),HL                     ;14b5  22 cc 16      3097   3109 
    JP  SERROR                          ;14b8  c3 3a 17      3098   3110 
L00A5:  CP  03Ah                        ;14bb  fe 3a         3099   3111 
    JP  C,EDITOR                        ;14bd  da f2 30      3100   3112 
    POP HL                              ;14c0  e1            3101   3113 
    LD  HL,IMDBUF                       ;14c1  21 4e 7b      3102   3114 
    PUSH    HL                          ;14c4  e5            3103   3115 
    CALL    CVIMTX                      ;14c5  cd 25 63      3104   3116 
    XOR A                               ;14c8  af            3105   3117 
    INC HL                              ;14c9  23            3106   3118 
    LD  (NXTLPT),HL                     ;14ca  22 12 16      3107   3119 
    LD  (HL),A                          ;14cd  77            3108   3120 
    INC HL                              ;14ce  23            3109   3121 
    LD  (HL),A                          ;14cf  77            3110   3122 
    INC A                               ;14d0  3c            3111   3123 
    LD  (DISFLG),A                      ;14d1  32 eb 11      3112   3124 
    LD  HL,0FFFFh                       ;14d4  21 ff ff      3113   3125 
    LD  (LNOBUF),HL                     ;14d7  22 cc 16      3114   3126 
    POP HL                              ;14da  e1            3115   3127 
ONELIN: LD  (SPBUF),SP                  ;14db  ed 73 25 22   3116   3128 
SPCCUT: LD  A,(HL)                      ;14df  7e            3117   3129 
    CP  020h                            ;14e0  fe 20         3118   3130 
    INC HL                              ;14e2  23            3119   3131 
    JR  Z,SPCCUT                        ;14e3  28 fa         3120   3132 
    CP  03Ah                            ;14e5  fe 3a         3121   3133 
    JR  Z,SPCCUT                        ;14e7  28 f6         3122   3134 
    OR  A                               ;14e9  b7            3123   3135 
    JP  Z,NXLINE                        ;14ea  ca 11 16      3124   3136 
    LD  (CURTXT),HL                     ;14ed  22 7b 21      3125   3137 
    LD  C,A                             ;14f0  4f            3126   3138 
    LD  A,080h                          ;14f1  3e 80         3127   3139 ;BREAK CHECK
    IN  A,(0)                           ;14f3  db 00         3128   3140 
    AND 012h                            ;14f5  e6 12         3129   3141 
BREAKJ: DEFB    0CAH                    ;14f7  ca            3130   3142 ;JP Z,?
    DEFW    BREAK                       ;14f8  a2 16         3131   3143 
PAUSEP: LD  A,C                         ;14fa  79            3132   3144 
    LD  DE,SPCCUT                       ;14fb  11 df 14      3133   3145 
    PUSH    DE                          ;14fe  d5            3134   3146 
LETDA': CP  027h                        ;14ff  fe 27         3135   3147 ;'
    JP  Z,REM                           ;1501  ca 3a 18      3136   3148 
    CP  081h                            ;1504  fe 81         3137   3149 
    JP  NC,STMNTS                       ;1506  d2 20 17      3138   3150 
    CP  041h                            ;1509  fe 41         3139   3151 
    JP  C,SERROR                        ;150b  da 3a 17      3140   3152 
LETDAI: LD  C,L                         ;150e  4d            3141   3153 
    LD  B,H                             ;150f  44            3142   3154 
    LD  DE,(INTFAC)                     ;1510  ed 5b 4b 7a   3143   3155 
DAINUE: CALL    GETVAR                  ;1514  cd da 1e      3144   3156 
    CP  003h                            ;1517  fe 03         3145   3157 
    JR  Z,DAISTR                        ;1519  28 2b         3146   3158 
DAINV': PUSH    AF                      ;151b  f5            3147   3159 
    CALL    BCFTCH                      ;151c  cd c4 25      3148   3160 
    CP  0F5h                            ;151f  fe f5         3149   3161 
    JP  NZ,SERROR                       ;1521  c2 3a 17      3150   3162 
    EX  (SP),HL                         ;1524  e3            3151   3163 
    PUSH    HL                          ;1525  e5            3152   3164 
    CALL    FLEXPR                      ;1526  cd 99 22      3153   3165 
    POP AF                              ;1529  f1            3154   3166 
    CP  002h                            ;152a  fe 02         3155   3167 
    JR  Z,INTDAI                        ;152c  28 0e         3156   3168 
    POP DE                              ;152e  d1            3157   3169 
DAIMID: PUSH    BC                      ;152f  c5            3158   3170 
    LD  B,A                             ;1530  47            3159   3171 
DAITRS: LD  A,(HL)                      ;1531  7e            3160   3172 
    LD  (DE),A                          ;1532  12            3161   3173 
    INC HL                              ;1533  23            3162   3174 
    INC DE                              ;1534  13            3163   3175 
    DJNZ    DAITRS                      ;1535  10 fa         3164   3176 
    POP BC                              ;1537  c1            3165   3177 
DAIRET: LD  L,C                         ;1538  69            3166   3178 
    LD  H,B                             ;1539  60            3167   3179 
    DEC HL                              ;153a  2b            3168   3180 
    RET                                 ;153b  c9            3169   3181 
                                        ;                    3170   3182 ;
INTDAI: CALL    HLFLTO                  ;153c  cd 97 2d      3171   3183 
    POP DE                              ;153f  d1            3172   3184 
    EX  DE,HL                           ;1540  eb            3173   3185 
    LD  (HL),E                          ;1541  73            3174   3186 
    INC HL                              ;1542  23            3175   3187 
    LD  (HL),D                          ;1543  72            3176   3188 
    JR  DAIRET                          ;1544  18 f2         3177   3189 
                                        ;                    3178   3190 ;
DAISTR: CALL    BCFTCH                  ;1546  cd c4 25      3179   3191 
    CP  0F5h                            ;1549  fe f5         3180   3192 
    JP  NZ,SERROR                       ;154b  c2 3a 17      3181   3193 
    PUSH    HL                          ;154e  e5            3182   3194 
    CALL    STEXPR                      ;154f  cd b2 22      3183   3195 
STRMDM: CALL    CONDMZ                  ;1552  cd f6 6b      3184   3196 
    CALL    CVDSAD                      ;1555  cd 0e 17      3185   3197 
    PUSH    BC                          ;1558  c5            3186   3198 
    PUSH    HL                          ;1559  e5            3187   3199 
    OR  A                               ;155a  b7            3188   3200 
    JR  Z,ESKTRS                        ;155b  28 11         3189   3201 
    LD  C,A                             ;155d  4f            3190   3202 
    LD  B,0                             ;155e  06 00         3191   3203 
    EX  DE,HL                           ;1560  eb            3192   3204 
    LD  DE,KEYBUF                       ;1561  11 4f 7a      3193   3205 
    PUSH    DE                          ;1564  d5            3194   3206 
    LDIR                                ;1565  ed b0         3195   3207 
    POP DE                              ;1567  d1            3196   3208 
    POP HL                              ;1568  e1            3197   3209 
    PUSH    HL                          ;1569  e5            3198   3210 
    INC HL                              ;156a  23            3199   3211 
    LD  (HL),E                          ;156b  73            3200   3212 
    INC HL                              ;156c  23            3201   3213 
    LD  (HL),D                          ;156d  72            3202   3214 
ESKTRS: POP HL                          ;156e  e1            3203   3215 
    POP BC                              ;156f  c1            3204   3216 
    POP DE                              ;1570  d1            3205   3217 
INPENT: PUSH    DE                      ;1571  d5            3206   3218 
    EX  DE,HL                           ;1572  eb            3207   3219 
    CALL    CONDM'                      ;1573  cd f2 6b      3208   3220 
    EX  DE,HL                           ;1576  eb            3209   3221 
    PUSH    HL                          ;1577  e5            3210   3222 
    INC HL                              ;1578  23            3211   3223 
    LD  E,(HL)                          ;1579  5e            3212   3224 
    INC HL                              ;157a  23            3213   3225 
    LD  D,(HL)                          ;157b  56            3214   3226 
    LD  HL,(STRTOP)                     ;157c  2a 41 7a      3215   3227 
    OR  A                               ;157f  b7            3216   3228 
    SBC HL,DE                           ;1580  ed 52         3217   3229 
    CCF                                 ;1582  3f            3218   3230 
    JR  NC,DAIMD'                       ;1583  30 05         3219   3231 
    LD  HL,TEXTST                       ;1585  21 4e 7c      3220   3232 
    SBC HL,DE                           ;1588  ed 52         3221   3233 
DAIMD': POP HL                          ;158a  e1            3222   3234 
    POP DE                              ;158b  d1            3223   3235 
    CALL    NC,GETSTR                   ;158c  d4 9e 2d      3224   3236 
    LD  A,003h                          ;158f  3e 03         3225   3237 
    JR  DAIMID                          ;1591  18 9c         3226   3238 
                                        ;                    3227   3239 ;
LININP: EI                              ;1593  fb            3228   3240 
    CALL    INPUTF                      ;1594  cd a4 06      3229   3241 
    LD  A,(DE)                          ;1597  1a            3230   3242 
    CP  3                               ;1598  fe 03         3231   3243 ;BREAK CODE
    SCF                                 ;159a  37            3232   3244 
    RET Z                               ;159b  c8            3233   3245 
    PUSH    DE                          ;159c  d5            3234   3246 
ZEROMK: LD  A,(DE)                      ;159d  1a            3235   3247 
    INC DE                              ;159e  13            3236   3248 
    CP  00Dh                            ;159f  fe 0d         3237   3249 
    JR  NZ,ZEROMK                       ;15a1  20 fa         3238   3250 
    DEC DE                              ;15a3  1b            3239   3251 
    XOR A                               ;15a4  af            3240   3252 
    PUSH    BC                          ;15a5  c5            3241   3253 
    LD  B,10                            ;15a6  06 0a         3242   3254 
KBCLLP: LD  (DE),A                      ;15a8  12            3243   3255 
    INC DE                              ;15a9  13            3244   3256 
    DJNZ    KBCLLP                      ;15aa  10 fc         3245   3257 
    POP BC                              ;15ac  c1            3246   3258 
    POP DE                              ;15ad  d1            3247   3259 
    RET                                 ;15ae  c9            3248   3260 
                                        ;                    3249   3261 ;
ENDTXT: LD  A,(ERRORF)                  ;15af  3a 50 22      3250   3262 
    OR  A                               ;15b2  b7            3251   3263 
OKFVC:  JP  Z,OK                        ;15b3  ca 62 14      3252   3264 
    LD  HL,(LNOBUF)                     ;15b6  2a cc 16      3253   3265 
    INC HL                              ;15b9  23            3254   3266 
    LD  A,L                             ;15ba  7d            3255   3267 
    OR  H                               ;15bb  b4            3256   3268 
    JR  Z,OKFVC                         ;15bc  28 f5         3257   3269 
    LD  A,19                            ;15be  3e 13         3258   3270 
    JP  ERROR                           ;15c0  c3 96 21      3259   3271 
                                        ;                    3260   3272 ;
RUN:    CALL    CLR                     ;15c3  cd 51 19      3261   3273 
    XOR A                               ;15c6  af            3262   3274 
    LD  (FILEFG),A                      ;15c7  32 83 33      3263   3275 
    LD  (CONTFG),A                      ;15ca  32 08 22      3264   3276 
    LD  (ERRCOD),A                      ;15cd  32 95 22      3265   3277 
    LD  (ERRORF),A                      ;15d0  32 50 22      3266   3278 
    PUSH    HL                          ;15d3  e5            3267   3279 
    LD  HL,TEXTST                       ;15d4  21 4e 7c      3268   3280 
    DEC HL                              ;15d7  2b            3269   3281 
    LD  (HL),A                          ;15d8  77            3270   3282 
    LD  (DATAPO),HL                     ;15d9  22 60 1c      3271   3283 
    LD  HL,LININP                       ;15dc  21 93 15      3272   3284 
    LD  (LODVEC),HL                     ;15df  22 9d 14      3273   3285 
    POP HL                              ;15e2  e1            3274   3286 
    LD  SP,(STRTOP)                     ;15e3  ed 7b 41 7a   3275   3287 
    PUSH    HL                          ;15e7  e5            3276   3288 
    LD  HL,0                            ;15e8  21 00 00      3277   3289 
    LD  (ERRLNO),HL                     ;15eb  22 65 22      3278   3290 
    LD  (ERRORV),HL                     ;15ee  22 83 21      3279   3291 
    DEC HL                              ;15f1  2b            3280   3292 
    EX  (SP),HL                         ;15f2  e3            3281   3293 
    LD  (SPBUF),SP                      ;15f3  ed 73 25 22   3282   3294 
    CALL    HLFTCH                      ;15f7  cd 87 29      3283   3295 
    CP  00Bh                            ;15fa  fe 0b         3284   3296 
    JR  NZ,RUNBOT                       ;15fc  20 0d         3285   3297 
    INC HL                              ;15fe  23            3286   3298 
    LD  E,(HL)                          ;15ff  5e            3287   3299 
    INC HL                              ;1600  23            3288   3300 
    LD  D,(HL)                          ;1601  56            3289   3301 
    EX  DE,HL                           ;1602  eb            3290   3302 
    CALL    LNOSER                      ;1603  cd 8e 3f      3291   3303 
    JP  C,UDFLNO                        ;1606  da dc 43      3292   3304 
    JR  RUNMID                          ;1609  18 03         3293   3305 
RUNBOT: LD  HL,TEXTST                   ;160b  21 4e 7c      3294   3306 
RUNMID: LD  (NXTLPT),HL                 ;160e  22 12 16      3295   3307 
NXLINE:                                 ;                    3296   3308 
    DEFB    021H                        ;1611  21            3297   3309 ;LD HL,?
NXTLPT: DEFS    2                       ;1612                3298   3310 
    LD  E,(HL)                          ;1614  5e            3299   3311 
    INC HL                              ;1615  23            3300   3312 
    LD  D,(HL)                          ;1616  56            3301   3313 
    INC HL                              ;1617  23            3302   3314 
    LD  A,D                             ;1618  7a            3303   3315 
    OR  E                               ;1619  b3            3304   3316 
    JR  Z,ENDTXT                        ;161a  28 93         3305   3317 
    LD  (NXTLPT),DE                     ;161c  ed 53 12 16   3306   3318 
    LD  E,(HL)                          ;1620  5e            3307   3319 
    INC HL                              ;1621  23            3308   3320 
    LD  D,(HL)                          ;1622  56            3309   3321 
    INC HL                              ;1623  23            3310   3322 
    LD  (LNOBUF),DE                     ;1624  ed 53 cc 16   3311   3323 
    DEFB    03EH                        ;1628  3e            3312   3324 ;LD A,?
TRACEF:DEFS 1                           ;1629                3313   3325 
    OR  A                               ;162a  b7            3314   3326 
    CALL    NZ,DEBUGR                   ;162b  c4 31 16      3315   3327 
    JP  ONELIN                          ;162e  c3 db 14      3316   3328 
                                        ;                    3317   3329 ;
DEBUGR: PUSH    AF                      ;1631  f5            3318   3330 
    XOR A                               ;1632  af            3319   3331 
    LD  (DISFLG),A                      ;1633  32 eb 11      3320   3332 
    LD  (DEBGHL),A                      ;1636  32 9f 16      3321   3333 
    POP AF                              ;1639  f1            3322   3334 
    RRCA                                ;163a  0f            3323   3335 
    JR  NC,NXSPL0                       ;163b  30 18         3324   3336 
    LD  C,L                             ;163d  4d            3325   3337 
    LD  B,H                             ;163e  44            3326   3338 
    PUSH    HL                          ;163f  e5            3327   3339 
    LD  HL,(CURX)                       ;1640  2a ed 11      3328   3340 
    PUSH    HL                          ;1643  e5            3329   3341 
    LD  HL,0                            ;1644  21 00 00      3330   3342 
    LD  (CURX),HL                       ;1647  22 ed 11      3331   3343 
    LD  L,C                             ;164a  69            3332   3344 
    LD  H,B                             ;164b  60            3333   3345 
    CALL    NXSPL0                      ;164c  cd 55 16      3334   3346 
    POP HL                              ;164f  e1            3335   3347 
    LD  (CURX),HL                       ;1650  22 ed 11      3336   3348 
    POP HL                              ;1653  e1            3337   3349 
    RET                                 ;1654  c9            3338   3350 
                                        ;                    3339   3351 ;
NXSPL0: PUSH    HL                      ;1655  e5            3340   3352 
    RRCA                                ;1656  0f            3341   3353 
    JR  NC,NXSPL1                       ;1657  30 0c         3342   3354 
    PUSH    AF                          ;1659  f5            3343   3355 
    LD  A,2                             ;165a  3e 02         3344   3356 
    LD  (DISFLG),A                      ;165c  32 eb 11      3345   3357 
    LD  A,023h                          ;165f  3e 23         3346   3358 
    LD  (DEBGHL),A                      ;1661  32 9f 16      3347   3359 
    POP AF                              ;1664  f1            3348   3360 
NXSPL1: RRCA                            ;1665  0f            3349   3361 
    JR  NC,NXSPL2                       ;1666  30 11         3350   3362 
    PUSH    AF                          ;1668  f5            3351   3363 
    LD  A,05Bh                          ;1669  3e 5b         3352   3364 
    CALL    ACCPRT                      ;166b  cd 64 08      3353   3365 
    EX  DE,HL                           ;166e  eb            3354   3366 
    CALL    FIVEPR                      ;166f  cd e5 16      3355   3367 
    EX  DE,HL                           ;1672  eb            3356   3368 
    LD  A,05Dh                          ;1673  3e 5d         3357   3369 
    CALL    ACCPRT                      ;1675  cd 64 08      3358   3370 
    POP AF                              ;1678  f1            3359   3371 
NXSPL2: RRCA                            ;1679  0f            3360   3372 
    JR  NC,NXSPL3                       ;167a  30 0f         3361   3373 
    POP HL                              ;167c  e1            3362   3374 
    PUSH    HL                          ;167d  e5            3363   3375 
    PUSH    AF                          ;167e  f5            3364   3376 
    CALL    ONELST                      ;167f  cd 28 41      3365   3377 
    LD  A,5                             ;1682  3e 05         3366   3378 
    CALL    ACCPRT                      ;1684  cd 64 08      3367   3379 
    CALL    CR1                         ;1687  cd 43 08      3368   3380 
    POP AF                              ;168a  f1            3369   3381 
NXSPL3: RRCA                            ;168b  0f            3370   3382 
    PUSH    AF                          ;168c  f5            3371   3383 
    CALL    C,FLSHGT                    ;168d  dc 3c 0d      3372   3384 
    POP AF                              ;1690  f1            3373   3385 
    RRCA                                ;1691  0f            3374   3386 
    LD  HL,DEBGHL                       ;1692  21 9f 16      3375   3387 
    CALL    C,DUMP                      ;1695  dc 2f 3d      3376   3388 
    LD  A,1                             ;1698  3e 01         3377   3389 
    LD  (DISFLG),A                      ;169a  32 eb 11      3378   3390 
    POP HL                              ;169d  e1            3379   3391 
    RET                                 ;169e  c9            3380   3392 
                                        ;                    3381   3393 ;
DEBGHL: DEFS    1                       ;169f                3382   3394 
                                        ;                    3383   3395 ;
                                        ;                    3384   3396 ;
BREAK$: POP BC                          ;16a0  c1            3385   3397 
    INC HL                              ;16a1  23            3386   3398 
BREAK:  DEC HL                          ;16a2  2b            3387   3399 
    LD  (BTEXTP),HL                     ;16a3  22 22 22      3388   3400 
    LD  HL,(LNOBUF)                     ;16a6  2a cc 16      3389   3401 
    LD  A,H                             ;16a9  7c            3390   3402 
    AND L                               ;16aa  a5            3391   3403 
    INC A                               ;16ab  3c            3392   3404 
    JR  Z,BRDRCT                        ;16ac  28 02         3393   3405 
    LD  A,1                             ;16ae  3e 01         3394   3406 
BRDRCT: LD  (BLNOBF),HL                 ;16b0  22 16 22      3395   3407 
    LD  (SPBUF),SP                      ;16b3  ed 73 25 22   3396   3408 
    LD  (CONTFG),A                      ;16b7  32 08 22      3397   3409 
    LD  HL,(NXTLPT)                     ;16ba  2a 12 16      3398   3410 
    LD  (BNXTLP),HL                     ;16bd  22 1c 22      3399   3411 
    CALL    CR2                         ;16c0  cd 23 08      3400   3412 
    LD  DE,BREAKM                       ;16c3  11 05 17      3401   3413 
    LD  B,5                             ;16c6  06 05         3402   3414 
    CALL    PRTSDC                      ;16c8  cd e1 07      3403   3415 
LNOPRT: DB  021H                        ;16cb  21            3404   3416 ;LD HL,?
LNOBUF: DEFS    2                       ;16cc                3405   3417 
    LD  A,H                             ;16ce  7c            3406   3418 
    AND L                               ;16cf  a5            3407   3419 
    INC A                               ;16d0  3c            3408   3420 
    JP  Z,OK                            ;16d1  ca 62 14      3409   3421 
    LD  (EDLINE),HL                     ;16d4  22 2a 37      3410   3422 
    LD  DE,INMES                        ;16d7  11 0a 17      3411   3423 
    LD  B,4                             ;16da  06 04         3412   3424 
    CALL    PRTSDC                      ;16dc  cd e1 07      3413   3425 
    CALL    FIVEPR                      ;16df  cd e5 16      3414   3426 
    JP  OK                              ;16e2  c3 62 14      3415   3427 
                                        ;                    3416   3428 ;
FIVEPR: PUSH    DE                      ;16e5  d5            3417   3429 
    LD  DE,KEYBUF                       ;16e6  11 4f 7a      3418   3430 
    CALL    ASCHL                       ;16e9  cd a8 62      3419   3431 
    LD  B,4                             ;16ec  06 04         3420   3432 
SKIPFZ: LD  A,(DE)                      ;16ee  1a            3421   3433 
    CP  030h                            ;16ef  fe 30         3422   3434 
    JR  NZ,PRTNUM                       ;16f1  20 09         3423   3435 
    INC DE                              ;16f3  13            3424   3436 
    DJNZ    SKIPFZ                      ;16f4  10 f8         3425   3437 
LSTODP: LD  A,(DE)                      ;16f6  1a            3426   3438 
    CALL    ACCPRT                      ;16f7  cd 64 08      3427   3439 
    POP DE                              ;16fa  d1            3428   3440 
    RET                                 ;16fb  c9            3429   3441 
                                        ;                    3430   3442 
PRTNUM: LD  A,(DE)                      ;16fc  1a            3431   3443 
    CALL    ACCPRT                      ;16fd  cd 64 08      3432   3444 
    INC DE                              ;1700  13            3433   3445 
    DJNZ    PRTNUM                      ;1701  10 f9         3434   3446 
    JR  LSTODP                          ;1703  18 f1         3435   3447 
                                        ;                    3436   3448 ;
BREAKM: DEFM    'BREAK'                 ;1705  42 52 45 41   3437   3449 
                                        ;1709  4b            3437   3450
                                        ;                    3438   3451 
INMES:  DEFM    ' IN '                  ;170a  20 49 4e 20   3439   3452 
                                        ;                    3440   3453 ;
CVDSAD: PUSH    HL                      ;170e  e5            3441   3454 
    CALL    INDRCT                      ;170f  cd a3 2a      3442   3455 
    LD  A,(HL)                          ;1712  7e            3443   3456 
    INC HL                              ;1713  23            3444   3457 
    LD  E,(HL)                          ;1714  5e            3445   3458 
    INC HL                              ;1715  23            3446   3459 
    LD  D,(HL)                          ;1716  56            3447   3460 
    POP HL                              ;1717  e1            3448   3461 
    LD  (HL),A                          ;1718  77            3449   3462 
    INC HL                              ;1719  23            3450   3463 
    LD  (HL),E                          ;171a  73            3451   3464 
    INC HL                              ;171b  23            3452   3465 
    LD  (HL),D                          ;171c  72            3453   3466 
    DEC HL                              ;171d  2b            3454   3467 
    DEC HL                              ;171e  2b            3455   3468 
    RET                                 ;171f  c9            3456   3469 
                                        ;                    3457   3470 ;
STMNTS: CP  0FFh                        ;1720  fe ff         3458   3471 
    JR  Z,FUNCTN1                       ;1722  28 1b         3459   3472 
    CP  0D0h                            ;1724  fe d0         3460   3473 
    JP  NC,SERROR                       ;1726  d2 3a 17      3461   3474 
    PUSH    HL                          ;1729  e5            3462   3475 
    LD  HL,SJPTBL                       ;172a  21 68 2f      3463   3476 
    CALL    GETJPA                      ;172d  cd 9f 28      3464   3477 
    EX  (SP),HL                         ;1730  e3            3465   3478 
    RET                                 ;1731  c9            3466   3479 
                                        ;                    3467   3480 ;
TYPEMS: LD  A,13                        ;1732  3e 0d         3468   3481 
    JR  ERJUMP                          ;1734  18 06         3469   3482 
                                        ;                    3470   3483 ;
IFCALL: LD  A,5                         ;1736  3e 05         3471   3484 
    JR  ERJUMP                          ;1738  18 02         3472   3485 
                                        ;                    3473   3486 ;
SERROR: LD  A,2                         ;173a  3e 02         3474   3487 
ERJUMP: JP  ERROR                       ;173c  c3 96 21      3475   3488 
                                        ;                    3476   3489 ;
FUNCTN1: LD A,(HL)                      ;173f  7e            3477   3490 
    CP  0B4h                            ;1740  fe b4         3478   3491 
    JP  Z,MIDDAI                        ;1742  ca 7e 17      3479   3492 
                                        ;                    3480   3493 ;
                                        ;                    3481   3494 ;	TIME$="00:00:00"
                                        ;                    3482   3495 ;
MEMDAI: CP  0B8h                        ;1745  fe b8         3483   3496 
MEMDSE: JP  NZ,SERROR                   ;1747  c2 3a 17      3484   3497 
    LD  C,L                             ;174a  4d            3485   3498 
    LD  B,H                             ;174b  44            3486   3499 
    INC BC                              ;174c  03            3487   3500 
    CALL    CH28H                       ;174d  cd 58 2d      3488   3501 
    CALL    IHLEXP                      ;1750  cd cc 22      3489   3502 
    PUSH    HL                          ;1753  e5            3490   3503 
    CALL    CH2CH                       ;1754  cd 61 2d      3491   3504 
    CALL    IHLEXP                      ;1757  cd cc 22      3492   3505 
    CALL    CH29H                       ;175a  cd 66 2d      3493   3506 
    CALL    HCHECK                      ;175d  cd d8 22      3494   3507 
    PUSH    AF                          ;1760  f5            3495   3508 
    CALL    BCFTCH                      ;1761  cd c4 25      3496   3509 
    CP  0F5h                            ;1764  fe f5         3497   3510 
    JR  NZ,MEMDSE                       ;1766  20 df         3498   3511 
    CALL    STREXX                      ;1768  cd 9d 45      3499   3512 
    DEC BC                              ;176b  0b            3500   3513 
    POP HL                              ;176c  e1            3501   3514 
    CP  H                               ;176d  bc            3502   3515 
    JR  C,SKMDAI                        ;176e  38 01         3503   3516 
    LD  A,H                             ;1770  7c            3504   3517 
SKMDAI: POP HL                          ;1771  e1            3505   3518 
    PUSH    BC                          ;1772  c5            3506   3519 
    OR  A                               ;1773  b7            3507   3520 
    JR  Z,NOMDAI                        ;1774  28 06         3508   3521 
    LD  C,A                             ;1776  4f            3509   3522 
    LD  B,0                             ;1777  06 00         3510   3523 
    EX  DE,HL                           ;1779  eb            3511   3524 
    LDIR                                ;177a  ed b0         3512   3525 
NOMDAI: POP HL                          ;177c  e1            3513   3526 
    RET                                 ;177d  c9            3514   3527 
                                        ;                    3515   3528 ;
MIDDAI: INC HL                          ;177e  23            3516   3529 
    LD  C,L                             ;177f  4d            3517   3530 
    LD  B,H                             ;1780  44            3518   3531 
    CALL    CH28H                       ;1781  cd 58 2d      3519   3532 
    LD  DE,(INTFAC)                     ;1784  ed 5b 4b 7a   3520   3533 
    CALL    GETVAB                      ;1788  cd d7 1e      3521   3534 
    CP  003h                            ;178b  fe 03         3522   3535 
    JP  NZ,TYPEMS                       ;178d  c2 32 17      3523   3536 
    PUSH    HL                          ;1790  e5            3524   3537 
    CALL    BCFTCH                      ;1791  cd c4 25      3525   3538 
    CALL    CH2CH                       ;1794  cd 61 2d      3526   3539 
    CALL    IHLEXP                      ;1797  cd cc 22      3527   3540 
    PUSH    AF                          ;179a  f5            3528   3541 
    CALL    HCHECK                      ;179b  cd d8 22      3529   3542 
    LD  D,A                             ;179e  57            3530   3543 
    LD  E,0FFh                          ;179f  1e ff         3531   3544 
    POP AF                              ;17a1  f1            3532   3545 
    CP  029h                            ;17a2  fe 29         3533   3546 
    JR  Z,MIDRAL                        ;17a4  28 0f         3534   3547 
    CALL    CH2CH                       ;17a6  cd 61 2d      3535   3548 
    PUSH    DE                          ;17a9  d5            3536   3549 
    CALL    IHLEXP                      ;17aa  cd cc 22      3537   3550 
    CALL    CH29H                       ;17ad  cd 66 2d      3538   3551 
    CALL    HCHECK                      ;17b0  cd d8 22      3539   3552 
    POP DE                              ;17b3  d1            3540   3553 
    LD  E,A                             ;17b4  5f            3541   3554 
MIDRAL: PUSH    DE                      ;17b5  d5            3542   3555 
    CALL    BCFTCH                      ;17b6  cd c4 25      3543   3556 
    CP  0F5h                            ;17b9  fe f5         3544   3557 
    JP  NZ,SERROR                       ;17bb  c2 3a 17      3545   3558 
    CALL    STREXX                      ;17be  cd 9d 45      3546   3559 
    EXX                                 ;17c1  d9            3547   3560 ; HL BC
    POP DE                              ;17c2  d1            3548   3561 ; D TO E
    POP HL                              ;17c3  e1            3549   3562 ; VAR DARD
    LD  A,(HL)                          ;17c4  7e            3550   3563 
    OR  A                               ;17c5  b7            3551   3564 
    LD  B,A                             ;17c6  47            3552   3565 
    LD  C,A                             ;17c7  4f            3553   3566 
    PUSH    HL                          ;17c8  e5            3554   3567 ; VAR ADRS
    JR  Z,NOEFT1                        ;17c9  28 56         3555   3568 
    PUSH    DE                          ;17cb  d5            3556   3569 ; D TO E
    INC HL                              ;17cc  23            3557   3570 
    CALL    INDRCT                      ;17cd  cd a3 2a      3558   3571 
    LD  DE,KEYBUF                       ;17d0  11 4f 7a      3559   3572 
    PUSH    DE                          ;17d3  d5            3560   3573 ; KEYBUF
MDTLLD: LD  A,(HL)                      ;17d4  7e            3561   3574 
    LD  (DE),A                          ;17d5  12            3562   3575 
    INC DE                              ;17d6  13            3563   3576 
    INC HL                              ;17d7  23            3564   3577 
    DJNZ    MDTLLD                      ;17d8  10 fa         3565   3578 
    POP HL                              ;17da  e1            3566   3579 ; KEYBUF
    POP DE                              ;17db  d1            3567   3580 ; D,E
    LD  A,D                             ;17dc  7a            3568   3581 
    DEC A                               ;17dd  3d            3569   3582 
    CP  C                               ;17de  b9            3570   3583 
    JR  NC,NOEFT1                       ;17df  30 40         3571   3584 
    ADD A,L                             ;17e1  85            3572   3585 
    LD  L,A                             ;17e2  6f            3573   3586 
    LD  A,000h                          ;17e3  3e 00         3574   3587 
    ADC A,H                             ;17e5  8c            3575   3588 
    LD  H,A                             ;17e6  67            3576   3589 ; HL <- REPLACE ADRS
    LD  A,C                             ;17e7  79            3577   3590 
    SUB D                               ;17e8  92            3578   3591 
    INC A                               ;17e9  3c            3579   3592 ; REPLACE LEN
    CP  E                               ;17ea  bb            3580   3593 
    JR  C,RPSTSW                        ;17eb  38 01         3581   3594 
    LD  A,E                             ;17ed  7b            3582   3595 
RPSTSW: LD  B,A                         ;17ee  47            3583   3596 
    PUSH    HL                          ;17ef  e5            3584   3597 
    PUSH    BC                          ;17f0  c5            3585   3598 
    EXX                                 ;17f1  d9            3586   3599 
    POP AF                              ;17f2  f1            3587   3600 ; B <- RP LEN
    POP DE                              ;17f3  d1            3588   3601 ; REPLACE ADRS
    PUSH    BC                          ;17f4  c5            3589   3602 ; TEXTPOINTER
    PUSH    AF                          ;17f5  f5            3590   3603 
    POP BC                              ;17f6  c1            3591   3604 ; B <- RP LEN
    LD  A,(HL)                          ;17f7  7e            3592   3605 
    CP  B                               ;17f8  b8            3593   3606 
    JR  NC,SKIOMR                       ;17f9  30 01         3594   3607 
    LD  B,A                             ;17fb  47            3595   3608 
SKIOMR: LD  A,B                         ;17fc  78            3596   3609 
    OR  A                               ;17fd  b7            3597   3610 
    JR  Z,NOEFT2                        ;17fe  28 1c         3598   3611 
    INC HL                              ;1800  23            3599   3612 
    CALL    INDRCT                      ;1801  cd a3 2a      3600   3613 
LSTRPL: LD  A,(HL)                      ;1804  7e            3601   3614 
    LD  (DE),A                          ;1805  12            3602   3615 
    INC HL                              ;1806  23            3603   3616 
    INC DE                              ;1807  13            3604   3617 
    DJNZ    LSTRPL                      ;1808  10 fa         3605   3618 
    LD  B,C                             ;180a  41            3606   3619 
    LD  DE,00008h                       ;180b  11 08 00      3607   3620 
    LD  HL,(INTFAC)                     ;180e  2a 4b 7a      3608   3621 
    ADD HL,DE                           ;1811  19            3609   3622 
    LD  DE,KEYBUF                       ;1812  11 4f 7a      3610   3623 
    CALL    ENTSTR                      ;1815  cd 1a 2b      3611   3624 
    POP BC                              ;1818  c1            3612   3625 
    JP  STRMDM                          ;1819  c3 52 15      3613   3626 
                                        ;                    3614   3627 ;
NOEFT2: POP BC                          ;181c  c1            3615   3628 
RETNOE: POP HL                          ;181d  e1            3616   3629 
    JP  RETIRQ                          ;181e  c3 39 1b      3617   3630 
                                        ;                    3618   3631 ;
NOEFT1: EXX                             ;1821  d9            3619   3632 
    JR  RETNOE                          ;1822  18 f9         3620   3633 
                                        ;                    3621   3634 ;
DFLTCL: PUSH    BC                      ;1824  c5            3622   3635 
    LD  A,004h                          ;1825  3e 04         3623   3636 
    LD  B,26                            ;1827  06 1a         3624   3637 
    LD  DE,DFTABL                       ;1829  11 88 30      3625   3638 
    CALL    FILL                        ;182c  cd 11 62      3626   3639 
    XOR A                               ;182f  af            3627   3640 
    LD  DE,USRTBL                       ;1830  11 a2 30      3628   3641 
    LD  B,20                            ;1833  06 14         3629   3642 
    CALL    FILL                        ;1835  cd 11 62      3630   3643 
    POP BC                              ;1838  c1            3631   3644 
    RET                                 ;1839  c9            3632   3645 
                                        ;                    3633   3646 ;
REM:    POP HL                          ;183a  e1            3634   3647 
    JP  NXLINE                          ;183b  c3 11 16      3635   3648 
                                        ;                    3636   3649 ;
FILEER: LD  A,31                        ;183e  3e 1f         3637   3650 
    JP  ERROR                           ;1840  c3 96 21      3638   3651 
                                        ;                    3639   3652 ;
PRTSTR: PUSH    BC                      ;1843  c5            3640   3653 
    CALL    CONDMZ                      ;1844  cd f6 6b      3641   3654 
    CALL    CVDSAD                      ;1847  cd 0e 17      3642   3655 
    LD  B,A                             ;184a  47            3643   3656 
    CALL    PRTSDC                      ;184b  cd e1 07      3644   3657 
    JP  SKIPP                           ;184e  c3 d6 18      3645   3658 
                                        ;                    3646   3659 ;
RGPRMT: PUSH    AF                      ;1851  f5            3647   3660 
    JP  RGPRM'                          ;1852  c3 ca 18      3648   3661 
                                        ;                    3649   3662 ;
PRINT:  LD  A,1                         ;1855  3e 01         3650   3663 
    LD  (DISFLG),A                      ;1857  32 eb 11      3651   3664 
    LD  C,L                             ;185a  4d            3652   3665 
    LD  B,H                             ;185b  44            3653   3666 
    CALL    BCFTCH                      ;185c  cd c4 25      3654   3667 
    CP  023h                            ;185f  fe 23         3655   3668 
    JR  NZ,PRINT'                       ;1861  20 2e         3656   3669 
    CALL    IHLEXP                      ;1863  cd cc 22      3657   3670 
    DEC BC                              ;1866  0b            3658   3671 
    OR  A                               ;1867  b7            3659   3672 
    JR  Z,PRDVSW                        ;1868  28 0a         3660   3673 
    CP  03Ah                            ;186a  fe 3a         3661   3674 
    JR  Z,PRDVSW                        ;186c  28 06         3662   3675 
    CP  02Ch                            ;186e  fe 2c         3663   3676 
    JP  NZ,SERROR                       ;1870  c2 3a 17      3664   3677 
    INC BC                              ;1873  03            3665   3678 
PRDVSW: LD  A,H                         ;1874  7c            3666   3679 
    OR  L                               ;1875  b5            3667   3680 
    JR  Z,PRSCRV                        ;1876  28 1b         3668   3681 
    INC HL                              ;1878  23            3669   3682 
    LD  A,H                             ;1879  7c            3670   3683 
    OR  L                               ;187a  b5            3671   3684 
    JR  NZ,PRTERM                       ;187b  20 0d         3672   3685 
    LD  A,(FILEFG)                      ;187d  3a 83 33      3673   3686 
    CP  2                               ;1880  fe 02         3674   3687 
    JR  NZ,FILEER                       ;1882  20 ba         3675   3688 
    INC A                               ;1884  3c            3676   3689 
    LD  (DISFLG),A                      ;1885  32 eb 11      3677   3690 
    JR  PRSCRV                          ;1888  18 09         3678   3691 
PRTERM: LD  A,2                         ;188a  3e 02         3679   3692 ; PRINTER
    LD  (DISFLG),A                      ;188c  32 eb 11      3680   3693 
    JR  PRSCRV                          ;188f  18 02         3681   3694 
                                        ;                    3682   3695 ;
                                        ;                    3683   3696 ;
PRINT': LD  C,L                         ;1891  4d            3684   3697 
    LD  B,H                             ;1892  44            3685   3698 
PRSCRV: CALL    SETSSP                  ;1893  cd f9 21      3686   3699 
    LD  (IY+0),0                        ;1896  fd 36 00 00   3687   3700 
    CALL    BCFTCH                      ;189a  cd c4 25      3688   3701 
    CP  0E2h                            ;189d  fe e2         3689   3702 
    JP  Z,USING                         ;189f  ca 10 34      3690   3703 
    OR  A                               ;18a2  b7            3691   3704 
    JR  Z,CRLFR'                        ;18a3  28 55         3692   3705 
    CP  03Ah                            ;18a5  fe 3a         3693   3706 
    JR  Z,CRLFR'                        ;18a7  28 51         3694   3707 
    CP  02Ch                            ;18a9  fe 2c         3695   3708 
    JP  Z,RGPRMT                        ;18ab  ca 51 18      3696   3709 
    CP  03Bh                            ;18ae  fe 3b         3697   3710 
    JP  Z,RGPRMT                        ;18b0  ca 51 18      3698   3711 
    CP  0E7h                            ;18b3  fe e7         3699   3712 
    JR  Z,TABOPR                        ;18b5  28 5b         3700   3713 
    CP  0E8h                            ;18b7  fe e8         3701   3714 
    JP  Z,SPCOPR                        ;18b9  ca 40 19      3702   3715 
    DEC BC                              ;18bc  0b            3703   3716 
    CALL    EXPRSN                      ;18bd  cd f2 22      3704   3717 
    PUSH    AF                          ;18c0  f5            3705   3718 
    LD  A,(IY+0)                        ;18c1  fd 7e 00      3706   3719 
    CP  003h                            ;18c4  fe 03         3707   3720 
    JP  Z,PRTSTR                        ;18c6  ca 43 18      3708   3721 
    OR  A                               ;18c9  b7            3709   3722 
RGPRM': PUSH    BC                      ;18ca  c5            3710   3723 
    JR  Z,SKIPP                         ;18cb  28 09         3711   3724 
    CALL    CVNMFL                      ;18cd  cd 58 5d      3712   3725 
    CALL    PRTSDC                      ;18d0  cd e1 07      3713   3726 
    CALL    SPPRT                       ;18d3  cd 62 08      3714   3727 
SKIPP:  POP HL                          ;18d6  e1            3715   3728 
    POP AF                              ;18d7  f1            3716   3729 
PRTYUI: OR  A                           ;18d8  b7            3717   3730 
    JR  Z,CRLFRT                        ;18d9  28 21         3718   3731 
    CP  03Ah                            ;18db  fe 3a         3719   3732 
    JR  Z,CRLFRT                        ;18dd  28 1d         3720   3733 
    CP  03Bh                            ;18df  fe 3b         3721   3734 
    JR  Z,SEMIS                         ;18e1  28 07         3722   3735 
    CP  02Ch                            ;18e3  fe 2c         3723   3736 
    JR  NZ,DECBCL                       ;18e5  20 1b         3724   3737 
    CALL    TABPRT                      ;18e7  cd 02 08      3725   3738 
SEMIS:  CALL    HLFTCH                  ;18ea  cd 87 29      3726   3739 
    OR  A                               ;18ed  b7            3727   3740 
    JR  Z,DISCLR                        ;18ee  28 04         3728   3741 
    CP  03Ah                            ;18f0  fe 3a         3729   3742 
    JR  NZ,PRINT'                       ;18f2  20 9d         3730   3743 
DISCLR: LD  A,1                         ;18f4  3e 01         3731   3744 
    LD  (DISFLG),A                      ;18f6  32 eb 11      3732   3745 
    RET                                 ;18f9  c9            3733   3746 
                                        ;                    3734   3747 ;
CRLFR': LD  H,B                         ;18fa  60            3735   3748 
    LD  L,C                             ;18fb  69            3736   3749 
CRLFRT: CALL    CR1                     ;18fc  cd 43 08      3737   3750 
    DEC HL                              ;18ff  2b            3738   3751 
    JR  DISCLR                          ;1900  18 f2         3739   3752 
DECBCL: DEC HL                          ;1902  2b            3740   3753 
    CP  022h                            ;1903  fe 22         3741   3754 
    JR  Z,PRINT'                        ;1905  28 8a         3742   3755 
    CP  041h                            ;1907  fe 41         3743   3756 
    JR  NC,PRINT'                       ;1909  30 86         3744   3757 
    CP  021h                            ;190b  fe 21         3745   3758 
    JR  C,PRINT'                        ;190d  38 82         3746   3759 
    JP  SERROR                          ;190f  c3 3a 17      3747   3760 
                                        ;                    3748   3761 ;
TABOPR: CALL    CH28H                   ;1912  cd 58 2d      3749   3762 
    CALL    IHLEXP                      ;1915  cd cc 22      3750   3763 
    CALL    CH29H                       ;1918  cd 66 2d      3751   3764 
    CALL    HCHECK                      ;191b  cd d8 22      3752   3765 
    LD  A,(DISFLG)                      ;191e  3a eb 11      3753   3766 
    CP  2                               ;1921  fe 02         3754   3767 
    JR  C,CRTTAS                        ;1923  38 05         3755   3768 
    LD  A,(PRINTN)                      ;1925  3a ec 11      3756   3769 
    JR  TSUBLS                          ;1928  18 03         3757   3770 
CRTTAS: LD  A,(CURX)                    ;192a  3a ed 11      3758   3771 
TSUBLS: SUB L                           ;192d  95            3759   3772 
    JR  NC,NOTABO                       ;192e  30 09         3760   3773 
    NEG                                 ;1930  ed 44         3761   3774 
TABPPP: LD  D,A                         ;1932  57            3762   3775 
TABPPT: CALL    SPPRT                   ;1933  cd 62 08      3763   3776 
    DEC D                               ;1936  15            3764   3777 
    JR  NZ,TABPPT                       ;1937  20 fa         3765   3778 
NOTABO: CALL    BCFTCH                  ;1939  cd c4 25      3766   3779 
    LD  L,C                             ;193c  69            3767   3780 
    LD  H,B                             ;193d  60            3768   3781 
    JR  PRTYUI                          ;193e  18 98         3769   3782 
                                        ;                    3770   3783 ;
SPCOPR: CALL    CH28H                   ;1940  cd 58 2d      3771   3784 
    CALL    IHLEXP                      ;1943  cd cc 22      3772   3785 
    CALL    CH29H                       ;1946  cd 66 2d      3773   3786 
    CALL    HCHECK                      ;1949  cd d8 22      3774   3787 
    OR  A                               ;194c  b7            3775   3788 
    JR  Z,NOTABO                        ;194d  28 ea         3776   3789 
    JR  TABPPP                          ;194f  18 e1         3777   3790 
                                        ;                    3778   3791 ;
CLR:    PUSH    HL                      ;1951  e5            3779   3792 
    PUSH    DE                          ;1952  d5            3780   3793 
    LD  HL,(VSTART)                     ;1953  2a 3b 7a      3781   3794 
    XOR A                               ;1956  af            3782   3795 
    LD  (HL),A                          ;1957  77            3783   3796 
    LD  (STKLMT),HL                     ;1958  22 3f 7a      3784   3797 
    LD  HL,(STRBTM)                     ;195b  2a 45 7a      3785   3798 
    LD  (STRPTR),HL                     ;195e  22 3d 7a      3786   3799 
    LD  DE,2000                         ;1961  11 d0 07      3787   3800 
    SBC HL,DE                           ;1964  ed 52         3788   3801 
    LD  (STRTOP),HL                     ;1966  22 41 7a      3789   3802 
    CALL    DFLTCL                      ;1969  cd 24 18      3790   3803 
    POP DE                              ;196c  d1            3791   3804 
    POP HL                              ;196d  e1            3792   3805 
    RET                                 ;196e  c9            3793   3806 
                                        ;                    3794   3807 ;
FOR:    POP BC                          ;196f  c1            3795   3808 
    LD  (FLJPVC),BC                     ;1970  ed 43 f9 19   3796   3809 
    LD  C,L                             ;1974  4d            3797   3810 
    LD  B,H                             ;1975  44            3798   3811 
    LD  DE,(INTFAC)                     ;1976  ed 5b 4b 7a   3799   3812 
    CALL    GETVAB                      ;197a  cd d7 1e      3800   3813 
    LD  (FVTYPE),A                      ;197d  32 f1 19      3801   3814 
    EX  DE,HL                           ;1980  eb            3802   3815 
    LD  HL,0                            ;1981  21 00 00      3803   3816 
    ADD HL,SP                           ;1984  39            3804   3817 
FTSKIP: LD  A,(HL)                      ;1985  7e            3805   3818 
    OR  A                               ;1986  b7            3806   3819 
    JR  NZ,FORPUS                       ;1987  20 24         3807   3820 
    PUSH    DE                          ;1989  d5            3808   3821 
    LD  DE,6                            ;198a  11 06 00      3809   3822 
    ADD HL,DE                           ;198d  19            3810   3823 
    POP DE                              ;198e  d1            3811   3824 
    PUSH    HL                          ;198f  e5            3812   3825 
    CALL    INDRCT                      ;1990  cd a3 2a      3813   3826 
    OR  A                               ;1993  b7            3814   3827 
    SBC HL,DE                           ;1994  ed 52         3815   3828 
    POP HL                              ;1996  e1            3816   3829 
    JR  NZ,NXTSFT                       ;1997  20 0c         3817   3830 
    PUSH    DE                          ;1999  d5            3818   3831 
    LD  DE,18                           ;199a  11 12 00      3819   3832 
    ADD HL,DE                           ;199d  19            3820   3833 
    POP DE                              ;199e  d1            3821   3834 
    LD  (SPBUF),HL                      ;199f  22 25 22      3822   3835 
    LD  SP,HL                           ;19a2  f9            3823   3836 
    JR  FORPUS                          ;19a3  18 08         3824   3837 
                                        ;                    3825   3838 ;
NXTSFT: PUSH    DE                      ;19a5  d5            3826   3839 
    LD  DE,16                           ;19a6  11 10 00      3827   3840 
    ADD HL,DE                           ;19a9  19            3828   3841 
    POP DE                              ;19aa  d1            3829   3842 
    JR  FTSKIP                          ;19ab  18 d8         3830   3843 
                                        ;                    3831   3844 ;
FORPUS: EX  DE,HL                       ;19ad  eb            3832   3845 
    PUSH    HL                          ;19ae  e5            3833   3846 
    LD  A,(FVTYPE)                      ;19af  3a f1 19      3834   3847 
    CALL    DAINV'                      ;19b2  cd 1b 15      3835   3848 
    LD  A,(HL)                          ;19b5  7e            3836   3849 
    CP  0DFh                            ;19b6  fe df         3837   3850 
    JP  NZ,SERROR                       ;19b8  c2 3a 17      3838   3851 
    INC HL                              ;19bb  23            3839   3852 
    LD  C,L                             ;19bc  4d            3840   3853 
    LD  B,H                             ;19bd  44            3841   3854 
    CALL    FLEXPR                      ;19be  cd 99 22      3842   3855 
    POP DE                              ;19c1  d1            3843   3856 
    PUSH    HL                          ;19c2  e5            3844   3857 
    EXX                                 ;19c3  d9            3845   3858 
    POP DE                              ;19c4  d1            3846   3859 
    LD  HL,0FFF8h                       ;19c5  21 f8 ff      3847   3860 
    ADD HL,SP                           ;19c8  39            3848   3861 
    LD  SP,HL                           ;19c9  f9            3849   3862 
    EX  DE,HL                           ;19ca  eb            3850   3863 
    CALL    LDIR8                       ;19cb  cd a6 73      3851   3864 
    EXX                                 ;19ce  d9            3852   3865 
    CP  0E0h                            ;19cf  fe e0         3853   3866 
    LD  HL,FLONE                        ;19d1  21 98 62      3854   3867 
    JR  NZ,STEPON                       ;19d4  20 05         3855   3868 
    PUSH    DE                          ;19d6  d5            3856   3869 
    CALL    FLEXPR                      ;19d7  cd 99 22      3857   3870 
    POP DE                              ;19da  d1            3858   3871 
STEPON: PUSH    HL                      ;19db  e5            3859   3872 
    EXX                                 ;19dc  d9            3860   3873 
    POP DE                              ;19dd  d1            3861   3874 
    LD  HL,0FFF8h                       ;19de  21 f8 ff      3862   3875 
    ADD HL,SP                           ;19e1  39            3863   3876 
    LD  SP,HL                           ;19e2  f9            3864   3877 
    EX  DE,HL                           ;19e3  eb            3865   3878 
    CALL    LDIR8                       ;19e4  cd a6 73      3866   3879 
    EXX                                 ;19e7  d9            3867   3880 
    PUSH    DE                          ;19e8  d5            3868   3881 
    DEC BC                              ;19e9  0b            3869   3882 
    PUSH    BC                          ;19ea  c5            3870   3883 
    LD  HL,(NXTLPT)                     ;19eb  2a 12 16      3871   3884 
    PUSH    HL                          ;19ee  e5            3872   3885 
    DEFB    021H                        ;19ef  21            3873   3886 ;LD HL,?
    DEFB    000H                        ;19f0  00            3874   3887 ;low
FVTYPE: DEFS    1                       ;19f1                3875   3888 ;high
                                        ;                    3876   3889 
    PUSH    HL                          ;19f2  e5            3877   3890 
    LD  L,C                             ;19f3  69            3878   3891 
    LD  H,B                             ;19f4  60            3879   3892 
    CALL    MEMCHK                      ;19f5  cd b0 1e      3880   3893 
    DEFB    0C3H                        ;19f8  c3            3881   3894 ; JP ?
FLJPVC: DEFS    2                       ;19f9                3882   3895 
                                        ;                    3883   3896 ;
NXFVAR: CALL    BCFTCH                  ;19fb  cd c4 25      3884   3897 
    OR  A                               ;19fe  b7            3885   3898 
    JR  Z,NXWFOR                        ;19ff  28 04         3886   3899 
    CP  03Ah                            ;1a01  fe 3a         3887   3900 
    JR  NZ,AGINCV                       ;1a03  20 16         3888   3901 
NXWFOR: LD  A,1                         ;1a05  3e 01         3889   3902 
    JP  ERROR                           ;1a07  c3 96 21      3890   3903 
                                        ;                    3891   3904 ;
NEXT:   CALL    HLFTCH                  ;1a0a  cd 87 29      3892   3905 
    OR  A                               ;1a0d  b7            3893   3906 
    JP  Z,DFLTNX                        ;1a0e  ca 62 1a      3894   3907 
    CP  03Ah                            ;1a11  fe 3a         3895   3908 
    JP  Z,DFLTNX                        ;1a13  ca 62 1a      3896   3909 
NEXTAG: LD  C,L                         ;1a16  4d            3897   3910 
    LD  B,H                             ;1a17  44            3898   3911 
    CALL    BCFTCH                      ;1a18  cd c4 25      3899   3912 
AGINCV: LD  DE,(INTFAC)                 ;1a1b  ed 5b 4b 7a   3900   3913 
    CALL    GETVAR                      ;1a1f  cd da 1e      3901   3914 
    EX  DE,HL                           ;1a22  eb            3902   3915 
    LD  HL,2                            ;1a23  21 02 00      3903   3916 
    ADD HL,SP                           ;1a26  39            3904   3917 
SKSTKS: LD  A,(HL)                      ;1a27  7e            3905   3918 
    OR  A                               ;1a28  b7            3906   3919 
    JR  NZ,NXFVAR                       ;1a29  20 d0         3907   3920 
    PUSH    DE                          ;1a2b  d5            3908   3921 
    LD  DE,6                            ;1a2c  11 06 00      3909   3922 
    ADD HL,DE                           ;1a2f  19            3910   3923 
    POP DE                              ;1a30  d1            3911   3924 
    PUSH    HL                          ;1a31  e5            3912   3925 
    CALL    INDRCT                      ;1a32  cd a3 2a      3913   3926 
    OR  A                               ;1a35  b7            3914   3927 
    SBC HL,DE                           ;1a36  ed 52         3915   3928 
    POP HL                              ;1a38  e1            3916   3929 
    JR  NZ,NXFPOR                       ;1a39  20 1f         3917   3930 
    LD  DE,6                            ;1a3b  11 06 00      3918   3931 
    OR  A                               ;1a3e  b7            3919   3932 
    SBC HL,DE                           ;1a3f  ed 52         3920   3933 
    POP DE                              ;1a41  d1            3921   3934 
    LD  SP,HL                           ;1a42  f9            3922   3935 
    LD  (NXTNXT),DE                     ;1a43  ed 53 4d 1a   3923   3936 
    LD  L,C                             ;1a47  69            3924   3937 
    LD  H,B                             ;1a48  60            3925   3938 
    CALL    DFLTNX                      ;1a49  cd 62 1a      3926   3939 
    DEFB    011H                        ;1a4c  11            3927   3940 ; LD DE,??
NXTNXT: DEFS    2                       ;1a4d                3928   3941 
    PUSH    DE                          ;1a4f  d5            3929   3942 
    RET NC                              ;1a50  d0            3930   3943 
    CALL    HLFTCH                      ;1a51  cd 87 29      3931   3944 
    CP  02Ch                            ;1a54  fe 2c         3932   3945 
    RET NZ                              ;1a56  c0            3933   3946 
    INC HL                              ;1a57  23            3934   3947 
    JR  NEXTAG                          ;1a58  18 bc         3935   3948 
                                        ;                    3936   3949 ;
NXFPOR: PUSH    DE                      ;1a5a  d5            3937   3950 
    LD  DE,012H                         ;1a5b  11 12 00      3938   3951 
    ADD HL,DE                           ;1a5e  19            3939   3952 
    POP DE                              ;1a5f  d1            3940   3953 
    JR  SKSTKS                          ;1a60  18 c5         3941   3954 
                                        ;                    3942   3955 ;
DFLTNX: PUSH    HL                      ;1a62  e5            3943   3956 
    LD  HL,00004h                       ;1a63  21 04 00      3944   3957 
    ADD HL,SP                           ;1a66  39            3945   3958 
    XOR A                               ;1a67  af            3946   3959 
    CP  (HL)                            ;1a68  be            3947   3960 
    JR  NZ,NXWFOR                       ;1a69  20 9a         3948   3961 
    INC HL                              ;1a6b  23            3949   3962 
    LD  A,0F0h                          ;1a6c  3e f0         3950   3963 
    AND (HL)                            ;1a6e  a6            3951   3964 
    JR  NZ,NXWFOR                       ;1a6f  20 94         3952   3965 
    LD  A,(HL)                          ;1a71  7e            3953   3966 
    INC HL                              ;1a72  23            3954   3967 
    LD  E,(HL)                          ;1a73  5e            3955   3968 
    INC HL                              ;1a74  23            3956   3969 
    LD  D,(HL)                          ;1a75  56            3957   3970 
    PUSH    DE                          ;1a76  d5            3958   3971 
    INC HL                              ;1a77  23            3959   3972 
    LD  E,(HL)                          ;1a78  5e            3960   3973 
    INC HL                              ;1a79  23            3961   3974 
    LD  D,(HL)                          ;1a7a  56            3962   3975 
    PUSH    DE                          ;1a7b  d5            3963   3976 
    INC HL                              ;1a7c  23            3964   3977 
    LD  E,(HL)                          ;1a7d  5e            3965   3978 
    INC HL                              ;1a7e  23            3966   3979 
    LD  D,(HL)                          ;1a7f  56            3967   3980 
    INC HL                              ;1a80  23            3968   3981 
    EX  DE,HL                           ;1a81  eb            3969   3982 
    CP  002h                            ;1a82  fe 02         3970   3983 
    JP  Z,INTFOR                        ;1a84  ca c1 1a      3971   3984 
    LD  (IY+0),A                        ;1a87  fd 77 00      3972   3985 
    CALL    ADD                         ;1a8a  cd a6 6c      3973   3986 
    INC DE                              ;1a8d  13            3974   3987 
    LD  A,(DE)                          ;1a8e  1a            3975   3988 
    DEC DE                              ;1a8f  1b            3976   3989 
    EX  AF,AF'                          ;1a90  08            3977   3990 
    PUSH    HL                          ;1a91  e5            3978   3991 
    LD  HL,00008h                       ;1a92  21 08 00      3979   3992 
    ADD HL,DE                           ;1a95  19            3980   3993 
    EX  DE,HL                           ;1a96  eb            3981   3994 
    POP HL                              ;1a97  e1            3982   3995 
    EX  AF,AF'                          ;1a98  08            3983   3996 
    RLCA                                ;1a99  07            3984   3997 
    JR  NC,FPCOMP                       ;1a9a  30 07         3985   3998 
    CALL    CMP                         ;1a9c  cd d6 61      3986   3999 
    JR  C,NEXTRT                        ;1a9f  38 12         3987   4000 
    JR  OMODED                          ;1aa1  18 07         3988   4001 
FPCOMP: CALL    CMP                     ;1aa3  cd d6 61      3989   4002 
    JR  Z,OMODED                        ;1aa6  28 02         3990   4003 
    JR  NC,NEXTRT                       ;1aa8  30 09         3991   4004 
OMODED: POP DE                          ;1aaa  d1            3992   4005 
    POP HL                              ;1aab  e1            3993   4006 
    LD  (NXTLPT),HL                     ;1aac  22 12 16      3994   4007 
    EX  DE,HL                           ;1aaf  eb            3995   4008 
    POP BC                              ;1ab0  c1            3996   4009 
    OR  A                               ;1ab1  b7            3997   4010 
    RET                                 ;1ab2  c9            3998   4011 
                                        ;                    3999   4012 ;
NEXTRT: LD  HL,00008h                   ;1ab3  21 08 00      4000   4013 
    ADD HL,DE                           ;1ab6  19            4001   4014 
    POP BC                              ;1ab7  c1            4002   4015 
    POP BC                              ;1ab8  c1            4003   4016 
    POP DE                              ;1ab9  d1            4004   4017 
    POP IX                              ;1aba  dd e1         4005   4018 
    LD  SP,HL                           ;1abc  f9            4006   4019 
    EX  DE,HL                           ;1abd  eb            4007   4020 
    SCF                                 ;1abe  37            4008   4021 
    JP  (IX)                            ;1abf  dd e9         4009   4022 
                                        ;                    4010   4023 ;
INTFOR: PUSH    DE                      ;1ac1  d5            4011   4024 ; STEP
    PUSH    HL                          ;1ac2  e5            4012   4025 ; VARADRS
    EX  DE,HL                           ;1ac3  eb            4013   4026 
    CALL    HLFLTO                      ;1ac4  cd 97 2d      4014   4027 ; STEP
    LD  A,H                             ;1ac7  7c            4015   4028 
    EX  AF,AF'                          ;1ac8  08            4016   4029 
    EX  DE,HL                           ;1ac9  eb            4017   4030 
    POP HL                              ;1aca  e1            4018   4031 
    PUSH    HL                          ;1acb  e5            4019   4032 
    CALL    INDRCT                      ;1acc  cd a3 2a      4020   4033 
    ADD HL,DE                           ;1acf  19            4021   4034 
    EX  DE,HL                           ;1ad0  eb            4022   4035 
    POP HL                              ;1ad1  e1            4023   4036 
    LD  (HL),E                          ;1ad2  73            4024   4037 
    INC HL                              ;1ad3  23            4025   4038 
    LD  (HL),D                          ;1ad4  72            4026   4039 
    POP HL                              ;1ad5  e1            4027   4040 
    LD  BC,00008h                       ;1ad6  01 08 00      4028   4041 
    ADD HL,BC                           ;1ad9  09            4029   4042 
    PUSH    HL                          ;1ada  e5            4030   4043 
    CALL    HLFLTO                      ;1adb  cd 97 2d      4031   4044 
    EX  AF,AF'                          ;1ade  08            4032   4045 
    RLCA                                ;1adf  07            4033   4046 
    JR  NC,MNIFOR                       ;1ae0  30 0a         4034   4047 
    CALL    INTCMP                      ;1ae2  cd f4 1a      4035   4048 
    POP DE                              ;1ae5  d1            4036   4049 
    JR  Z,OMODED                        ;1ae6  28 c2         4037   4050 
    JR  C,OMODED                        ;1ae8  38 c0         4038   4051 
    JR  NEXTRT                          ;1aea  18 c7         4039   4052 
                                        ;                    4040   4053 ;
MNIFOR: CALL    INTCMP                  ;1aec  cd f4 1a      4041   4054 
    POP DE                              ;1aef  d1            4042   4055 
    JR  NC,OMODED                       ;1af0  30 b8         4043   4056 
    JR  NEXTRT                          ;1af2  18 bf         4044   4057 
                                        ;                    4045   4058 ;
INTCMP: LD  A,H                         ;1af4  7c            4046   4059 
    RLCA                                ;1af5  07            4047   4060 
    JR  C,ICHMNS                        ;1af6  38 0c         4048   4061 
    LD  A,D                             ;1af8  7a            4049   4062 
    RLCA                                ;1af9  07            4050   4063 
    CCF                                 ;1afa  3f            4051   4064 
    JR  NC,NCICMT                       ;1afb  30 13         4052   4065 
INTCPM: OR  A                           ;1afd  b7            4053   4066 
    SBC HL,DE                           ;1afe  ed 52         4054   4067 
    RET C                               ;1b00  d8            4055   4068 
    LD  A,H                             ;1b01  7c            4056   4069 
    OR  L                               ;1b02  b5            4057   4070 
    RET                                 ;1b03  c9            4058   4071 
                                        ;                    4059   4072 ;
ICHMNS: LD  A,D                         ;1b04  7a            4060   4073 
    RLCA                                ;1b05  07            4061   4074 
    CCF                                 ;1b06  3f            4062   4075 
    JR  C,CPRTMY                        ;1b07  38 02         4063   4076 
    JR  INTCPM                          ;1b09  18 f2         4064   4077 
                                        ;                    4065   4078 ;
CPRTMY: LD  A,1                         ;1b0b  3e 01         4066   4079 
    OR  A                               ;1b0d  b7            4067   4080 
    SCF                                 ;1b0e  37            4068   4081 
    RET                                 ;1b0f  c9            4069   4082 
                                        ;                    4070   4083 ;
NCICMT: LD  A,1                         ;1b10  3e 01         4071   4084 
    OR  A                               ;1b12  b7            4072   4085 
    RET                                 ;1b13  c9            4073   4086 
                                        ;                    4074   4087 ;
ERTEST: LD  C,L                         ;1b14  4d            4075   4088 
    LD  B,H                             ;1b15  44            4076   4089 
    CALL    IBYTE                       ;1b16  cd df 22      4077   4090 
ERRTST: JP  ERROR                       ;1b19  c3 96 21      4078   4091 
                                        ;                    4079   4092 ;
LET:    CALL    HLFTCH                  ;1b1c  cd 87 29      4080   4093 
    INC HL                              ;1b1f  23            4081   4094 
    JP  LETDA'                          ;1b20  c3 ff 14      4082   4095 
                                        ;                    4083   4096 ;
POKE:   LD  C,L                         ;1b23  4d            4084   4097 
    LD  B,H                             ;1b24  44            4085   4098 
    CALL    IHLEXP                      ;1b25  cd cc 22      4086   4099 
POKELP: CP  02Ch                        ;1b28  fe 2c         4087   4100 
    JR  NZ,RETIRQ                       ;1b2a  20 0d         4088   4101 
    PUSH    HL                          ;1b2c  e5            4089   4102 
    CALL    IBYTE                       ;1b2d  cd df 22      4090   4103 
    POP HL                              ;1b30  e1            4091   4104 
    LD  (HL),A                          ;1b31  77            4092   4105 
    INC HL                              ;1b32  23            4093   4106 
    DEC BC                              ;1b33  0b            4094   4107 
    CALL    BCFTCH                      ;1b34  cd c4 25      4095   4108 
    JR  POKELP                          ;1b37  18 ef         4096   4109 
                                        ;                    4097   4110 ;
RETIRQ: LD  L,C                         ;1b39  69            4098   4111 
    LD  H,B                             ;1b3a  60            4099   4112 
    DEC HL                              ;1b3b  2b            4100   4113 
    LD  A,1                             ;1b3c  3e 01         4101   4114 
    LD  (DISFLG),A                      ;1b3e  32 eb 11      4102   4115 
    RET                                 ;1b41  c9            4103   4116 
                                        ;                    4104   4117 ;
CLS:    LD  A,(GMODEF)                  ;1b42  3a 06 1c      4105   4118 
    CP  2                               ;1b45  fe 02         4106   4119 
    LD  A,12                            ;1b47  3e 0c         4107   4120 
    JP  C,ACCPRT                        ;1b49  da 64 08      4108   4121 
CLSSB:                                  ;                    4109   4122 
    LD  BC,01800h                       ;1b4c  01 00 18      4110   4123 
    LD  D,000h                          ;1b4f  16 00         4111   4124 
CLS1LP: DEC BC                          ;1b51  0b            4112   4125 
    OUT (C),D                           ;1b52  ed 51         4113   4126 
    LD  A,B                             ;1b54  78            4114   4127 
    OR  C                               ;1b55  b1            4115   4128 
    JR  NZ,CLS1LP                       ;1b56  20 f9         4116   4129 
    RET                                 ;1b58  c9            4117   4130 
                                        ;                    4118   4131 ;
                                        ;                    4119   4132 ;
SCREEN: LD  C,L                         ;1b59  4d            4120   4133 
    LD  B,H                             ;1b5a  44            4121   4134 
    CALL    IHLEXP                      ;1b5b  cd cc 22      4122   4135 
    CALL    CH2CH                       ;1b5e  cd 61 2d      4123   4136 
    CALL    HCHECK                      ;1b61  cd d8 22      4124   4137 
    CP  5                               ;1b64  fe 05         4125   4138 
    JP  NC,IFCALL                       ;1b66  d2 36 17      4126   4139 
    PUSH    AF                          ;1b69  f5            4127   4140 
    CALL    IHLEXP                      ;1b6a  cd cc 22      4128   4141 
    CALL    CH2CH                       ;1b6d  cd 61 2d      4129   4142 
    CALL    HCHECK                      ;1b70  cd d8 22      4130   4143 
    CP  5                               ;1b73  fe 05         4131   4144 
    JP  NC,IFCALL                       ;1b75  d2 36 17      4132   4145 
    PUSH    AF                          ;1b78  f5            4133   4146 
    CALL    IBYTE                       ;1b79  cd df 22      4134   4147 
    CP  6                               ;1b7c  fe 06         4135   4148 
    JP  NC,IFCALL                       ;1b7e  d2 36 17      4136   4149 
    POP DE                              ;1b81  d1            4137   4150 
    LD  E,D                             ;1b82  5a            4138   4151 
    LD  L,A                             ;1b83  6f            4139   4152 
    POP AF                              ;1b84  f1            4140   4153 
    LD  D,A                             ;1b85  57            4141   4154 
    PUSH    BC                          ;1b86  c5            4142   4155 
    PUSH    DE                          ;1b87  d5            4143   4156 
PATCH5:                                 ;                    4144   4157 
    CALL    GRAPH                       ;1b88  cd 95 1b      4145   4158 
    POP BC                              ;1b8b  c1            4146   4159 
    CALL    SCRNBC                      ;1b8c  cd d6 05      4147   4160 
    POP BC                              ;1b8f  c1            4148   4161 
    JP  RETIRQ                          ;1b90  c3 39 1b      4149   4162 
                                        ;                    4150   4163 ;
GRAPHI: LD  L,0                         ;1b93  2e 00         4151   4164 
GRAPH:  LD  A,(GMODEF)                  ;1b95  3a 06 1c      4152   4165 
    CP  L                               ;1b98  bd            4153   4166 
    JR  Z,GRAPOK                        ;1b99  28 1d         4154   4167 
    CP  2                               ;1b9b  fe 02         4155   4168 
    JR  NC,GM2345                       ;1b9d  30 0c         4156   4169 
    LD  A,L                             ;1b9f  7d            4157   4170 
    CP  2                               ;1ba0  fe 02         4158   4171 
    JR  C,GRAPOK                        ;1ba2  38 14         4159   4172 
    PUSH    AF                          ;1ba4  f5            4160   4173 
    CALL    CLSSB                       ;1ba5  cd 4c 1b      4161   4174 
    POP AF                              ;1ba8  f1            4162   4175 
    JR  GRAPOK                          ;1ba9  18 0d         4163   4176 
GM2345: LD  A,L                         ;1bab  7d            4164   4177 
    CP  2                               ;1bac  fe 02         4165   4178 
    JR  NC,GRAPOK                       ;1bae  30 08         4166   4179 
    PUSH    AF                          ;1bb0  f5            4167   4180 
    CALL    CLSSB                       ;1bb1  cd 4c 1b      4168   4181 
    CALL    GSAVES                      ;1bb4  cd ea 1b      4169   4182 
    POP AF                              ;1bb7  f1            4170   4183 
GRAPOK: LD  (GMODEF),A                  ;1bb8  32 06 1c      4171   4184 
    LD  L,A                             ;1bbb  6f            4172   4185 
    LD  E,A                             ;1bbc  5f            4173   4186 
    LD  H,0                             ;1bbd  26 00         4174   4187 
    LD  D,H                             ;1bbf  54            4175   4188 
    ADD HL,HL                           ;1bc0  29            4176   4189 
    ADD HL,HL                           ;1bc1  29            4177   4190 
    ADD HL,DE                           ;1bc2  19            4178   4191 
    LD  DE,SCRTAB                       ;1bc3  11 07 1c      4179   4192 
    ADD HL,DE                           ;1bc6  19            4180   4193 
    LD  A,(HL)                          ;1bc7  7e            4181   4194 
    LD  (SCRNYE+1),A                    ;1bc8  32 25 48      4182   4195 
    INC HL                              ;1bcb  23            4183   4196 
    LD  A,(HL)                          ;1bcc  7e            4184   4197 
    LD  (SCRNXE+1),A                    ;1bcd  32 2d 48      4185   4198 
    LD  A,0FFh                          ;1bd0  3e ff         4186   4199 
    LD  (SCRNYE+2),A                    ;1bd2  32 26 48      4187   4200 
    LD  (SCRNXE+2),A                    ;1bd5  32 2e 48      4188   4201 
    INC HL                              ;1bd8  23            4189   4202 
    LD  E,(HL)                          ;1bd9  5e            4190   4203 
    INC HL                              ;1bda  23            4191   4204 
    LD  D,(HL)                          ;1bdb  56            4192   4205 
    LD  (CALADR+1),DE                   ;1bdc  ed 53 34 48   4193   4206 
    INC HL                              ;1be0  23            4194   4207 
    LD  A,(IO2000)                      ;1be1  3a ea 11      4195   4208 
    AND 030h                            ;1be4  e6 30         4196   4209 
    OR  (HL)                            ;1be6  b6            4197   4210 
    JP  IO20SB                          ;1be7  c3 62 00      4198   4211 
                                        ;                    4199   4212 ;
                                        ;                    4200   4213 ;
GSAVES: PUSH    HL                      ;1bea  e5            4201   4214 
    LD  HL,$CGBUF                       ;1beb  21 4a 55      4202   4215 
    LD  BC,01000h                       ;1bee  01 00 10      4203   4216 
    LD  D,080h                          ;1bf1  16 80         4204   4217 
GSAVEL: LD  E,12                        ;1bf3  1e 0c         4205   4218 
GSAVEP: LD  A,(HL)                      ;1bf5  7e            4206   4219 
    OUT (C),A                           ;1bf6  ed 79         4207   4220 
    INC HL                              ;1bf8  23            4208   4221 
    INC BC                              ;1bf9  03            4209   4222 
    DEC E                               ;1bfa  1d            4210   4223 
    JR  NZ,GSAVEP                       ;1bfb  20 f8         4211   4224 
    INC BC                              ;1bfd  03            4212   4225 
    INC BC                              ;1bfe  03            4213   4226 
    INC BC                              ;1bff  03            4214   4227 
    INC BC                              ;1c00  03            4215   4228 
    DEC D                               ;1c01  15            4216   4229 
    JR  NZ,GSAVEL                       ;1c02  20 ef         4217   4230 
    POP HL                              ;1c04  e1            4218   4231 
    RET                                 ;1c05  c9            4219   4232 
                                        ;                    4220   4233 ;
                                        ;                    4221   4234 ;
GMODEF: DEFB    0                       ;1c06  00            4222   4235 
                                        ;                    4223   4236 ;
SCRTAB: DEFB    0E0H                    ;1c07  e0            4224   4237 ;-32	G0
    DEFB    0C0H                        ;1c08  c0            4225   4238 ;-64
    DEFW    CALAD0                      ;1c09  36 48         4226   4239 
    DEFB    000H                        ;1c0b  00            4227   4240 
                                        ;                    4228   4241 ;
    DEFB    0D0H                        ;1c0c  d0            4229   4242 ;G1	;-48
    DEFB    0C0H                        ;1c0d  c0            4230   4243 ;-64
    DEFW    CALAD1                      ;1c0e  75 48         4231   4244 
    DEFB    000H                        ;1c10  00            4232   4245 
                                        ;                    4233   4246 ;
    DEFB    040H                        ;1c11  40            4234   4247 ;G2	;-192
    DEFB    080H                        ;1c12  80            4235   4248 ;-128
    DEFW    CALAD2                      ;1c13  ca 48         4236   4249 
    DEFB    00AH                        ;1c15  0a            4237   4250 
                                        ;                    4238   4251 ;
    DEFB    040H                        ;1c16  40            4239   4252 ;G3
    DEFB    080H                        ;1c17  80            4240   4253 
    DEFW    CALAD3                      ;1c18  ca 48         4241   4254 
    DEFB    08AH                        ;1c1a  8a            4242   4255 
                                        ;                    4243   4256 ;
    DEFB    040H                        ;1c1b  40            4244   4257 ;G4	;-192
    DEFB    000H                        ;1c1c  00            4245   4258 ;-256
    DEFW    CALAD4                      ;1c1d  f3 48         4246   4259 
    DEFB    00EH                        ;1c1f  0e            4247   4260 
                                        ;                    4248   4261 ;
    DEFB    040H                        ;1c20  40            4249   4262 ;G5
    DEFB    000H                        ;1c21  00            4250   4263 
    DEFW    CALAD5                      ;1c22  f3 48         4251   4264 
    DEFB    08EH                        ;1c24  8e            4252   4265 
                                        ;                    4253   4266 ;
LOCATE: LD  C,L                         ;1c25  4d            4254   4267 
    LD  B,H                             ;1c26  44            4255   4268 
    CALL    IHLEXP                      ;1c27  cd cc 22      4256   4269 
    CALL    CH2CH                       ;1c2a  cd 61 2d      4257   4270 
    CALL    HCHECK                      ;1c2d  cd d8 22      4258   4271 
    CP  32                              ;1c30  fe 20         4259   4272 ; CURX LIMI
LCTIFC: JP  NC,IFCALL                   ;1c32  d2 36 17      4260   4273 
    LD  (CURX),A                        ;1c35  32 ed 11      4261   4274 
    CALL    IBYTE                       ;1c38  cd df 22      4262   4275 
    CP  16                              ;1c3b  fe 10         4263   4276 ; CURY LIMIT
    JR  NC,LCTIFC                       ;1c3d  30 f3         4264   4277 
    LD  (CURY),A                        ;1c3f  32 ee 11      4265   4278 
    JP  RETIRQ                          ;1c42  c3 39 1b      4266   4279 
                                        ;                    4267   4280 ;
READ:   LD  C,L                         ;1c45  4d            4268   4281 
    LD  B,H                             ;1c46  44            4269   4282 
    LD  HL,DATASK                       ;1c47  21 5f 1c      4270   4283 
    LD  (READVC),HL                     ;1c4a  22 5a 1e      4271   4284 
    LD  HL,LNG+1                        ;1c4d  21 28 45      4272   4285 
    LD  (DATAFV),HL                     ;1c50  22 fc 1d      4273   4286 
    LD  HL,00000h                       ;1c53  21 00 00      4274   4287 
    LD  (DATAV1),HL                     ;1c56  22 e2 1d      4275   4288 
    LD  HL,00428h                       ;1c59  21 28 04      4276   4289 
    LD  (DATAV2),HL                     ;1c5c  22 81 1e      4277   4290 
DATASK: DEFB    021H                    ;1c5f  21            4278   4291 ; LD HL,?
DATAPO: DEFS    2                       ;1c60                4279   4292 
DATAS': LD  A,(HL)                      ;1c62  7e            4280   4293 
    CP  03Ah                            ;1c63  fe 3a         4281   4294 
    JR  Z,MIDDAR                        ;1c65  28 11         4282   4295 
    OR  A                               ;1c67  b7            4283   4296 
    JR  NZ,DATAFD                       ;1c68  20 20         4284   4297 
    INC HL                              ;1c6a  23            4285   4298 
    LD  E,(HL)                          ;1c6b  5e            4286   4299 
    INC HL                              ;1c6c  23            4287   4300 
    LD  D,(HL)                          ;1c6d  56            4288   4301 
    LD  A,E                             ;1c6e  7b            4289   4302 
    OR  D                               ;1c6f  b2            4290   4303 
    LD  A,4                             ;1c70  3e 04         4291   4304 
    JP  Z,ERROR                         ;1c72  ca 96 21      4292   4305 
    INC HL                              ;1c75  23            4293   4306 
    INC HL                              ;1c76  23            4294   4307 
    INC HL                              ;1c77  23            4295   4308 
MIDDAR: CALL    HLFTCH                  ;1c78  cd 87 29      4296   4309 
    OR  A                               ;1c7b  b7            4297   4310 
    JR  Z,DATAS'                        ;1c7c  28 e4         4298   4311 
    CP  08Fh                            ;1c7e  fe 8f         4299   4312 ; DATA IM
    JR  Z,DATAFD                        ;1c80  28 08         4300   4313 
    CALL    DATA                        ;1c82  cd c8 1c      4301   4314 
    JR  C,DATAS'                        ;1c85  38 db         4302   4315 
    INC HL                              ;1c87  23            4303   4316 
    JR  MIDDAR                          ;1c88  18 ee         4304   4317 
                                        ;                    4305   4318 ;
DATAFD: INC HL                          ;1c8a  23            4306   4319 
    LD  (DATAPO),HL                     ;1c8b  22 60 1c      4307   4320 
    EX  DE,HL                           ;1c8e  eb            4308   4321 
    JP  INPLOP                          ;1c8f  c3 df 1d      4309   4322 
                                        ;                    4310   4323 ;
RESLBL: PUSH    HL                      ;1c92  e5            4311   4324 
    CALL    LBLSER                      ;1c93  cd be 42      4312   4325 
    LD  HL,(CURLPT)                     ;1c96  2a 53 43      4313   4326 
    DEC HL                              ;1c99  2b            4314   4327 
    LD  (DATAPO),HL                     ;1c9a  22 60 1c      4315   4328 
    POP HL                              ;1c9d  e1            4316   4329 
    CALL    IFDQSK                      ;1c9e  cd 64 44      4317   4330 
    OR  A                               ;1ca1  b7            4318   4331 
    RET Z                               ;1ca2  c8            4319   4332 
    INC HL                              ;1ca3  23            4320   4333 
    RET                                 ;1ca4  c9            4321   4334 
                                        ;                    4322   4335 ;
RESTOR: CALL    HLFTCH                  ;1ca5  cd 87 29      4323   4336 
    CP  022h                            ;1ca8  fe 22         4324   4337 
    JR  Z,RESLBL                        ;1caa  28 e6         4325   4338 
    CP  00Bh                            ;1cac  fe 0b         4326   4339 
    PUSH    HL                          ;1cae  e5            4327   4340 
    LD  HL,TEXTST                       ;1caf  21 4e 7c      4328   4341 
    JR  NZ,RESTTT                       ;1cb2  20 0e         4329   4342 
    POP HL                              ;1cb4  e1            4330   4343 
    INC HL                              ;1cb5  23            4331   4344 
    LD  E,(HL)                          ;1cb6  5e            4332   4345 
    INC HL                              ;1cb7  23            4333   4346 
    LD  D,(HL)                          ;1cb8  56            4334   4347 
    INC HL                              ;1cb9  23            4335   4348 
    PUSH    HL                          ;1cba  e5            4336   4349 
    EX  DE,HL                           ;1cbb  eb            4337   4350 
    CALL    LNOSER                      ;1cbc  cd 8e 3f      4338   4351 
    JP  C,UDFLNO                        ;1cbf  da dc 43      4339   4352 
RESTTT: DEC HL                          ;1cc2  2b            4340   4353 
    LD  (DATAPO),HL                     ;1cc3  22 60 1c      4341   4354 
    POP HL                              ;1cc6  e1            4342   4355 
    RET                                 ;1cc7  c9            4343   4356 
                                        ;                    4344   4357 ;
DATA:   DEC HL                          ;1cc8  2b            4345   4358 
DATALZ: CALL    IFSKSB                  ;1cc9  cd 40 44      4346   4359 
    OR  A                               ;1ccc  b7            4347   4360 
    SCF                                 ;1ccd  37            4348   4361 
    RET Z                               ;1cce  c8            4349   4362 
    CP  03Ah                            ;1ccf  fe 3a         4350   4363 
    RET Z                               ;1cd1  c8            4351   4364 
    JR  DATALZ                          ;1cd2  18 f5         4352   4365 
                                        ;                    4353   4366 ;
LINCIN: CALL    IHLEXP                  ;1cd4  cd cc 22      4354   4367 
    CP  02Ch                            ;1cd7  fe 2c         4355   4368 
    JP  NZ,SERROR                       ;1cd9  c2 3a 17      4356   4369 
    LD  HL,CINPUT                       ;1cdc  21 f8 39      4357   4370 
    LD  (LINVEC),HL                     ;1cdf  22 30 1d      4358   4371 
    CALL    BCFTCH                      ;1ce2  cd c4 25      4359   4372 
    JR  LINPNP                          ;1ce5  18 35         4360   4373 
                                        ;                    4361   4374 ;
LINE:   LD  (IBREKH),HL                 ;1ce7  22 4c 1d      4362   4375 
    LD  C,L                             ;1cea  4d            4363   4376 
    LD  B,H                             ;1ceb  44            4364   4377 
    CALL    BCFTCH                      ;1cec  cd c4 25      4365   4378 
    CP  08Dh                            ;1cef  fe 8d         4366   4379 
    JP  NZ,LINE@                        ;1cf1  c2 79 49      4367   4380 
    CALL    BCFTCH                      ;1cf4  cd c4 25      4368   4381 
    CP  023h                            ;1cf7  fe 23         4369   4382 
    JR  Z,LINCIN                        ;1cf9  28 d9         4370   4383 
    LD  HL,LININP                       ;1cfb  21 93 15      4371   4384 
    LD  (LINVEC),HL                     ;1cfe  22 30 1d      4372   4385 
    CP  022h                            ;1d01  fe 22         4373   4386 
    JR  NZ,LINPNP                       ;1d03  20 17         4374   4387 
LINPOL: LD  A,(BC)                      ;1d05  0a            4375   4388 
    INC BC                              ;1d06  03            4376   4389 
    OR  A                               ;1d07  b7            4377   4390 
    JP  Z,SERROR                        ;1d08  ca 3a 17      4378   4391 
    CP  022h                            ;1d0b  fe 22         4379   4392 
    JR  Z,PMTOUE                        ;1d0d  28 05         4380   4393 
    CALL    ACCPRT                      ;1d0f  cd 64 08      4381   4394 
    JR  LINPOL                          ;1d12  18 f1         4382   4395 
PMTOUE: CALL    BCFTCH                  ;1d14  cd c4 25      4383   4396 
    CP  03Bh                            ;1d17  fe 3b         4384   4397 
    CALL    Z,BCFTCH                    ;1d19  cc c4 25      4385   4398 
LINPNP: LD  DE,(INTFAC)                 ;1d1c  ed 5b 4b 7a   4386   4399 
    CALL    GETVAR                      ;1d20  cd da 1e      4387   4400 
    CP  003h                            ;1d23  fe 03         4388   4401 
    JP  NZ,TYPEMS                       ;1d25  c2 32 17      4389   4402 
    CALL    BCFTCH                      ;1d28  cd c4 25      4390   4403 
    PUSH    HL                          ;1d2b  e5            4391   4404 
    LD  DE,KEYBUF                       ;1d2c  11 4f 7a      4392   4405 
    DEFB    0CDH                        ;1d2f  cd            4393   4406 ; CALL ?
LINVEC: DEFW    LININP                  ;1d30  93 15         4394   4407 
    JR  C,IBREAK                        ;1d32  38 15         4395   4408 
    PUSH    BC                          ;1d34  c5            4396   4409 
    PUSH    DE                          ;1d35  d5            4397   4410 
    LD  B,0                             ;1d36  06 00         4398   4411 
LINESR: LD  A,(DE)                      ;1d38  1a            4399   4412 
    OR  A                               ;1d39  b7            4400   4413 
    JR  Z,ESLINE                        ;1d3a  28 04         4401   4414 
    INC DE                              ;1d3c  13            4402   4415 
    INC B                               ;1d3d  04            4403   4416 
    JR  LINESR                          ;1d3e  18 f8         4404   4417 
ESLINE: EX  DE,HL                       ;1d40  eb            4405   4418 
    POP DE                              ;1d41  d1            4406   4419 
    CALL    ENTSTR                      ;1d42  cd 1a 2b      4407   4420 
    POP BC                              ;1d45  c1            4408   4421 
    JP  STRMDM                          ;1d46  c3 52 15      4409   4422 
                                        ;                    4410   4423 ;
IBREAK: POP HL                          ;1d49  e1            4411   4424 
    POP HL                              ;1d4a  e1            4412   4425 
    DEFB    021H                        ;1d4b  21            4413   4426 ; LD HL,?
IBREKH: DEFS    2                       ;1d4c                4414   4427 
    JP  BREAK                           ;1d4e  c3 a2 16      4415   4428 
                                        ;                    4416   4429 ;
CINP'#: LD  HL,CIRPUT                   ;1d51  21 6c 1d      4417   4430 
    LD  (PMASVC),HL                     ;1d54  22 c3 1d      4418   4431 
    INC BC                              ;1d57  03            4419   4432 
    CALL    IHLEXP                      ;1d58  cd cc 22      4420   4433 
    CP  02Ch                            ;1d5b  fe 2c         4421   4434 
    JP  NZ,SERROR                       ;1d5d  c2 3a 17      4422   4435 
    LD  A,(FILEFG)                      ;1d60  3a 83 33      4423   4436 
    DEC A                               ;1d63  3d            4424   4437 
    JP  NZ,FILEER                       ;1d64  c2 3e 18      4425   4438 
    LD  A,0C3h                          ;1d67  3e c3         4426   4439 
    LD  (NRLDED),A                      ;1d69  32 30 3a      4427   4440 
CIRPUT: LD  DE,KEYBUF                   ;1d6c  11 4f 7a      4428   4441 
    CALL    CINPUT                      ;1d6f  cd f8 39      4429   4442 
    JR  INPLOP                          ;1d72  18 6b         4430   4443 
                                        ;                    4431   4444 ;
INPUT:  PUSH    HL                      ;1d74  e5            4432   4445 
    LD  (IBREKH),HL                     ;1d75  22 4c 1d      4433   4446 
    LD  HL,PMTASK                       ;1d78  21 c2 1d      4434   4447 
    LD  (READVC),HL                     ;1d7b  22 5a 1e      4435   4448 
    LD  HL,00000h                       ;1d7e  21 00 00      4436   4449 
    LD  (DATAFV),HL                     ;1d81  22 fc 1d      4437   4450 
    LD  (DATAV2),HL                     ;1d84  22 81 1e      4438   4451 
    LD  HL,00418h                       ;1d87  21 18 04      4439   4452 
    LD  (DATAV1),HL                     ;1d8a  22 e2 1d      4440   4453 
    POP HL                              ;1d8d  e1            4441   4454 
    CALL    HLFTCH                      ;1d8e  cd 87 29      4442   4455 
    LD  C,L                             ;1d91  4d            4443   4456 
    LD  B,H                             ;1d92  44            4444   4457 
    PUSH    HL                          ;1d93  e5            4445   4458 
    LD  HL,LINEKB                       ;1d94  21 c5 1d      4446   4459 
    LD  (PMASVC),HL                     ;1d97  22 c3 1d      4447   4460 
    POP HL                              ;1d9a  e1            4448   4461 
    CP  023h                            ;1d9b  fe 23         4449   4462 
    JP  Z,CINP'#                        ;1d9d  ca 51 1d      4450   4463 
    CP  022h                            ;1da0  fe 22         4451   4464 
    JR  NZ,PMTASK                       ;1da2  20 1e         4452   4465 
PMTOUL: INC HL                          ;1da4  23            4453   4466 
    LD  A,(HL)                          ;1da5  7e            4454   4467 
    CP  022h                            ;1da6  fe 22         4455   4468 
    JR  Z,NPASK?                        ;1da8  28 09         4456   4469 
    OR  A                               ;1daa  b7            4457   4470 
    JP  Z,SERROR                        ;1dab  ca 3a 17      4458   4471 
    CALL    ACCPRT                      ;1dae  cd 64 08      4459   4472 
    JR  PMTOUL                          ;1db1  18 f1         4460   4473 
NPASK?: CALL    INCHLF                  ;1db3  cd 86 29      4461   4474 
    INC HL                              ;1db6  23            4462   4475 
    LD  C,L                             ;1db7  4d            4463   4476 
    LD  B,H                             ;1db8  44            4464   4477 
    CP  02Ch                            ;1db9  fe 2c         4465   4478 
    JR  Z,NOPPMT                        ;1dbb  28 10         4466   4479 
    CP  03Bh                            ;1dbd  fe 3b         4467   4480 
    JP  NZ,SERROR                       ;1dbf  c2 3a 17      4468   4481 
                                        ;                    4469   4482 ;
PMTASK: DEFB    0C3H                    ;1dc2  c3            4470   4483 ; JP ?
PMASVC: DEFS    2                       ;1dc3                4471   4484 
LINEKB: LD  A,03Fh                      ;1dc5  3e 3f         4472   4485 
    CALL    ACCPRT                      ;1dc7  cd 64 08      4473   4486 
    CALL    SPPRT                       ;1dca  cd 62 08      4474   4487 
                                        ;                    4475   4488 ;
NOPPMT: LD  HL,(CURX)                   ;1dcd  2a ed 11      4476   4489 ; ??DISPN
    PUSH    HL                          ;1dd0  e5            4477   4490 
    LD  DE,KEYBUF                       ;1dd1  11 4f 7a      4478   4491 
    CALL    LININP                      ;1dd4  cd 93 15      4479   4492 
    JP  C,IBREAK                        ;1dd7  da 49 1d      4480   4493 
    POP HL                              ;1dda  e1            4481   4494 
    LD  H,0                             ;1ddb  26 00         4482   4495 
    ADD HL,DE                           ;1ddd  19            4483   4496 
    EX  DE,HL                           ;1dde  eb            4484   4497 
                                        ;                    4485   4498 ;
INPLOP: CALL    BCFTCH                  ;1ddf  cd c4 25      4486   4499 
DATAV1: JR  DASKIO                      ;1de2  18 04         4487   4500 
    LD  (DATAPO),DE                     ;1de4  ed 53 60 1c   4488   4501 
DASKIO: OR  A                           ;1de8  b7            4489   4502 
    JP  Z,RETIRQ                        ;1de9  ca 39 1b      4490   4503 
    CP  03Ah                            ;1dec  fe 3a         4491   4504 
    JP  Z,RETIRQ                        ;1dee  ca 39 1b      4492   4505 
    EX  AF,AF'                          ;1df1  08            4493   4506 
    CALL    DEFTCH                      ;1df2  cd 51 5d      4494   4507 
    DEC DE                              ;1df5  1b            4495   4508 
    OR  A                               ;1df6  b7            4496   4509 
    DEC BC                              ;1df7  0b            4497   4510 
    JR  Z,PMTERM                        ;1df8  28 5f         4498   4511 
    CP  03Ah                            ;1dfa  fe 3a         4499   4512 
DATAFV:                                 ;                    4500   4513 
    JR  Z,PMTERM                        ;1dfc  28 5b         4501   4514 
    INC BC                              ;1dfe  03            4502   4515 
    EX  AF,AF'                          ;1dff  08            4503   4516 
    PUSH    DE                          ;1e00  d5            4504   4517 
    LD  DE,(INTFAC)                     ;1e01  ed 5b 4b 7a   4505   4518 
    CALL    GETVAR                      ;1e05  cd da 1e      4506   4519 
    POP DE                              ;1e08  d1            4507   4520 
    CP  003h                            ;1e09  fe 03         4508   4521 
    JP  Z,STRINP                        ;1e0b  ca 69 1e      4509   4522 
    PUSH    HL                          ;1e0e  e5            4510   4523 
    PUSH    AF                          ;1e0f  f5            4511   4524 
    CALL    DEFTCH                      ;1e10  cd 51 5d      4512   4525 
    DEC DE                              ;1e13  1b            4513   4526 
    CP  02Eh                            ;1e14  fe 2e         4514   4527 
    JR  Z,INNMOK                        ;1e16  28 16         4515   4528 
    CP  02Dh                            ;1e18  fe 2d         4516   4529 
    JR  Z,INNMOK                        ;1e1a  28 12         4517   4530 
    CP  026h                            ;1e1c  fe 26         4518   4531 
    JR  Z,INNMOK                        ;1e1e  28 0e         4519   4532 
    CP  02Bh                            ;1e20  fe 2b         4520   4533 
    JR  Z,INNMOK                        ;1e22  28 0a         4521   4534 
    CP  030h                            ;1e24  fe 30         4522   4535 
    JP  C,TYPEMS                        ;1e26  da 32 17      4523   4536 
    CP  03Ah                            ;1e29  fe 3a         4524   4537 
    JP  NC,TYPEMS                       ;1e2b  d2 32 17      4525   4538 
INNMOK: LD  HL,ZFAC                     ;1e2e  21 f2 62      4526   4539 
    PUSH    BC                          ;1e31  c5            4527   4540 
    CALL    OVFLAG                      ;1e32  cd b8 5b      4528   4541 
    POP BC                              ;1e35  c1            4529   4542 
    POP AF                              ;1e36  f1            4530   4543 
    CP  002h                            ;1e37  fe 02         4531   4544 
    JR  Z,INITDI                        ;1e39  28 21         4532   4545 
    POP HL                              ;1e3b  e1            4533   4546 
    PUSH    BC                          ;1e3c  c5            4534   4547 
    LD  C,A                             ;1e3d  4f            4535   4548 
    LD  B,0                             ;1e3e  06 00         4536   4549 
    PUSH    DE                          ;1e40  d5            4537   4550 
    EX  DE,HL                           ;1e41  eb            4538   4551 
    LD  HL,ZFAC                         ;1e42  21 f2 62      4539   4552 
    LDIR                                ;1e45  ed b0         4540   4553 
    POP DE                              ;1e47  d1            4541   4554 
    POP BC                              ;1e48  c1            4542   4555 
NXTIN?: CALL    BCFTCH                  ;1e49  cd c4 25      4543   4556 
    CP  02Ch                            ;1e4c  fe 2c         4544   4557 
    DEC BC                              ;1e4e  0b            4545   4558 
    JR  NZ,INPLOP                       ;1e4f  20 8e         4546   4559 
    INC BC                              ;1e51  03            4547   4560 
    CALL    DEFTCH                      ;1e52  cd 51 5d      4548   4561 
    CP  02Ch                            ;1e55  fe 2c         4549   4562 ; BCOUTA?
    JR  Z,INPLOP                        ;1e57  28 86         4550   4563 
                                        ;                    4551   4564 ;
PMTERM: DEFB    0C3H                    ;1e59  c3            4552   4565 ; JP ?
READVC: DEFS    2                       ;1e5a                4553   4566 
                                        ;                    4554   4567 ;
INITDI: CALL    HLFLTO                  ;1e5c  cd 97 2d      4555   4568 
    POP IX                              ;1e5f  dd e1         4556   4569 
    LD  (IX+0),L                        ;1e61  dd 75 00      4557   4570 
    LD  (IX+1),H                        ;1e64  dd 74 01      4558   4571 
    JR  NXTIN?                          ;1e67  18 e0         4559   4572 
                                        ;                    4560   4573 ;
STRINP: PUSH    BC                      ;1e69  c5            4561   4574 ; TEXT POINTR
    PUSH    HL                          ;1e6a  e5            4562   4575 ; VAR ADRS
    LD  (INPSDC),DE                     ;1e6b  ed 53 a9 1e   4563   4576 
    LD  B,0                             ;1e6f  06 00         4564   4577 
    CALL    DEFTCH                      ;1e71  cd 51 5d      4565   4578 
    CP  022h                            ;1e74  fe 22         4566   4579 
    JR  Z,DATA22                        ;1e76  28 20         4567   4580 
    DEC DE                              ;1e78  1b            4568   4581 
SRINPL: LD  A,(DE)                      ;1e79  1a            4569   4582 
    INC DE                              ;1e7a  13            4570   4583 
    INC B                               ;1e7b  04            4571   4584 
    OR  A                               ;1e7c  b7            4572   4585 
    JR  Z,ESCINS                        ;1e7d  28 08         4573   4586 
    CP  03Ah                            ;1e7f  fe 3a         4574   4587 
DATAV2: JR  Z,ESCINS                    ;1e81  28 04         4575   4588 
    CP  02Ch                            ;1e83  fe 2c         4576   4589 
    JR  NZ,SRINPL                       ;1e85  20 f2         4577   4590 
ESCINS: DEC DE                          ;1e87  1b            4578   4591 
ESCIN': DEC B                           ;1e88  05            4579   4592 
    LD  HL,INSDC                        ;1e89  21 a8 1e      4580   4593 
    LD  (HL),B                          ;1e8c  70            4581   4594 
    LD  C,E                             ;1e8d  4b            4582   4595 
    LD  B,D                             ;1e8e  42            4583   4596 
    POP DE                              ;1e8f  d1            4584   4597 
    PUSH    BC                          ;1e90  c5            4585   4598 
    CALL    INPENT                      ;1e91  cd 71 15      4586   4599 
    POP DE                              ;1e94  d1            4587   4600 
    POP BC                              ;1e95  c1            4588   4601 
    JR  NXTIN?                          ;1e96  18 b1         4589   4602 
                                        ;                    4590   4603 ;
DATA22: LD  (INPSDC),DE                 ;1e98  ed 53 a9 1e   4591   4604 
DATADN: LD  A,(DE)                      ;1e9c  1a            4592   4605 
    INC B                               ;1e9d  04            4593   4606 
    OR  A                               ;1e9e  b7            4594   4607 
    JR  Z,ESCIN'                        ;1e9f  28 e7         4595   4608 
    INC DE                              ;1ea1  13            4596   4609 
    CP  022h                            ;1ea2  fe 22         4597   4610 
    JR  NZ,DATADN                       ;1ea4  20 f6         4598   4611 
    JR  ESCIN'                          ;1ea6  18 e0         4599   4612 
INSDC:  DEFS    1                       ;1ea8                4600   4613 
INPSDC: DEFS    2                       ;1ea9                4601   4614 
                                        ;                    4602   4615 ;
HMEMCK: PUSH    HL                      ;1eab  e5            4603   4616 
    PUSH    DE                          ;1eac  d5            4604   4617 
    EX  DE,HL                           ;1ead  eb            4605   4618 
    JR  MCHKMD                          ;1eae  18 06         4606   4619 
                                        ;                    4607   4620 ;
MEMCHK: PUSH    HL                      ;1eb0  e5            4608   4621 
    PUSH    DE                          ;1eb1  d5            4609   4622 
    LD  DE,(STKLMT)                     ;1eb2  ed 5b 3f 7a   4610   4623 
MCHKMD: PUSH    AF                      ;1eb6  f5            4611   4624 
    LD  HL,0                            ;1eb7  21 00 00      4612   4625 
    ADD HL,SP                           ;1eba  39            4613   4626 
    DEC H                               ;1ebb  25            4614   4627 
    OR  A                               ;1ebc  b7            4615   4628 
    SBC HL,DE                           ;1ebd  ed 52         4616   4629 
    JR  NC,MCHCKR                       ;1ebf  30 0e         4617   4630 
    CALL    MEMPUR                      ;1ec1  cd e8 2d      4618   4631 
    LD  HL,0                            ;1ec4  21 00 00      4619   4632 
    ADD HL,SP                           ;1ec7  39            4620   4633 
    DEC H                               ;1ec8  25            4621   4634 
    OR  A                               ;1ec9  b7            4622   4635 
    SBC HL,DE                           ;1eca  ed 52         4623   4636 
    JP  C,OMERR                         ;1ecc  da 88 21      4624   4637 
MCHCKR: POP AF                          ;1ecf  f1            4625   4638 
    POP DE                              ;1ed0  d1            4626   4639 
    POP HL                              ;1ed1  e1            4627   4640 
    RET                                 ;1ed2  c9            4628   4641 
                                        ;                    4629   4642 
GETVAC: LD  DE,(INTFAC)                 ;1ed3  ed 5b 4b 7a   4630   4643 
GETVAB: CALL    BCFTCH                  ;1ed7  cd c4 25      4631   4644 
GETVAR: PUSH    DE                      ;1eda  d5            4632   4645 
    CALL    VSRTST                      ;1edb  cd fe 20      4633   4646 
    CP  028h                            ;1ede  fe 28         4634   4647 
    JP  Z,ARRAY                         ;1ee0  ca 41 1f      4635   4648 
    DEC BC                              ;1ee3  0b            4636   4649 
    PUSH    BC                          ;1ee4  c5            4637   4650 
    LD  A,E                             ;1ee5  7b            4638   4651 
    EX  DE,HL                           ;1ee6  eb            4639   4652 
    LD  B,A                             ;1ee7  47            4640   4653 
    LD  HL,(VSTART)                     ;1ee8  2a 3b 7a      4641   4654 
VARCLP: LD  A,(HL)                      ;1eeb  7e            4642   4655 
    OR  A                               ;1eec  b7            4643   4656 
    JR  Z,CRNVAR                        ;1eed  28 34         4644   4657 
    CP  B                               ;1eef  b8            4645   4658 
    JR  NZ,SKIPUS                       ;1ef0  20 12         4646   4659 
    INC HL                              ;1ef2  23            4647   4660 
    LD  A,E                             ;1ef3  7b            4648   4661 
    CP  (HL)                            ;1ef4  be            4649   4662 
    LD  A,B                             ;1ef5  78            4650   4663 
    JP  NZ,SKIPVT                       ;1ef6  c2 18 1f      4651   4664 
    INC HL                              ;1ef9  23            4652   4665 
    LD  A,D                             ;1efa  7a            4653   4666 
    CP  (HL)                            ;1efb  be            4654   4667 
    LD  A,B                             ;1efc  78            4655   4668 
    JP  NZ,SKIPVU                       ;1efd  c2 19 1f      4656   4669 
    INC HL                              ;1f00  23            4657   4670 
GVARRT: POP BC                          ;1f01  c1            4658   4671 
    POP DE                              ;1f02  d1            4659   4672 
    RET                                 ;1f03  c9            4660   4673 
                                        ;                    4661   4674 ;
SKIPUS: INC A                           ;1f04  3c            4662   4675 
    JP  P,SKIPVT                        ;1f05  f2 18 1f      4663   4676 
    DEC A                               ;1f08  3d            4664   4677 
    AND 0C0h                            ;1f09  e6 c0         4665   4678 
    CP  0C0h                            ;1f0b  fe c0         4666   4679 
    LD  A,5                             ;1f0d  3e 05         4667   4680 
    JR  Z,SKIPVV                        ;1f0f  28 09         4668   4681 
    INC HL                              ;1f11  23            4669   4682 
    CALL    INDRCT                      ;1f12  cd a3 2a      4670   4683 
    JP  VARCLP                          ;1f15  c3 eb 1e      4671   4684 
                                        ;                    4672   4685 ;
SKIPVT: INC A                           ;1f18  3c            4673   4686 
SKIPVU: INC A                           ;1f19  3c            4674   4687 
SKIPVV: ADD A,L                         ;1f1a  85            4675   4688 
    LD  L,A                             ;1f1b  6f            4676   4689 
    LD  A,000h                          ;1f1c  3e 00         4677   4690 
    ADC A,H                             ;1f1e  8c            4678   4691 
    LD  H,A                             ;1f1f  67            4679   4692 
    JP  VARCLP                          ;1f20  c3 eb 1e      4680   4693 
                                        ;                    4681   4694 ;
CRNVAR: LD  (HL),B                      ;1f23  70            4682   4695 
    INC HL                              ;1f24  23            4683   4696 
    LD  (HL),E                          ;1f25  73            4684   4697 
    INC HL                              ;1f26  23            4685   4698 
    LD  (HL),D                          ;1f27  72            4686   4699 
    INC HL                              ;1f28  23            4687   4700 
    LD  C,B                             ;1f29  48            4688   4701 
    PUSH    HL                          ;1f2a  e5            4689   4702 
    EX  DE,HL                           ;1f2b  eb            4690   4703 
    INC B                               ;1f2c  04            4691   4704 
    XOR A                               ;1f2d  af            4692   4705 
LZFIL1: LD  (DE),A                      ;1f2e  12            4693   4706 
    INC DE                              ;1f2f  13            4694   4707 
    DJNZ    LZFIL1                      ;1f30  10 fc         4695   4708 
    DEC DE                              ;1f32  1b            4696   4709 
    EX  DE,HL                           ;1f33  eb            4697   4710 
    CALL    HMEMCK                      ;1f34  cd ab 1e      4698   4711 
    EX  DE,HL                           ;1f37  eb            4699   4712 
    LD  (STKLMT),DE                     ;1f38  ed 53 3f 7a   4700   4713 
    POP HL                              ;1f3c  e1            4701   4714 
    LD  A,C                             ;1f3d  79            4702   4715 
    JP  GVARRT                          ;1f3e  c3 01 1f      4703   4716 
                                        ;                    4704   4717 ;
ARRAY:  LD  D,0                         ;1f41  16 00         4705   4718 
    EXX                                 ;1f43  d9            4706   4719 
    POP HL                              ;1f44  e1            4707   4720 
    PUSH    HL                          ;1f45  e5            4708   4721 
    PUSH    HL                          ;1f46  e5            4709   4722 
    EXX                                 ;1f47  d9            4710   4723 
    EX  (SP),HL                         ;1f48  e3            4711   4724 
    PUSH    HL                          ;1f49  e5            4712   4725 
TSALOP: POP HL                          ;1f4a  e1            4713   4726 
    PUSH    HL                          ;1f4b  e5            4714   4727 
    PUSH    DE                          ;1f4c  d5            4715   4728 
    DEC IY                              ;1f4d  fd 2b         4716   4729 
    CALL    HLEXP                       ;1f4f  cd c7 22      4717   4730 
    INC IY                              ;1f52  fd 23         4718   4731 
    CP  029h                            ;1f54  fe 29         4719   4732 
    JR  Z,TSFARY                        ;1f56  28 12         4720   4733 
    CP  02Ch                            ;1f58  fe 2c         4721   4734 
    JP  NZ,SERROR                       ;1f5a  c2 3a 17      4722   4735 
    POP DE                              ;1f5d  d1            4723   4736 
    INC D                               ;1f5e  14            4724   4737 
    EXX                                 ;1f5f  d9            4725   4738 
    POP HL                              ;1f60  e1            4726   4739 
    POP DE                              ;1f61  d1            4727   4740 
    EXX                                 ;1f62  d9            4728   4741 
    PUSH    HL                          ;1f63  e5            4729   4742 
    EXX                                 ;1f64  d9            4730   4743 
    PUSH    DE                          ;1f65  d5            4731   4744 
    PUSH    HL                          ;1f66  e5            4732   4745 
    EXX                                 ;1f67  d9            4733   4746 
    JR  TSALOP                          ;1f68  18 e0         4734   4747 
                                        ;                    4735   4748 ;
TSFARY: POP DE                          ;1f6a  d1            4736   4749 
    EXX                                 ;1f6b  d9            4737   4750 
    POP HL                              ;1f6c  e1            4738   4751 
    POP DE                              ;1f6d  d1            4739   4752 
    EXX                                 ;1f6e  d9            4740   4753 
    INC D                               ;1f6f  14            4741   4754 
    PUSH    HL                          ;1f70  e5            4742   4755 
    PUSH    BC                          ;1f71  c5            4743   4756 
    EXX                                 ;1f72  d9            4744   4757 
    PUSH    DE                          ;1f73  d5            4745   4758 
    EXX                                 ;1f74  d9            4746   4759 
    POP BC                              ;1f75  c1            4747   4760 
    LD  HL,(VSTART)                     ;1f76  2a 3b 7a      4748   4761 
ASLOP:  LD  A,(HL)                      ;1f79  7e            4749   4762 
    OR  A                               ;1f7a  b7            4750   4763 
    JP  Z,SORERR                        ;1f7b  ca f5 20      4751   4764 
    JP  M,ARYATA                        ;1f7e  fa 8c 1f      4752   4765 
    INC A                               ;1f81  3c            4753   4766 
    INC A                               ;1f82  3c            4754   4767 
    INC A                               ;1f83  3c            4755   4768 
ARSKFN: ADD A,L                         ;1f84  85            4756   4769 
    LD  L,A                             ;1f85  6f            4757   4770 
    LD  A,000h                          ;1f86  3e 00         4758   4771 
    ADC A,H                             ;1f88  8c            4759   4772 
    LD  H,A                             ;1f89  67            4760   4773 
    JR  ASLOP                           ;1f8a  18 ed         4761   4774 
                                        ;                    4762   4775 ;
ARYATA: AND 0C0h                        ;1f8c  e6 c0         4763   4776 
    CP  0C0h                            ;1f8e  fe c0         4764   4777 
    LD  A,005h                          ;1f90  3e 05         4765   4778 
    JR  Z,ARSKFN                        ;1f92  28 f0         4766   4779 
    LD  A,(HL)                          ;1f94  7e            4767   4780 
    AND 07Fh                            ;1f95  e6 7f         4768   4781 
    CP  E                               ;1f97  bb            4769   4782 
    JR  Z,ARMSN1                        ;1f98  28 0d         4770   4783 
    INC HL                              ;1f9a  23            4771   4784 
MIDNAM: CALL    INDRCT                  ;1f9b  cd a3 2a      4772   4785 
    JP  ASLOP                           ;1f9e  c3 79 1f      4773   4786 
                                        ;                    4774   4787 ;
NXTVR:  DEC HL                          ;1fa1  2b            4775   4788 
NXTVR1:     DEC HL                      ;1fa2  2b            4776   4789 
    DEC HL                              ;1fa3  2b            4777   4790 
    JP  MIDNAM                          ;1fa4  c3 9b 1f      4778   4791 
                                        ;                    4779   4792 ;
ARMSN1: EXX                             ;1fa7  d9            4780   4793 
    LD  C,A                             ;1fa8  4f            4781   4794 
    LD  B,000h                          ;1fa9  06 00         4782   4795 
    LD  HL,00000h                       ;1fab  21 00 00      4783   4796 
    EXX                                 ;1fae  d9            4784   4797 
    INC HL                              ;1faf  23            4785   4798 
    INC HL                              ;1fb0  23            4786   4799 
    INC HL                              ;1fb1  23            4787   4800 
    LD  A,C                             ;1fb2  79            4788   4801 
    CP  (HL)                            ;1fb3  be            4789   4802 
    JP  NZ,NXTVR1                       ;1fb4  c2 a2 1f      4790   4803 
    INC HL                              ;1fb7  23            4791   4804 
    LD  A,B                             ;1fb8  78            4792   4805 
    CP  (HL)                            ;1fb9  be            4793   4806 
    JP  NZ,NXTVR                        ;1fba  c2 a1 1f      4794   4807 
    INC HL                              ;1fbd  23            4795   4808 
    LD  A,D                             ;1fbe  7a            4796   4809 
    CP  (HL)                            ;1fbf  be            4797   4810 
    JP  NZ,SORERR                       ;1fc0  c2 f5 20      4798   4811 
    POP BC                              ;1fc3  c1            4799   4812 
    LD  (ARBCBF),BC                     ;1fc4  ed 43 f1 1f   4800   4813 
    LD  B,(HL)                          ;1fc8  46            4801   4814 
    INC HL                              ;1fc9  23            4802   4815 
ADRCL:  LD  E,(HL)                      ;1fca  5e            4803   4816 
    INC HL                              ;1fcb  23            4804   4817 
    LD  D,(HL)                          ;1fcc  56            4805   4818 
    INC HL                              ;1fcd  23            4806   4819 
    EX  (SP),HL                         ;1fce  e3            4807   4820 
    PUSH    DE                          ;1fcf  d5            4808   4821 
    EXX                                 ;1fd0  d9            4809   4822 
    POP DE                              ;1fd1  d1            4810   4823 
    CALL    IMUL                        ;1fd2  cd 4b 21      4811   4824 
    EXX                                 ;1fd5  d9            4812   4825 
    PUSH    HL                          ;1fd6  e5            4813   4826 
    SBC HL,DE                           ;1fd7  ed 52         4814   4827 
    JP  NC,SORERR                       ;1fd9  d2 f5 20      4815   4828 
    EXX                                 ;1fdc  d9            4816   4829 
    POP DE                              ;1fdd  d1            4817   4830 
    ADD HL,DE                           ;1fde  19            4818   4831 
    EXX                                 ;1fdf  d9            4819   4832 
    POP HL                              ;1fe0  e1            4820   4833 
    DJNZ    ADRCL                       ;1fe1  10 e7         4821   4834 
    PUSH    HL                          ;1fe3  e5            4822   4835 
    EXX                                 ;1fe4  d9            4823   4836 
    LD  E,C                             ;1fe5  59            4824   4837 
    LD  D,B                             ;1fe6  50            4825   4838 
    LD  A,C                             ;1fe7  79            4826   4839 
    CALL    IMUL                        ;1fe8  cd 4b 21      4827   4840 
    PUSH    HL                          ;1feb  e5            4828   4841 
    EXX                                 ;1fec  d9            4829   4842 
    POP DE                              ;1fed  d1            4830   4843 
    POP HL                              ;1fee  e1            4831   4844 
    ADD HL,DE                           ;1fef  19            4832   4845 
    DEFB    001H                        ;1ff0  01            4833   4846 ; LD BC,?
ARBCBF: DEFS    2                       ;1ff1                4834   4847 
    POP DE                              ;1ff3  d1            4835   4848 
    RET                                 ;1ff4  c9            4836   4849 
                                        ;                    4837   4850 ;
CHALNM: CP  030h                        ;1ff5  fe 30         4838   4851 
    RET C                               ;1ff7  d8            4839   4852 
    CP  05Bh                            ;1ff8  fe 5b         4840   4853 
    CCF                                 ;1ffa  3f            4841   4854 
    RET C                               ;1ffb  d8            4842   4855 
    CP  041h                            ;1ffc  fe 41         4843   4856 
    RET NC                              ;1ffe  d0            4844   4857 
    CP  03Ah                            ;1fff  fe 3a         4845   4858 
    CCF                                 ;2001  3f            4846   4859 
    RET                                 ;2002  c9            4847   4860 
                                        ;                    4848   4861 ;
DIM:    CALL    HLFTCH                  ;2003  cd 87 29      4849   4862 
    OR  A                               ;2006  b7            4850   4863 
    RET Z                               ;2007  c8            4851   4864 
    CP  03Ah                            ;2008  fe 3a         4852   4865 
    RET Z                               ;200a  c8            4853   4866 
    LD  C,L                             ;200b  4d            4854   4867 
    LD  B,H                             ;200c  44            4855   4868 
    CALL    BCFTCH                      ;200d  cd c4 25      4856   4869 
    CALL    VSRTST                      ;2010  cd fe 20      4857   4870 
    CP  028h                            ;2013  fe 28         4858   4871 
    JP  NZ,SERROR                       ;2015  c2 3a 17      4859   4872 
    PUSH    BC                          ;2018  c5            4860   4873 
    PUSH    DE                          ;2019  d5            4861   4874 
    PUSH    HL                          ;201a  e5            4862   4875 
    LD  C,L                             ;201b  4d            4863   4876 
    LD  B,H                             ;201c  44            4864   4877 
    LD  HL,(VSTART)                     ;201d  2a 3b 7a      4865   4878 
DASLOP: LD  A,(HL)                      ;2020  7e            4866   4879 
    OR  A                               ;2021  b7            4867   4880 
    JR  Z,DIMFDD                        ;2022  28 39         4868   4881 
    JP  M,DRYATA                        ;2024  fa 32 20      4869   4882 
    INC A                               ;2027  3c            4870   4883 
    INC A                               ;2028  3c            4871   4884 
    INC A                               ;2029  3c            4872   4885 
DRSKFN: ADD A,L                         ;202a  85            4873   4886 
    LD  L,A                             ;202b  6f            4874   4887 
    LD  A,000h                          ;202c  3e 00         4875   4888 
    ADC A,H                             ;202e  8c            4876   4889 
    LD  H,A                             ;202f  67            4877   4890 
    JR  DASLOP                          ;2030  18 ee         4878   4891 
                                        ;                    4879   4892 ;
DRYATA: AND 0C0h                        ;2032  e6 c0         4880   4893 
    CP  0C0h                            ;2034  fe c0         4881   4894 
    LD  A,5                             ;2036  3e 05         4882   4895 
    JR  Z,DRSKFN                        ;2038  28 f0         4883   4896 
    LD  A,(HL)                          ;203a  7e            4884   4897 
    AND 07Fh                            ;203b  e6 7f         4885   4898 
    CP  E                               ;203d  bb            4886   4899 
    JP  Z,MOPDIM                        ;203e  ca 4c 20      4887   4900 
    INC HL                              ;2041  23            4888   4901 
DIDNAM: CALL    INDRCT                  ;2042  cd a3 2a      4889   4902 
    JR  DASLOP                          ;2045  18 d9         4890   4903 
                                        ;                    4891   4904 ;
DXTVR1: DEC HL                          ;2047  2b            4892   4905 
DXTVR:  DEC HL                          ;2048  2b            4893   4906 
    DEC HL                              ;2049  2b            4894   4907 
    JR  DIDNAM                          ;204a  18 f6         4895   4908 
                                        ;                    4896   4909 ;
MOPDIM: INC HL                          ;204c  23            4897   4910 
    INC HL                              ;204d  23            4898   4911 
    INC HL                              ;204e  23            4899   4912 
    LD  A,C                             ;204f  79            4900   4913 
    CP  (HL)                            ;2050  be            4901   4914 
    JP  NZ,DXTVR                        ;2051  c2 48 20      4902   4915 
    INC HL                              ;2054  23            4903   4916 
    LD  A,B                             ;2055  78            4904   4917 
    CP  (HL)                            ;2056  be            4905   4918 
    JP  NZ,DXTVR1                       ;2057  c2 47 20      4906   4919 
    JP  DUPDEF                          ;205a  c3 8b 3b      4907   4920 
                                        ;                    4908   4921 ;
DIMFDD: POP HL                          ;205d  e1            4909   4922 
    POP DE                              ;205e  d1            4910   4923 
    POP BC                              ;205f  c1            4911   4924 
    LD  D,0                             ;2060  16 00         4912   4925 
    PUSH    HL                          ;2062  e5            4913   4926 
ARGLOP: PUSH    DE                      ;2063  d5            4914   4927 
    CALL    IHLEXP                      ;2064  cd cc 22      4915   4928 
    CP  029h                            ;2067  fe 29         4916   4929 
    JR  Z,DEFARY                        ;2069  28 09         4917   4930 
    CALL    CH2CH                       ;206b  cd 61 2d      4918   4931 
    POP DE                              ;206e  d1            4919   4932 
    INC D                               ;206f  14            4920   4933 
    INC HL                              ;2070  23            4921   4934 
    PUSH    HL                          ;2071  e5            4922   4935 
    JR  ARGLOP                          ;2072  18 ef         4923   4936 
                                        ;                    4924   4937 ;
DEFARY: POP DE                          ;2074  d1            4925   4938 
    INC D                               ;2075  14            4926   4939 
    INC HL                              ;2076  23            4927   4940 
    PUSH    HL                          ;2077  e5            4928   4941 
    LD  HL,(STKLMT)                     ;2078  2a 3f 7a      4929   4942 
    LD  A,E                             ;207b  7b            4930   4943 
    OR  080h                            ;207c  f6 80         4931   4944 
    LD  (HL),A                          ;207e  77            4932   4945 
    EX  AF,AF'                          ;207f  08            4933   4946 
    INC HL                              ;2080  23            4934   4947 
    INC HL                              ;2081  23            4935   4948 
    INC HL                              ;2082  23            4936   4949 
    INC HL                              ;2083  23            4937   4950 
    INC HL                              ;2084  23            4938   4951 
    LD  (HL),D                          ;2085  72            4939   4952 
    INC HL                              ;2086  23            4940   4953 
    LD  A,D                             ;2087  7a            4941   4954 
    EXX                                 ;2088  d9            4942   4955 
    LD  HL,00001h                       ;2089  21 01 00      4943   4956 
AREPUT: POP DE                          ;208c  d1            4944   4957 
    PUSH    DE                          ;208d  d5            4945   4958 
    CALL    IMUL                        ;208e  cd 4b 21      4946   4959 
    EXX                                 ;2091  d9            4947   4960 
    POP DE                              ;2092  d1            4948   4961 
    LD  (HL),E                          ;2093  73            4949   4962 
    INC HL                              ;2094  23            4950   4963 
    LD  (HL),D                          ;2095  72            4951   4964 
    INC HL                              ;2096  23            4952   4965 
    DEC A                               ;2097  3d            4953   4966 
    EXX                                 ;2098  d9            4954   4967 
    JR  NZ,AREPUT                       ;2099  20 f1         4955   4968 
    EX  AF,AF'                          ;209b  08            4956   4969 
    AND 07Fh                            ;209c  e6 7f         4957   4970 
    LD  E,A                             ;209e  5f            4958   4971 
    LD  D,0                             ;209f  16 00         4959   4972 
    CALL    IMUL                        ;20a1  cd 4b 21      4960   4973 
    PUSH    HL                          ;20a4  e5            4961   4974 
    EXX                                 ;20a5  d9            4962   4975 
    POP DE                              ;20a6  d1            4963   4976 
    PUSH    HL                          ;20a7  e5            4964   4977 
    ADD HL,DE                           ;20a8  19            4965   4978 
    JP  C,OMERR                         ;20a9  da 88 21      4966   4979 
    PUSH    DE                          ;20ac  d5            4967   4980 
    CALL    HMEMCK                      ;20ad  cd ab 1e      4968   4981 
    EX  DE,HL                           ;20b0  eb            4969   4982 
    LD  HL,(STKLMT)                     ;20b1  2a 3f 7a      4970   4983 
    INC HL                              ;20b4  23            4971   4984 
    LD  (HL),E                          ;20b5  73            4972   4985 
    INC HL                              ;20b6  23            4973   4986 
    LD  (HL),D                          ;20b7  72            4974   4987 
    INC HL                              ;20b8  23            4975   4988 
    LD  (STKLMT),DE                     ;20b9  ed 53 3f 7a   4976   4989 
    POP DE                              ;20bd  d1            4977   4990 
    INC DE                              ;20be  13            4978   4991 
    EX  (SP),HL                         ;20bf  e3            4979   4992 
ARYCLL: LD  (HL),0                      ;20c0  36 00         4980   4993 
    INC HL                              ;20c2  23            4981   4994 
    DEC DE                              ;20c3  1b            4982   4995 
    LD  A,D                             ;20c4  7a            4983   4996 
    OR  E                               ;20c5  b3            4984   4997 
    JR  NZ,ARYCLL                       ;20c6  20 f8         4985   4998 
    POP HL                              ;20c8  e1            4986   4999 
    POP DE                              ;20c9  d1            4987   5000 
    LD  (HL),E                          ;20ca  73            4988   5001 
    INC HL                              ;20cb  23            4989   5002 
    LD  (HL),D                          ;20cc  72            4990   5003 
    LD  L,C                             ;20cd  69            4991   5004 
    LD  H,B                             ;20ce  60            4992   5005 
    CALL    HLFTCH                      ;20cf  cd 87 29      4993   5006 
    INC HL                              ;20d2  23            4994   5007 
    CP  02Ch                            ;20d3  fe 2c         4995   5008 
    JP  Z,DIM                           ;20d5  ca 03 20      4996   5009 
    DEC HL                              ;20d8  2b            4997   5010 
    RET                                 ;20d9  c9            4998   5011 
                                        ;                    4999   5012 ;
OFF:    CALL    HLFTCH                  ;20da  cd 87 29      5000   5013 
    CP  09Ch                            ;20dd  fe 9c         5001   5014 
    JR  Z,BREAKL                        ;20df  28 0a         5002   5015 
    XOR A                               ;20e1  af            5003   5016 ;NUL CODE
    LD  (BREAKI),A                      ;20e2  32 be 06      5004   5017 
    LD  A,011h                          ;20e5  3e 11         5005   5018 ;LD DE,BREAK
OFFOFF: LD  (BREAKJ),A                  ;20e7  32 f7 14      5006   5019 
    RET                                 ;20ea  c9            5007   5020 
                                        ;                    5008   5021 ;
BREAKL: LD  A,3                         ;20eb  3e 03         5009   5022 ;BREAK CODE
    LD  (BREAKI),A                      ;20ed  32 be 06      5010   5023 
    LD  A,0CAh                          ;20f0  3e ca         5011   5024 ;JP Z,BREAK
    INC HL                              ;20f2  23            5012   5025 
    JR  OFFOFF                          ;20f3  18 f2         5013   5026 
                                        ;                    5014   5027 ;
SORERR: LD  A,9                         ;20f5  3e 09         5015   5028 
NIERRO: JP  ERROR                       ;20f7  c3 96 21      5016   5029 
                                        ;                    5017   5030 ;
NINS:   LD  A,29                        ;20fa  3e 1d         5018   5031 
    JR  NIERRO                          ;20fc  18 f9         5019   5032 
                                        ;                    5020   5033 ;
VSRTST: LD  HL,00000h                   ;20fe  21 00 00      5021   5034 
    CP  041h                            ;2101  fe 41         5022   5035 
    JP  C,SERROR                        ;2103  da 3a 17      5023   5036 
    CP  05Bh                            ;2106  fe 5b         5024   5037 
    JP  NC,SERROR                       ;2108  d2 3a 17      5025   5038 
    LD  L,A                             ;210b  6f            5026   5039 
    CALL    BCFTCH                      ;210c  cd c4 25      5027   5040 
    CALL    CHALNM                      ;210f  cd f5 1f      5028   5041 
    JR  C,CHKTYP                        ;2112  38 09         5029   5042 
    LD  H,A                             ;2114  67            5030   5043 
SKIPDM: CALL    BCFTCH                  ;2115  cd c4 25      5031   5044 
    CALL    CHALNM                      ;2118  cd f5 1f      5032   5045 
    JR  NC,SKIPDM                       ;211b  30 f8         5033   5046 
CHKTYP: CP  028h                        ;211d  fe 28         5034   5047 
    JR  NC,DFLTER                       ;211f  30 20         5035   5048 
    OR  A                               ;2121  b7            5036   5049 
    JP  Z,DFLTER                        ;2122  ca 41 21      5037   5050 
    CP  025h                            ;2125  fe 25         5038   5051 ;%
    LD  E,2                             ;2127  1e 02         5039   5052 
    JP  Z,BCFTCH                        ;2129  ca c4 25      5040   5053 
    CP  024h                            ;212c  fe 24         5041   5054 ;$
    LD  E,3                             ;212e  1e 03         5042   5055 
    JP  Z,BCFTCH                        ;2130  ca c4 25      5043   5056 
    CP  021h                            ;2133  fe 21         5044   5057 ;!
    LD  E,4                             ;2135  1e 04         5045   5058 
    JP  Z,BCFTCH                        ;2137  ca c4 25      5046   5059 
    CP  023h                            ;213a  fe 23         5047   5060 ;#
    LD  E,8                             ;213c  1e 08         5048   5061 
    JP  Z,BCFTCH                        ;213e  ca c4 25      5049   5062 
DFLTER: PUSH    HL                      ;2141  e5            5050   5063 
    LD  H,0                             ;2142  26 00         5051   5064 
    LD  DE,DFTABL-041H                  ;2144  11 47 30      5052   5065 
    ADD HL,DE                           ;2147  19            5053   5066 
    LD  E,(HL)                          ;2148  5e            5054   5067 
    POP HL                              ;2149  e1            5055   5068 
    RET                                 ;214a  c9            5056   5069 
                                        ;                    5057   5070 ;
IMUL:   PUSH    AF                      ;214b  f5            5058   5071 
    PUSH    BC                          ;214c  c5            5059   5072 
    LD  A,L                             ;214d  7d            5060   5073 
    LD  C,H                             ;214e  4c            5061   5074 
    LD  HL,00000h                       ;214f  21 00 00      5062   5075 
    LD  B,008h                          ;2152  06 08         5063   5076 
IMADL1: RRCA                            ;2154  0f            5064   5077 
    JR  NC,IMNADD                       ;2155  30 03         5065   5078 
    ADD HL,DE                           ;2157  19            5066   5079 
    JR  C,SORERR                        ;2158  38 9b         5067   5080 
IMNADD: RL  E                           ;215a  cb 13         5068   5081 
    RL  D                               ;215c  cb 12         5069   5082 
    DJNZ    IMADL1                      ;215e  10 f4         5070   5083 
    LD  A,C                             ;2160  79            5071   5084 
    OR  A                               ;2161  b7            5072   5085 
    JR  Z,IMRET                         ;2162  28 0e         5073   5086 
    LD  B,008h                          ;2164  06 08         5074   5087 
IMADL2: RRCA                            ;2166  0f            5075   5088 
    JR  NC,IMNAD1                       ;2167  30 03         5076   5089 
    ADD HL,DE                           ;2169  19            5077   5090 
    JR  C,SORERR                        ;216a  38 89         5078   5091 
IMNAD1: RL  E                           ;216c  cb 13         5079   5092 
    RL  D                               ;216e  cb 12         5080   5093 
    DJNZ    IMADL2                      ;2170  10 f4         5081   5094 
IMRET:  POP BC                          ;2172  c1            5082   5095 
    POP AF                              ;2173  f1            5083   5096 
    RET                                 ;2174  c9            5084   5097 
                                        ;                    5085   5098 ;
ERROPR: LD  A,2                         ;2175  3e 02         5086   5099 
    LD  (ERRORF),A                      ;2177  32 50 22      5087   5100 
    DEFB    021H                        ;217a  21            5088   5101 
CURTXT: DEFS    2                       ;217b                5089   5102 
    DEC HL                              ;217d  2b            5090   5103 
    LD  (RESTXT),HL                     ;217e  22 8a 22      5091   5104 
    POP AF                              ;2181  f1            5092   5105 
    DEFB    021H                        ;2182  21            5093   5106 
ERRORV: DEFS    2                       ;2183                5094   5107 
    JP  RUNMID                          ;2185  c3 0e 16      5095   5108 
                                        ;                    5096   5109 ;
OMERRE:                                 ;                    5097   5110 
OMERR:  CALL    CLR                     ;2188  cd 51 19      5098   5111 
    EI                                  ;218b  fb            5099   5112 
    LD  SP,(STRTOP)                     ;218c  ed 7b 41 7a   5100   5113 
    LD  (SPBUF),SP                      ;2190  ed 73 25 22   5101   5114 
    LD  A,7                             ;2194  3e 07         5102   5115 
ERROR:  LD  SP,(SPBUF)                  ;2196  ed 7b 25 22   5103   5116 
    PUSH    AF                          ;219a  f5            5104   5117 
    LD  HL,(LNOBUF)                     ;219b  2a cc 16      5105   5118 
    LD  A,H                             ;219e  7c            5106   5119 
    AND L                               ;219f  a5            5107   5120 
    INC A                               ;21a0  3c            5108   5121 
    JR  Z,ERRSML                        ;21a1  28 14         5109   5122 
    POP AF                              ;21a3  f1            5110   5123 
    LD  (ERRLNO),HL                     ;21a4  22 65 22      5111   5124 
    LD  (ERRCOD),A                      ;21a7  32 95 22      5112   5125 
    LD  HL,(NXTLPT)                     ;21aa  2a 12 16      5113   5126 
    LD  (ERNLPT),HL                     ;21ad  22 5f 22      5114   5127 
    PUSH    AF                          ;21b0  f5            5115   5128 
    LD  A,(ERRORF)                      ;21b1  3a 50 22      5116   5129 
    DEC A                               ;21b4  3d            5117   5130 
    JR  Z,ERROPR                        ;21b5  28 be         5118   5131 
ERRSML: CALL    CR2                     ;21b7  cd 23 08      5119   5132 
    LD  A,1                             ;21ba  3e 01         5120   5133 
    LD  (DISFLG),A                      ;21bc  32 eb 11      5121   5134 
    POP AF                              ;21bf  f1            5122   5135 
    OR  A                               ;21c0  b7            5123   5136 
    JR  Z,UNPERR                        ;21c1  28 14         5124   5137 
    CP  32                              ;21c3  fe 20         5125   5138 
    JR  NC,UNPERR                       ;21c5  30 10         5126   5139 
    LD  DE,ERRTXT                       ;21c7  11 b2 69      5127   5140 
    LD  B,A                             ;21ca  47            5128   5141 
ERRTCO: LD  A,(DE)                      ;21cb  1a            5129   5142 
    INC DE                              ;21cc  13            5130   5143 
    OR  A                               ;21cd  b7            5131   5144 
    JR  NZ,ERRTCO                       ;21ce  20 fb         5132   5145 
    DEC B                               ;21d0  05            5133   5146 
    JR  NZ,ERRTCO                       ;21d1  20 f8         5134   5147 
    LD  A,(DE)                          ;21d3  1a            5135   5148 
    INC A                               ;21d4  3c            5136   5149 
    JR  NZ,ERRLOP                       ;21d5  20 03         5137   5150 
UNPERR: LD  DE,UNPMES                   ;21d7  11 e5 21      5138   5151 
ERRLOP: LD  A,(DE)                      ;21da  1a            5139   5152 
    OR  A                               ;21db  b7            5140   5153 
    JP  Z,LNOPRT                        ;21dc  ca cb 16      5141   5154 
    CALL    ACCPRT                      ;21df  cd 64 08      5142   5155 
    INC DE                              ;21e2  13            5143   5156 
    JR  ERRLOP                          ;21e3  18 f5         5144   5157 
                                        ;                    5145   5158 
UNPMES: DEFM    'UNPRINTABLE ERROR'     ;21e5  55 4e 50 52   5146   5159 
                                        ;21e9  49 4e 54 41   5146   5160
                                        ;21ed  42 4c 45 20   5146   5161
                                        ;21f1  45 52 52 4f   5146   5162
                                        ;21f5  52            5146   5163
    DEFB    000H                        ;21f6  00            5147   5164 
                                        ;                    5148   5165 ;
OKMES:  DEFM    'OK'                    ;21f7  4f 4b         5149   5166 
                                        ;                    5150   5167 ;
SETSSP: LD  HL,00000h                   ;21f9  21 00 00      5151   5168 
    LD  (FUNCNS),HL                     ;21fc  22 2f 26      5152   5169 
    LD  HL,(INTFAC)                     ;21ff  2a 4b 7a      5153   5170 
    LD  IY,(INTSSP)                     ;2202  fd 2a 43 7a   5154   5171 
    RET                                 ;2206  c9            5155   5172 
                                        ;                    5156   5173 ;
CONT:   DEFB    03EH                    ;2207  3e            5157   5174 
CONTFG: DEFS    1                       ;2208                5158   5175 
    OR  A                               ;2209  b7            5159   5176 
    JR  NZ,OKCONT                       ;220a  20 05         5160   5177 
    LD  A,17                            ;220c  3e 11         5161   5178 
    JP  ERROR                           ;220e  c3 96 21      5162   5179 
                                        ;                    5163   5180 ;
OKCONT: XOR A                           ;2211  af            5164   5181 
    LD  (CONTFG),A                      ;2212  32 08 22      5165   5182 
    DEFB    021H                        ;2215  21            5166   5183 
BLNOBF: DEFS    2                       ;2216                5167   5184 
    LD  (LNOBUF),HL                     ;2218  22 cc 16      5168   5185 
    DEFB    021H                        ;221b  21            5169   5186 
BNXTLP: DEFS    2                       ;221c                5170   5187 
    LD  (NXTLPT),HL                     ;221e  22 12 16      5171   5188 
    DEFB    021H                        ;2221  21            5172   5189 
BTEXTP: DEFS    2                       ;2222                5173   5190 
    DEFB    031H                        ;2224  31            5174   5191 
SPBUF:  DEFS    2                       ;2225                5175   5192 
    JP  SPCCUT                          ;2227  c3 df 14      5176   5193 
                                        ;                    5177   5194 ;
AUTOFF: LD  A,(AUTOVC)                  ;222a  3a 37 22      5178   5195 
    OR  A                               ;222d  b7            5179   5196 
    RET NZ                              ;222e  c0            5180   5197 
    LD  A,0C9h                          ;222f  3e c9         5181   5198 
    LD  (AUTOVC),A                      ;2231  32 37 22      5182   5199 
    JP  HOTENT                          ;2234  c3 46 14      5183   5200 
                                        ;                    5184   5201 ;
AUTOVC: DEFB    0C9H                    ;2237  c9            5185   5202 
    DEFB    021H                        ;2238  21            5186   5203 
AUTOLN: DEFS    2                       ;2239                5187   5204 
    CALL    FIVEPR                      ;223b  cd e5 16      5188   5205 
    CALL    SPPRT                       ;223e  cd 62 08      5189   5206 
    LD  HL,(AUTOLN)                     ;2241  2a 39 22      5190   5207 
    DEFB    011H                        ;2244  11            5191   5208 ;LD DE,?
AUTOST: DEFS    2                       ;2245                5192   5209 
    ADD HL,DE                           ;2247  19            5193   5210 
    LD  (AUTOLN),HL                     ;2248  22 39 22      5194   5211 
    JP  C,AUTOFF                        ;224b  da 2a 22      5195   5212 
    RET                                 ;224e  c9            5196   5213 
                                        ;                    5197   5214 ;
RESUME: DEFB    03EH                    ;224f  3e            5198   5215 
ERRORF: DEFS    1                       ;2250                5199   5216 
    CP  2                               ;2251  fe 02         5200   5217 
    LD  A,20                            ;2253  3e 14         5201   5218 
    JP  NZ,ERROR                        ;2255  c2 96 21      5202   5219 
    LD  A,1                             ;2258  3e 01         5203   5220 
    LD  (ERRORF),A                      ;225a  32 50 22      5204   5221 
    PUSH    HL                          ;225d  e5            5205   5222 
    DEFB    021H                        ;225e  21            5206   5223 ; LD HL,?
ERNLPT: DEFS    2                       ;225f                5207   5224 
    LD  (NXTLPT),HL                     ;2261  22 12 16      5208   5225 
    DEFB    021H                        ;2264  21            5209   5226 ; LD HL,?
ERRLNO: DEFS    2                       ;2265                5210   5227 
    LD  (LNOBUF),HL                     ;2267  22 cc 16      5211   5228 
    POP HL                              ;226a  e1            5212   5229 
    CALL    HLFTCH                      ;226b  cd 87 29      5213   5230 
    CP  03Ah                            ;226e  fe 3a         5214   5231 
    JR  Z,THISLN                        ;2270  28 17         5215   5232 
    OR  A                               ;2272  b7            5216   5233 
    JR  Z,THISLN                        ;2273  28 14         5217   5234 
    CP  0B5h                            ;2275  fe b5         5218   5235 
    JR  Z,RESERR                        ;2277  28 14         5219   5236 
    CP  08Bh                            ;2279  fe 8b         5220   5237 
    JP  NZ,GOTO                         ;227b  c2 b1 43      5221   5238 
    LD  HL,(RESTXT)                     ;227e  2a 8a 22      5222   5239 
    CALL    DATA                        ;2281  cd c8 1c      5223   5240 
    RET NC                              ;2284  d0            5224   5241 
    POP HL                              ;2285  e1            5225   5242 
    JP  NXLINE                          ;2286  c3 11 16      5226   5243 
                                        ;                    5227   5244 ;
THISLN:                                 ;                    5228   5245 
    DEFB    021H                        ;2289  21            5229   5246 
RESTXT: DEFS    2                       ;228a                5230   5247 
    RET                                 ;228c  c9            5231   5248 
                                        ;                    5232   5249 ;
RESERR: XOR A                           ;228d  af            5233   5250 
    LD  (ERRORF),A                      ;228e  32 50 22      5234   5251 
    CALL    THISLN                      ;2291  cd 89 22      5235   5252 
    DEFB    03EH                        ;2294  3e            5236   5253 
ERRCOD: DEFS    1                       ;2295                5237   5254 
    JP  ERROR                           ;2296  c3 96 21      5238   5255 
                                        ;                    5239   5256 ;
                                        ;                    5240   5257 ;	CHAIN	,EXPR
FLEXPR: CALL    SETSSP                  ;2299  cd f9 21      5241   5258 
FLEXP': LD  (IY+0),0                    ;229c  fd 36 00 00   5242   5259 
    CALL    EXPRSN                      ;22a0  cd f2 22      5243   5260 
    PUSH    AF                          ;22a3  f5            5244   5261 
    LD  A,(IY+0)                        ;22a4  fd 7e 00      5245   5262 
    CP  003h                            ;22a7  fe 03         5246   5263 
    JP  Z,TYPEMS                        ;22a9  ca 32 17      5247   5264 
MOTEST: OR  A                           ;22ac  b7            5248   5265 
    JP  Z,MOPRND                        ;22ad  ca bf 25      5249   5266 
    POP AF                              ;22b0  f1            5250   5267 
    RET                                 ;22b1  c9            5251   5268 
                                        ;                    5252   5269 ;
STEXPR: CALL    SETSSP                  ;22b2  cd f9 21      5253   5270 
STEXP': LD  (IY+0),0                    ;22b5  fd 36 00 00   5254   5271 
    CALL    EXPRSN                      ;22b9  cd f2 22      5255   5272 
    PUSH    AF                          ;22bc  f5            5256   5273 
    LD  A,(IY+0)                        ;22bd  fd 7e 00      5257   5274 
    CP  003h                            ;22c0  fe 03         5258   5275 
    JP  NZ,TYPEMS                       ;22c2  c2 32 17      5259   5276 
    JR  MOTEST                          ;22c5  18 e5         5260   5277 
                                        ;                    5261   5278 ;
HLEXP:  CALL    FLEXP'                  ;22c7  cd 9c 22      5262   5279 
    JR  MDLHLE                          ;22ca  18 03         5263   5280 
                                        ;                    5264   5281 ;
IHLEXP: CALL    FLEXPR                  ;22cc  cd 99 22      5265   5282 
MDLHLE: PUSH    AF                      ;22cf  f5            5266   5283 
    CALL    HLFLTO                      ;22d0  cd 97 2d      5267   5284 
    POP AF                              ;22d3  f1            5268   5285 
    RET                                 ;22d4  c9            5269   5286 
                                        ;                    5270   5287 ;
BYTE:   CALL    HLEXP                   ;22d5  cd c7 22      5271   5288 
HCHECK: LD  A,H                         ;22d8  7c            5272   5289 
    OR  A                               ;22d9  b7            5273   5290 
    LD  A,L                             ;22da  7d            5274   5291 
    RET Z                               ;22db  c8            5275   5292 
    JP  IFCALL                          ;22dc  c3 36 17      5276   5293 
                                        ;                    5277   5294 ;
IBYTE:  CALL    IHLEXP                  ;22df  cd cc 22      5278   5295 
    JR  HCHECK                          ;22e2  18 f4         5279   5296 
                                        ;                    5280   5297 ;
TYPECS: LD  A,(IY+0)                    ;22e4  fd 7e 00      5281   5298 
    CP  003h                            ;22e7  fe 03         5282   5299 
    RET NZ                              ;22e9  c0            5283   5300 
    JP  TYPEMS                          ;22ea  c3 32 17      5284   5301 
                                        ;                    5285   5302 ;
TOOCMP: LD  A,16                        ;22ed  3e 10         5286   5303 
    JP  ERROR                           ;22ef  c3 96 21      5287   5304 
                                        ;                    5288   5305 ;
EXPRSN: EX  DE,HL                       ;22f2  eb            5289   5306 
    DEFB    021H                        ;22f3  21            5290   5307 
MEMFAC: DEFS    2                       ;22f4                5291   5308 
    OR  A                               ;22f6  b7            5292   5309 
    SBC HL,DE                           ;22f7  ed 52         5293   5310 
    EX  DE,HL                           ;22f9  eb            5294   5311 
    JR  C,TOOCMP                        ;22fa  38 f1         5295   5312 
    CALL    EXPPH3                      ;22fc  cd 26 23      5296   5313 
XORAGN: CP  0EBh                        ;22ff  fe eb         5297   5314 
    RET NZ                              ;2301  c0            5298   5315 
    CALL    TYPECS                      ;2302  cd e4 22      5299   5316 
    PUSH    HL                          ;2305  e5            5300   5317 
    LD  (IY+0),0                        ;2306  fd 36 00 00   5301   5318 
    CALL    EXPPH3                      ;230a  cd 26 23      5302   5319 
    PUSH    AF                          ;230d  f5            5303   5320 
    CALL    HLFLTO                      ;230e  cd 97 2d      5304   5321 
    POP AF                              ;2311  f1            5305   5322 
    EX  DE,HL                           ;2312  eb            5306   5323 
    POP HL                              ;2313  e1            5307   5324 
    PUSH    AF                          ;2314  f5            5308   5325 
    PUSH    HL                          ;2315  e5            5309   5326 
    CALL    HLFLTO                      ;2316  cd 97 2d      5310   5327 
    LD  A,H                             ;2319  7c            5311   5328 
    XOR D                               ;231a  aa            5312   5329 
    LD  D,A                             ;231b  57            5313   5330 
    LD  A,L                             ;231c  7d            5314   5331 
    XOR E                               ;231d  ab            5315   5332 
    LD  E,A                             ;231e  5f            5316   5333 
    POP HL                              ;231f  e1            5317   5334 
    CALL    FLTHEX                      ;2320  cd 02 29      5318   5335 
    POP AF                              ;2323  f1            5319   5336 
    JR  XORAGN                          ;2324  18 d9         5320   5337 
                                        ;                    5321   5338 ;
EXPPH3: CALL    EXPPH4                  ;2326  cd 50 23      5322   5339 
ORAGN:  CP  0ECh                        ;2329  fe ec         5323   5340 
    RET NZ                              ;232b  c0            5324   5341 
    CALL    TYPECS                      ;232c  cd e4 22      5325   5342 
    PUSH    HL                          ;232f  e5            5326   5343 
    LD  (IY+0),0                        ;2330  fd 36 00 00   5327   5344 
    CALL    EXPPH4                      ;2334  cd 50 23      5328   5345 
    PUSH    AF                          ;2337  f5            5329   5346 
    CALL    HLFLTO                      ;2338  cd 97 2d      5330   5347 
    POP AF                              ;233b  f1            5331   5348 
    EX  DE,HL                           ;233c  eb            5332   5349 
    POP HL                              ;233d  e1            5333   5350 
    PUSH    AF                          ;233e  f5            5334   5351 
    PUSH    HL                          ;233f  e5            5335   5352 
    CALL    HLFLTO                      ;2340  cd 97 2d      5336   5353 
    LD  A,H                             ;2343  7c            5337   5354 
    OR  D                               ;2344  b2            5338   5355 
    LD  D,A                             ;2345  57            5339   5356 
    LD  A,L                             ;2346  7d            5340   5357 
    OR  E                               ;2347  b3            5341   5358 
    LD  E,A                             ;2348  5f            5342   5359 
    POP HL                              ;2349  e1            5343   5360 
    CALL    FLTHEX                      ;234a  cd 02 29      5344   5361 
    POP AF                              ;234d  f1            5345   5362 
    JR  ORAGN                           ;234e  18 d9         5346   5363 
                                        ;                    5347   5364 ;
EXPPH4: CALL    EXPPH5                  ;2350  cd 7b 23      5348   5365 
ANDAGN: CP  0EDh                        ;2353  fe ed         5349   5366 
    RET NZ                              ;2355  c0            5350   5367 
    CALL    TYPECS                      ;2356  cd e4 22      5351   5368 
    PUSH    HL                          ;2359  e5            5352   5369 
    LD  (IY+0),0                        ;235a  fd 36 00 00   5353   5370 
    CALL    EXPPH5                      ;235e  cd 7b 23      5354   5371 
    PUSH    AF                          ;2361  f5            5355   5372 
    CALL    HLFLTO                      ;2362  cd 97 2d      5356   5373 
    POP AF                              ;2365  f1            5357   5374 
    EX  DE,HL                           ;2366  eb            5358   5375 
    POP HL                              ;2367  e1            5359   5376 
    PUSH    AF                          ;2368  f5            5360   5377 
    PUSH    HL                          ;2369  e5            5361   5378 
    CALL    HLFLTO                      ;236a  cd 97 2d      5362   5379 
    LD  A,H                             ;236d  7c            5363   5380 
    AND D                               ;236e  a2            5364   5381 
    LD  D,A                             ;236f  57            5365   5382 
    LD  A,L                             ;2370  7d            5366   5383 
    AND E                               ;2371  a3            5367   5384 
    LD  E,A                             ;2372  5f            5368   5385 
    POP HL                              ;2373  e1            5369   5386 
    CALL    FLTHEX                      ;2374  cd 02 29      5370   5387 
    POP AF                              ;2377  f1            5371   5388 
    JP  ANDAGN                          ;2378  c3 53 23      5372   5389 
                                        ;                    5373   5390 ;
EXPPH5: CALL    BCFTCH                  ;237b  cd c4 25      5374   5391 
    DEC BC                              ;237e  0b            5375   5392 
    CP  0EEh                            ;237f  fe ee         5376   5393 
    JP  NZ,EXPPH6                       ;2381  c2 9d 23      5377   5394 
    INC BC                              ;2384  03            5378   5395 
    CALL    EXPPH6                      ;2385  cd 9d 23      5379   5396 
    PUSH    AF                          ;2388  f5            5380   5397 
    CALL    TYPECS                      ;2389  cd e4 22      5381   5398 
    PUSH    HL                          ;238c  e5            5382   5399 
    CALL    HLFLTO                      ;238d  cd 97 2d      5383   5400 
    LD  A,L                             ;2390  7d            5384   5401 
    CPL                                 ;2391  2f            5385   5402 
    LD  L,A                             ;2392  6f            5386   5403 
    LD  A,H                             ;2393  7c            5387   5404 
    CPL                                 ;2394  2f            5388   5405 
    LD  H,A                             ;2395  67            5389   5406 
    EX  DE,HL                           ;2396  eb            5390   5407 
    POP HL                              ;2397  e1            5391   5408 
    CALL    FLTHEX                      ;2398  cd 02 29      5392   5409 
    POP AF                              ;239b  f1            5393   5410 
    RET                                 ;239c  c9            5394   5411 
                                        ;                    5395   5412 ;
EXPPH6: CALL    EXPR1                   ;239d  cd 0e 24      5396   5413 
LOGLP:  CP  0EFh                        ;23a0  fe ef         5397   5414 
    RET C                               ;23a2  d8            5398   5415 
    PUSH    AF                          ;23a3  f5            5399   5416 
    PUSH    HL                          ;23a4  e5            5400   5417 
    CALL    EXPR1                       ;23a5  cd 0e 24      5401   5418 
    EX  DE,HL                           ;23a8  eb            5402   5419 
    POP HL                              ;23a9  e1            5403   5420 
    EX  AF,AF'                          ;23aa  08            5404   5421 
    POP AF                              ;23ab  f1            5405   5422 
    EX  AF,AF'                          ;23ac  08            5406   5423 
    PUSH    AF                          ;23ad  f5            5407   5424 
    EX  AF,AF'                          ;23ae  08            5408   5425 
    CP  0F6h                            ;23af  fe f6         5409   5426 
    JR  C,EQUALG                        ;23b1  38 2d         5410   5427 
    JR  Z,GTTHAN                        ;23b3  28 22         5411   5428 
    CALL    CMP                         ;23b5  cd d6 61      5412   5429 
LDGTCM: JR  Z,FALSE                     ;23b8  28 12         5413   5430 
    JR  NC,FALSE                        ;23ba  30 10         5414   5431 
TRUE:   PUSH    DE                      ;23bc  d5            5415   5432 
    PUSH    HL                          ;23bd  e5            5416   5433 
    PUSH    BC                          ;23be  c5            5417   5434 
    EX  DE,HL                           ;23bf  eb            5418   5435 
    CALL    LDIR1                       ;23c0  cd a3 73      5419   5436 
    POP BC                              ;23c3  c1            5420   5437 
    POP HL                              ;23c4  e1            5421   5438 
    CALL    TOGLE                       ;23c5  cd eb 6b      5422   5439 
    POP DE                              ;23c8  d1            5423   5440 
LGBACK: POP AF                          ;23c9  f1            5424   5441 
    JR  LOGLP                           ;23ca  18 d4         5425   5442 
                                        ;                    5426   5443 ;
FALSE:  PUSH    BC                      ;23cc  c5            5427   5444 
    LD  B,8                             ;23cd  06 08         5428   5445 
    EX  DE,HL                           ;23cf  eb            5429   5446 
    CALL    ZFILL                       ;23d0  cd 10 62      5430   5447 
    POP BC                              ;23d3  c1            5431   5448 
    EX  DE,HL                           ;23d4  eb            5432   5449 
    JR  LGBACK                          ;23d5  18 f2         5433   5450 
                                        ;                    5434   5451 ;
GTTHAN: CALL    CMP                     ;23d7  cd d6 61      5435   5452 
    CCF                                 ;23da  3f            5436   5453 
    JR  LDGTCM                          ;23db  18 db         5437   5454 
                                        ;                    5438   5455 ;
PORTRU: POP AF                          ;23dd  f1            5439   5456 
    JR  TRUE                            ;23de  18 dc         5440   5457 
                                        ;                    5441   5458 ;
EQUALG: CP  0F5h                        ;23e0  fe f5         5442   5459 
    JR  C,ALGLOG                        ;23e2  38 07         5443   5460 
    CALL    CMP                         ;23e4  cd d6 61      5444   5461 
    JR  Z,TRUE                          ;23e7  28 d3         5445   5462 
    JR  FALSE                           ;23e9  18 e1         5446   5463 
                                        ;                    5447   5464 ;
ALGLOG: CP  0F1h                        ;23eb  fe f1         5448   5465 
    JP  C,NOTEQU                        ;23ed  da 07 24      5449   5466 
    PUSH    AF                          ;23f0  f5            5450   5467 
    CALL    CMP                         ;23f1  cd d6 61      5451   5468 
    JR  Z,PORTRU                        ;23f4  28 e7         5452   5469 
    EX  AF,AF'                          ;23f6  08            5453   5470 
    POP AF                              ;23f7  f1            5454   5471 
    CP  0F2h                            ;23f8  fe f2         5455   5472 
    JR  Z,GTEQLG                        ;23fa  28 07         5456   5473 
    CP  0F4h                            ;23fc  fe f4         5457   5474 
    JR  Z,GTEQLG                        ;23fe  28 03         5458   5475 
    EX  AF,AF'                          ;2400  08            5459   5476 
    JR  LDGTCM                          ;2401  18 b5         5460   5477 
GTEQLG: EX  AF,AF'                      ;2403  08            5461   5478 
    CCF                                 ;2404  3f            5462   5479 
    JR  LDGTCM                          ;2405  18 b1         5463   5480 
                                        ;                    5464   5481 ;
NOTEQU: CALL    CMP                     ;2407  cd d6 61      5465   5482 
    JR  Z,FALSE                         ;240a  28 c0         5466   5483 
    JR  TRUE                            ;240c  18 ae         5467   5484 
                                        ;                    5468   5485 ;
EXPR1:  CALL    TERM                    ;240e  cd 33 24      5469   5486 
EXPR':  CP  0F8h                        ;2411  fe f8         5470   5487 
    RET C                               ;2413  d8            5471   5488 
    PUSH    HL                          ;2414  e5            5472   5489 
    JR  Z,EXADD                         ;2415  28 0f         5473   5490 
    CALL    TERM                        ;2417  cd 33 24      5474   5491 
    EX  DE,HL                           ;241a  eb            5475   5492 
    POP HL                              ;241b  e1            5476   5493 
    PUSH    BC                          ;241c  c5            5477   5494 
EXPRBK: PUSH    AF                      ;241d  f5            5478   5495 
    CALL    SUB                         ;241e  cd d1 6b      5479   5496 
EXPRBK1:                                ;                    5480   5497 
    POP AF                              ;2421  f1            5481   5498 
    POP BC                              ;2422  c1            5482   5499 
    JP  EXPR'                           ;2423  c3 11 24      5483   5500 
                                        ;                    5484   5501 ;
EXADD:  CALL    TERM                    ;2426  cd 33 24      5485   5502 
    EX  DE,HL                           ;2429  eb            5486   5503 
    POP HL                              ;242a  e1            5487   5504 
    PUSH    BC                          ;242b  c5            5488   5505 
    PUSH    AF                          ;242c  f5            5489   5506 
    CALL    ADD                         ;242d  cd a6 6c      5490   5507 
    JP  EXPRBK1                         ;2430  c3 21 24      5491   5508 
                                        ;                    5492   5509 ;
TERM:   CALL    MFACT                   ;2433  cd 5b 24      5493   5510 
TERM':  CP  0FAh                        ;2436  fe fa         5494   5511 ; /
    RET C                               ;2438  d8            5495   5512 
    PUSH    HL                          ;2439  e5            5496   5513 
    JR  NZ,TMDIV                        ;243a  20 0f         5497   5514 
    CALL    MFACT                       ;243c  cd 5b 24      5498   5515 
    EX  DE,HL                           ;243f  eb            5499   5516 
    POP HL                              ;2440  e1            5500   5517 
    PUSH    BC                          ;2441  c5            5501   5518 
    PUSH    AF                          ;2442  f5            5502   5519 
    CALL    MOD_                        ;2443  cd 4f 61      5503   5520 
TERMBK: POP AF                          ;2446  f1            5504   5521 
    POP BC                              ;2447  c1            5505   5522 
    JP  TERM'                           ;2448  c3 36 24      5506   5523 
                                        ;                    5507   5524 ;
TMDIV:  CALL    MFACT                   ;244b  cd 5b 24      5508   5525 
    EX  DE,HL                           ;244e  eb            5509   5526 
    POP HL                              ;244f  e1            5510   5527 
    PUSH    BC                          ;2450  c5            5511   5528 
    PUSH    AF                          ;2451  f5            5512   5529 
    CALL    DIV                         ;2452  cd bd 70      5513   5530 
    CALL    INT                         ;2455  cd 10 60      5514   5531 
    JP  TERMBK                          ;2458  c3 46 24      5515   5532 
                                        ;                    5516   5533 ;
MFACT:  CALL    FACT                    ;245b  cd 8f 24      5517   5534 
MFACT': CP  0FCh                        ;245e  fe fc         5518   5535 ; MOD
    RET C                               ;2460  d8            5519   5536 
    PUSH    HL                          ;2461  e5            5520   5537 
    JR  Z,TMMOD                         ;2462  28 0f         5521   5538 
    CALL    FACT                        ;2464  cd 8f 24      5522   5539 
    EX  DE,HL                           ;2467  eb            5523   5540 
    POP HL                              ;2468  e1            5524   5541 
    PUSH    BC                          ;2469  c5            5525   5542 
    PUSH    AF                          ;246a  f5            5526   5543 
    CALL    MUL                         ;246b  cd e0 6f      5527   5544 
MFACBK: POP AF                          ;246e  f1            5528   5545 
    POP BC                              ;246f  c1            5529   5546 
    JP  MFACT'                          ;2470  c3 5e 24      5530   5547 
                                        ;                    5531   5548 ;
TMMOD:  CALL    FACT                    ;2473  cd 8f 24      5532   5549 
    EX  DE,HL                           ;2476  eb            5533   5550 
    POP HL                              ;2477  e1            5534   5551 
    PUSH    BC                          ;2478  c5            5535   5552 
    PUSH    AF                          ;2479  f5            5536   5553 
    CALL    DIV                         ;247a  cd bd 70      5537   5554 
    JP  MFACBK                          ;247d  c3 6e 24      5538   5555 
                                        ;                    5539   5556 ;
POWZRR: POP HL                          ;2480  e1            5540   5557 
    PUSH    HL                          ;2481  e5            5541   5558 
    EX  DE,HL                           ;2482  eb            5542   5559 
    PUSH    BC                          ;2483  c5            5543   5560 
    CALL    LDIR1                       ;2484  cd a3 73      5544   5561 
    POP BC                              ;2487  c1            5545   5562 
    POP HL                              ;2488  e1            5546   5563 
POWAGN: DEC BC                          ;2489  0b            5547   5564 
    CALL    BCFTCH                      ;248a  cd c4 25      5548   5565 
    JR  MIDFAP                          ;248d  18 03         5549   5566 
                                        ;                    5550   5567 ;
FACT:   CALL    FACT''                  ;248f  cd 5f 25      5551   5568 
MIDFAP: CP  0FEh                        ;2492  fe fe         5552   5569 
    RET NZ                              ;2494  c0            5553   5570 
    PUSH    HL                          ;2495  e5            5554   5571 
    CALL    FACT''                      ;2496  cd 5f 25      5555   5572 
    LD  A,(HL)                          ;2499  7e            5556   5573 
    OR  A                               ;249a  b7            5557   5574 
    JR  Z,POWZRR                        ;249b  28 e3         5558   5575 
    INC HL                              ;249d  23            5559   5576 
    BIT 7,(HL)                          ;249e  cb 7e         5560   5577 
    RES 7,(HL)                          ;24a0  cb be         5561   5578 
    DEC HL                              ;24a2  2b            5562   5579 
    JR  NZ,MPOWER                       ;24a3  20 07         5563   5580 
    EX  DE,HL                           ;24a5  eb            5564   5581 
    POP HL                              ;24a6  e1            5565   5582 
    CALL    POWER                       ;24a7  cd c6 24      5566   5583 
    JR  POWAGN                          ;24aa  18 dd         5567   5584 
                                        ;                    5568   5585 ;
MPOWER: EX  DE,HL                       ;24ac  eb            5569   5586 
    POP HL                              ;24ad  e1            5570   5587 
    PUSH    HL                          ;24ae  e5            5571   5588 
    PUSH    DE                          ;24af  d5            5572   5589 
    CALL    POWER                       ;24b0  cd c6 24      5573   5590 
    POP DE                              ;24b3  d1            5574   5591 
    PUSH    DE                          ;24b4  d5            5575   5592 
    PUSH    BC                          ;24b5  c5            5576   5593 
    CALL    LDIR1                       ;24b6  cd a3 73      5577   5594 
    POP BC                              ;24b9  c1            5578   5595 
    POP DE                              ;24ba  d1            5579   5596 
    POP HL                              ;24bb  e1            5580   5597 
    CALL    PSWAP                       ;24bc  cd 42 25      5581   5598 
    PUSH    BC                          ;24bf  c5            5582   5599 
    CALL    DIV                         ;24c0  cd bd 70      5583   5600 
    POP BC                              ;24c3  c1            5584   5601 
    JR  POWAGN                          ;24c4  18 c3         5585   5602 
                                        ;                    5586   5603 ;
POWER:  PUSH    BC                      ;24c6  c5            5587   5604 
    PUSH    HL                          ;24c7  e5            5588   5605 
    PUSH    DE                          ;24c8  d5            5589   5606 
    LD  HL,8                            ;24c9  21 08 00      5590   5607 
    ADD HL,DE                           ;24cc  19            5591   5608 
    EX  DE,HL                           ;24cd  eb            5592   5609 
    PUSH    DE                          ;24ce  d5            5593   5610 
    CALL    LDIR8                       ;24cf  cd a6 73      5594   5611 
    POP HL                              ;24d2  e1            5595   5612 
    CALL    INT                         ;24d3  cd 10 60      5596   5613 
    EX  DE,HL                           ;24d6  eb            5597   5614 
    POP HL                              ;24d7  e1            5598   5615 
    CALL    CMP                         ;24d8  cd d6 61      5599   5616 
    JR  Z,IPOWER                        ;24db  28 12         5600   5617 
RPOWER: POP DE                          ;24dd  d1            5601   5618 
    PUSH    DE                          ;24de  d5            5602   5619 
    CALL    PSWAP                       ;24df  cd 42 25      5603   5620 
    CALL    B_LOG                       ;24e2  cd bd 78      5604   5621 
    EX  DE,HL                           ;24e5  eb            5605   5622 
    POP HL                              ;24e6  e1            5606   5623 
    CALL    MUL                         ;24e7  cd e0 6f      5607   5624 
    CALL    B_EXP                       ;24ea  cd ca 77      5608   5625 
    POP BC                              ;24ed  c1            5609   5626 
    RET                                 ;24ee  c9            5610   5627 
                                        ;                    5611   5628 
IPOWER: LD  A,(HL)                      ;24ef  7e            5612   5629 
    CP  086h                            ;24f0  fe 86         5613   5630 
    JR  NC,RPOWER                       ;24f2  30 e9         5614   5631 
    EX  (SP),HL                         ;24f4  e3            5615   5632 
    LD  A,(HL)                          ;24f5  7e            5616   5633 
    EX  (SP),HL                         ;24f6  e3            5617   5634 
    CP  088h                            ;24f7  fe 88         5618   5635 
    JR  NC,RPOWER                       ;24f9  30 e2         5619   5636 
    CALL    HLFLTO                      ;24fb  cd 97 2d      5620   5637 ; 0 END
    LD  A,L                             ;24fe  7d            5621   5638 
    POP HL                              ;24ff  e1            5622   5639 
    PUSH    AF                          ;2500  f5            5623   5640 ; BIT-P
    PUSH    HL                          ;2501  e5            5624   5641 ; FAC
    LD  DE,KEYBUF                       ;2502  11 4f 7a      5625   5642 
    PUSH    DE                          ;2505  d5            5626   5643 
    CALL    LDIR8                       ;2506  cd a6 73      5627   5644 
    POP HL                              ;2509  e1            5628   5645 ;ZFAC
    LD  B,4                             ;250a  06 04         5629   5646 ;RCOUNT
PWCLLP: PUSH    BC                      ;250c  c5            5630   5647 
    EX  DE,HL                           ;250d  eb            5631   5648 
    LD  HL,00008h                       ;250e  21 08 00      5632   5649 
    ADD HL,DE                           ;2511  19            5633   5650 
    EX  DE,HL                           ;2512  eb            5634   5651 
    CALL    LDIR8                       ;2513  cd a6 73      5635   5652 
    LD  E,L                             ;2516  5d            5636   5653 
    LD  D,H                             ;2517  54            5637   5654 
    CALL    MUL                         ;2518  cd e0 6f      5638   5655 
    POP BC                              ;251b  c1            5639   5656 
    DJNZ    PWCLLP                      ;251c  10 ee         5640   5657 
    POP HL                              ;251e  e1            5641   5658 
    PUSH    HL                          ;251f  e5            5642   5659 
    EX  DE,HL                           ;2520  eb            5643   5660 
    CALL    LDIR1                       ;2521  cd a3 73      5644   5661 
    POP HL                              ;2524  e1            5645   5662 
    POP AF                              ;2525  f1            5646   5663 
    LD  DE,KEYBUF                       ;2526  11 4f 7a      5647   5664 
    LD  B,5                             ;2529  06 05         5648   5665 
PWCLL1: RRCA                            ;252b  0f            5649   5666 
    JR  NC,NEXTPL                       ;252c  30 09         5650   5667 
    PUSH    AF                          ;252e  f5            5651   5668 
    PUSH    BC                          ;252f  c5            5652   5669 
    PUSH    DE                          ;2530  d5            5653   5670 
    CALL    MUL                         ;2531  cd e0 6f      5654   5671 
    POP DE                              ;2534  d1            5655   5672 
    POP BC                              ;2535  c1            5656   5673 
    POP AF                              ;2536  f1            5657   5674 
NEXTPL: PUSH    HL                      ;2537  e5            5658   5675 
    LD  HL,8                            ;2538  21 08 00      5659   5676 
    ADD HL,DE                           ;253b  19            5660   5677 
    EX  DE,HL                           ;253c  eb            5661   5678 
    POP HL                              ;253d  e1            5662   5679 
    DJNZ    PWCLL1                      ;253e  10 eb         5663   5680 
    POP BC                              ;2540  c1            5664   5681 
    RET                                 ;2541  c9            5665   5682 
                                        ;                    5666   5683 ;
PSWAP:  PUSH    BC                      ;2542  c5            5667   5684 
    PUSH    HL                          ;2543  e5            5668   5685 
    PUSH    DE                          ;2544  d5            5669   5686 
    EX  DE,HL                           ;2545  eb            5670   5687 
    LD  DE,ZFAC                         ;2546  11 f2 62      5671   5688 
    CALL    LDIR8                       ;2549  cd a6 73      5672   5689 
    POP DE                              ;254c  d1            5673   5690 
    POP HL                              ;254d  e1            5674   5691 
    PUSH    DE                          ;254e  d5            5675   5692 
    PUSH    HL                          ;254f  e5            5676   5693 
    CALL    LDIR8                       ;2550  cd a6 73      5677   5694 
    POP DE                              ;2553  d1            5678   5695 
    PUSH    DE                          ;2554  d5            5679   5696 
    LD  HL,ZFAC                         ;2555  21 f2 62      5680   5697 
    CALL    LDIR8                       ;2558  cd a6 73      5681   5698 
    POP HL                              ;255b  e1            5682   5699 
    POP DE                              ;255c  d1            5683   5700 
    POP BC                              ;255d  c1            5684   5701 
    RET                                 ;255e  c9            5685   5702 
                                        ;                    5686   5703 
FACT'': CALL    BCFTCH                  ;255f  cd c4 25      5687   5704 
    CP  020h                            ;2562  fe 20         5688   5705 
    JP  C,CONST                         ;2564  da cc 25      5689   5706 
    CP  0F8h                            ;2567  fe f8         5690   5707 
    JR  Z,FACT''                        ;2569  28 f4         5691   5708 
    CP  0F9h                            ;256b  fe f9         5692   5709 
    JP  Z,INUSE                         ;256d  ca 85 25      5693   5710 
    CP  041h                            ;2570  fe 41         5694   5711 
    JP  NC,VARFUN                       ;2572  d2 24 26      5695   5712 
    CP  028h                            ;2575  fe 28         5696   5713 
    JR  Z,KAKKO                         ;2577  28 1d         5697   5714 
    CP  029h                            ;2579  fe 29         5698   5715 
    JP  Z,SERROR                        ;257b  ca 3a 17      5699   5716 
    CP  022h                            ;257e  fe 22         5700   5717 
    JP  Z,STRFAC                        ;2580  ca b5 28      5701   5718 
    JR  MOCHCK                          ;2583  18 32         5702   5719 
                                        ;                    5703   5720 ;
INUSE:  CALL    FACT''                  ;2585  cd 5f 25      5704   5721 
    PUSH    AF                          ;2588  f5            5705   5722 
    LD  A,(IY+0)                        ;2589  fd 7e 00      5706   5723 
    CP  003h                            ;258c  fe 03         5707   5724 
    JP  Z,TYPEMS                        ;258e  ca 32 17      5708   5725 
    CALL    TOGLE                       ;2591  cd eb 6b      5709   5726 
    POP AF                              ;2594  f1            5710   5727 
    RET                                 ;2595  c9            5711   5728 
                                        ;                    5712   5729 ;
KAKKO:  DEC IY                          ;2596  fd 2b         5713   5730 
    LD  (IY+0),0                        ;2598  fd 36 00 00   5714   5731 
    CALL    EXPRSN                      ;259c  cd f2 22      5715   5732 
    CALL    CH29H                       ;259f  cd 66 2d      5716   5733 
    LD  A,(IY+0)                        ;25a2  fd 7e 00      5717   5734 
    INC IY                              ;25a5  fd 23         5718   5735 
    CP  003h                            ;25a7  fe 03         5719   5736 
    JR  Z,CONDSB                        ;25a9  28 06         5720   5737 
    CALL    CONDFL                      ;25ab  cd eb 28      5721   5738 
    JP  BCFTCH                          ;25ae  c3 c4 25      5722   5739 
                                        ;                    5723   5740 ;
CONDSB: CALL    CONDSR                  ;25b1  cd d9 28      5724   5741 
    JP  BCFTCH                          ;25b4  c3 c4 25      5725   5742 
                                        ;                    5726   5743 ;
MOCHCK: LD  D,A                         ;25b7  57            5727   5744 
    XOR A                               ;25b8  af            5728   5745 
    CP  (IY+0)                          ;25b9  fd be 00      5729   5746 
    LD  A,D                             ;25bc  7a            5730   5747 
    DEC BC                              ;25bd  0b            5731   5748 
    RET Z                               ;25be  c8            5732   5749 
MOPRND: LD  A,22                        ;25bf  3e 16         5733   5750 
    JP  ERROR                           ;25c1  c3 96 21      5734   5751 
                                        ;                    5735   5752 ;
BCFTCH: LD  A,(BC)                      ;25c4  0a            5736   5753 
    INC BC                              ;25c5  03            5737   5754 
    CP  020h                            ;25c6  fe 20         5738   5755 
    RET NZ                              ;25c8  c0            5739   5756 
    JP  BCFTCH                          ;25c9  c3 c4 25      5740   5757 
                                        ;                    5741   5758 ;
CONST:  CP  00Bh                        ;25cc  fe 0b         5742   5759 
    JR  NC,HXORFL                       ;25ce  30 16         5743   5760 
    OR  A                               ;25d0  b7            5744   5761 
    JR  Z,MOPRND                        ;25d1  28 ec         5745   5762 
    DEC A                               ;25d3  3d            5746   5763 
    LD  DE,00008h                       ;25d4  11 08 00      5747   5764 
    ADD HL,DE                           ;25d7  19            5748   5765 
    LD  E,A                             ;25d8  5f            5749   5766 
    LD  D,0                             ;25d9  16 00         5750   5767 
FLTHXB: LD  A,004h                      ;25db  3e 04         5751   5768 
    CALL    CONDFL                      ;25dd  cd eb 28      5752   5769 
    CALL    FLTHEX                      ;25e0  cd 02 29      5753   5770 
BCKFTR: JP  BCFTCH                      ;25e3  c3 c4 25      5754   5771 
                                        ;                    5755   5772 ;
HXORFL: CP  014h                        ;25e6  fe 14         5756   5773 
    JR  NC,FLTPNT                       ;25e8  30 19         5757   5774 
    CP  00Bh                            ;25ea  fe 0b         5758   5775 
    LD  DE,00008h                       ;25ec  11 08 00      5759   5776 
    ADD HL,DE                           ;25ef  19            5760   5777 
    JR  Z,LNOCON                        ;25f0  28 08         5761   5778 
LDELNO: LD  A,(BC)                      ;25f2  0a            5762   5779 
    LD  E,A                             ;25f3  5f            5763   5780 
    INC BC                              ;25f4  03            5764   5781 
    LD  A,(BC)                          ;25f5  0a            5765   5782 
    LD  D,A                             ;25f6  57            5766   5783 
    INC BC                              ;25f7  03            5767   5784 
    JR  FLTHXB                          ;25f8  18 e1         5768   5785 
                                        ;                    5769   5786 ;
LNOCON: CALL    LDELNO                  ;25fa  cd f2 25      5770   5787 
    PUSH    AF                          ;25fd  f5            5771   5788 
    CALL    ADJERL                      ;25fe  cd 78 37      5772   5789 
    POP AF                              ;2601  f1            5773   5790 
    RET                                 ;2602  c9            5774   5791 
                                        ;                    5775   5792 ;
FLTPNT: CP  019h                        ;2603  fe 19         5776   5793 
    JP  NC,SERROR                       ;2605  d2 3a 17      5777   5794 
    LD  DE,00008h                       ;2608  11 08 00      5778   5795 
    ADD HL,DE                           ;260b  19            5779   5796 
    AND 00Fh                            ;260c  e6 0f         5780   5797 
    CALL    CONDFL                      ;260e  cd eb 28      5781   5798 
    CP  004h                            ;2611  fe 04         5782   5799 
    CALL    Z,CLRFAC                    ;2613  cc a9 28      5783   5800 
    PUSH    HL                          ;2616  e5            5784   5801 
    EX  DE,HL                           ;2617  eb            5785   5802 
    LD  L,C                             ;2618  69            5786   5803 
    LD  H,B                             ;2619  60            5787   5804 
    LD  B,000h                          ;261a  06 00         5788   5805 
    LD  C,A                             ;261c  4f            5789   5806 
    LDIR                                ;261d  ed b0         5790   5807 
    LD  C,L                             ;261f  4d            5791   5808 
    LD  B,H                             ;2620  44            5792   5809 
    POP HL                              ;2621  e1            5793   5810 
    JR  BCKFTR                          ;2622  18 bf         5794   5811 
                                        ;                    5795   5812 ;
VARFUN: CP  0FFh                        ;2624  fe ff         5796   5813 
    JP  Z,FCTION                        ;2626  ca 61 27      5797   5814 
    CP  05Ch                            ;2629  fe 5c         5798   5815 
    JP  NC,SERROR                       ;262b  d2 3a 17      5799   5816 
    DEFB    011H                        ;262e  11            5800   5817 ;LD DE,
FUNCNS: DEFS    2                       ;262f                5801   5818 
    EX  AF,AF'                          ;2631  08            5802   5819 
    LD  A,E                             ;2632  7b            5803   5820 
    OR  D                               ;2633  b2            5804   5821 
    JR  NZ,FUNGVR                       ;2634  20 3d         5805   5822 
    EX  AF,AF'                          ;2636  08            5806   5823 
VARFNE: LD  DE,00008h                   ;2637  11 08 00      5807   5824 
    ADD HL,DE                           ;263a  19            5808   5825 
    EX  DE,HL                           ;263b  eb            5809   5826 
    CALL    GETVAR                      ;263c  cd da 1e      5810   5827 
    EX  DE,HL                           ;263f  eb            5811   5828 
    CALL    CLRFAC                      ;2640  cd a9 28      5812   5829 
    PUSH    HL                          ;2643  e5            5813   5830 
    PUSH    BC                          ;2644  c5            5814   5831 
    CP  003h                            ;2645  fe 03         5815   5832 
    JR  Z,STRVAR                        ;2647  28 13         5816   5833 
    CP  002h                            ;2649  fe 02         5817   5834 
    JR  Z,INTVAR                        ;264b  28 17         5818   5835 
    CALL    CONDFL                      ;264d  cd eb 28      5819   5836 
    LD  B,A                             ;2650  47            5820   5837 
VARTR#: LD  A,(DE)                      ;2651  1a            5821   5838 
    LD  (HL),A                          ;2652  77            5822   5839 
    INC HL                              ;2653  23            5823   5840 
    INC DE                              ;2654  13            5824   5841 
    DJNZ    VARTR#                      ;2655  10 fa         5825   5842 
RTVARI: POP BC                          ;2657  c1            5826   5843 
    POP HL                              ;2658  e1            5827   5844 
    JP  BCFTCH                          ;2659  c3 c4 25      5828   5845 
                                        ;                    5829   5846 ;
STRVAR: CALL    CONDSR                  ;265c  cd d9 28      5830   5847 
    LD  (HL),E                          ;265f  73            5831   5848 
    INC HL                              ;2660  23            5832   5849 
    LD  (HL),D                          ;2661  72            5833   5850 
    JR  RTVARI                          ;2662  18 f3         5834   5851 
                                        ;                    5835   5852 ;
INTVAR: LD  A,004h                      ;2664  3e 04         5836   5853 
    CALL    CONDFL                      ;2666  cd eb 28      5837   5854 
    EX  DE,HL                           ;2669  eb            5838   5855 
    CALL    INDRCT                      ;266a  cd a3 2a      5839   5856 
    EX  DE,HL                           ;266d  eb            5840   5857 
    CALL    FLTHEX                      ;266e  cd 02 29      5841   5858 
    JR  RTVARI                          ;2671  18 e4         5842   5859 
                                        ;                    5843   5860 ;
FUNGVR: EX  AF,AF'                      ;2673  08            5844   5861 
    PUSH    HL                          ;2674  e5            5845   5862 
    PUSH    AF                          ;2675  f5            5846   5863 
    PUSH    BC                          ;2676  c5            5847   5864 
    CALL    VSRTST                      ;2677  cd fe 20      5848   5865 
    LD  (FNBCPT),BC                     ;267a  ed 43 c3 26   5849   5866 
    CP  028h                            ;267e  fe 28         5850   5867 
    JR  NZ,EFCT1                        ;2680  20 05         5851   5868 
NFCVAR: POP BC                          ;2682  c1            5852   5869 
    POP AF                              ;2683  f1            5853   5870 
    POP HL                              ;2684  e1            5854   5871 
    JR  VARFNE                          ;2685  18 b0         5855   5872 
                                        ;                    5856   5873 ;
EFCT1:  LD  A,E                         ;2687  7b            5857   5874 
    LD  (CPIMDP),A                      ;2688  32 ad 26      5858   5875 
    LD  (CPIMDQ),A                      ;268b  32 ba 26      5859   5876 
    XOR A                               ;268e  af            5860   5877 
    EX  AF,AF'                          ;268f  08            5861   5878 
    EX  DE,HL                           ;2690  eb            5862   5879 
    LD  HL,(FUNCNS)                     ;2691  2a 2f 26      5863   5880 
    LD  C,(HL)                          ;2694  4e            5864   5881 
    INC HL                              ;2695  23            5865   5882 
    LD  B,(HL)                          ;2696  46            5866   5883 
VRFLOP: PUSH    DE                      ;2697  d5            5867   5884 
    EX  AF,AF'                          ;2698  08            5868   5885 
    INC A                               ;2699  3c            5869   5886 
    EX  AF,AF'                          ;269a  08            5870   5887 
    CALL    BCFTCH                      ;269b  cd c4 25      5871   5888 
    CALL    VSRTST                      ;269e  cd fe 20      5872   5889 
    CP  029h                            ;26a1  fe 29         5873   5890 
    JR  Z,LSTCMP                        ;26a3  28 12         5874   5891 
    CP  02Ch                            ;26a5  fe 2c         5875   5892 
    JP  NZ,SERROR                       ;26a7  c2 3a 17      5876   5893 
    LD  A,E                             ;26aa  7b            5877   5894 
    POP DE                              ;26ab  d1            5878   5895 
    DEFB    0FEH                        ;26ac  fe            5879   5896 ;CP
CPIMDP: DEFS    1                       ;26ad                5880   5897 
    JR  NZ,VRFLOP                       ;26ae  20 e7         5881   5898 
    OR  A                               ;26b0  b7            5882   5899 
    SBC HL,DE                           ;26b1  ed 52         5883   5900 
    JR  NZ,VRFLOP                       ;26b3  20 e2         5884   5901 
    JR  FVRFND                          ;26b5  18 0b         5885   5902 
                                        ;                    5886   5903 ;
LSTCMP: LD  A,E                         ;26b7  7b            5887   5904 
    POP DE                              ;26b8  d1            5888   5905 
    DEFB    0FEH                        ;26b9  fe            5889   5906 ;CP
CPIMDQ: DEFS    1                       ;26ba                5890   5907 
    JR  NZ,NFCVAR                       ;26bb  20 c5         5891   5908 
    OR  A                               ;26bd  b7            5892   5909 
    SBC HL,DE                           ;26be  ed 52         5893   5910 
    JR  NZ,NFCVAR                       ;26c0  20 c0         5894   5911 
                                        ;                    5895   5912 ;
FVRFND: DEFB    001H                    ;26c2  01            5896   5913 ;LD BC,?
FNBCPT: DEFS    2                       ;26c3                5897   5914 
    EX  AF,AF'                          ;26c5  08            5898   5915 
    LD  E,A                             ;26c6  5f            5899   5916 
    LD  A,(CPIMDQ)                      ;26c7  3a ba 26      5900   5917 
    CP  003h                            ;26ca  fe 03         5901   5918 
    JR  Z,FNLVRS                        ;26cc  28 05         5902   5919 
    CALL    CONDFL                      ;26ce  cd eb 28      5903   5920 
    JR  FVRFDD                          ;26d1  18 03         5904   5921 
FNLVRS: CALL    CONDSR                  ;26d3  cd d9 28      5905   5922 
FVRFDD: POP HL                          ;26d6  e1            5906   5923 
    POP HL                              ;26d7  e1            5907   5924 
    POP HL                              ;26d8  e1            5908   5925 
    DEC BC                              ;26d9  0b            5909   5926 
    PUSH    BC                          ;26da  c5            5910   5927 
    PUSH    HL                          ;26db  e5            5911   5928 
    LD  HL,(FUNCNS)                     ;26dc  2a 2f 26      5912   5929 
    INC HL                              ;26df  23            5913   5930 
    INC HL                              ;26e0  23            5914   5931 
    LD  C,(HL)                          ;26e1  4e            5915   5932 
    INC HL                              ;26e2  23            5916   5933 
    LD  B,(HL)                          ;26e3  46            5917   5934 
TSTARG: DEC E                           ;26e4  1d            5918   5935 
    JR  Z,FNCGS                         ;26e5  28 05         5919   5936 
    CALL    SNXT2C                      ;26e7  cd 08 27      5920   5937 
    JR  TSTARG                          ;26ea  18 f8         5921   5938 
                                        ;                    5922   5939 ;
FNCGS:  LD  HL,(FUNCNS)                 ;26ec  2a 2f 26      5923   5940 
    POP DE                              ;26ef  d1            5924   5941 
    PUSH    HL                          ;26f0  e5            5925   5942 
    INC HL                              ;26f1  23            5926   5943 
    INC HL                              ;26f2  23            5927   5944 
    INC HL                              ;26f3  23            5928   5945 
    INC HL                              ;26f4  23            5929   5946 
    CALL    INDRCT                      ;26f5  cd a3 2a      5930   5947 
    LD  (FUNCNS),HL                     ;26f8  22 2f 26      5931   5948 
    EX  DE,HL                           ;26fb  eb            5932   5949 
    CALL    EXPRSN                      ;26fc  cd f2 22      5933   5950 
    POP DE                              ;26ff  d1            5934   5951 
    LD  (FUNCNS),DE                     ;2700  ed 53 2f 26   5935   5952 
    POP BC                              ;2704  c1            5936   5953 
    JP  BCFTCH                          ;2705  c3 c4 25      5937   5954 
                                        ;                    5938   5955 ;
SNXT2C: CALL    SK2C2C                  ;2708  cd 10 27      5939   5956 
    CP  02Ch                            ;270b  fe 2c         5940   5957 
    JR  NZ,SNXT2C                       ;270d  20 f9         5941   5958 
    RET                                 ;270f  c9            5942   5959 
                                        ;                    5943   5960 ;
SK2C2C: CALL    SKPSBL                  ;2710  cd 2d 27      5944   5961 
    CP  028h                            ;2713  fe 28         5945   5962 
    RET NZ                              ;2715  c0            5946   5963 
S2C2CL: CALL    SK2C2C                  ;2716  cd 10 27      5947   5964 
    CP  029h                            ;2719  fe 29         5948   5965 
    RET Z                               ;271b  c8            5949   5966 
    JR  S2C2CL                          ;271c  18 f8         5950   5967 
                                        ;                    5951   5968 ;
SK2829: CALL    SKPSBL                  ;271e  cd 2d 27      5952   5969 
    CP  029h                            ;2721  fe 29         5953   5970 
    RET Z                               ;2723  c8            5954   5971 
    CP  028h                            ;2724  fe 28         5955   5972 
    JR  NZ,SK2829                       ;2726  20 f6         5956   5973 
SK2BLO: CALL    SK2829                  ;2728  cd 1e 27      5957   5974 
    JR  SK2829                          ;272b  18 f1         5958   5975 
                                        ;                    5959   5976 ;
SKPSBL: CALL    BCFTCH                  ;272d  cd c4 25      5960   5977 
    OR  A                               ;2730  b7            5961   5978 
SKSBER: JP  Z,SERROR                    ;2731  ca 3a 17      5962   5979 
    CP  03Ah                            ;2734  fe 3a         5963   5980 
    JR  Z,SKSBER                        ;2736  28 f9         5964   5981 
    CP  022h                            ;2738  fe 22         5965   5982 
    JR  Z,DQSKCM                        ;273a  28 19         5966   5983 
    CP  020h                            ;273c  fe 20         5967   5984 
    RET NC                              ;273e  d0            5968   5985 
    CP  012h                            ;273f  fe 12         5969   5986 
    JR  C,DWNERG                        ;2741  38 0a         5970   5987 
    AND 00Fh                            ;2743  e6 0f         5971   5988 
HEXSKS: ADD A,C                         ;2745  81            5972   5989 
    LD  C,A                             ;2746  4f            5973   5990 
    LD  A,0                             ;2747  3e 00         5974   5991 
    ADC A,B                             ;2749  88            5975   5992 
    LD  B,A                             ;274a  47            5976   5993 
    JR  SKPSBL                          ;274b  18 e0         5977   5994 
                                        ;                    5978   5995 ;
DWNERG: CP  00Bh                        ;274d  fe 0b         5979   5996 
    JR  C,SKPSBL                        ;274f  38 dc         5980   5997 
    LD  A,002h                          ;2751  3e 02         5981   5998 
    JR  HEXSKS                          ;2753  18 f0         5982   5999 
                                        ;                    5983   6000 ;
DQSKCM: CALL    BCFTCH                  ;2755  cd c4 25      5984   6001 
    CP  022h                            ;2758  fe 22         5985   6002 
    JR  Z,SKPSBL                        ;275a  28 d1         5986   6003 
    OR  A                               ;275c  b7            5987   6004 
    JR  Z,SKSBER                        ;275d  28 d2         5988   6005 
    JR  DQSKCM                          ;275f  18 f4         5989   6006 
                                        ;                    5990   6007 ;
FCTION: LD  A,(BC)                      ;2761  0a            5991   6008 
    INC BC                              ;2762  03            5992   6009 
    CP  0A0h                            ;2763  fe a0         5993   6010 
    JP  NC,FUNCT1                       ;2765  d2 8c 27      5994   6011 
    PUSH    HL                          ;2768  e5            5995   6012 
    LD  HL,FLFNRT                       ;2769  21 81 27      5996   6013 
FTRMER: EX  (SP),HL                     ;276c  e3            5997   6014 
    PUSH    HL                          ;276d  e5            5998   6015 
    CALL    GETFJP                      ;276e  cd 9c 28      5999   6016 
    EX  (SP),HL                         ;2771  e3            6000   6017 
    CALL    CH28H                       ;2772  cd 58 2d      6001   6018 
    DEC IY                              ;2775  fd 2b         6002   6019 
    LD  (IY+0),0                        ;2777  fd 36 00 00   6003   6020 
    CALL    FLEXP'                      ;277b  cd 9c 22      6004   6021 
    JP  CH29H                           ;277e  c3 66 2d      6005   6022 
                                        ;                    6006   6023 ;
FLFNRT: LD  A,(IY+0)                    ;2781  fd 7e 00      6007   6024 
    INC IY                              ;2784  fd 23         6008   6025 
    CALL    CONDFL                      ;2786  cd eb 28      6009   6026 
FNCCON: JP  BCFTCH                      ;2789  c3 c4 25      6010   6027 
                                        ;                    6011   6028 ;
FUNCT1: CP  0A9h                        ;278c  fe a9         6012   6029 
    JP  NC,FUNCT2                       ;278e  d2 9c 27      6013   6030 
    PUSH    HL                          ;2791  e5            6014   6031 
    LD  HL,SRFNRT                       ;2792  21 97 27      6015   6032 
    JR  FTRMER                          ;2795  18 d5         6016   6033 
                                        ;                    6017   6034 ;
SRFNRT: INC IY                          ;2797  fd 23         6018   6035 
    JP  CONDSB                          ;2799  c3 b1 25      6019   6036 
                                        ;                    6020   6037 ;
                                        ;                    6021   6038 ;
FUNCT2: CP  0B2h                        ;279c  fe b2         6022   6039 
    JP  NC,OTHERF                       ;279e  d2 c5 27      6023   6040 
    PUSH    HL                          ;27a1  e5            6024   6041 
    LD  HL,SRSRRT                       ;27a2  21 ba 27      6025   6042 
    EX  (SP),HL                         ;27a5  e3            6026   6043 
    PUSH    HL                          ;27a6  e5            6027   6044 
    CALL    GETFJP                      ;27a7  cd 9c 28      6028   6045 
    EX  (SP),HL                         ;27aa  e3            6029   6046 
    CALL    CH28H                       ;27ab  cd 58 2d      6030   6047 
    DEC IY                              ;27ae  fd 2b         6031   6048 
    LD  (IY+0),0                        ;27b0  fd 36 00 00   6032   6049 
    CALL    STEXP'                      ;27b4  cd b5 22      6033   6050 
    JP  CH29H                           ;27b7  c3 66 2d      6034   6051 
                                        ;                    6035   6052 ;
SRSRRT: LD  A,(IY+0)                    ;27ba  fd 7e 00      6036   6053 
    INC IY                              ;27bd  fd 23         6037   6054 
    CALL    CONDFL                      ;27bf  cd eb 28      6038   6055 
    JP  BCFTCH                          ;27c2  c3 c4 25      6039   6056 
                                        ;                    6040   6057 ;
OTHERF: PUSH    HL                      ;27c5  e5            6041   6058 
    CALL    GETFJP                      ;27c6  cd 9c 28      6042   6059 
    EX  (SP),HL                         ;27c9  e3            6043   6060 
    RET                                 ;27ca  c9            6044   6061 
                                        ;                    6045   6062 ;
LENSUB: PUSH    BC                      ;27cb  c5            6046   6063 
    PUSH    DE                          ;27cc  d5            6047   6064 
    PUSH    HL                          ;27cd  e5            6048   6065 
    CALL    CONDMZ                      ;27ce  cd f6 6b      6049   6066 
    CALL    INDRCT                      ;27d1  cd a3 2a      6050   6067 
    JR  MIDERL                          ;27d4  18 12         6051   6068 
                                        ;                    6052   6069 ;
ASCSUB: PUSH    BC                      ;27d6  c5            6053   6070 
    PUSH    DE                          ;27d7  d5            6054   6071 
    PUSH    HL                          ;27d8  e5            6055   6072 
    CALL    CONDMZ                      ;27d9  cd f6 6b      6056   6073 
    CALL    INDRCT                      ;27dc  cd a3 2a      6057   6074 
    LD  A,(HL)                          ;27df  7e            6058   6075 
    OR  A                               ;27e0  b7            6059   6076 
    JP  Z,IFCALL                        ;27e1  ca 36 17      6060   6077 
    INC HL                              ;27e4  23            6061   6078 
    CALL    INDRCT                      ;27e5  cd a3 2a      6062   6079 
MIDERL: LD  E,(HL)                      ;27e8  5e            6063   6080 
    LD  D,0                             ;27e9  16 00         6064   6081 
    POP HL                              ;27eb  e1            6065   6082 
    LD  (IY+0),4                        ;27ec  fd 36 00 04   6066   6083 
    CALL    CLRFAC                      ;27f0  cd a9 28      6067   6084 
    CALL    FLTHEX                      ;27f3  cd 02 29      6068   6085 
    POP DE                              ;27f6  d1            6069   6086 
    POP BC                              ;27f7  c1            6070   6087 
    RET                                 ;27f8  c9            6071   6088 
                                        ;                    6072   6089 ;
VALSUB: PUSH    BC                      ;27f9  c5            6073   6090 
    PUSH    DE                          ;27fa  d5            6074   6091 
    PUSH    HL                          ;27fb  e5            6075   6092 
    CALL    CONDMZ                      ;27fc  cd f6 6b      6076   6093 
    CALL    INDRCT                      ;27ff  cd a3 2a      6077   6094 
    LD  A,(HL)                          ;2802  7e            6078   6095 
    OR  A                               ;2803  b7            6079   6096 
    JR  Z,ZRVALR                        ;2804  28 1a         6080   6097 
    INC HL                              ;2806  23            6081   6098 
    CALL    INDRCT                      ;2807  cd a3 2a      6082   6099 
    LD  B,A                             ;280a  47            6083   6100 
    LD  DE,KEYBUF                       ;280b  11 4f 7a      6084   6101 
VALTRL: LD  A,(HL)                      ;280e  7e            6085   6102 
    LD  (DE),A                          ;280f  12            6086   6103 
    INC HL                              ;2810  23            6087   6104 
    INC DE                              ;2811  13            6088   6105 
    DJNZ    VALTRL                      ;2812  10 fa         6089   6106 
MIDVAL: XOR A                           ;2814  af            6090   6107 
    LD  (DE),A                          ;2815  12            6091   6108 
    LD  DE,KEYBUF                       ;2816  11 4f 7a      6092   6109 
    POP HL                              ;2819  e1            6093   6110 
    CALL    OVFLAG                      ;281a  cd b8 5b      6094   6111 
    POP DE                              ;281d  d1            6095   6112 
    POP BC                              ;281e  c1            6096   6113 
    RET                                 ;281f  c9            6097   6114 
                                        ;                    6098   6115 ;
ZRVALR: LD  DE,KEYBUF                   ;2820  11 4f 7a      6099   6116 
    JR  MIDVAL                          ;2823  18 ef         6100   6117 
                                        ;                    6101   6118 ;
NULSDC: DEFB    000H                    ;2825  00            6102   6119 
    DEFW    0                           ;2826  00 00         6103   6120 
                                        ;                    6104   6121 ;
INKEY:  LD  DE,00008h                   ;2828  11 08 00      6105   6122 
    ADD HL,DE                           ;282b  19            6106   6123 
    CALL    BCFTCH                      ;282c  cd c4 25      6107   6124 
    CP  028h                            ;282f  fe 28         6108   6125 
    DEC BC                              ;2831  0b            6109   6126 
    JR  NZ,NORGET                       ;2832  20 20         6110   6127 
    INC BC                              ;2834  03            6111   6128 
    PUSH    HL                          ;2835  e5            6112   6129 
    DEC IY                              ;2836  fd 2b         6113   6130 
    LD  (IY+0),0                        ;2838  fd 36 00 00   6114   6131 
    CALL    FLEXP'                      ;283c  cd 9c 22      6115   6132 
    CALL    CH29H                       ;283f  cd 66 2d      6116   6133 
    INC IY                              ;2842  fd 23         6117   6134 
    CALL    HLFLTO                      ;2844  cd 97 2d      6118   6135 
    CALL    HCHECK                      ;2847  cd d8 22      6119   6136 
    POP HL                              ;284a  e1            6120   6137 
    LD  (FLASHF),A                      ;284b  32 7f 0c      6121   6138 
    CALL    ASCGET                      ;284e  cd 62 0c      6122   6139 
    JP  INKMID                          ;2851  c3 62 28      6123   6140 
                                        ;                    6124   6141 ;
NORGET: XOR A                           ;2854  af            6125   6142 
    LD  (FLASHF),A                      ;2855  32 7f 0c      6126   6143 
    CALL    ASCGET                      ;2858  cd 62 0c      6127   6144 
    DEFB    0FEH                        ;285b  fe            6128   6145 ;CP
LSTGET: DEFB    000H                    ;285c  00            6129   6146 
    JR  Z,NLINKY                        ;285d  28 06         6130   6147 
    LD  (LSTGET),A                      ;285f  32 5c 28      6131   6148 
INKMID: OR  A                           ;2862  b7            6132   6149 
    JR  NZ,CHRMIS                       ;2863  20 0a         6133   6150 
NLINKY: LD  DE,NULSDC                   ;2865  11 25 28      6134   6151 
    LD  (HL),E                          ;2868  73            6135   6152 
    INC HL                              ;2869  23            6136   6153 
    LD  (HL),D                          ;286a  72            6137   6154 
    DEC HL                              ;286b  2b            6138   6155 
INKBCK: JP  CONDSB                      ;286c  c3 b1 25      6139   6156 
                                        ;                    6140   6157 ;
                                        ;                    6141   6158 ;
CHRMIS: CALL    CHRMID                  ;286f  cd 7c 28      6142   6159 
    JR  INKBCK                          ;2872  18 f8         6143   6160 
                                        ;                    6144   6161 ;
CHRSUB: PUSH    HL                      ;2874  e5            6145   6162 
    CALL    HLFLTO                      ;2875  cd 97 2d      6146   6163 
    CALL    HCHECK                      ;2878  cd d8 22      6147   6164 
    POP HL                              ;287b  e1            6148   6165 
CHRMID: PUSH    HL                      ;287c  e5            6149   6166 
    PUSH    DE                          ;287d  d5            6150   6167 
    LD  E,L                             ;287e  5d            6151   6168 
    LD  D,H                             ;287f  54            6152   6169 
    INC DE                              ;2880  13            6153   6170 
    INC DE                              ;2881  13            6154   6171 
    LD  (HL),E                          ;2882  73            6155   6172 
    INC HL                              ;2883  23            6156   6173 
    LD  (HL),D                          ;2884  72            6157   6174 
    INC HL                              ;2885  23            6158   6175 
    PUSH    HL                          ;2886  e5            6159   6176 
    LD  (HL),1                          ;2887  36 01         6160   6177 
    INC HL                              ;2889  23            6161   6178 
    INC DE                              ;288a  13            6162   6179 
    INC DE                              ;288b  13            6163   6180 
    INC DE                              ;288c  13            6164   6181 
    INC DE                              ;288d  13            6165   6182 
    INC DE                              ;288e  13            6166   6183 
    LD  (HL),E                          ;288f  73            6167   6184 
    INC HL                              ;2890  23            6168   6185 
    LD  (HL),D                          ;2891  72            6169   6186 
    LD  (DE),A                          ;2892  12            6170   6187 
    POP HL                              ;2893  e1            6171   6188 
    LD  E,L                             ;2894  5d            6172   6189 
    LD  D,H                             ;2895  54            6173   6190 
    CALL    GETSTR                      ;2896  cd 9e 2d      6174   6191 
    POP DE                              ;2899  d1            6175   6192 
    POP HL                              ;289a  e1            6176   6193 
    RET                                 ;289b  c9            6177   6194 
                                        ;                    6178   6195 ;
GETFJP: LD  HL,FJPTBL                   ;289c  21 06 30      6179   6196 
GETJPA: SUB 081h                        ;289f  d6 81         6180   6197 
    ADD A,A                             ;28a1  87            6181   6198 
    LD  E,A                             ;28a2  5f            6182   6199 
    LD  D,0                             ;28a3  16 00         6183   6200 
    ADD HL,DE                           ;28a5  19            6184   6201 
    JP  INDRCT                          ;28a6  c3 a3 2a      6185   6202 
                                        ;                    6186   6203 ;
CLRFAC: PUSH    HL                      ;28a9  e5            6187   6204 
    PUSH    BC                          ;28aa  c5            6188   6205 
    LD  B,8                             ;28ab  06 08         6189   6206 
CLFCLP: LD  (HL),0                      ;28ad  36 00         6190   6207 
    INC HL                              ;28af  23            6191   6208 
    DJNZ    CLFCLP                      ;28b0  10 fb         6192   6209 
    POP BC                              ;28b2  c1            6193   6210 
    POP HL                              ;28b3  e1            6194   6211 
    RET                                 ;28b4  c9            6195   6212 
                                        ;                    6196   6213 ;
STRFAC: LD  DE,00008h                   ;28b5  11 08 00      6197   6214 
    ADD HL,DE                           ;28b8  19            6198   6215 
    INC HL                              ;28b9  23            6199   6216 
    INC HL                              ;28ba  23            6200   6217 
    LD  (HL),0                          ;28bb  36 00         6201   6218 
    INC HL                              ;28bd  23            6202   6219 
    LD  (HL),C                          ;28be  71            6203   6220 
    INC HL                              ;28bf  23            6204   6221 
    LD  (HL),B                          ;28c0  70            6205   6222 
    DEC HL                              ;28c1  2b            6206   6223 
    DEC HL                              ;28c2  2b            6207   6224 
STRSL:  LD  A,(BC)                      ;28c3  0a            6208   6225 
    INC (HL)                            ;28c4  34            6209   6226 
    OR  A                               ;28c5  b7            6210   6227 
    JR  Z,LENOKS                        ;28c6  28 05         6211   6228 
    INC BC                              ;28c8  03            6212   6229 
    CP  022h                            ;28c9  fe 22         6213   6230 
    JR  NZ,STRSL                        ;28cb  20 f6         6214   6231 
LENOKS: DEC (HL)                        ;28cd  35            6215   6232 
    PUSH    DE                          ;28ce  d5            6216   6233 
    LD  E,L                             ;28cf  5d            6217   6234 
    LD  D,H                             ;28d0  54            6218   6235 
    DEC HL                              ;28d1  2b            6219   6236 
    LD  (HL),D                          ;28d2  72            6220   6237 
    DEC HL                              ;28d3  2b            6221   6238 
    LD  (HL),E                          ;28d4  73            6222   6239 
    POP DE                              ;28d5  d1            6223   6240 
    JP  CONDSB                          ;28d6  c3 b1 25      6224   6241 
                                        ;                    6225   6242 ;
CONDSR: PUSH    AF                      ;28d9  f5            6226   6243 
    LD  A,(IY+0)                        ;28da  fd 7e 00      6227   6244 
    OR  A                               ;28dd  b7            6228   6245 
    JR  Z,OKSTTH                        ;28de  28 05         6229   6246 
    CP  003h                            ;28e0  fe 03         6230   6247 
    JP  NZ,TYPEMS                       ;28e2  c2 32 17      6231   6248 
OKSTTH: POP AF                          ;28e5  f1            6232   6249 
    LD  (IY+0),3                        ;28e6  fd 36 00 03   6233   6250 
    RET                                 ;28ea  c9            6234   6251 
                                        ;                    6235   6252 ;
CONDFL: PUSH    AF                      ;28eb  f5            6236   6253 
    LD  A,(IY+0)                        ;28ec  fd 7e 00      6237   6254 
    OR  A                               ;28ef  b7            6238   6255 
    JR  Z,STFLMK                        ;28f0  28 0b         6239   6256 
    CP  003h                            ;28f2  fe 03         6240   6257 
    JP  Z,TYPEMS                        ;28f4  ca 32 17      6241   6258 
    POP AF                              ;28f7  f1            6242   6259 
    CP  004h                            ;28f8  fe 04         6243   6260 
    RET Z                               ;28fa  c8            6244   6261 
    JR  STDBL                           ;28fb  18 01         6245   6262 
STFLMK: POP AF                          ;28fd  f1            6246   6263 
STDBL:  LD  (IY+0),A                    ;28fe  fd 77 00      6247   6264 
    RET                                 ;2901  c9            6248   6265 
                                        ;                    6249   6266 ;
FLTHEX: CALL    CLRFAC                  ;2902  cd a9 28      6250   6267 
    LD  A,E                             ;2905  7b            6251   6268 
    OR  D                               ;2906  b2            6252   6269 
    RET Z                               ;2907  c8            6253   6270 
    BIT 7,D                             ;2908  cb 7a         6254   6271 
    JR  Z,NORFLH                        ;290a  28 0d         6255   6272 
    LD  A,D                             ;290c  7a            6256   6273 
    CPL                                 ;290d  2f            6257   6274 
    LD  D,A                             ;290e  57            6258   6275 
    LD  A,E                             ;290f  7b            6259   6276 
    CPL                                 ;2910  2f            6260   6277 
    LD  E,A                             ;2911  5f            6261   6278 
    INC DE                              ;2912  13            6262   6279 
    CALL    NORFLH                      ;2913  cd 19 29      6263   6280 
    JP  TOGLE                           ;2916  c3 eb 6b      6264   6281 
                                        ;                    6265   6282 ;
NORFLH: LD  A,091h                      ;2919  3e 91         6266   6283 
SFL:    DEC A                           ;291b  3d            6267   6284 
    BIT 7,D                             ;291c  cb 7a         6268   6285 
    JR  NZ,FLHXRT                       ;291e  20 06         6269   6286 
    RL  E                               ;2920  cb 13         6270   6287 
    RL  D                               ;2922  cb 12         6271   6288 
    JR  SFL                             ;2924  18 f5         6272   6289 
FLHXRT: LD  (HL),A                      ;2926  77            6273   6290 
    INC HL                              ;2927  23            6274   6291 
    RES 7,D                             ;2928  cb ba         6275   6292 
    LD  (HL),D                          ;292a  72            6276   6293 
    INC HL                              ;292b  23            6277   6294 
    LD  (HL),E                          ;292c  73            6278   6295 
    DEC HL                              ;292d  2b            6279   6296 
    DEC HL                              ;292e  2b            6280   6297 
    RET                                 ;292f  c9            6281   6298 
                                        ;                    6282   6299 ;
DEFINT: LD  C,002h                      ;2930  0e 02         6283   6300 
    JR  CONTDF                          ;2932  18 0a         6284   6301 
DEFSTR: LD  C,003h                      ;2934  0e 03         6285   6302 
    JR  CONTDF                          ;2936  18 06         6286   6303 
DEFSNG: LD  C,004h                      ;2938  0e 04         6287   6304 
    JR  CONTDF                          ;293a  18 02         6288   6305 
DEFDBL: LD  C,008h                      ;293c  0e 08         6289   6306 
CONTDF: CALL    HLFTCH                  ;293e  cd 87 29      6290   6307 
    CP  05Bh                            ;2941  fe 5b         6291   6308 
    RET NC                              ;2943  d0            6292   6309 
    SUB 041h                            ;2944  d6 41         6293   6310 
    RET C                               ;2946  d8            6294   6311 
    LD  E,A                             ;2947  5f            6295   6312 
    LD  D,0                             ;2948  16 00         6296   6313 
    LD  B,A                             ;294a  47            6297   6314 
    PUSH    HL                          ;294b  e5            6298   6315 
    LD  HL,DFTABL                       ;294c  21 88 30      6299   6316 
    ADD HL,DE                           ;294f  19            6300   6317 
    LD  (HL),C                          ;2950  71            6301   6318 
    EX  DE,HL                           ;2951  eb            6302   6319 
    POP HL                              ;2952  e1            6303   6320 
CDEFTP: CALL    INCHLF                  ;2953  cd 86 29      6304   6321 
                                        ;                    6305   6322 ;
    INC HL                              ;2956  23            6306   6323 
    CP  02Ch                            ;2957  fe 2c         6307   6324 
    JR  Z,CONTDF                        ;2959  28 e3         6308   6325 
    DEC HL                              ;295b  2b            6309   6326 
    CP  0F9h                            ;295c  fe f9         6310   6327 
    RET NZ                              ;295e  c0            6311   6328 
    CALL    INCHLF                      ;295f  cd 86 29      6312   6329 
                                        ;                    6313   6330 ;
    CP  05Bh                            ;2962  fe 5b         6314   6331 
    RET NC                              ;2964  d0            6315   6332 
    SUB 041h                            ;2965  d6 41         6316   6333 
    RET C                               ;2967  d8            6317   6334 
STRMDM2: SUB    B                       ;2968  90            6318   6335 
    RET C                               ;2969  d8            6319   6336 
    RET Z                               ;296a  c8            6320   6337 
    EX  DE,HL                           ;296b  eb            6321   6338 
DFFIL1: INC HL                          ;296c  23            6322   6339 
    LD  (HL),C                          ;296d  71            6323   6340 
    DEC A                               ;296e  3d            6324   6341 
    JR  NZ,DFFIL1                       ;296f  20 fb         6325   6342 
    EX  DE,HL                           ;2971  eb            6326   6343 
    JR  CDEFTP                          ;2972  18 df         6327   6344 
                                        ;                    6328   6345 ;
CALLUP: LD  C,L                         ;2974  4d            6329   6346 
    LD  B,H                             ;2975  44            6330   6347 
    CALL    IHLEXP                      ;2976  cd cc 22      6331   6348 
    PUSH    BC                          ;2979  c5            6332   6349 
    PUSH    IY                          ;297a  fd e5         6333   6350 
    LD  BC,CALUPR                       ;297c  01 81 29      6334   6351 
    PUSH    BC                          ;297f  c5            6335   6352 
    JP  (HL)                            ;2980  e9            6336   6353 
CALUPR: POP IY                          ;2981  fd e1         6337   6354 
    POP HL                              ;2983  e1            6338   6355 
    DEC HL                              ;2984  2b            6339   6356 
    RET                                 ;2985  c9            6340   6357 
                                        ;                    6341   6358 ;
INCHLF: INC HL                          ;2986  23            6342   6359 
HLFTCH:                                 ;                    6343   6360 
    LD  A,(HL)                          ;2987  7e            6344   6361 
    CP  020h                            ;2988  fe 20         6345   6362 
    RET NZ                              ;298a  c0            6346   6363 
    JR  INCHLF                          ;298b  18 f9         6347   6364 
                                        ;                    6348   6365 ;
INTG:   INC HL                          ;298d  23            6349   6366 
    BIT 7,(HL)                          ;298e  cb 7e         6350   6367 
    DEC HL                              ;2990  2b            6351   6368 
    JP  Z,INT                           ;2991  ca 10 60      6352   6369 
    PUSH    DE                          ;2994  d5            6353   6370 
    PUSH    HL                          ;2995  e5            6354   6371 
    LD  DE,00008h                       ;2996  11 08 00      6355   6372 
    ADD HL,DE                           ;2999  19            6356   6373 
    EX  DE,HL                           ;299a  eb            6357   6374 
    POP HL                              ;299b  e1            6358   6375 
    PUSH    HL                          ;299c  e5            6359   6376 
    PUSH    DE                          ;299d  d5            6360   6377 
    PUSH    BC                          ;299e  c5            6361   6378 
    CALL    LDIR8                       ;299f  cd a6 73      6362   6379 
    POP BC                              ;29a2  c1            6363   6380 
    POP HL                              ;29a3  e1            6364   6381 
    CALL    INT                         ;29a4  cd 10 60      6365   6382 
    EX  DE,HL                           ;29a7  eb            6366   6383 
    POP HL                              ;29a8  e1            6367   6384 
    CALL    CMP                         ;29a9  cd d6 61      6368   6385 
    JR  Z,MNINTR                        ;29ac  28 08         6369   6386 
    CALL    INT                         ;29ae  cd 10 60      6370   6387 
    PUSH    BC                          ;29b1  c5            6371   6388 
    CALL    ONESUB                      ;29b2  cd ce 6b      6372   6389 
    POP BC                              ;29b5  c1            6373   6390 
MNINTR: POP DE                          ;29b6  d1            6374   6391 
    RET                                 ;29b7  c9            6375   6392 
                                        ;                    6376   6393 ;
STRING: CALL    CH28H                   ;29b8  cd 58 2d      6377   6394 
    DEC IY                              ;29bb  fd 2b         6378   6395 
    PUSH    HL                          ;29bd  e5            6379   6396 
    CALL    FLEXP'                      ;29be  cd 9c 22      6380   6397 
    CALL    CH2CH                       ;29c1  cd 61 2d      6381   6398 
    CALL    HLFLTO                      ;29c4  cd 97 2d      6382   6399 
    CALL    HCHECK                      ;29c7  cd d8 22      6383   6400 
    POP HL                              ;29ca  e1            6384   6401 
    PUSH    AF                          ;29cb  f5            6385   6402 
    CALL    FLEXP'                      ;29cc  cd 9c 22      6386   6403 
    INC IY                              ;29cf  fd 23         6387   6404 
    PUSH    HL                          ;29d1  e5            6388   6405 
    CALL    HLFLTO                      ;29d2  cd 97 2d      6389   6406 
    CALL    HCHECK                      ;29d5  cd d8 22      6390   6407 
    LD  (FILLCH),A                      ;29d8  32 ff 29      6391   6408 
    POP HL                              ;29db  e1            6392   6409 
    POP AF                              ;29dc  f1            6393   6410 
    CALL    SPCSU'                      ;29dd  cd e3 29      6394   6411 
    JP  CONDSB                          ;29e0  c3 b1 25      6395   6412 
                                        ;                    6396   6413 ;
                                        ;                    6397   6414 ;
SPCSU': PUSH    BC                      ;29e3  c5            6398   6415 
    PUSH    DE                          ;29e4  d5            6399   6416 
    PUSH    HL                          ;29e5  e5            6400   6417 
    JR  SPCSME                          ;29e6  18 0e         6401   6418 
                                        ;                    6402   6419 ;
SPCSUB: LD  A,020h                      ;29e8  3e 20         6403   6420 
    LD  (FILLCH),A                      ;29ea  32 ff 29      6404   6421 
    PUSH    BC                          ;29ed  c5            6405   6422 
    PUSH    DE                          ;29ee  d5            6406   6423 
    PUSH    HL                          ;29ef  e5            6407   6424 
    CALL    HLFLTO                      ;29f0  cd 97 2d      6408   6425 
    CALL    HCHECK                      ;29f3  cd d8 22      6409   6426 
SPCSME: OR  A                           ;29f6  b7            6410   6427 
    JR  Z,NULRET                        ;29f7  28 0a         6411   6428 
    LD  B,A                             ;29f9  47            6412   6429 
    LD  C,B                             ;29fa  48            6413   6430 
    LD  HL,KEYBUF                       ;29fb  21 4f 7a      6414   6431 
SPCFLL: DEFB    036H                    ;29fe  36            6415   6432 ;LD (HL),?
FILLCH: DEFB    020H                    ;29ff  20            6416   6433 
    INC HL                              ;2a00  23            6417   6434 
    DJNZ    SPCFLL                      ;2a01  10 fb         6418   6435 
NULRET: POP HL                          ;2a03  e1            6419   6436 
    LD  DE,KEYBUF                       ;2a04  11 4f 7a      6420   6437 
    LD  B,C                             ;2a07  41            6421   6438 
    CALL    ENTSTR                      ;2a08  cd 1a 2b      6422   6439 
    POP DE                              ;2a0b  d1            6423   6440 
    POP BC                              ;2a0c  c1            6424   6441 
    RET                                 ;2a0d  c9            6425   6442 
                                        ;                    6426   6443 ;
FRACSB: PUSH    BC                      ;2a0e  c5            6427   6444 
    CALL    FRAC                        ;2a0f  cd 95 60      6428   6445 
    POP BC                              ;2a12  c1            6429   6446 
    RET                                 ;2a13  c9            6430   6447 
                                        ;                    6431   6448 ;
PEEK:   PUSH    DE                      ;2a14  d5            6432   6449 
    PUSH    HL                          ;2a15  e5            6433   6450 
    CALL    HLFLTO                      ;2a16  cd 97 2d      6434   6451 
    LD  E,(HL)                          ;2a19  5e            6435   6452 
    LD  D,0                             ;2a1a  16 00         6436   6453 
    POP HL                              ;2a1c  e1            6437   6454 
    CALL    FLTHEX                      ;2a1d  cd 02 29      6438   6455 
    POP DE                              ;2a20  d1            6439   6456 
    LD  (IY+0),4                        ;2a21  fd 36 00 04   6440   6457 
    RET                                 ;2a25  c9            6441   6458 
                                        ;                    6442   6459 ;
HEXD:   PUSH    BC                      ;2a26  c5            6443   6460 
    PUSH    DE                          ;2a27  d5            6444   6461 
    PUSH    HL                          ;2a28  e5            6445   6462 
    PUSH    HL                          ;2a29  e5            6446   6463 
    LD  DE,KEYBUF                       ;2a2a  11 4f 7a      6447   6464 
    CALL    HLFLTO                      ;2a2d  cd 97 2d      6448   6465 
    CALL    HEXHL                       ;2a30  cd 12 67      6449   6466 
    LD  B,4                             ;2a33  06 04         6450   6467 
MIDOCT: LD  A,(DE)                      ;2a35  1a            6451   6468 
    CP  030h                            ;2a36  fe 30         6452   6469 
    JR  NZ,MIDHEX                       ;2a38  20 20         6453   6470 
    INC DE                              ;2a3a  13            6454   6471 
    DEC B                               ;2a3b  05            6455   6472 
    JR  NZ,MIDOCT                       ;2a3c  20 f7         6456   6473 
    INC B                               ;2a3e  04            6457   6474 
    DEC DE                              ;2a3f  1b            6458   6475 
    JR  MIDHEX                          ;2a40  18 18         6459   6476 
                                        ;                    6460   6477 ;
OCTD:   PUSH    BC                      ;2a42  c5            6461   6478 
    PUSH    DE                          ;2a43  d5            6462   6479 
    PUSH    HL                          ;2a44  e5            6463   6480 
    PUSH    HL                          ;2a45  e5            6464   6481 
    LD  DE,KEYBUF                       ;2a46  11 4f 7a      6465   6482 
    CALL    HLFLTO                      ;2a49  cd 97 2d      6466   6483 
    CALL    OCTHL                       ;2a4c  cd db 66      6467   6484 
    LD  B,6                             ;2a4f  06 06         6468   6485 
    JR  MIDOCT                          ;2a51  18 e2         6469   6486 
                                        ;                    6470   6487 ;
STRSUB: PUSH    BC                      ;2a53  c5            6471   6488 
    PUSH    DE                          ;2a54  d5            6472   6489 
    PUSH    HL                          ;2a55  e5            6473   6490 
    PUSH    HL                          ;2a56  e5            6474   6491 
    CALL    CVNMFL                      ;2a57  cd 58 5d      6475   6492 
MIDHEX: EX  DE,HL                       ;2a5a  eb            6476   6493 
    EX  (SP),HL                         ;2a5b  e3            6477   6494 
    LD  E,L                             ;2a5c  5d            6478   6495 
    LD  D,H                             ;2a5d  54            6479   6496 
    INC DE                              ;2a5e  13            6480   6497 
    INC DE                              ;2a5f  13            6481   6498 
    LD  (HL),E                          ;2a60  73            6482   6499 
    INC HL                              ;2a61  23            6483   6500 
    LD  (HL),D                          ;2a62  72            6484   6501 
    INC HL                              ;2a63  23            6485   6502 
    LD  (HL),B                          ;2a64  70            6486   6503 
    INC HL                              ;2a65  23            6487   6504 
    POP DE                              ;2a66  d1            6488   6505 
    LD  (HL),E                          ;2a67  73            6489   6506 
    INC HL                              ;2a68  23            6490   6507 
    LD  (HL),D                          ;2a69  72            6491   6508 
    DEC HL                              ;2a6a  2b            6492   6509 
    DEC HL                              ;2a6b  2b            6493   6510 
    LD  E,L                             ;2a6c  5d            6494   6511 
    LD  D,H                             ;2a6d  54            6495   6512 
    CALL    GETSTR                      ;2a6e  cd 9e 2d      6496   6513 
    POP HL                              ;2a71  e1            6497   6514 
    POP DE                              ;2a72  d1            6498   6515 
    POP BC                              ;2a73  c1            6499   6516 
    RET                                 ;2a74  c9            6500   6517 
                                        ;                    6501   6518 ;
MK1:    PUSH    BC                      ;2a75  c5            6502   6519 
    PUSH    DE                          ;2a76  d5            6503   6520 
    PUSH    HL                          ;2a77  e5            6504   6521 
    PUSH    HL                          ;2a78  e5            6505   6522 
    CALL    HLFLTO                      ;2a79  cd 97 2d      6506   6523 
    LD  (INPSDC),HL                     ;2a7c  22 a9 1e      6507   6524 
    LD  B,2                             ;2a7f  06 02         6508   6525 
    LD  DE,INPSDC                       ;2a81  11 a9 1e      6509   6526 
    POP HL                              ;2a84  e1            6510   6527 
    PUSH    HL                          ;2a85  e5            6511   6528 
    JR  MIDHEX                          ;2a86  18 d2         6512   6529 
                                        ;                    6513   6530 ;
MKS:    PUSH    BC                      ;2a88  c5            6514   6531 
    LD  BC,4                            ;2a89  01 04 00      6515   6532 
    JR  MKHILS                          ;2a8c  18 04         6516   6533 
                                        ;                    6517   6534 ;
MKD:    PUSH    BC                      ;2a8e  c5            6518   6535 
    LD  BC,8                            ;2a8f  01 08 00      6519   6536 
MKHILS: PUSH    DE                      ;2a92  d5            6520   6537 
    PUSH    HL                          ;2a93  e5            6521   6538 
    PUSH    HL                          ;2a94  e5            6522   6539 
    LD  DE,ZFAC                         ;2a95  11 f2 62      6523   6540 
    PUSH    DE                          ;2a98  d5            6524   6541 
    PUSH    BC                          ;2a99  c5            6525   6542 
    LDIR                                ;2a9a  ed b0         6526   6543 
    POP BC                              ;2a9c  c1            6527   6544 
    POP DE                              ;2a9d  d1            6528   6545 
    POP HL                              ;2a9e  e1            6529   6546 
    PUSH    HL                          ;2a9f  e5            6530   6547 
    LD  B,C                             ;2aa0  41            6531   6548 
    JR  MIDHEX                          ;2aa1  18 b7         6532   6549 
INDRCT: PUSH    DE                      ;2aa3  d5            6533   6550 
    LD  E,(HL)                          ;2aa4  5e            6534   6551 
    INC HL                              ;2aa5  23            6535   6552 
    LD  D,(HL)                          ;2aa6  56            6536   6553 
    EX  DE,HL                           ;2aa7  eb            6537   6554 
    POP DE                              ;2aa8  d1            6538   6555 
    RET                                 ;2aa9  c9            6539   6556 
                                        ;                    6540   6557 ;
CVI:    PUSH    BC                      ;2aaa  c5            6541   6558 
    PUSH    HL                          ;2aab  e5            6542   6559 
    CALL    CONDMZ                      ;2aac  cd f6 6b      6543   6560 
    CALL    INDRCT                      ;2aaf  cd a3 2a      6544   6561 
    LD  A,(HL)                          ;2ab2  7e            6545   6562 
    CP  002h                            ;2ab3  fe 02         6546   6563 
    JP  NZ,IFCALL                       ;2ab5  c2 36 17      6547   6564 
    INC HL                              ;2ab8  23            6548   6565 
    CALL    INDRCT                      ;2ab9  cd a3 2a      6549   6566 
    CALL    INDRCT                      ;2abc  cd a3 2a      6550   6567 
    EX  DE,HL                           ;2abf  eb            6551   6568 
    POP HL                              ;2ac0  e1            6552   6569 
    CALL    FLTHEX                      ;2ac1  cd 02 29      6553   6570 
    POP BC                              ;2ac4  c1            6554   6571 
    LD  (IY+0),4                        ;2ac5  fd 36 00 04   6555   6572 
    RET                                 ;2ac9  c9            6556   6573 
                                        ;                    6557   6574 ;
CVD:    PUSH    BC                      ;2aca  c5            6558   6575 
    LD  C,8                             ;2acb  0e 08         6559   6576 
    JR  CVMIDE                          ;2acd  18 03         6560   6577 
                                        ;                    6561   6578 ;
CVS:    PUSH    BC                      ;2acf  c5            6562   6579 
    LD  C,4                             ;2ad0  0e 04         6563   6580 
CVMIDE: PUSH    HL                      ;2ad2  e5            6564   6581 
    CALL    CONDMZ                      ;2ad3  cd f6 6b      6565   6582 
    CALL    INDRCT                      ;2ad6  cd a3 2a      6566   6583 
    LD  A,(HL)                          ;2ad9  7e            6567   6584 
    CP  C                               ;2ada  b9            6568   6585 
    JP  NZ,IFCALL                       ;2adb  c2 36 17      6569   6586 
    INC HL                              ;2ade  23            6570   6587 
    CALL    INDRCT                      ;2adf  cd a3 2a      6571   6588 
    EX  DE,HL                           ;2ae2  eb            6572   6589 
    POP HL                              ;2ae3  e1            6573   6590 
    PUSH    HL                          ;2ae4  e5            6574   6591 
    CALL    CLRFAC                      ;2ae5  cd a9 28      6575   6592 
    LD  B,C                             ;2ae8  41            6576   6593 
CVTRLP: LD  A,(DE)                      ;2ae9  1a            6577   6594 
    LD  (HL),A                          ;2aea  77            6578   6595 
    INC HL                              ;2aeb  23            6579   6596 
    INC DE                              ;2aec  13            6580   6597 
    DJNZ    CVTRLP                      ;2aed  10 fa         6581   6598 
    POP HL                              ;2aef  e1            6582   6599 
    LD  (IY+0),C                        ;2af0  fd 71 00      6583   6600 
    POP BC                              ;2af3  c1            6584   6601 
    RET                                 ;2af4  c9            6585   6602 
                                        ;                    6586   6603 ;
PARI:   PUSH    BC                      ;2af5  c5            6587   6604 
    PUSH    DE                          ;2af6  d5            6588   6605 
    PUSH    HL                          ;2af7  e5            6589   6606 
    CALL    CONDMZ                      ;2af8  cd f6 6b      6590   6607 
    CALL    INDRCT                      ;2afb  cd a3 2a      6591   6608 
    LD  A,(HL)                          ;2afe  7e            6592   6609 
    JP  Z,IFCALL                        ;2aff  ca 36 17      6593   6610 
    INC HL                              ;2b02  23            6594   6611 
    CALL    INDRCT                      ;2b03  cd a3 2a      6595   6612 
    LD  A,(HL)                          ;2b06  7e            6596   6613 
    AND A                               ;2b07  a7            6597   6614 
    LD  DE,00001h                       ;2b08  11 01 00      6598   6615 
    JP  PO,SKIMPL                       ;2b0b  e2 0f 2b      6599   6616 
    DEC DE                              ;2b0e  1b            6600   6617 
SKIMPL: POP HL                          ;2b0f  e1            6601   6618 
    CALL    FLTHEX                      ;2b10  cd 02 29      6602   6619 
    POP DE                              ;2b13  d1            6603   6620 
    POP BC                              ;2b14  c1            6604   6621 
    LD  (IY+0),4                        ;2b15  fd 36 00 04   6605   6622 
    RET                                 ;2b19  c9            6606   6623 
                                        ;                    6607   6624 ;
ENTSTR: PUSH    BC                      ;2b1a  c5            6608   6625 
    PUSH    DE                          ;2b1b  d5            6609   6626 
    PUSH    HL                          ;2b1c  e5            6610   6627 
    PUSH    HL                          ;2b1d  e5            6611   6628 
    JP  MIDHEX                          ;2b1e  c3 5a 2a      6612   6629 
                                        ;                    6613   6630 ;
CDBL:   LD  A,8                         ;2b21  3e 08         6614   6631 
    JP  CONDFL                          ;2b23  c3 eb 28      6615   6632 ;CONDFL
                                        ;                    6616   6633 ;
CSNG:   LD  A,(HL)                      ;2b26  7e            6617   6634 
    OR  A                               ;2b27  b7            6618   6635 
    JR  Z,INRETY                        ;2b28  28 51         6619   6636 
    LD  A,(IY+0)                        ;2b2a  fd 7e 00      6620   6637 
    CP  004h                            ;2b2d  fe 04         6621   6638 
    JR  Z,INRETY                        ;2b2f  28 4a         6622   6639 
    INC HL                              ;2b31  23            6623   6640 
    LD  A,(HL)                          ;2b32  7e            6624   6641 
    RES 7,(HL)                          ;2b33  cb be         6625   6642 
    DEC HL                              ;2b35  2b            6626   6643 
    PUSH    AF                          ;2b36  f5            6627   6644 
    LD  A,(HL)                          ;2b37  7e            6628   6645 
    PUSH    AF                          ;2b38  f5            6629   6646 
    LD  (HL),099h                       ;2b39  36 99         6630   6647 
    PUSH    BC                          ;2b3b  c5            6631   6648 
    CALL    ONEADD                      ;2b3c  cd ac 73      6632   6649 
    POP BC                              ;2b3f  c1            6633   6650 
    LD  A,(HL)                          ;2b40  7e            6634   6651 
    CP  09Ah                            ;2b41  fe 9a         6635   6652 
    JR  NZ,EPREST                       ;2b43  20 06         6636   6653 
    POP AF                              ;2b45  f1            6637   6654 
    INC A                               ;2b46  3c            6638   6655 
    JP  Z,OVERFL                        ;2b47  ca b8 30      6639   6656 
    PUSH    AF                          ;2b4a  f5            6640   6657 
EPREST: POP AF                          ;2b4b  f1            6641   6658 
    LD  (HL),A                          ;2b4c  77            6642   6659 
    POP AF                              ;2b4d  f1            6643   6660 
    INC HL                              ;2b4e  23            6644   6661 
    AND 080h                            ;2b4f  e6 80         6645   6662 
    OR  (HL)                            ;2b51  b6            6646   6663 
    LD  (HL),A                          ;2b52  77            6647   6664 
    DEC HL                              ;2b53  2b            6648   6665 
    LD  (IY+0),4                        ;2b54  fd 36 00 04   6649   6666 
    JR  INRETY                          ;2b58  18 21         6650   6667 
                                        ;                    6651   6668 ;
CINT:   LD  A,(HL)                      ;2b5a  7e            6652   6669 
    OR  A                               ;2b5b  b7            6653   6670 
    JR  Z,INRETY                        ;2b5c  28 1d         6654   6671 
    PUSH    HL                          ;2b5e  e5            6655   6672 
    INC HL                              ;2b5f  23            6656   6673 
    LD  A,(HL)                          ;2b60  7e            6657   6674 
    PUSH    AF                          ;2b61  f5            6658   6675 
    RES 7,(HL)                          ;2b62  cb be         6659   6676 
    DEC HL                              ;2b64  2b            6660   6677 
    PUSH    BC                          ;2b65  c5            6661   6678 
    INC (HL)                            ;2b66  34            6662   6679 
    CALL    ONEADD                      ;2b67  cd ac 73      6663   6680 
    DEC (HL)                            ;2b6a  35            6664   6681 
    POP BC                              ;2b6b  c1            6665   6682 
    INC HL                              ;2b6c  23            6666   6683 
    POP AF                              ;2b6d  f1            6667   6684 
    AND 080h                            ;2b6e  e6 80         6668   6685 
    ADD A,(HL)                          ;2b70  86            6669   6686 
    LD  (HL),A                          ;2b71  77            6670   6687 
    DEC HL                              ;2b72  2b            6671   6688 
    CALL    HLFLTO                      ;2b73  cd 97 2d      6672   6689 
    EX  DE,HL                           ;2b76  eb            6673   6690 
    POP HL                              ;2b77  e1            6674   6691 
    CALL    FLTHEX                      ;2b78  cd 02 29      6675   6692 
INRETY: LD  A,004h                      ;2b7b  3e 04         6676   6693 
    JP  CONDFL                          ;2b7d  c3 eb 28      6677   6694 
                                        ;                    6678   6695 ;
LEFT1:  CALL    CH28H                   ;2b80  cd 58 2d      6679   6696 
    LD  DE,00008h                       ;2b83  11 08 00      6680   6697 
    ADD HL,DE                           ;2b86  19            6681   6698 
    PUSH    HL                          ;2b87  e5            6682   6699 
    CALL    STEXP'                      ;2b88  cd b5 22      6683   6700 
    CALL    CH2CH                       ;2b8b  cd 61 2d      6684   6701 
    PUSH    HL                          ;2b8e  e5            6685   6702 
    DEC IY                              ;2b8f  fd 2b         6686   6703 
    LD  (IY+0),0                        ;2b91  fd 36 00 00   6687   6704 
    CALL    HLEXP                       ;2b95  cd c7 22      6688   6705 
    INC IY                              ;2b98  fd 23         6689   6706 
    CALL    CH29H                       ;2b9a  cd 66 2d      6690   6707 
    CALL    HCHECK                      ;2b9d  cd d8 22      6691   6708 
    POP HL                              ;2ba0  e1            6692   6709 
    PUSH    HL                          ;2ba1  e5            6693   6710 
    CALL    INDRCT                      ;2ba2  cd a3 2a      6694   6711 
    CP  (HL)                            ;2ba5  be            6695   6712 
    JR  C,LFTOLM                        ;2ba6  38 01         6696   6713 
    LD  A,(HL)                          ;2ba8  7e            6697   6714 
LFTOLM: INC HL                          ;2ba9  23            6698   6715 
    CALL    INDRCT                      ;2baa  cd a3 2a      6699   6716 
    EX  DE,HL                           ;2bad  eb            6700   6717 
LMIDET: POP IX                          ;2bae  dd e1         6701   6718 
    POP HL                              ;2bb0  e1            6702   6719 
    PUSH    BC                          ;2bb1  c5            6703   6720 
    LD  B,A                             ;2bb2  47            6704   6721 
    OR  A                               ;2bb3  b7            6705   6722 
    JR  Z,NOLENE                        ;2bb4  28 0f         6706   6723 
    PUSH    HL                          ;2bb6  e5            6707   6724 
    PUSH    BC                          ;2bb7  c5            6708   6725 
    EX  DE,HL                           ;2bb8  eb            6709   6726 
    LD  DE,KEYBUF                       ;2bb9  11 4f 7a      6710   6727 
    PUSH    DE                          ;2bbc  d5            6711   6728 
    LD  C,B                             ;2bbd  48            6712   6729 
    LD  B,0                             ;2bbe  06 00         6713   6730 
    LDIR                                ;2bc0  ed b0         6714   6731 
    POP DE                              ;2bc2  d1            6715   6732 
    POP BC                              ;2bc3  c1            6716   6733 
    POP HL                              ;2bc4  e1            6717   6734 
NOLENE: CALL    ENTSTR                  ;2bc5  cd 1a 2b      6718   6735 
    PUSH    HL                          ;2bc8  e5            6719   6736 
    PUSH    IX                          ;2bc9  dd e5         6720   6737 
    POP HL                              ;2bcb  e1            6721   6738 
    CALL    CONDMZ                      ;2bcc  cd f6 6b      6722   6739 
    POP HL                              ;2bcf  e1            6723   6740 
    POP BC                              ;2bd0  c1            6724   6741 
    JP  CONDSB                          ;2bd1  c3 b1 25      6725   6742 
                                        ;                    6726   6743 ;
RIGHT1: CALL    CH28H                   ;2bd4  cd 58 2d      6727   6744 
    LD  DE,00008h                       ;2bd7  11 08 00      6728   6745 
    ADD HL,DE                           ;2bda  19            6729   6746 
    PUSH    HL                          ;2bdb  e5            6730   6747 
    CALL    STEXP'                      ;2bdc  cd b5 22      6731   6748 
    CALL    CH2CH                       ;2bdf  cd 61 2d      6732   6749 
    PUSH    HL                          ;2be2  e5            6733   6750 
    DEC IY                              ;2be3  fd 2b         6734   6751 
    LD  (IY+0),0                        ;2be5  fd 36 00 00   6735   6752 
    CALL    HLEXP                       ;2be9  cd c7 22      6736   6753 
    INC IY                              ;2bec  fd 23         6737   6754 
    CALL    CH29H                       ;2bee  cd 66 2d      6738   6755 
    CALL    HCHECK                      ;2bf1  cd d8 22      6739   6756 
    POP HL                              ;2bf4  e1            6740   6757 
    PUSH    HL                          ;2bf5  e5            6741   6758 
    CALL    INDRCT                      ;2bf6  cd a3 2a      6742   6759 
    CP  (HL)                            ;2bf9  be            6743   6760 
    JR  C,NOLSRD                        ;2bfa  38 01         6744   6761 
    LD  A,(HL)                          ;2bfc  7e            6745   6762 
NOLSRD: PUSH    AF                      ;2bfd  f5            6746   6763 
    SUB (HL)                            ;2bfe  96            6747   6764 
    NEG                                 ;2bff  ed 44         6748   6765 
    INC HL                              ;2c01  23            6749   6766 
    CALL    INDRCT                      ;2c02  cd a3 2a      6750   6767 
    ADD A,L                             ;2c05  85            6751   6768 
    LD  L,A                             ;2c06  6f            6752   6769 
    LD  A,000h                          ;2c07  3e 00         6753   6770 
    ADC A,H                             ;2c09  8c            6754   6771 
    LD  H,A                             ;2c0a  67            6755   6772 
    EX  DE,HL                           ;2c0b  eb            6756   6773 
    POP AF                              ;2c0c  f1            6757   6774 
    JR  LMIDET                          ;2c0d  18 9f         6758   6775 
                                        ;                    6759   6776 ;
MID:    CALL    CH28H                   ;2c0f  cd 58 2d      6760   6777 
    LD  DE,00008h                       ;2c12  11 08 00      6761   6778 
    ADD HL,DE                           ;2c15  19            6762   6779 
    PUSH    HL                          ;2c16  e5            6763   6780 
    CALL    STEXP'                      ;2c17  cd b5 22      6764   6781 
    CALL    CH2CH                       ;2c1a  cd 61 2d      6765   6782 
    PUSH    HL                          ;2c1d  e5            6766   6783 
    DEC IY                              ;2c1e  fd 2b         6767   6784 
    LD  (IY+0),0                        ;2c20  fd 36 00 00   6768   6785 
    CALL    HLEXP                       ;2c24  cd c7 22      6769   6786 
    INC IY                              ;2c27  fd 23         6770   6787 
    EX  AF,AF'                          ;2c29  08            6771   6788 
    CALL    HCHECK                      ;2c2a  cd d8 22      6772   6789 
    OR  A                               ;2c2d  b7            6773   6790 
    JP  Z,IFCALL                        ;2c2e  ca 36 17      6774   6791 
    LD  D,A                             ;2c31  57            6775   6792 
    EX  AF,AF'                          ;2c32  08            6776   6793 
    CP  029h                            ;2c33  fe 29         6777   6794 
    LD  E,0FFh                          ;2c35  1e ff         6778   6795 
    JR  Z,MIDALL                        ;2c37  28 19         6779   6796 
    CALL    CH2CH                       ;2c39  cd 61 2d      6780   6797 
    POP HL                              ;2c3c  e1            6781   6798 
    PUSH    HL                          ;2c3d  e5            6782   6799 
    PUSH    DE                          ;2c3e  d5            6783   6800 
    DEC IY                              ;2c3f  fd 2b         6784   6801 
    LD  (IY+0),0                        ;2c41  fd 36 00 00   6785   6802 
    CALL    HLEXP                       ;2c45  cd c7 22      6786   6803 
    INC IY                              ;2c48  fd 23         6787   6804 
    CALL    CH29H                       ;2c4a  cd 66 2d      6788   6805 
    CALL    HCHECK                      ;2c4d  cd d8 22      6789   6806 
    POP DE                              ;2c50  d1            6790   6807 
    LD  E,A                             ;2c51  5f            6791   6808 
MIDALL: POP HL                          ;2c52  e1            6792   6809 
    PUSH    HL                          ;2c53  e5            6793   6810 
    CALL    INDRCT                      ;2c54  cd a3 2a      6794   6811 
    LD  A,D                             ;2c57  7a            6795   6812 
    DEC A                               ;2c58  3d            6796   6813 
    CP  (HL)                            ;2c59  be            6797   6814 
    JR  NC,MIDNUL                       ;2c5a  30 18         6798   6815 
    EX  AF,AF'                          ;2c5c  08            6799   6816 
    LD  A,(HL)                          ;2c5d  7e            6800   6817 
    SUB D                               ;2c5e  92            6801   6818 
    INC A                               ;2c5f  3c            6802   6819 
    EX  AF,AF'                          ;2c60  08            6803   6820 
    INC HL                              ;2c61  23            6804   6821 
    CALL    INDRCT                      ;2c62  cd a3 2a      6805   6822 
    ADD A,L                             ;2c65  85            6806   6823 
    LD  L,A                             ;2c66  6f            6807   6824 
    LD  A,000h                          ;2c67  3e 00         6808   6825 
    ADC A,H                             ;2c69  8c            6809   6826 
    LD  H,A                             ;2c6a  67            6810   6827 
    EX  AF,AF'                          ;2c6b  08            6811   6828 
    CP  E                               ;2c6c  bb            6812   6829 
    JR  C,KMIJL                         ;2c6d  38 01         6813   6830 
    LD  A,E                             ;2c6f  7b            6814   6831 
KMIJL:  EX  DE,HL                       ;2c70  eb            6815   6832 
MNULIS: JP  LMIDET                      ;2c71  c3 ae 2b      6816   6833 
                                        ;                    6817   6834 ;
MIDNUL: LD  DE,00000h                   ;2c74  11 00 00      6818   6835 
    XOR A                               ;2c77  af            6819   6836 
    JR  MNULIS                          ;2c78  18 f7         6820   6837 
                                        ;                    6821   6838 ;
INSTR:  PUSH    HL                      ;2c7a  e5            6822   6839 
    CALL    CH28H                       ;2c7b  cd 58 2d      6823   6840 
    LD  D,001h                          ;2c7e  16 01         6824   6841 
    DEC IY                              ;2c80  fd 2b         6825   6842 
    LD  (IY+0),0                        ;2c82  fd 36 00 00   6826   6843 
    PUSH    DE                          ;2c86  d5            6827   6844 
    CALL    EXPRSN                      ;2c87  cd f2 22      6828   6845 
    POP DE                              ;2c8a  d1            6829   6846 
    CALL    CH2CH                       ;2c8b  cd 61 2d      6830   6847 
    LD  A,(IY+0)                        ;2c8e  fd 7e 00      6831   6848 
    CP  003h                            ;2c91  fe 03         6832   6849 
    JR  Z,SINSEX                        ;2c93  28 11         6833   6850 
    CALL    HLFLTO                      ;2c95  cd 97 2d      6834   6851 
    CALL    HCHECK                      ;2c98  cd d8 22      6835   6852 
    LD  D,A                             ;2c9b  57            6836   6853 
    POP HL                              ;2c9c  e1            6837   6854 
    PUSH    HL                          ;2c9d  e5            6838   6855 
    PUSH    DE                          ;2c9e  d5            6839   6856 
    CALL    STEXP'                      ;2c9f  cd b5 22      6840   6857 
    POP DE                              ;2ca2  d1            6841   6858 
    CALL    CH2CH                       ;2ca3  cd 61 2d      6842   6859 
SINSEX: PUSH    DE                      ;2ca6  d5            6843   6860 
    PUSH    HL                          ;2ca7  e5            6844   6861 
    CALL    STEXP'                      ;2ca8  cd b5 22      6845   6862 
    CALL    CH29H                       ;2cab  cd 66 2d      6846   6863 
    LD  (BCPOTR),BC                     ;2cae  ed 43 11 2d   6847   6864 
    INC IY                              ;2cb2  fd 23         6848   6865 
    CALL    CONDMZ                      ;2cb4  cd f6 6b      6849   6866 
    CALL    INDRCT                      ;2cb7  cd a3 2a      6850   6867 
    LD  A,(HL)                          ;2cba  7e            6851   6868 
    OR  A                               ;2cbb  b7            6852   6869 
    JR  Z,INSZR1                        ;2cbc  28 5b         6853   6870 
    INC HL                              ;2cbe  23            6854   6871 
    CALL    INDRCT                      ;2cbf  cd a3 2a      6855   6872 
    EX  DE,HL                           ;2cc2  eb            6856   6873 
    LD  C,A                             ;2cc3  4f            6857   6874 
    POP HL                              ;2cc4  e1            6858   6875 
    CALL    CONDMZ                      ;2cc5  cd f6 6b      6859   6876 
    CALL    INDRCT                      ;2cc8  cd a3 2a      6860   6877 
    LD  A,(HL)                          ;2ccb  7e            6861   6878 
    OR  A                               ;2ccc  b7            6862   6879 
    JR  Z,INSZR2                        ;2ccd  28 4b         6863   6880 
    CP  C                               ;2ccf  b9            6864   6881 
    JR  C,INSZR2                        ;2cd0  38 48         6865   6882 
    LD  B,A                             ;2cd2  47            6866   6883 
    INC HL                              ;2cd3  23            6867   6884 
    CALL    INDRCT                      ;2cd4  cd a3 2a      6868   6885 
    POP AF                              ;2cd7  f1            6869   6886 
    DEC A                               ;2cd8  3d            6870   6887 
INCPL1: CP  B                           ;2cd9  b8            6871   6888 
    JR  NC,INSZR3                       ;2cda  30 3f         6872   6889 
    PUSH    AF                          ;2cdc  f5            6873   6890 
    SUB B                               ;2cdd  90            6874   6891 
    NEG                                 ;2cde  ed 44         6875   6892 
    CP  C                               ;2ce0  b9            6876   6893 
    JR  C,INSZR2                        ;2ce1  38 37         6877   6894 
    POP AF                              ;2ce3  f1            6878   6895 
    PUSH    BC                          ;2ce4  c5            6879   6896 
    PUSH    DE                          ;2ce5  d5            6880   6897 
    PUSH    HL                          ;2ce6  e5            6881   6898 
    PUSH    AF                          ;2ce7  f5            6882   6899 
    ADD A,L                             ;2ce8  85            6883   6900 
    LD  L,A                             ;2ce9  6f            6884   6901 
    LD  A,0                             ;2cea  3e 00         6885   6902 
    ADC A,H                             ;2cec  8c            6886   6903 
    LD  H,A                             ;2ced  67            6887   6904 
    LD  B,C                             ;2cee  41            6888   6905 
INSCPL: LD  A,(DE)                      ;2cef  1a            6889   6906 
    CP  (HL)                            ;2cf0  be            6890   6907 
    JR  NZ,INMTCH                       ;2cf1  20 06         6891   6908 
    INC HL                              ;2cf3  23            6892   6909 
    INC DE                              ;2cf4  13            6893   6910 
    DJNZ    INSCPL                      ;2cf5  10 f8         6894   6911 
    JR  INSRET                          ;2cf7  18 07         6895   6912 
INMTCH: POP AF                          ;2cf9  f1            6896   6913 
    POP HL                              ;2cfa  e1            6897   6914 
    POP DE                              ;2cfb  d1            6898   6915 
    POP BC                              ;2cfc  c1            6899   6916 
    INC A                               ;2cfd  3c            6900   6917 
    JR  INCPL1                          ;2cfe  18 d9         6901   6918 
                                        ;                    6902   6919 ;
INSRET: POP AF                          ;2d00  f1            6903   6920 
    POP HL                              ;2d01  e1            6904   6921 
    POP DE                              ;2d02  d1            6905   6922 
    POP BC                              ;2d03  c1            6906   6923 
    INC A                               ;2d04  3c            6907   6924 
INSZR:  LD  DE,00008h                   ;2d05  11 08 00      6908   6925 
    POP HL                              ;2d08  e1            6909   6926 
    ADD HL,DE                           ;2d09  19            6910   6927 
    LD  E,A                             ;2d0a  5f            6911   6928 
    CALL    FLTHEX                      ;2d0b  cd 02 29      6912   6929 
    LD  A,004h                          ;2d0e  3e 04         6913   6930 
    DEFB    001H                        ;2d10  01            6914   6931 ;LD BC,?
BCPOTR: DEFS    2                       ;2d11                6915   6932 
    CALL    CONDFL                      ;2d13  cd eb 28      6916   6933 
    JP  BCFTCH                          ;2d16  c3 c4 25      6917   6934 
                                        ;                    6918   6935 ;
INSZR1: POP HL                          ;2d19  e1            6919   6936 
INSZR2: POP AF                          ;2d1a  f1            6920   6937 
INSZR3: XOR A                           ;2d1b  af            6921   6938 
    JR  INSZR                           ;2d1c  18 e7         6922   6939 
                                        ;                    6923   6940 ;
FRE:    CALL    CH28H                   ;2d1e  cd 58 2d      6924   6941 
    CALL    FLEXP'                      ;2d21  cd 9c 22      6925   6942 
    CALL    CH29H                       ;2d24  cd 66 2d      6926   6943 
                                        ;                    6927   6944 ;
    PUSH    HL                          ;2d27  e5            6928   6945 
    LD  DE,(STKLMT)                     ;2d28  ed 5b 3f 7a   6929   6946 
    LD  HL,00000h                       ;2d2c  21 00 00      6930   6947 
    ADD HL,SP                           ;2d2f  39            6931   6948 
    OR  A                               ;2d30  b7            6932   6949 
    SBC HL,DE                           ;2d31  ed 52         6933   6950 
    EX  DE,HL                           ;2d33  eb            6934   6951 
    POP HL                              ;2d34  e1            6935   6952 
FREMID: CALL    FLTHEX                  ;2d35  cd 02 29      6936   6953 
    LD  A,004h                          ;2d38  3e 04         6937   6954 
    CALL    CONDFL                      ;2d3a  cd eb 28      6938   6955 
    JP  BCFTCH                          ;2d3d  c3 c4 25      6939   6956 
                                        ;                    6940   6957 ;
VARPTR: CALL    CH28H                   ;2d40  cd 58 2d      6941   6958 
    PUSH    HL                          ;2d43  e5            6942   6959 
    EX  DE,HL                           ;2d44  eb            6943   6960 
    CALL    GETVAB                      ;2d45  cd d7 1e      6944   6961 
    CALL    BCFTCH                      ;2d48  cd c4 25      6945   6962 
    CALL    CH29H                       ;2d4b  cd 66 2d      6946   6963 
    EX  DE,HL                           ;2d4e  eb            6947   6964 
    POP HL                              ;2d4f  e1            6948   6965 
    PUSH    DE                          ;2d50  d5            6949   6966 
    LD  DE,00008h                       ;2d51  11 08 00      6950   6967 
    ADD HL,DE                           ;2d54  19            6951   6968 
    POP DE                              ;2d55  d1            6952   6969 
    JR  FREMID                          ;2d56  18 dd         6953   6970 
                                        ;                    6954   6971 ;
CH28H:  CALL    BCFTCH                  ;2d58  cd c4 25      6955   6972 
    CP  028h                            ;2d5b  fe 28         6956   6973 
    RET Z                               ;2d5d  c8            6957   6974 
SERVED: JP  SERROR                      ;2d5e  c3 3a 17      6958   6975 
                                        ;                    6959   6976 ;
CH2CH:  CP  02Ch                        ;2d61  fe 2c         6960   6977 
    RET Z                               ;2d63  c8            6961   6978 
    JR  SERVED                          ;2d64  18 f8         6962   6979 
                                        ;                    6963   6980 ;
CH29H:  CP  029h                        ;2d66  fe 29         6964   6981 
    RET Z                               ;2d68  c8            6965   6982 
    JR  SERVED                          ;2d69  18 f3         6966   6983 
                                        ;                    6967   6984 ;
MEM$:   CALL    CH28H                   ;2d6b  cd 58 2d      6968   6985 
    DEC IY                              ;2d6e  fd 2b         6969   6986 
    PUSH    HL                          ;2d70  e5            6970   6987 
    CALL    FLEXP'                      ;2d71  cd 9c 22      6971   6988 
    CALL    CH2CH                       ;2d74  cd 61 2d      6972   6989 
    CALL    HLFLTO                      ;2d77  cd 97 2d      6973   6990 
    EX  DE,HL                           ;2d7a  eb            6974   6991 
    POP HL                              ;2d7b  e1            6975   6992 
    PUSH    DE                          ;2d7c  d5            6976   6993 
    CALL    FLEXP'                      ;2d7d  cd 9c 22      6977   6994 
    CALL    CH29H                       ;2d80  cd 66 2d      6978   6995 
    INC IY                              ;2d83  fd 23         6979   6996 
    PUSH    HL                          ;2d85  e5            6980   6997 
    CALL    HLFLTO                      ;2d86  cd 97 2d      6981   6998 
    CALL    HCHECK                      ;2d89  cd d8 22      6982   6999 
    POP HL                              ;2d8c  e1            6983   7000 
    POP DE                              ;2d8d  d1            6984   7001 
    PUSH    BC                          ;2d8e  c5            6985   7002 
    LD  B,A                             ;2d8f  47            6986   7003 
    CALL    ENTSTR                      ;2d90  cd 1a 2b      6987   7004 
    POP BC                              ;2d93  c1            6988   7005 
    JP  CONDSB                          ;2d94  c3 b1 25      6989   7006 
                                        ;                    6990   7007 ;
                                        ;                    6991   7008 ;
HLFLTO: CALL    HLFLT                   ;2d97  cd 67 61      6992   7009 
    RET NC                              ;2d9a  d0            6993   7010 
    JP  OVERFL                          ;2d9b  c3 b8 30      6994   7011 
                                        ;                    6995   7012 ;
GETSTR: PUSH    BC                      ;2d9e  c5            6996   7013 
    PUSH    HL                          ;2d9f  e5            6997   7014 
    PUSH    DE                          ;2da0  d5            6998   7015 
    XOR A                               ;2da1  af            6999   7016 
    LD  B,(HL)                          ;2da2  46            7000   7017 
    OR  B                               ;2da3  b0            7001   7018 
    JR  Z,NULSTR                        ;2da4  28 3d         7002   7019 
    INC HL                              ;2da6  23            7003   7020 
    LD  E,(HL)                          ;2da7  5e            7004   7021 
    INC HL                              ;2da8  23            7005   7022 
    LD  D,(HL)                          ;2da9  56            7006   7023 
    LD  HL,(STRPTR)                     ;2daa  2a 3d 7a      7007   7024 
    XOR A                               ;2dad  af            7008   7025 
    LD  C,B                             ;2dae  48            7009   7026 
    LD  B,A                             ;2daf  47            7010   7027 
    SBC HL,BC                           ;2db0  ed 42         7011   7028 
    DEC HL                              ;2db2  2b            7012   7029 
    DEC HL                              ;2db3  2b            7013   7030 
    PUSH    HL                          ;2db4  e5            7014   7031 
    PUSH    DE                          ;2db5  d5            7015   7032 
    LD  DE,(STRTOP)                     ;2db6  ed 5b 41 7a   7016   7033 
    OR  A                               ;2dba  b7            7017   7034 
    SBC HL,DE                           ;2dbb  ed 52         7018   7035 
    POP DE                              ;2dbd  d1            7019   7036 
    POP HL                              ;2dbe  e1            7020   7037 
    JR  C,PURGE                         ;2dbf  38 76         7021   7038 
    LD  (STRPTR),HL                     ;2dc1  22 3d 7a      7022   7039 
    EX  DE,HL                           ;2dc4  eb            7023   7040 
    EX  (SP),HL                         ;2dc5  e3            7024   7041 
    EX  DE,HL                           ;2dc6  eb            7025   7042 
    LD  (HL),E                          ;2dc7  73            7026   7043 
    INC HL                              ;2dc8  23            7027   7044 
    LD  (HL),D                          ;2dc9  72            7028   7045 
    INC HL                              ;2dca  23            7029   7046 
    EX  DE,HL                           ;2dcb  eb            7030   7047 
    EX  (SP),HL                         ;2dcc  e3            7031   7048 
    EX  DE,HL                           ;2dcd  eb            7032   7049 
    LD  B,C                             ;2dce  41            7033   7050 
    PUSH    HL                          ;2dcf  e5            7034   7051 
STRTRL: LD  A,(DE)                      ;2dd0  1a            7035   7052 
    LD  (HL),A                          ;2dd1  77            7036   7053 
    INC HL                              ;2dd2  23            7037   7054 
    INC DE                              ;2dd3  13            7038   7055 
    DJNZ    STRTRL                      ;2dd4  10 fa         7039   7056 
    POP DE                              ;2dd6  d1            7040   7057 
NULBCK: POP BC                          ;2dd7  c1            7041   7058 
    POP HL                              ;2dd8  e1            7042   7059 
    INC HL                              ;2dd9  23            7043   7060 
    LD  (HL),E                          ;2dda  73            7044   7061 
    INC HL                              ;2ddb  23            7045   7062 
    LD  (HL),D                          ;2ddc  72            7046   7063 
    DEC HL                              ;2ddd  2b            7047   7064 
    DEC HL                              ;2dde  2b            7048   7065 
    LD  D,B                             ;2ddf  50            7049   7066 
    LD  E,C                             ;2de0  59            7050   7067 
    POP BC                              ;2de1  c1            7051   7068 
    RET                                 ;2de2  c9            7052   7069 
                                        ;                    7053   7070 ;
NULSTR: LD  DE,00000h                   ;2de3  11 00 00      7054   7071 
    JR  NULBCK                          ;2de6  18 ef         7055   7072 
                                        ;                    7056   7073 ;
MEMPUR: LD  (BLTHLB),HL                 ;2de8  22 c1 2e      7057   7074 
    LD  (BLTDEB),DE                     ;2deb  ed 53 c4 2e   7058   7075 
    LD  (BLTBCB),BC                     ;2def  ed 43 c7 2e   7059   7076 
    POP HL                              ;2df3  e1            7060   7077 
    LD  (BLTRTA),HL                     ;2df4  22 ca 2e      7061   7078 
    CALL    STRPRG                      ;2df7  cd cc 2e      7062   7079 
    LD  HL,(STRPTR)                     ;2dfa  2a 3d 7a      7063   7080 
    LD  DE,0FC00h                       ;2dfd  11 00 fc      7064   7081 ;-400H
    ADD HL,DE                           ;2e00  19            7065   7082 
    LD  DE,(STRTOP)                     ;2e01  ed 5b 41 7a   7066   7083 
    LD  (STRTOP),HL                     ;2e05  22 41 7a      7067   7084 
    EX  DE,HL                           ;2e08  eb            7068   7085 
    LD  (MEPDEB),HL                     ;2e09  22 1d 2e      7069   7086 
    EX  DE,HL                           ;2e0c  eb            7070   7087 
    LD  HL,0                            ;2e0d  21 00 00      7071   7088 
    ADD HL,SP                           ;2e10  39            7072   7089 
    EX  DE,HL                           ;2e11  eb            7073   7090 
    OR  A                               ;2e12  b7            7074   7091 
    SBC HL,DE                           ;2e13  ed 52         7075   7092 
    LD  C,L                             ;2e15  4d            7076   7093 
    LD  B,H                             ;2e16  44            7077   7094 
    INC BC                              ;2e17  03            7078   7095 
    LD  HL,(STRTOP)                     ;2e18  2a 41 7a      7079   7096 
    EX  DE,HL                           ;2e1b  eb            7080   7097 
    DEFB    021H                        ;2e1c  21            7081   7098 ; LD HL,
MEPDEB: DEFS    2                       ;2e1d                7082   7099 
    DI                                  ;2e1f  f3            7083   7100 
    INC DE                              ;2e20  13            7084   7101 
    INC HL                              ;2e21  23            7085   7102 
    INC BC                              ;2e22  03            7086   7103 
    LDDR                                ;2e23  ed b8         7087   7104 
    EX  DE,HL                           ;2e25  eb            7088   7105 
    INC HL                              ;2e26  23            7089   7106 
    LD  SP,HL                           ;2e27  f9            7090   7107 
    EI                                  ;2e28  fb            7091   7108 
    LD  DE,(STRTOP)                     ;2e29  ed 5b 41 7a   7092   7109 
    LD  HL,(MEPDEB)                     ;2e2d  2a 1d 2e      7093   7110 
    OR  A                               ;2e30  b7            7094   7111 
    SBC HL,DE                           ;2e31  ed 52         7095   7112 
    EX  DE,HL                           ;2e33  eb            7096   7113 
    JP  MIDMPR                          ;2e34  c3 a0 2e      7097   7114 
                                        ;                    7098   7115 ;
PURGE:  CALL    STRPRG                  ;2e37  cd cc 2e      7099   7116 
    LD  HL,(STRPTR)                     ;2e3a  2a 3d 7a      7100   7117 
    SBC HL,BC                           ;2e3d  ed 42         7101   7118 
    DEC HL                              ;2e3f  2b            7102   7119 
    DEC HL                              ;2e40  2b            7103   7120 
PURAGN: LD  DE,(STRTOP)                 ;2e41  ed 5b 41 7a   7104   7121 
    OR  A                               ;2e45  b7            7105   7122 
    SBC HL,DE                           ;2e46  ed 52         7106   7123 
    JR  C,SPBLTF                        ;2e48  38 06         7107   7124 
    POP DE                              ;2e4a  d1            7108   7125 
    POP HL                              ;2e4b  e1            7109   7126 
    POP BC                              ;2e4c  c1            7110   7127 
    JP  GETSTR                          ;2e4d  c3 9e 2d      7111   7128 
                                        ;                    7112   7129 ;
SPBLTF: CALL    STKBLT                  ;2e50  cd 55 2e      7113   7130 
    JR  PURAGN                          ;2e53  18 ec         7114   7131 
                                        ;                    7115   7132 ;
STKBLT: PUSH    HL                      ;2e55  e5            7116   7133 
    PUSH    DE                          ;2e56  d5            7117   7134 
    LD  HL,00000h                       ;2e57  21 00 00      7118   7135 
    ADD HL,SP                           ;2e5a  39            7119   7136 
    EX  DE,HL                           ;2e5b  eb            7120   7137 
    LD  HL,(STKLMT)                     ;2e5c  2a 3f 7a      7121   7138 
    INC H                               ;2e5f  24            7122   7139 
    INC H                               ;2e60  24            7123   7140 
    INC H                               ;2e61  24            7124   7141 
    OR  A                               ;2e62  b7            7125   7142 
    SBC HL,DE                           ;2e63  ed 52         7126   7143 
    JP  NC,OMERR                        ;2e65  d2 88 21      7127   7144 
    POP DE                              ;2e68  d1            7128   7145 
    POP HL                              ;2e69  e1            7129   7146 
    LD  (BLTHLB),HL                     ;2e6a  22 c1 2e      7130   7147 
    LD  (BLTDEB),DE                     ;2e6d  ed 53 c4 2e   7131   7148 
    LD  (BLTBCB),BC                     ;2e71  ed 43 c7 2e   7132   7149 
    POP HL                              ;2e75  e1            7133   7150 
    LD  (BLTRTA),HL                     ;2e76  22 ca 2e      7134   7151 
    LD  HL,0                            ;2e79  21 00 00      7135   7152 
    ADD HL,SP                           ;2e7c  39            7136   7153 
    EX  DE,HL                           ;2e7d  eb            7137   7154 
    LD  HL,(STRTOP)                     ;2e7e  2a 41 7a      7138   7155 
    OR  A                               ;2e81  b7            7139   7156 
    SBC HL,DE                           ;2e82  ed 52         7140   7157 
    LD  C,L                             ;2e84  4d            7141   7158 
    LD  B,H                             ;2e85  44            7142   7159 
    INC BC                              ;2e86  03            7143   7160 
    INC BC                              ;2e87  03            7144   7161 
    LD  HL,0FE00h                       ;2e88  21 00 fe      7145   7162 ;-200H
    ADD HL,DE                           ;2e8b  19            7146   7163 
    EX  DE,HL                           ;2e8c  eb            7147   7164 
    DI                                  ;2e8d  f3            7148   7165 
    LDIR                                ;2e8e  ed b0         7149   7166 
    LD  HL,0FE00h                       ;2e90  21 00 fe      7150   7167 ;-200H
    ADD HL,SP                           ;2e93  39            7151   7168 
    LD  SP,HL                           ;2e94  f9            7152   7169 
    EI                                  ;2e95  fb            7153   7170 
    LD  DE,0FE00h                       ;2e96  11 00 fe      7154   7171 ;-200H
    LD  HL,(STRTOP)                     ;2e99  2a 41 7a      7155   7172 
    ADD HL,DE                           ;2e9c  19            7156   7173 
    LD  (STRTOP),HL                     ;2e9d  22 41 7a      7157   7174 
MIDMPR: LD  HL,(SPBUF)                  ;2ea0  2a 25 22      7158   7175 
    ADD HL,DE                           ;2ea3  19            7159   7176 
    LD  (SPBUF),HL                      ;2ea4  22 25 22      7160   7177 
    LD  BC,FUNCNS                       ;2ea7  01 2f 26      7161   7178 
BLTAJL: LD  A,(BC)                      ;2eaa  0a            7162   7179 
    LD  L,A                             ;2eab  6f            7163   7180 
    INC BC                              ;2eac  03            7164   7181 
    LD  A,(BC)                          ;2ead  0a            7165   7182 
    LD  H,A                             ;2eae  67            7166   7183 
    OR  L                               ;2eaf  b5            7167   7184 
    JR  Z,BLTRET                        ;2eb0  28 0e         7168   7185 
    ADD HL,DE                           ;2eb2  19            7169   7186 
    LD  A,H                             ;2eb3  7c            7170   7187 
    LD  (BC),A                          ;2eb4  02            7171   7188 
    DEC BC                              ;2eb5  0b            7172   7189 
    LD  A,L                             ;2eb6  7d            7173   7190 
    LD  (BC),A                          ;2eb7  02            7174   7191 
    LD  C,L                             ;2eb8  4d            7175   7192 
    LD  B,H                             ;2eb9  44            7176   7193 
    INC BC                              ;2eba  03            7177   7194 
    INC BC                              ;2ebb  03            7178   7195 
    INC BC                              ;2ebc  03            7179   7196 
    INC BC                              ;2ebd  03            7180   7197 
    JR  BLTAJL                          ;2ebe  18 ea         7181   7198 
                                        ;                    7182   7199 ;
BLTRET: DEFB    021H                    ;2ec0  21            7183   7200 ; LD HL,?
BLTHLB: DEFS    2                       ;2ec1                7184   7201 
    DEFB    011H                        ;2ec3  11            7185   7202 ; LD DE,?
BLTDEB: DEFS    2                       ;2ec4                7186   7203 
    DEFB    001H                        ;2ec6  01            7187   7204 ; LD BC,?
BLTBCB: DEFS    2                       ;2ec7                7188   7205 
    DEFB    0C3H                        ;2ec9  c3            7189   7206 ; JP ?
BLTRTA: DEFS    2                       ;2eca                7190   7207 
                                        ;                    7191   7208 ;
STRPRG: PUSH    BC                      ;2ecc  c5            7192   7209 
    PUSH    DE                          ;2ecd  d5            7193   7210 
    PUSH    HL                          ;2ece  e5            7194   7211 
    LD  HL,(STRPTR)                     ;2ecf  2a 3d 7a      7195   7212 
FSTRTP: CALL    SREDCK                  ;2ed2  cd 59 2f      7196   7213 
    LD  C,(HL)                          ;2ed5  4e            7197   7214 
    INC HL                              ;2ed6  23            7198   7215 
    LD  B,(HL)                          ;2ed7  46            7199   7216 
    INC HL                              ;2ed8  23            7200   7217 
    XOR A                               ;2ed9  af            7201   7218 
    CP  B                               ;2eda  b8            7202   7219 
    JP  NZ,FDSRTP                       ;2edb  c2 e5 2e      7203   7220 
    ADD HL,BC                           ;2ede  09            7204   7221 
    LD  (STRPTR),HL                     ;2edf  22 3d 7a      7205   7222 
    JP  FSTRTP                          ;2ee2  c3 d2 2e      7206   7223 
                                        ;                    7207   7224 ;
FDSRTP: LD  HL,(STRPTR)                 ;2ee5  2a 3d 7a      7208   7225 
SPRGLP: CALL    SREDCK                  ;2ee8  cd 59 2f      7209   7226 
    LD  C,(HL)                          ;2eeb  4e            7210   7227 
    INC HL                              ;2eec  23            7211   7228 
    LD  B,(HL)                          ;2eed  46            7212   7229 
    INC HL                              ;2eee  23            7213   7230 
    XOR A                               ;2eef  af            7214   7231 
    CP  B                               ;2ef0  b8            7215   7232 
    JR  Z,SHORTN                        ;2ef1  28 0c         7216   7233 
    LD  A,(BC)                          ;2ef3  0a            7217   7234 
    LD  E,A                             ;2ef4  5f            7218   7235 
    LD  D,0                             ;2ef5  16 00         7219   7236 
    ADD HL,DE                           ;2ef7  19            7220   7237 
    JP  SPRGLP                          ;2ef8  c3 e8 2e      7221   7238 
ESCSPR: POP HL                          ;2efb  e1            7222   7239 
    POP DE                              ;2efc  d1            7223   7240 
    POP BC                              ;2efd  c1            7224   7241 
    RET                                 ;2efe  c9            7225   7242 
                                        ;                    7226   7243 ;
SHORTN: PUSH    HL                      ;2eff  e5            7227   7244 
SHRTNL: ADD HL,BC                       ;2f00  09            7228   7245 
    EX  DE,HL                           ;2f01  eb            7229   7246 
    LD  HL,(STRBTM)                     ;2f02  2a 45 7a      7230   7247 
    XOR A                               ;2f05  af            7231   7248 
    SBC HL,DE                           ;2f06  ed 52         7232   7249 
    EX  DE,HL                           ;2f08  eb            7233   7250 
    JR  Z,STRNST                        ;2f09  28 09         7234   7251 
    LD  C,(HL)                          ;2f0b  4e            7235   7252 
    INC HL                              ;2f0c  23            7236   7253 
    LD  B,(HL)                          ;2f0d  46            7237   7254 
    INC HL                              ;2f0e  23            7238   7255 
    CP  B                               ;2f0f  b8            7239   7256 
    JR  Z,SHRTNL                        ;2f10  28 ee         7240   7257 
    DEC HL                              ;2f12  2b            7241   7258 
    DEC HL                              ;2f13  2b            7242   7259 
STRNST: POP DE                          ;2f14  d1            7243   7260 
    DEC DE                              ;2f15  1b            7244   7261 
    DEC DE                              ;2f16  1b            7245   7262 
    DEC DE                              ;2f17  1b            7246   7263 
    PUSH    HL                          ;2f18  e5            7247   7264 
    DEC HL                              ;2f19  2b            7248   7265 
    EX  DE,HL                           ;2f1a  eb            7249   7266 
    PUSH    HL                          ;2f1b  e5            7250   7267 
    LD  BC,(STRPTR)                     ;2f1c  ed 4b 3d 7a   7251   7268 
    OR  A                               ;2f20  b7            7252   7269 
    SBC HL,BC                           ;2f21  ed 42         7253   7270 
    LD  C,L                             ;2f23  4d            7254   7271 
    LD  B,H                             ;2f24  44            7255   7272 
    INC BC                              ;2f25  03            7256   7273 
    POP HL                              ;2f26  e1            7257   7274 
    PUSH    HL                          ;2f27  e5            7258   7275 
    PUSH    DE                          ;2f28  d5            7259   7276 
    EX  DE,HL                           ;2f29  eb            7260   7277 
    OR  A                               ;2f2a  b7            7261   7278 
    SBC HL,DE                           ;2f2b  ed 52         7262   7279 
    EX  DE,HL                           ;2f2d  eb            7263   7280 
    LD  HL,(STRPTR)                     ;2f2e  2a 3d 7a      7264   7281 
    ADD HL,DE                           ;2f31  19            7265   7282 
    LD  (STRPTR),HL                     ;2f32  22 3d 7a      7266   7283 
    POP DE                              ;2f35  d1            7267   7284 
    POP HL                              ;2f36  e1            7268   7285 
    LDDR                                ;2f37  ed b8         7269   7286 
    LD  HL,(STRPTR)                     ;2f39  2a 3d 7a      7270   7287 
    POP DE                              ;2f3c  d1            7271   7288 
ADRSFL: LD  C,(HL)                      ;2f3d  4e            7272   7289 
    INC HL                              ;2f3e  23            7273   7290 
    LD  B,(HL)                          ;2f3f  46            7274   7291 
    INC HL                              ;2f40  23            7275   7292 
    LD  A,(BC)                          ;2f41  0a            7276   7293 
    EX  AF,AF'                          ;2f42  08            7277   7294 
    INC BC                              ;2f43  03            7278   7295 
    LD  A,L                             ;2f44  7d            7279   7296 
    LD  (BC),A                          ;2f45  02            7280   7297 
    INC BC                              ;2f46  03            7281   7298 
    LD  A,H                             ;2f47  7c            7282   7299 
    LD  (BC),A                          ;2f48  02            7283   7300 
    EX  AF,AF'                          ;2f49  08            7284   7301 
    ADD A,L                             ;2f4a  85            7285   7302 
    LD  L,A                             ;2f4b  6f            7286   7303 
    LD  A,000h                          ;2f4c  3e 00         7287   7304 
    ADC A,H                             ;2f4e  8c            7288   7305 
    LD  H,A                             ;2f4f  67            7289   7306 
    PUSH    HL                          ;2f50  e5            7290   7307 
    SBC HL,DE                           ;2f51  ed 52         7291   7308 
    POP HL                              ;2f53  e1            7292   7309 
    JR  NZ,ADRSFL                       ;2f54  20 e7         7293   7310 
    JP  SPRGLP                          ;2f56  c3 e8 2e      7294   7311 
                                        ;                    7295   7312 ;
SREDCK: EX  DE,HL                       ;2f59  eb            7296   7313 
    LD  HL,(STRBTM)                     ;2f5a  2a 45 7a      7297   7314 
    OR  A                               ;2f5d  b7            7298   7315 
    SBC HL,DE                           ;2f5e  ed 52         7299   7316 
    EX  DE,HL                           ;2f60  eb            7300   7317 
    JR  C,OVERST                        ;2f61  38 01         7301   7318 
    RET NZ                              ;2f63  c0            7302   7319 
OVERST: POP HL                          ;2f64  e1            7303   7320 
    JP  ESCSPR                          ;2f65  c3 fb 2e      7304   7321 
                                        ;                    7305   7322 ;
SJPTBL: DEFW    GOTO                    ;2f68  b1 43         7306   7323 ; GOTO
    DEFW    GOSUB                       ;2f6a  63 42         7307   7324 ; GOSUB
    DEFW    RUN                         ;2f6c  c3 15         7308   7325 ; RUN
    DEFW    RETURN                      ;2f6e  78 41         7309   7326 ; RETURN
    DEFW    RESTOR                      ;2f70  a5 1c         7310   7327 ; RESTORE
    DEFW    LIST                        ;2f72  7e 40         7311   7328 ; LIST
    DEFW    LIST#                       ;2f74  72 40         7312   7329 ; LIST#
    DEFW    AUTO                        ;2f76  0f 37         7313   7330 ; AUTO
    DEFW    DEL                         ;2f78  8e 37         7314   7331 ; DELETE
    DEFW    FOR                         ;2f7a  6f 19         7315   7332 ; FOR
    DEFW    NEXT                        ;2f7c  0a 1a         7316   7333 ; NEXT
    DEFW    PRINT                       ;2f7e  55 18         7317   7334 ; PRINT
    DEFW    INPUT                       ;2f80  74 1d         7318   7335 ; INPUT
    DEFW    IFF                         ;2f82  01 44         7319   7336 ; IF
    DEFW    DATA                        ;2f84  c8 1c         7320   7337 ; DATA
    DEFW    READ                        ;2f86  45 1c         7321   7338 ; READ ; 90H
    DEFW    DIM                         ;2f88  03 20         7322   7339 ; DIM
    DEFW    REM                         ;2f8a  3a 18         7323   7340 ; REM
    DEFW    EDIT                        ;2f8c  22 40         7324   7341 ; EDIT
    DEFW    BREAK$                      ;2f8e  a0 16         7325   7342 ; STOP
    DEFW    CONT                        ;2f90  07 22         7326   7343 ; CONT
    DEFW    CLS                         ;2f92  42 1b         7327   7344 ; CLS
    DEFW    CLEAR                       ;2f94  ab 33         7328   7345 ; CLEAR
    DEFW    ON                          ;2f96  72 43         7329   7346 ; ON
    DEFW    LET                         ;2f98  1c 1b         7330   7347 ; LET
    DEFW    START                       ;2f9a  3d 14         7331   7348 ; START
    DEFW    POKE                        ;2f9c  23 1b         7332   7349 ; POKE
    DEFW    OFF                         ;2f9e  da 20         7333   7350 ; OFF
    DEFW    WHILE                       ;2fa0  b2 41         7334   7351 ; WHILE
    DEFW    WEND                        ;2fa2  df 41         7335   7352 ; WEND
    DEFW    REPEAT                      ;2fa4  44 42         7336   7353 ; REPEAT
    DEFW    UNTIL                       ;2fa6  3e 41         7337   7354 ; UNTIL ; A0H
    DEFW    TRACE                       ;2fa8  9b 32         7338   7355 ; TRACE
    DEFW    OK                          ;2faa  62 14         7339   7356 ; END
    DEFW    PLAY                        ;2fac  8c 47         7340   7357 ; PLAY
    DEFW    BEEPOP                      ;2fae  48 47         7341   7358 ; BEEP
    DEFW    DEFINT                      ;2fb0  30 29         7342   7359 ; DEFINT
    DEFW    DEFSNG                      ;2fb2  38 29         7343   7360 ; DEFSNG
    DEFW    DEFDBL                      ;2fb4  3c 29         7344   7361 ; DEFDBL
    DEFW    DEFSTR                      ;2fb6  34 29         7345   7362 ; DEFSTR
    DEFW    DEFFN                       ;2fb8  4d 3b         7346   7363 ; DEF
    DEFW    DUMP                        ;2fba  2f 3d         7347   7364 ; DUMP
    DEFW    LOAD                        ;2fbc  2c 39         7348   7365 ; LOAD
    DEFW    SAVE$                       ;2fbe  bb 3a         7349   7366 ; SAVE
    DEFW    MERGE                       ;2fc0  19 39         7350   7367 ; MERGE
    DEFW    NINS                        ;2fc2  fa 20         7351   7368 ; CONSOLE/WIDTH
    DEFW    OUT                         ;2fc4  67 33         7352   7369 ; OUT
    DEFW    SEARCH                      ;2fc6  2b 32         7353   7370 ; SEARCH ; B0H
    DEFW    SOUND                       ;2fc8  22 47         7354   7371 ;SOUND
    DEFW    NINS                        ;2fca  fa 20         7355   7372 ; WRITE
    DEFW    SWAP                        ;2fcc  ef 32         7356   7373 ; SWAP
    DEFW    NINS                        ;2fce  fa 20         7357   7374 ; ERASE
    DEFW    ERTEST                      ;2fd0  14 1b         7358   7375 ; ERROR
    DEFW    RESUME                      ;2fd2  4f 22         7359   7376 ; RESUME
    DEFW    RENUM                       ;2fd4  aa 37         7360   7377 ; RENUM
    DEFW    REM                         ;2fd6  3a 18         7361   7378 ; ELSE
    DEFW    CALLUP                      ;2fd8  74 29         7362   7379 ; CALL
    DEFW    LOCATE                      ;2fda  25 1c         7363   7380 ; LOCATE
    DEFW    NINS                        ;2fdc  fa 20         7364   7381 ; MAT
    DEFW    MONOP                       ;2fde  50 04         7365   7382 ; MON
    DEFW    HCOPY                       ;2fe0  d3 50         7366   7383 ; HCOPY
    DEFW    KEY                         ;2fe2  75 3e         7367   7384 ; KEY
    DEFW    VPUSH                       ;2fe4  6d 44         7368   7385 ; PUSH
    DEFW    VPOP                        ;2fe6  b4 44         7369   7386 ; POP ; C0H
    DEFW    NINS                        ;2fe8  fa 20         7370   7387 ;BASE
    DEFW    DATA                        ;2fea  c8 1c         7371   7388 ; LABEL
    DEFW    NINS                        ;2fec  fa 20         7372   7389 ; RANDOMIZE
    DEFW    SCREEN                      ;2fee  59 1b         7373   7390 ;SCREEN
    DEFW    LINE                        ;2ff0  e7 1c         7374   7391 ; LINE
    DEFW    COLOR                       ;2ff2  e9 47         7375   7392 ; COLOR
    DEFW    PSET                        ;2ff4  03 48         7376   7393 ; PSET
    DEFW    PRESET                      ;2ff6  fa 47         7377   7394 ; PRESET
    DEFW    GSAVES                      ;2ff8  ea 1b         7378   7395 ;CGINIT
    DEFW    PATTEN                      ;2ffa  28 50         7379   7396 ;PATTERN
    DEFW    CIRCLE                      ;2ffc  de 4b         7380   7397 ;CIRCLE
    DEFW    PAINT                       ;2ffe  c1 4e         7381   7398 ; PAINT
    DEFW    ROPEN                       ;3000  f4 38         7382   7399 ; ROPEN
    DEFW    WOPEN                       ;3002  51 3a         7383   7400 ; WOPEN
    DEFW    CLOSE                       ;3004  82 33         7384   7401 ; CLOSE
                                        ;                    7385   7402 ;DEFW	NINS	; FILES
                                        ;                    7386   7403 ;DEFW	NINS	; RENAME
                                        ;                    7387   7404 ;DEFW	NINS	; KILL
                                        ;                    7388   7405 ;DEFW	NINS	; LSET
                                        ;                    7389   7406 ;DEFW	NINS	; RSET
                                        ;                    7390   7407 ;DEFW	NINS	; FORMAT
                                        ;                    7391   7408 ;DEFW	NINS	; INIT
                                        ;                    7392   7409 ;DEFW	NINS	; CHAIN
                                        ;                    7393   7410 ;DEFW	NINS	; PEN
                                        ;                    7394   7411 ;DEFW	NINS	; COM
                                        ;                    7395   7412 ;DEFW	NINS	; PAUSE ; DEH
                                        ;                    7396   7413 ;
FJPTBL: DEFW    INTG                    ;3006  8d 29         7397   7414 ; INT 81H
    DEFW    RESNHL                      ;3008  c0 6b         7398   7415 ; ABS
    DEFW    B_SIN                       ;300a  57 75         7399   7416 ; SIN
    DEFW    B_COS                       ;300c  45 75         7400   7417 ; COS
    DEFW    B_TAN                       ;300e  46 76         7401   7418 ; TAN
    DEFW    B_LOG                       ;3010  bd 78         7402   7419 ; LOG 078bdh
    DEFW    B_EXP                       ;3012  ca 77         7403   7420 ; EXP
    DEFW    B_SQR                       ;3014  b9 73         7404   7421 ; SQR
    DEFW    B_RND                       ;3016  99 77         7405   7422 ; RND
    DEFW    PEEK                        ;3018  14 2a         7406   7423 ; PEEK
    DEFW    B_ATN                       ;301a  77 74         7407   7424 ; ATN
    DEFW    B_SGN                       ;301c  52 77         7408   7425 ; SGN
    DEFW    FRACSB                      ;301e  0e 2a         7409   7426 ; FRAC
    DEFW    INT                         ;3020  10 60         7410   7427 ; FIX
    DEFW    B_PAI                       ;3022  6f 77         7411   7428 ; PAI   776fh
    DEFW    B_RAD                       ;3024  6a 77         7412   7429 ; RAD 90H 776ah
    DEFW    B_INP                       ;3026  88 77         7413   7430 ; INP   7788h
    DEFW    CDBL                        ;3028  21 2b         7414   7431 ; CDBL
    DEFW    CSNG                        ;302a  26 2b         7415   7432 ; CSNG
    DEFW    CINT                        ;302c  5a 2b         7416   7433 ; CINT
    DEFW    NINS                        ;302e  fa 20         7417   7434 ; DSKF
    DEFW    NINS                        ;3030  fa 20         7418   7435 ; EOF
    DEFW    NINS                        ;3032  fa 20         7419   7436 ; FPOS
    DEFW    NINS                        ;3034  fa 20         7420   7437 ; LOC
    DEFW    NINS                        ;3036  fa 20         7421   7438 ; LOF
    DEFW    POS                         ;3038  4f 37         7422   7439 ; POS
    DEFW    LPOS                        ;303a  4a 37         7423   7440 ; LPOS
    DEFW    B_FACG                      ;303c  2b 74         7424   7441 ; FAC
    DEFW    B_SUM                       ;303e  09 74         7425   7442 ; SUM
    DEFW    NINS                        ;3040  fa 20         7426   7443 ; REV
    DEFW    NINS                        ;3042  fa 20         7427   7444 ; DUMMY
    DEFW    CHRSUB                      ;3044  74 28         7428   7445 ; CHR$ A0H
    DEFW    STRSUB                      ;3046  53 2a         7429   7446 ; STR$
    DEFW    HEXD                        ;3048  26 2a         7430   7447 ; HEX$
    DEFW    OCTD                        ;304a  42 2a         7431   7448 ; OCT$
    DEFW    MK1                         ;304c  75 2a         7432   7449 ; MK1$
    DEFW    MKS                         ;304e  88 2a         7433   7450 ; MKS$
    DEFW    MKD                         ;3050  8e 2a         7434   7451 ; MKD$
    DEFW    SPCSUB                      ;3052  e8 29         7435   7452 ; SPACE$
    DEFW    SPCSUB                      ;3054  e8 29         7436   7453 ; SPC
    DEFW    ASCSUB                      ;3056  d6 27         7437   7454 ; ASC A9H
    DEFW    LENSUB                      ;3058  cb 27         7438   7455 ; LEN
    DEFW    VALSUB                      ;305a  f9 27         7439   7456 ; VAL
    DEFW    CVS                         ;305c  cf 2a         7440   7457 ; CVS
    DEFW    CVD                         ;305e  ca 2a         7441   7458 ; CVD
    DEFW    CVI                         ;3060  aa 2a         7442   7459 ; CVI
    DEFW    NINS                        ;3062  fa 20         7443   7460 ; STAT
    DEFW    PARI                        ;3064  f5 2a         7444   7461 ; PARITY
    DEFW    NINS                        ;3066  fa 20         7445   7462 ; 
    DEFW    LEFT1                       ;3068  80 2b         7446   7463 ; LEFT$ (CVI)
    DEFW    RIGHT1                      ;306a  d4 2b         7447   7464 ; RIGHT$
    DEFW    MID                         ;306c  0f 2c         7448   7465 ; MID$
    DEFW    INKEY                       ;306e  28 28         7449   7466 ; INKEY$
    DEFW    INSTR                       ;3070  7a 2c         7450   7467 ; INSTR
    DEFW    FRE                         ;3072  1e 2d         7451   7468 ; FRE
    DEFW    MEM$                        ;3074  6b 2d         7452   7469 ; MEM$
    DEFW    SCRN$                       ;3076  c4 3c         7453   7470 ; SCRN
    DEFW    VARPTR                      ;3078  40 2d         7454   7471 ; VARPTR
    DEFW    STRING                      ;307a  b8 29         7455   7472 ; STRING$
    DEFW    NINS                        ;307c  fa 20         7456   7473 ; TIME$
    DEFW    FNOPR                       ;307e  f4 3b         7457   7474 ;
    DEFW    USROPR                      ;3080  78 3c         7458   7475 ; USR
    DEFW    ERR                         ;3082  58 37         7459   7476 ; ERR
    DEFW    ERL                         ;3084  72 37         7460   7477 ; ERL
    DEFW    CSRLIN                      ;3086  e8 3e         7461   7478 ; CSRLIN
                                        ;                    7462   7479 ;
                                        ;                    7463   7480 ;
DFTABL: DEFS    26                      ;3088                7464   7481 
                                        ;                    7465   7482 ;
USRTBL: DEFS    20                      ;30a2                7466   7483 
                                        ;                    7467   7484 ;
ADHLHL: ADD HL,HL                       ;30b6  29            7468   7485 
    RET NC                              ;30b7  d0            7469   7486 
OVERFL: LD  A,6                         ;30b8  3e 06         7470   7487 
    JP  ERROR                           ;30ba  c3 96 21      7471   7488 
                                        ;                    7472   7489 ;
CVBCAS: PUSH    HL                      ;30bd  e5            7473   7490 
    CALL    HEXCUL                      ;30be  cd d0 30      7474   7491 
    LD  C,L                             ;30c1  4d            7475   7492 
    LD  B,H                             ;30c2  44            7476   7493 
    DEC DE                              ;30c3  1b            7477   7494 
    DEC DE                              ;30c4  1b            7478   7495 
    POP HL                              ;30c5  e1            7479   7496 
CVBABS: LD  A,(DE)                      ;30c6  1a            7480   7497 
    CP  020h                            ;30c7  fe 20         7481   7498 
    JR  NZ,INCRTM                       ;30c9  20 03         7482   7499 
    DEC DE                              ;30cb  1b            7483   7500 
    JR  CVBABS                          ;30cc  18 f8         7484   7501 
                                        ;                    7485   7502 ;
INCRTM: INC DE                          ;30ce  13            7486   7503 
    RET                                 ;30cf  c9            7487   7504 
                                        ;                    7488   7505 ;
HEXCUL: LD  HL,00000h                   ;30d0  21 00 00      7489   7506 
LNOCLP: CALL    DEFTCH                  ;30d3  cd 51 5d      7490   7507 
    SUB 030h                            ;30d6  d6 30         7491   7508 
    RET C                               ;30d8  d8            7492   7509 
    CP  00Ah                            ;30d9  fe 0a         7493   7510 
    RET NC                              ;30db  d0            7494   7511 
    CALL    ADHLHL                      ;30dc  cd b6 30      7495   7512 
    LD  C,L                             ;30df  4d            7496   7513 
    LD  B,H                             ;30e0  44            7497   7514 
    CALL    ADHLHL                      ;30e1  cd b6 30      7498   7515 
    CALL    ADHLHL                      ;30e4  cd b6 30      7499   7516 
    ADD HL,BC                           ;30e7  09            7500   7517 
    JR  C,OVERFL                        ;30e8  38 ce         7501   7518 
    LD  C,A                             ;30ea  4f            7502   7519 
    LD  B,0                             ;30eb  06 00         7503   7520 
    ADD HL,BC                           ;30ed  09            7504   7521 
    JR  C,OVERFL                        ;30ee  38 c8         7505   7522 
    JR  LNOCLP                          ;30f0  18 e1         7506   7523 
                                        ;                    7507   7524 ;
EDITOR: CALL    CLR                     ;30f2  cd 51 19      7508   7525 
    XOR A                               ;30f5  af            7509   7526 
    LD  (CONTFG),A                      ;30f6  32 08 22      7510   7527 
    LD  (ERRORF),A                      ;30f9  32 50 22      7511   7528 
    CALL    RETLNO                      ;30fc  cd 0a 3f      7512   7529 
    CALL    HEXCUL                      ;30ff  cd d0 30      7513   7530 
    LD  (EDLINE),HL                     ;3102  22 2a 37      7514   7531 
    ADD A,030h                          ;3105  c6 30         7515   7532 
    DEC DE                              ;3107  1b            7516   7533 
    JR  Z,DELMIK                        ;3108  28 0f         7517   7534 
    DEC DE                              ;310a  1b            7518   7535 
RSFGLP: LD  A,(DE)                      ;310b  1a            7519   7536 
    CP  020h                            ;310c  fe 20         7520   7537 
    DEC DE                              ;310e  1b            7521   7538 
    JR  Z,RSFGLP                        ;310f  28 fa         7522   7539 
    INC DE                              ;3111  13            7523   7540 
    INC DE                              ;3112  13            7524   7541 
    LD  A,(DE)                          ;3113  1a            7525   7542 
    CP  020h                            ;3114  fe 20         7526   7543 
    JR  NZ,DELMIK                       ;3116  20 01         7527   7544 
    INC DE                              ;3118  13            7528   7545 
DELMIK: PUSH    HL                      ;3119  e5            7529   7546 
    PUSH    AF                          ;311a  f5            7530   7547 
    LD  HL,IMDBUF                       ;311b  21 4e 7b      7531   7548 
    CALL    CVIMTX                      ;311e  cd 25 63      7532   7549 
    LD  (IMLSTP),HL                     ;3121  22 2f 31      7533   7550 
    POP AF                              ;3124  f1            7534   7551 
    POP HL                              ;3125  e1            7535   7552 
    LD  E,L                             ;3126  5d            7536   7553 
    LD  D,H                             ;3127  54            7537   7554 
    CALL    DELETE1                     ;3128  cd a5 31      7538   7555 
    OR  A                               ;312b  b7            7539   7556 
    RET Z                               ;312c  c8            7540   7557 
    PUSH    HL                          ;312d  e5            7541   7558 
    DEFB    021H                        ;312e  21            7542   7559 ; LD HL,?
IMLSTP: DEFS    2                       ;312f                7543   7560 
    LD  DE,IMDBUF                       ;3131  11 4e 7b      7544   7561 
    OR  A                               ;3134  b7            7545   7562 
    SBC HL,DE                           ;3135  ed 52         7546   7563 
    INC HL                              ;3137  23            7547   7564 
    INC HL                              ;3138  23            7548   7565 
    INC HL                              ;3139  23            7549   7566 
    INC HL                              ;313a  23            7550   7567 
    INC HL                              ;313b  23            7551   7568 
    EX  (SP),HL                         ;313c  e3            7552   7569 
    LD  C,L                             ;313d  4d            7553   7570 
    LD  B,H                             ;313e  44            7554   7571 
    LD  HL,TEXTST                       ;313f  21 4e 7c      7555   7572 
    JR  IMDENS                          ;3142  18 04         7556   7573 
                                        ;                    7557   7574 ;
ENOSLP: LD  E,(HL)                      ;3144  5e            7558   7575 
    INC HL                              ;3145  23            7559   7576 
    LD  D,(HL)                          ;3146  56            7560   7577 
    EX  DE,HL                           ;3147  eb            7561   7578 
IMDENS: LD  E,(HL)                      ;3148  5e            7562   7579 
    INC HL                              ;3149  23            7563   7580 
    LD  D,(HL)                          ;314a  56            7564   7581 
    DEC HL                              ;314b  2b            7565   7582 
    LD  A,D                             ;314c  7a            7566   7583 
    OR  E                               ;314d  b3            7567   7584 
    JR  Z,EAPEND                        ;314e  28 0e         7568   7585 
    INC HL                              ;3150  23            7569   7586 
    INC HL                              ;3151  23            7570   7587 
    LD  E,(HL)                          ;3152  5e            7571   7588 
    INC HL                              ;3153  23            7572   7589 
    LD  D,(HL)                          ;3154  56            7573   7590 
    EX  DE,HL                           ;3155  eb            7574   7591 
    SBC HL,BC                           ;3156  ed 42         7575   7592 
    DEC DE                              ;3158  1b            7576   7593 
    DEC DE                              ;3159  1b            7577   7594 
    DEC DE                              ;315a  1b            7578   7595 
    EX  DE,HL                           ;315b  eb            7579   7596 
    JR  C,ENOSLP                        ;315c  38 e6         7580   7597 
EAPEND: POP DE                          ;315e  d1            7581   7598 
    PUSH    BC                          ;315f  c5            7582   7599 ; L NO
    PUSH    HL                          ;3160  e5            7583   7600 ; INS POINTER
    PUSH    DE                          ;3161  d5            7584   7601 ; LENGTH
    EX  DE,HL                           ;3162  eb            7585   7602 
    LD  HL,(VSTART)                     ;3163  2a 3b 7a      7586   7603 
    PUSH    HL                          ;3166  e5            7587   7604 
    SBC HL,DE                           ;3167  ed 52         7588   7605 
    LD  C,L                             ;3169  4d            7589   7606 
    LD  B,H                             ;316a  44            7590   7607 
    POP HL                              ;316b  e1            7591   7608 
    POP DE                              ;316c  d1            7592   7609 
    PUSH    DE                          ;316d  d5            7593   7610 
    EX  DE,HL                           ;316e  eb            7594   7611 
    ADD HL,DE                           ;316f  19            7595   7612 
    CALL    HMEMCK                      ;3170  cd ab 1e      7596   7613 
    LD  (VSTART),HL                     ;3173  22 3b 7a      7597   7614 
    EX  DE,HL                           ;3176  eb            7598   7615 
    INC BC                              ;3177  03            7599   7616 
    LDDR                                ;3178  ed b8         7600   7617 
    POP BC                              ;317a  c1            7601   7618 ; LENGTH
    POP DE                              ;317b  d1            7602   7619 ; INS POINTER
    POP HL                              ;317c  e1            7603   7620 ; L NO
    PUSH    DE                          ;317d  d5            7604   7621 
    EX  DE,HL                           ;317e  eb            7605   7622 
    INC HL                              ;317f  23            7606   7623 
    INC HL                              ;3180  23            7607   7624 
    LD  (HL),E                          ;3181  73            7608   7625 
    INC HL                              ;3182  23            7609   7626 
    LD  (HL),D                          ;3183  72            7610   7627 
    INC HL                              ;3184  23            7611   7628 
    EX  DE,HL                           ;3185  eb            7612   7629 
    LD  HL,IMDBUF                       ;3186  21 4e 7b      7613   7630 
    PUSH    BC                          ;3189  c5            7614   7631 
    DEC BC                              ;318a  0b            7615   7632 
    DEC BC                              ;318b  0b            7616   7633 
    DEC BC                              ;318c  0b            7617   7634 
    DEC BC                              ;318d  0b            7618   7635 
    LDIR                                ;318e  ed b0         7619   7636 
    POP BC                              ;3190  c1            7620   7637 
    POP HL                              ;3191  e1            7621   7638 
    LD  (HL),E                          ;3192  73            7622   7639 
    INC HL                              ;3193  23            7623   7640 
    LD  (HL),D                          ;3194  72            7624   7641 
    EX  DE,HL                           ;3195  eb            7625   7642 
RELPTR: LD  E,(HL)                      ;3196  5e            7626   7643 
    INC HL                              ;3197  23            7627   7644 
    LD  D,(HL)                          ;3198  56            7628   7645 
    LD  A,D                             ;3199  7a            7629   7646 
    OR  E                               ;319a  b3            7630   7647 
    RET Z                               ;319b  c8            7631   7648 
    EX  DE,HL                           ;319c  eb            7632   7649 
    ADD HL,BC                           ;319d  09            7633   7650 
    EX  DE,HL                           ;319e  eb            7634   7651 
    LD  (HL),D                          ;319f  72            7635   7652 
    DEC HL                              ;31a0  2b            7636   7653 
    LD  (HL),E                          ;31a1  73            7637   7654 
    EX  DE,HL                           ;31a2  eb            7638   7655 
    JR  RELPTR                          ;31a3  18 f1         7639   7656 
                                        ;                    7640   7657 ;
DELETE1: PUSH   AF                      ;31a5  f5            7641   7658 ; 315ah
    PUSH    BC                          ;31a6  c5            7642   7659 
    PUSH    HL                          ;31a7  e5            7643   7660 
    PUSH    DE                          ;31a8  d5            7644   7661 
    LD  C,L                             ;31a9  4d            7645   7662 
    LD  B,H                             ;31aa  44            7646   7663 
    LD  HL,TEXTST                       ;31ab  21 4e 7c      7647   7664 
FSTLOP: LD  E,(HL)                      ;31ae  5e            7648   7665 
    INC HL                              ;31af  23            7649   7666 
    LD  D,(HL)                          ;31b0  56            7650   7667 
    INC HL                              ;31b1  23            7651   7668 
    LD  A,E                             ;31b2  7b            7652   7669 
    OR  D                               ;31b3  b2            7653   7670 
    JR  NZ,FDDLST                       ;31b4  20 08         7654   7671 
RTDLTE: POP DE                          ;31b6  d1            7655   7672 
    POP HL                              ;31b7  e1            7656   7673 
    POP BC                              ;31b8  c1            7657   7674 
    POP AF                              ;31b9  f1            7658   7675 
    RET                                 ;31ba  c9            7659   7676 
                                        ;                    7660   7677 ;
POPDLR: POP DE                          ;31bb  d1            7661   7678 
    JR  RTDLTE                          ;31bc  18 f8         7662   7679 
                                        ;                    7663   7680 ;
FDDLST: PUSH    DE                      ;31be  d5            7664   7681 
    LD  E,(HL)                          ;31bf  5e            7665   7682 
    INC HL                              ;31c0  23            7666   7683 
    LD  D,(HL)                          ;31c1  56            7667   7684 
    EX  DE,HL                           ;31c2  eb            7668   7685 
    LD  (LNOTBF),HL                     ;31c3  22 d3 31      7669   7686 
    SBC HL,BC                           ;31c6  ed 42         7670   7687 
    POP HL                              ;31c8  e1            7671   7688 
    JR  C,FSTLOP                        ;31c9  38 e3         7672   7689 
    DEC DE                              ;31cb  1b            7673   7690 
    DEC DE                              ;31cc  1b            7674   7691 
    DEC DE                              ;31cd  1b            7675   7692 
    POP BC                              ;31ce  c1            7676   7693 ; DELETE END LINE NO.
    PUSH    BC                          ;31cf  c5            7677   7694 
    PUSH    DE                          ;31d0  d5            7678   7695 ; DELETE START ADRS
    PUSH    HL                          ;31d1  e5            7679   7696 ; NEXT LINE ADRS
    DEFB    021H                        ;31d2  21            7680   7697 ; LD HL,?
LNOTBF: DEFS    2                       ;31d3                7681   7698 
    SBC HL,BC                           ;31d5  ed 42         7682   7699 
    POP HL                              ;31d7  e1            7683   7700 
    JR  Z,DLSTRT                        ;31d8  28 1a         7684   7701 ; DEL-LINE END FOUND
    JR  NC,POPDLR                       ;31da  30 df         7685   7702 ; NOTHING OCCUR
SNDDLP: LD  E,(HL)                      ;31dc  5e            7686   7703 ; END S-LOOP
    INC HL                              ;31dd  23            7687   7704 
    LD  D,(HL)                          ;31de  56            7688   7705 
    INC HL                              ;31df  23            7689   7706 
    LD  A,D                             ;31e0  7a            7690   7707 
    OR  E                               ;31e1  b3            7691   7708 
    JR  Z,DLEFD'                        ;31e2  28 0e         7692   7709 
    PUSH    DE                          ;31e4  d5            7693   7710 
    LD  E,(HL)                          ;31e5  5e            7694   7711 
    INC HL                              ;31e6  23            7695   7712 
    LD  D,(HL)                          ;31e7  56            7696   7713 
    EX  DE,HL                           ;31e8  eb            7697   7714 
    SBC HL,BC                           ;31e9  ed 42         7698   7715 
    POP HL                              ;31eb  e1            7699   7716 
    JR  C,SNDDLP                        ;31ec  38 ee         7700   7717 
    JR  Z,DLSTRT                        ;31ee  28 04         7701   7718 
    EX  DE,HL                           ;31f0  eb            7702   7719 
    DEC HL                              ;31f1  2b            7703   7720 
DLEFD': DEC HL                          ;31f2  2b            7704   7721 
    DEC HL                              ;31f3  2b            7705   7722 
DLSTRT: POP DE                          ;31f4  d1            7706   7723 
    PUSH    DE                          ;31f5  d5            7707   7724 
    PUSH    HL                          ;31f6  e5            7708   7725 
    OR  A                               ;31f7  b7            7709   7726 
    SBC HL,DE                           ;31f8  ed 52         7710   7727 
    LD  C,L                             ;31fa  4d            7711   7728 
    LD  B,H                             ;31fb  44            7712   7729 
    POP HL                              ;31fc  e1            7713   7730 
    POP DE                              ;31fd  d1            7714   7731 
    PUSH    BC                          ;31fe  c5            7715   7732 
    PUSH    DE                          ;31ff  d5            7716   7733 
    PUSH    DE                          ;3200  d5            7717   7734 
    PUSH    HL                          ;3201  e5            7718   7735 
    EX  DE,HL                           ;3202  eb            7719   7736 
    LD  HL,(VSTART)                     ;3203  2a 3b 7a      7720   7737 
    OR  A                               ;3206  b7            7721   7738 
    SBC HL,DE                           ;3207  ed 52         7722   7739 
    LD  C,L                             ;3209  4d            7723   7740 
    LD  B,H                             ;320a  44            7724   7741 
    POP HL                              ;320b  e1            7725   7742 
    POP DE                              ;320c  d1            7726   7743 
    LDIR                                ;320d  ed b0         7727   7744 
    EX  DE,HL                           ;320f  eb            7728   7745 
    LD  (VSTART),HL                     ;3210  22 3b 7a      7729   7746 
    CALL    CLR                         ;3213  cd 51 19      7730   7747 
    POP HL                              ;3216  e1            7731   7748 
    POP BC                              ;3217  c1            7732   7749 
DRNLOP: LD  E,(HL)                      ;3218  5e            7733   7750 
    INC HL                              ;3219  23            7734   7751 
    LD  D,(HL)                          ;321a  56            7735   7752 
    LD  A,D                             ;321b  7a            7736   7753 
    OR  E                               ;321c  b3            7737   7754 
    JP  Z,RTDLTE                        ;321d  ca b6 31      7738   7755 
    EX  DE,HL                           ;3220  eb            7739   7756 
    OR  A                               ;3221  b7            7740   7757 
    SBC HL,BC                           ;3222  ed 42         7741   7758 
    EX  DE,HL                           ;3224  eb            7742   7759 
    LD  (HL),D                          ;3225  72            7743   7760 
    DEC HL                              ;3226  2b            7744   7761 
    LD  (HL),E                          ;3227  73            7745   7762 
    EX  DE,HL                           ;3228  eb            7746   7763 
    JR  DRNLOP                          ;3229  18 ed         7747   7764 
                                        ;                    7748   7765 ;
                                        ;                    7749   7766 ;
                                        ;                    7750   7767 ;	CHAIN	,LIST
                                        ;                    7751   7768 ;
                                        ;                    7752   7769 ;   LIST
                                        ;                    7753   7770 ;
SEARCH: XOR A                           ;322b  af            7754   7771 
    LD  (DISFLG),A                      ;322c  32 eb 11      7755   7772 
    CALL    HLFTCH                      ;322f  cd 87 29      7756   7773 
    CP  023h                            ;3232  fe 23         7757   7774 
    JR  NZ,SEARC'                       ;3234  20 06         7758   7775 
    LD  A,2                             ;3236  3e 02         7759   7776 
    LD  (DISFLG),A                      ;3238  32 eb 11      7760   7777 
    INC HL                              ;323b  23            7761   7778 
SEARC': CALL    STREXZ                  ;323c  cd 9b 45      7762   7779 
    OR  A                               ;323f  b7            7763   7780 
    JP  Z,IFCALL                        ;3240  ca 36 17      7764   7781 
    PUSH    BC                          ;3243  c5            7765   7782 
    LD  (SERLEN),A                      ;3244  32 90 32      7766   7783 
    LD  (MATLEN),A                      ;3247  32 62 32      7767   7784 
    LD  (SERDEB),DE                     ;324a  ed 53 95 32   7768   7785 
    LD  (MARDEB),DE                     ;324e  ed 53 5c 32   7769   7786 
    CALL    SLIST                       ;3252  cd 50 40      7770   7787 
    POP HL                              ;3255  e1            7771   7788 
    DEC HL                              ;3256  2b            7772   7789 
    RET                                 ;3257  c9            7773   7790 
                                        ;                    7774   7791 ;
SERVEC: PUSH    DE                      ;3258  d5            7775   7792 
    PUSH    HL                          ;3259  e5            7776   7793 
    LD  B,A                             ;325a  47            7777   7794 
    DEFB    021H                        ;325b  21            7778   7795 ; LD HL,?
MARDEB: DEFS    2                       ;325c                7779   7796 
    CP  (HL)                            ;325e  be            7780   7797 
    JR  NZ,SERNMT                       ;325f  20 11         7781   7798 
    DEFB    03EH                        ;3261  3e            7782   7799 ; LD A,?
MATLEN: DEFS    1                       ;3262                7783   7800 
    DEC A                               ;3263  3d            7784   7801 
    LD  (MATLEN),A                      ;3264  32 62 32      7785   7802 
    JR  Z,MATLIS                        ;3267  28 0e         7786   7803 
    INC HL                              ;3269  23            7787   7804 
    LD  (MARDEB),HL                     ;326a  22 5c 32      7788   7805 
SERRTT: POP HL                          ;326d  e1            7789   7806 
    POP DE                              ;326e  d1            7790   7807 
    JP  CTIRTR                          ;326f  c3 00 41      7791   7808 
                                        ;                    7792   7809 ;
SERNMT: CALL    SERINT                  ;3272  cd 8f 32      7793   7810 
    JR  SERRTT                          ;3275  18 f6         7794   7811 
                                        ;                    7795   7812 ;
MATLIS: DEFB    011H                    ;3277  11            7796   7813 ; LD DE,?
SERDIS: DEFS    2                       ;3278                7797   7814 
SERLPP: LD  A,(DE)                      ;327a  1a            7798   7815 
    OR  A                               ;327b  b7            7799   7816 
    JR  Z,ESSRSP                        ;327c  28 06         7800   7817 
    CALL    ACCPRT                      ;327e  cd 64 08      7801   7818 
    INC DE                              ;3281  13            7802   7819 
    JR  SERLPP                          ;3282  18 f6         7803   7820 
                                        ;                    7804   7821 ;
ESSRSP: CALL    CR2                     ;3284  cd 23 08      7805   7822 
    JR  SERRTT                          ;3287  18 e4         7806   7823 
                                        ;                    7807   7824 ;
SER0DH: CALL    SERINT                  ;3289  cd 8f 32      7808   7825 
    JP  LISCRC                          ;328c  c3 11 41      7809   7826 
                                        ;                    7810   7827 ;
SERINT: DEFB    03EH                    ;328f  3e            7811   7828 ; LD A,?
SERLEN: DEFS    1                       ;3290                7812   7829 
    LD  (MATLEN),A                      ;3291  32 62 32      7813   7830 
    DEFB    021H                        ;3294  21            7814   7831 ; LD HL,?
SERDEB: DEFS    2                       ;3295                7815   7832 
    LD  (MARDEB),HL                     ;3297  22 5c 32      7816   7833 
    RET                                 ;329a  c9            7817   7834 
                                        ;                    7818   7835 ;
TRACE:  CALL    HLFTCH                  ;329b  cd 87 29      7819   7836 
    OR  A                               ;329e  b7            7820   7837 
    JR  Z,TROFF                         ;329f  28 49         7821   7838 
    CP  03Ah                            ;32a1  fe 3a         7822   7839 
    JR  Z,TROFF                         ;32a3  28 45         7823   7840 
    CALL    STREXZ                      ;32a5  cd 9b 45      7824   7841 
    LD  A,(HL)                          ;32a8  7e            7825   7842 
    OR  A                               ;32a9  b7            7826   7843 
    JR  Z,TRCOFF                        ;32aa  28 38         7827   7844 
    PUSH    BC                          ;32ac  c5            7828   7845 
    INC HL                              ;32ad  23            7829   7846 
    LD  B,A                             ;32ae  47            7830   7847 
    CALL    INDRCT                      ;32af  cd a3 2a      7831   7848 
    CALL    TROFF                       ;32b2  cd ea 32      7832   7849 
    EX  DE,HL                           ;32b5  eb            7833   7850 
    LD  HL,TRACEF                       ;32b6  21 29 16      7834   7851 
TRLTPR: LD  A,(DE)                      ;32b9  1a            7835   7852 
    CP  048h                            ;32ba  fe 48         7836   7853 ; HOME?
    JR  NZ,TRACL0                       ;32bc  20 02         7837   7854 
    SET 0,(HL)                          ;32be  cb c6         7838   7855 
TRACL0: CP  050h                        ;32c0  fe 50         7839   7856 
    JR  NZ,TRACL1                       ;32c2  20 02         7840   7857 ; PRINTER?
    SET 1,(HL)                          ;32c4  cb ce         7841   7858 
TRACL1: CP  04Eh                        ;32c6  fe 4e         7842   7859 ; NUMBER?
    JR  NZ,TRACL2                       ;32c8  20 02         7843   7860 
    SET 2,(HL)                          ;32ca  cb d6         7844   7861 
TRACL2: CP  04Ch                        ;32cc  fe 4c         7845   7862 ; LIST?
    JR  NZ,TRACL3                       ;32ce  20 02         7846   7863 
    SET 3,(HL)                          ;32d0  cb de         7847   7864 
TRACL3: CP  053h                        ;32d2  fe 53         7848   7865 ; STEP?
    JR  NZ,TRACL4                       ;32d4  20 02         7849   7866 
    SET 4,(HL)                          ;32d6  cb e6         7850   7867 
TRACL4: CP  044h                        ;32d8  fe 44         7851   7868 ; DUMP?
    JR  NZ,TRACLP                       ;32da  20 02         7852   7869 
    SET 5,(HL)                          ;32dc  cb ee         7853   7870 
TRACLP: INC DE                          ;32de  13            7854   7871 
    DJNZ    TRLTPR                      ;32df  10 d8         7855   7872 
    POP BC                              ;32e1  c1            7856   7873 
    JR  RTTRAC                          ;32e2  18 03         7857   7874 
                                        ;                    7858   7875 ;
TRCOFF: CALL    TROFF                   ;32e4  cd ea 32      7859   7876 
RTTRAC: JP  RETIRQ                      ;32e7  c3 39 1b      7860   7877 
                                        ;                    7861   7878 ;
TROFF:  XOR A                           ;32ea  af            7862   7879 
    LD  (TRACEF),A                      ;32eb  32 29 16      7863   7880 
    RET                                 ;32ee  c9            7864   7881 
                                        ;                    7865   7882 ;
SWAP:   LD  C,L                         ;32ef  4d            7866   7883 
    LD  B,H                             ;32f0  44            7867   7884 
    CALL    GETVAC                      ;32f1  cd d3 1e      7868   7885 
    PUSH    HL                          ;32f4  e5            7869   7886 
    PUSH    AF                          ;32f5  f5            7870   7887 
    CALL    BCFTCH                      ;32f6  cd c4 25      7871   7888 
    CALL    CH2CH                       ;32f9  cd 61 2d      7872   7889 
    CALL    GETVAC                      ;32fc  cd d3 1e      7873   7890 
    POP DE                              ;32ff  d1            7874   7891 
    CP  D                               ;3300  ba            7875   7892 
    JP  NZ,TYPEMS                       ;3301  c2 32 17      7876   7893 
    POP DE                              ;3304  d1            7877   7894 
    PUSH    AF                          ;3305  f5            7878   7895 
    PUSH    BC                          ;3306  c5            7879   7896 
    LD  B,A                             ;3307  47            7880   7897 
    LD  C,B                             ;3308  48            7881   7898 
    PUSH    HL                          ;3309  e5            7882   7899 
    PUSH    DE                          ;330a  d5            7883   7900 
    LD  (SWAPHL),DE                     ;330b  ed 53 49 33   7884   7901 
    LD  HL,ZFAC                         ;330f  21 f2 62      7885   7902 
SWTRL1: LD  A,(DE)                      ;3312  1a            7886   7903 
    LD  (HL),A                          ;3313  77            7887   7904 
    INC HL                              ;3314  23            7888   7905 
    INC DE                              ;3315  13            7889   7906 
    DJNZ    SWTRL1                      ;3316  10 fa         7890   7907 
    POP DE                              ;3318  d1            7891   7908 
    POP HL                              ;3319  e1            7892   7909 
    PUSH    HL                          ;331a  e5            7893   7910 
    PUSH    BC                          ;331b  c5            7894   7911 
    LDIR                                ;331c  ed b0         7895   7912 
    POP BC                              ;331e  c1            7896   7913 
    POP DE                              ;331f  d1            7897   7914 
    PUSH    DE                          ;3320  d5            7898   7915 
    LD  HL,ZFAC                         ;3321  21 f2 62      7899   7916 
    LDIR                                ;3324  ed b0         7900   7917 
    POP DE                              ;3326  d1            7901   7918 
    POP HL                              ;3327  e1            7902   7919 
    POP AF                              ;3328  f1            7903   7920 
    CP  003h                            ;3329  fe 03         7904   7921 
    RET NZ                              ;332b  c0            7905   7922 
    PUSH    HL                          ;332c  e5            7906   7923 ; TEXT POINT
    EX  DE,HL                           ;332d  eb            7907   7924 
    LD  A,(HL)                          ;332e  7e            7908   7925 
    OR  A                               ;332f  b7            7909   7926 
    JR  Z,NXTSAS                        ;3330  28 16         7910   7927 
    LD  E,L                             ;3332  5d            7911   7928 
    LD  D,H                             ;3333  54            7912   7929 
    INC HL                              ;3334  23            7913   7930 
    CALL    INDRCT                      ;3335  cd a3 2a      7914   7931 
    PUSH    DE                          ;3338  d5            7915   7932 
    EX  DE,HL                           ;3339  eb            7916   7933 
    LD  HL,(STRPTR)                     ;333a  2a 3d 7a      7917   7934 
    OR  A                               ;333d  b7            7918   7935 
    SBC HL,DE                           ;333e  ed 52         7919   7936 
    EX  DE,HL                           ;3340  eb            7920   7937 
    POP DE                              ;3341  d1            7921   7938 
    JR  NC,NXTSAS                       ;3342  30 04         7922   7939 
    DEC HL                              ;3344  2b            7923   7940 
    LD  (HL),H                          ;3345  74            7924   7941 
    DEC HL                              ;3346  2b            7925   7942 
    LD  (HL),L                          ;3347  75            7926   7943 
NXTSAS: DEFB    021H                    ;3348  21            7927   7944 
SWAPHL: DEFS    2                       ;3349                7928   7945 
    LD  A,(HL)                          ;334b  7e            7929   7946 
    OR  A                               ;334c  b7            7930   7947 
    JR  Z,NXTSAW                        ;334d  28 16         7931   7948 
    LD  E,L                             ;334f  5d            7932   7949 
    LD  D,H                             ;3350  54            7933   7950 
    INC HL                              ;3351  23            7934   7951 
    CALL    INDRCT                      ;3352  cd a3 2a      7935   7952 
    PUSH    DE                          ;3355  d5            7936   7953 
    EX  DE,HL                           ;3356  eb            7937   7954 
    LD  HL,(STRPTR)                     ;3357  2a 3d 7a      7938   7955 
    OR  A                               ;335a  b7            7939   7956 
    SBC HL,DE                           ;335b  ed 52         7940   7957 
    EX  DE,HL                           ;335d  eb            7941   7958 
    POP DE                              ;335e  d1            7942   7959 
    JR  NC,NXTSAW                       ;335f  30 04         7943   7960 
    DEC HL                              ;3361  2b            7944   7961 
    LD  (HL),H                          ;3362  74            7945   7962 
    DEC HL                              ;3363  2b            7946   7963 
    LD  (HL),L                          ;3364  75            7947   7964 
NXTSAW: POP HL                          ;3365  e1            7948   7965 
    RET                                 ;3366  c9            7949   7966 
                                        ;                    7950   7967 ;
OUT:    LD  C,L                         ;3367  4d            7951   7968 
    LD  B,H                             ;3368  44            7952   7969 
    CALL    IHLEXP                      ;3369  cd cc 22      7953   7970 
    CALL    CH2CH                       ;336c  cd 61 2d      7954   7971 
    LD  (OPORT),HL                      ;336f  22 7a 33      7955   7972 
    CALL    IHLEXP                      ;3372  cd cc 22      7956   7973 
    CALL    HCHECK                      ;3375  cd d8 22      7957   7974 
    PUSH    BC                          ;3378  c5            7958   7975 
    DEFB    001H                        ;3379  01            7959   7976 ;LD BC,OPOR
OPORT:  DEFW    00000H                  ;337a  00 00         7960   7977 
    OUT (C),A                           ;337c  ed 79         7961   7978 
    POP BC                              ;337e  c1            7962   7979 
    JP  RETIRQ                          ;337f  c3 39 1b      7963   7980 
                                        ;                    7964   7981 ;
CLOSE:  DEFB    03EH                    ;3382  3e            7965   7982 ; LD A,?
FILEFG: DEFS    1                       ;3383                7966   7983 
    CP  2                               ;3384  fe 02         7967   7984 
    LD  A,0                             ;3386  3e 00         7968   7985 
    LD  (FILEFG),A                      ;3388  32 83 33      7969   7986 
    JR  NZ,CLSINP                       ;338b  20 10         7970   7987 
    LD  A,00Dh                          ;338d  3e 0d         7971   7988 
    CALL    CTOUT                       ;338f  cd 58 45      7972   7989 
    XOR A                               ;3392  af            7973   7990 
    CALL    CTOUT                       ;3393  cd 58 45      7974   7991 
    XOR A                               ;3396  af            7975   7992 
    CALL    CTOUT                       ;3397  cd 58 45      7976   7993 
    CALL    CTCLOS                      ;339a  cd 86 45      7977   7994 
CLSINP: PUSH    HL                      ;339d  e5            7978   7995 
    LD  HL,LININP                       ;339e  21 93 15      7979   7996 
    LD  (LODVEC),HL                     ;33a1  22 9d 14      7980   7997 
    POP HL                              ;33a4  e1            7981   7998 
    LD  A,001h                          ;33a5  3e 01         7982   7999 
    LD  (DISFLG),A                      ;33a7  32 eb 11      7983   8000 
    RET                                 ;33aa  c9            7984   8001 
                                        ;                    7985   8002 ;
CLEAR:  CALL    HLFTCH                  ;33ab  cd 87 29      7986   8003 
    OR  A                               ;33ae  b7            7987   8004 
    JP  Z,CLR                           ;33af  ca 51 19      7988   8005 
    CP  03Ah                            ;33b2  fe 3a         7989   8006 
    JP  Z,CLR                           ;33b4  ca 51 19      7990   8007 
    LD  C,L                             ;33b7  4d            7991   8008 
    LD  B,H                             ;33b8  44            7992   8009 
    CALL    IHLEXP                      ;33b9  cd cc 22      7993   8010 
    PUSH    HL                          ;33bc  e5            7994   8011 
    LD  DE,(MEMMAX)                     ;33bd  ed 5b 49 7a   7995   8012 
    SCF                                 ;33c1  37            7996   8013 
    SBC HL,DE                           ;33c2  ed 52         7997   8014 
    JP  NC,OMERR                        ;33c4  d2 88 21      7998   8015 
    LD  DE,(VSTART)                     ;33c7  ed 5b 3b 7a   7999   8016 
    LD  HL,00800h                       ;33cb  21 00 08      8000   8017 
    ADD HL,DE                           ;33ce  19            8001   8018 
                                        ;                    8002   8019 
    POP DE                              ;33cf  d1            8003   8020 
    PUSH    DE                          ;33d0  d5            8004   8021 
    OR  A                               ;33d1  b7            8005   8022 
    SBC HL,DE                           ;33d2  ed 52         8006   8023 
    JP  NC,OMERR                        ;33d4  d2 88 21      8007   8024 
    POP HL                              ;33d7  e1            8008   8025 
    CALL    MEMSET                      ;33d8  cd e9 33      8009   8026 
    LD  SP,(STRTOP)                     ;33db  ed 7b 41 7a   8010   8027 
    LD  DE,0FFFFh                       ;33df  11 ff ff      8011   8028 
    PUSH    DE                          ;33e2  d5            8012   8029 
    LD  L,C                             ;33e3  69            8013   8030 
    LD  H,B                             ;33e4  60            8014   8031 
    DEC HL                              ;33e5  2b            8015   8032 
    JP  ONELIN                          ;33e6  c3 db 14      8016   8033 
                                        ;                    8017   8034 ;
MEMSET: LD  (MEMEND),HL                 ;33e9  22 47 7a      8018   8035 
    LD  DE,00010h                       ;33ec  11 10 00      8019   8036 
    OR  A                               ;33ef  b7            8020   8037 
    SBC HL,DE                           ;33f0  ed 52         8021   8038 
    LD  (MEMFAC),HL                     ;33f2  22 f4 22      8022   8039 
    LD  DE,000F1h                       ;33f5  11 f1 00      8023   8040 
    SBC HL,DE                           ;33f8  ed 52         8024   8041 
    LD  (INTSSP),HL                     ;33fa  22 43 7a      8025   8042 
    LD  DE,00007h                       ;33fd  11 07 00      8026   8043 
    SBC HL,DE                           ;3400  ed 52         8027   8044 
    LD  (INTFAC),HL                     ;3402  22 4b 7a      8028   8045 
    LD  DE,JT9                          ;3405  11 18 00      8029   8046 
    SBC HL,DE                           ;3408  ed 52         8030   8047 
    LD  (STRBTM),HL                     ;340a  22 45 7a      8031   8048 
    JP  CLR                             ;340d  c3 51 19      8032   8049 
                                        ;                    8033   8050 ;
USING:  CALL    STREXX                  ;3410  cd 9d 45      8034   8051 
    DEC BC                              ;3413  0b            8035   8052 
    CALL    BCFTCH                      ;3414  cd c4 25      8036   8053 
    CP  02Ch                            ;3417  fe 2c         8037   8054 
    JR  Z,OKLIOP                        ;3419  28 05         8038   8055 
    CP  03Bh                            ;341b  fe 3b         8039   8056 
    JP  NZ,SERROR                       ;341d  c2 3a 17      8040   8057 
OKLIOP: LD  A,(HL)                      ;3420  7e            8041   8058 
    CP  019h                            ;3421  fe 19         8042   8059 
USGIFC: JP  NC,IFCALL                   ;3423  d2 36 17      8043   8060 
    OR  A                               ;3426  b7            8044   8061 
    JR  Z,USGIFC                        ;3427  28 fa         8045   8062 
    INC HL                              ;3429  23            8046   8063 
    CALL    INDRCT                      ;342a  cd a3 2a      8047   8064 
    LD  DE,USINGB                       ;342d  11 b1 46      8048   8065 
    PUSH    BC                          ;3430  c5            8049   8066 
    LD  C,A                             ;3431  4f            8050   8067 
    LD  B,000h                          ;3432  06 00         8051   8068 
    LDIR                                ;3434  ed b0         8052   8069 
    POP BC                              ;3436  c1            8053   8070 
    XOR A                               ;3437  af            8054   8071 
    LD  (DE),A                          ;3438  12            8055   8072 
    INC DE                              ;3439  13            8056   8073 
    LD  (DE),A                          ;343a  12            8057   8074 
IUSGLP: LD  DE,USINGB                   ;343b  11 b1 46      8058   8075 
    XOR A                               ;343e  af            8059   8076 
    LD  (PRTEDF),A                      ;343f  32 75 34      8060   8077 
USNGLP: LD  A,(DE)                      ;3442  1a            8061   8078 
    INC DE                              ;3443  13            8062   8079 
    OR  A                               ;3444  b7            8063   8080 
    JP  Z,USINED                        ;3445  ca 74 34      8064   8081 
    CP  0C4h                            ;3448  fe c4         8065   8082 
    JR  Z,PESCCH                        ;344a  28 38         8066   8083 
    CP  021h                            ;344c  fe 21         8067   8084 
    JP  Z,PSFRST                        ;344e  ca 88 34      8068   8085 
    CP  026h                            ;3451  fe 26         8069   8086 
    JP  Z,PSMIDL                        ;3453  ca e9 34      8070   8087 
    CP  023h                            ;3456  fe 23         8071   8088 
    JP  Z,PFLENG                        ;3458  ca 81 35      8072   8089 
    CP  02Ah                            ;345b  fe 2a         8073   8090 
    JP  Z,ASTRSK                        ;345d  ca 34 35      8074   8091 
    CP  07Ch                            ;3460  fe 7c         8075   8092 
    JP  Z,VENUSG                        ;3462  ca 59 35      8076   8093 
    CP  02Eh                            ;3465  fe 2e         8077   8094 
    JP  Z,PRLEN?                        ;3467  ca 79 35      8078   8095 
    CP  02Bh                            ;346a  fe 2b         8079   8096 
    JP  Z,PLUSUS                        ;346c  ca 6b 35      8080   8097 
PUTCHS: CALL    ACCPRT                  ;346f  cd 64 08      8081   8098 
    JR  USNGLP                          ;3472  18 ce         8082   8099 
                                        ;                    8083   8100 ;
USINED: DEFB    03EH                    ;3474  3e            8084   8101 ; LD A,?
PRTEDF: DEFS    1                       ;3475                8085   8102 
    OR  A                               ;3476  b7            8086   8103 
    JP  Z,IFCALL                        ;3477  ca 36 17      8087   8104 
    LD  DE,USINGB                       ;347a  11 b1 46      8088   8105 
    XOR A                               ;347d  af            8089   8106 
    LD  (PRTEDF),A                      ;347e  32 75 34      8090   8107 
ESPUVC: DEFB    0C3H                    ;3481  c3            8091   8108 ; JP ?
URTVEC: DEFW    RETIRQ                  ;3482  39 1b         8092   8109 
                                        ;                    8093   8110 ;
PESCCH: LD  A,(DE)                      ;3484  1a            8094   8111 
    INC DE                              ;3485  13            8095   8112 
    JR  PUTCHS                          ;3486  18 e7         8096   8113 
                                        ;                    8097   8114 ;
PSFRST: PUSH    DE                      ;3488  d5            8098   8115 
    CALL    STREXX                      ;3489  cd 9d 45      8099   8116 
    CALL    CHCKRV                      ;348c  cd a2 34      8100   8117 
    POP DE                              ;348f  d1            8101   8118 
    LD  A,1                             ;3490  3e 01         8102   8119 
    LD  (PRTEDF),A                      ;3492  32 75 34      8103   8120 
    LD  A,(HL)                          ;3495  7e            8104   8121 
    OR  A                               ;3496  b7            8105   8122 
    LD  A,020h                          ;3497  3e 20         8106   8123 
    JR  Z,PUTCHS                        ;3499  28 d4         8107   8124 
    INC HL                              ;349b  23            8108   8125 
    CALL    INDRCT                      ;349c  cd a3 2a      8109   8126 
    LD  A,(HL)                          ;349f  7e            8110   8127 
    JR  PUTCHS                          ;34a0  18 cd         8111   8128 
                                        ;                    8112   8129 ;
CHCKRV: DEC BC                          ;34a2  0b            8113   8130 
    LD  A,(BC)                          ;34a3  0a            8114   8131 
    INC BC                              ;34a4  03            8115   8132 
    CP  03Bh                            ;34a5  fe 3b         8116   8133 
    JR  Z,USGCON                        ;34a7  28 0a         8117   8134 
    CP  02Ch                            ;34a9  fe 2c         8118   8135 
    JR  Z,USGCMN                        ;34ab  28 1a         8119   8136 
    PUSH    HL                          ;34ad  e5            8120   8137 
    LD  HL,CRRTIR                       ;34ae  21 e3 34      8121   8138 
    JR  PTPURV                          ;34b1  18 0f         8122   8139 
                                        ;                    8123   8140 ;
USGCON: CALL    BCFTCH                  ;34b3  cd c4 25      8124   8141 
    OR  A                               ;34b6  b7            8125   8142 
    JR  Z,PUSEMR                        ;34b7  28 24         8126   8143 
    CP  03Ah                            ;34b9  fe 3a         8127   8144 
    JR  Z,PUSEMR                        ;34bb  28 20         8128   8145 
MGFDXZ: DEC BC                          ;34bd  0b            8129   8146 
    PUSH    HL                          ;34be  e5            8130   8147 
    LD  HL,USNGLP                       ;34bf  21 42 34      8131   8148 
PTPURV: LD  (URTVEC),HL                 ;34c2  22 82 34      8132   8149 
    POP HL                              ;34c5  e1            8133   8150 
    RET                                 ;34c6  c9            8134   8151 
                                        ;                    8135   8152 ;
USGCMN: CALL    BCFTCH                  ;34c7  cd c4 25      8136   8153 
    OR  A                               ;34ca  b7            8137   8154 
    JR  Z,PUCHRA                        ;34cb  28 04         8138   8155 
    CP  03Ah                            ;34cd  fe 3a         8139   8156 
    JR  NZ,MGFDXZ                       ;34cf  20 ec         8140   8157 
PUCHRA: PUSH    HL                      ;34d1  e5            8141   8158 
    LD  HL,PULSC#                       ;34d2  21 d7 34      8142   8159 
    JR  PTPURV                          ;34d5  18 eb         8143   8160 
                                        ;                    8144   8161 ;
PULSC#: CALL    TABPRT                  ;34d7  cd 02 08      8145   8162 
    JP  RETIRQ                          ;34da  c3 39 1b      8146   8163 
                                        ;                    8147   8164 ;
PUSEMR: PUSH    HL                      ;34dd  e5            8148   8165 
    LD  HL,RETIRQ                       ;34de  21 39 1b      8149   8166 
    JR  PTPURV                          ;34e1  18 df         8150   8167 
                                        ;                    8151   8168 ;
CRRTIR: CALL    CR1                     ;34e3  cd 43 08      8152   8169 
    JP  RETIRQ                          ;34e6  c3 39 1b      8153   8170 
                                        ;                    8154   8171 ;
PSMIDL: LD  H,1                         ;34e9  26 01         8155   8172 
COUUSP: LD  A,(DE)                      ;34eb  1a            8156   8173 
    INC H                               ;34ec  24            8157   8174 
    INC DE                              ;34ed  13            8158   8175 
    CP  026h                            ;34ee  fe 26         8159   8176 
    JR  Z,ESCCSP                        ;34f0  28 07         8160   8177 
    CP  020h                            ;34f2  fe 20         8161   8178 
    JR  Z,COUUSP                        ;34f4  28 f5         8162   8179 
    JP  IFCALL                          ;34f6  c3 36 17      8163   8180 
                                        ;                    8164   8181 ;
ESCCSP: PUSH    DE                      ;34f9  d5            8165   8182 
    PUSH    HL                          ;34fa  e5            8166   8183 
    CALL    STREXX                      ;34fb  cd 9d 45      8167   8184 
    CALL    CHCKRV                      ;34fe  cd a2 34      8168   8185 
    POP AF                              ;3501  f1            8169   8186 
    CP  (HL)                            ;3502  be            8170   8187 
    PUSH    BC                          ;3503  c5            8171   8188 
    JR  NC,PRSPNE                       ;3504  30 16         8172   8189 
ZRPRUS: LD  B,A                         ;3506  47            8173   8190 
    INC HL                              ;3507  23            8174   8191 
    CALL    INDRCT                      ;3508  cd a3 2a      8175   8192 
USGMDL: LD  A,(HL)                      ;350b  7e            8176   8193 
    INC HL                              ;350c  23            8177   8194 
    CALL    ACCPRT                      ;350d  cd 64 08      8178   8195 
    DJNZ    USGMDL                      ;3510  10 f9         8179   8196 
RETIOE: POP BC                          ;3512  c1            8180   8197 
    POP DE                              ;3513  d1            8181   8198 
    LD  A,1                             ;3514  3e 01         8182   8199 
    LD  (PRTEDF),A                      ;3516  32 75 34      8183   8200 
    JP  USNGLP                          ;3519  c3 42 34      8184   8201 
                                        ;                    8185   8202 ;
PRSPNE: JR  Z,ZRPRUS                    ;351c  28 e8         8186   8203 
    SUB (HL)                            ;351e  96            8187   8204 
    PUSH    AF                          ;351f  f5            8188   8205 
    LD  B,(HL)                          ;3520  46            8189   8206 
    INC HL                              ;3521  23            8190   8207 
    CALL    INDRCT                      ;3522  cd a3 2a      8191   8208 
USGMD': LD  A,(HL)                      ;3525  7e            8192   8209 
    INC HL                              ;3526  23            8193   8210 
    CALL    ACCPRT                      ;3527  cd 64 08      8194   8211 
    DJNZ    USGMD'                      ;352a  10 f9         8195   8212 
    POP BC                              ;352c  c1            8196   8213 
SPACPT: CALL    SPPRT                   ;352d  cd 62 08      8197   8214 
    DJNZ    SPACPT                      ;3530  10 fb         8198   8215 
    JR  RETIOE                          ;3532  18 de         8199   8216 
                                        ;                    8200   8217 ;
ASTRSK: LD  A,(DE)                      ;3534  1a            8201   8218 
    CP  02Ah                            ;3535  fe 2a         8202   8219 
    LD  A,02Ah                          ;3537  3e 2a         8203   8220 
    JP  NZ,PUTCHS                       ;3539  c2 6f 34      8204   8221 
    LD  A,1                             ;353c  3e 01         8205   8222 
    LD  (PUASTF),A                      ;353e  32 c5 36      8206   8223 
    INC DE                              ;3541  13            8207   8224 
    LD  A,(DE)                          ;3542  1a            8208   8225 
    INC DE                              ;3543  13            8209   8226 
    LD  H,2                             ;3544  26 02         8210   8227 
    CP  07Ch                            ;3546  fe 7c         8211   8228 
    LD  A,0                             ;3548  3e 00         8212   8229 
    JR  NZ,PULSLS                       ;354a  20 3d         8213   8230 
    INC DE                              ;354c  13            8214   8231 
    INC H                               ;354d  24            8215   8232 
KIUYTJ: LD  A,1                         ;354e  3e 01         8216   8233 
    LD  (PUYENF),A                      ;3550  32 ae 36      8217   8234 
    XOR A                               ;3553  af            8218   8235 
    LD  (FPLUSF),A                      ;3554  32 80 36      8219   8236 
    JR  MIDFUS                          ;3557  18 33         8220   8237 
                                        ;                    8221   8238 ;
VENUSG: LD  A,(DE)                      ;3559  1a            8222   8239 
    CP  07Ch                            ;355a  fe 7c         8223   8240 
    LD  A,07Ch                          ;355c  3e 7c         8224   8241 
    JP  NZ,PUTCHS                       ;355e  c2 6f 34      8225   8242 
    XOR A                               ;3561  af            8226   8243 
    LD  (PUASTF),A                      ;3562  32 c5 36      8227   8244 
    INC DE                              ;3565  13            8228   8245 
    INC DE                              ;3566  13            8229   8246 
    LD  H,2                             ;3567  26 02         8230   8247 
    JR  KIUYTJ                          ;3569  18 e3         8231   8248 
                                        ;                    8232   8249 ;
PLUSUS: LD  A,1                         ;356b  3e 01         8233   8250 
    LD  (FPLUSF),A                      ;356d  32 80 36      8234   8251 
    XOR A                               ;3570  af            8235   8252 
    LD  (PUASTF),A                      ;3571  32 c5 36      8236   8253 
    INC DE                              ;3574  13            8237   8254 
    LD  H,1                             ;3575  26 01         8238   8255 
    JR  PULSLS                          ;3577  18 10         8239   8256 
                                        ;                    8240   8257 ;
PRLEN?: LD  A,(DE)                      ;3579  1a            8241   8258 
    CP  023h                            ;357a  fe 23         8242   8259 
    LD  A,02Eh                          ;357c  3e 2e         8243   8260 
    JP  NZ,PUTCHS                       ;357e  c2 6f 34      8244   8261 
PFLENG: XOR A                           ;3581  af            8245   8262 
    LD  H,A                             ;3582  67            8246   8263 
    LD  (FPLUSF),A                      ;3583  32 80 36      8247   8264 
    LD  (PUASTF),A                      ;3586  32 c5 36      8248   8265 ; PUT *   FLG
PULSLS: LD  (PUYENF),A                  ;3589  32 ae 36      8249   8266 ;PUT * FLG
MIDFUS: LD  (PUAFMF),A                  ;358c  32 75 36      8250   8267 ;AFTER-FLG
    LD  (PUCOMF),A                      ;358f  32 31 36      8251   8268 ; PUT ,   FLG
    LD  (INTLEN),A                      ;3592  32 5d 36      8252   8269 ; INT LENGTH
    LD  (FRCLEN),A                      ;3595  32 21 36      8253   8270 ; FRAC LENGTH
    LD  (RPLUSF),A                      ;3598  32 7b 36      8254   8271 ; ###+
    LD  (PUEXPF),A                      ;359b  32 24 36      8255   8272 ; ^^^^
    DEC DE                              ;359e  1b            8256   8273 
PUGTFC: INC H                           ;359f  24            8257   8274 
    LD  A,(DE)                          ;35a0  1a            8258   8275 
    INC DE                              ;35a1  13            8259   8276 
    CP  023h                            ;35a2  fe 23         8260   8277 
    JR  Z,PUGTFC                        ;35a4  28 f9         8261   8278 
    CP  02Ch                            ;35a6  fe 2c         8262   8279 
    JR  NZ,PUCOMP                       ;35a8  20 07         8263   8280 
    LD  A,1                             ;35aa  3e 01         8264   8281 
    LD  (PUCOMF),A                      ;35ac  32 31 36      8265   8282 
    JR  PUGTFC                          ;35af  18 ee         8266   8283 
PUCOMP: CP  02Eh                        ;35b1  fe 2e         8267   8284 
    JR  Z,PUPOIT                        ;35b3  28 1e         8268   8285 
    CP  02Dh                            ;35b5  fe 2d         8269   8286 
    JR  NZ,PUAFMO                       ;35b7  20 08         8270   8287 
    LD  A,1                             ;35b9  3e 01         8271   8288 
    LD  (PUAFMF),A                      ;35bb  32 75 36      8272   8289 
    INC DE                              ;35be  13            8273   8290 
    JR  PUAFQO                          ;35bf  18 0a         8274   8291 
PUAFMO: CP  02Bh                        ;35c1  fe 2b         8275   8292 
    JR  NZ,PUAFQO                       ;35c3  20 06         8276   8293 
    LD  A,1                             ;35c5  3e 01         8277   8294 
    LD  (RPLUSF),A                      ;35c7  32 7b 36      8278   8295 
    INC DE                              ;35ca  13            8279   8296 
PUAFQO: DEC DE                          ;35cb  1b            8280   8297 
    DEC H                               ;35cc  25            8281   8298 
    LD  A,H                             ;35cd  7c            8282   8299 
    LD  (INTLEN),A                      ;35ce  32 5d 36      8283   8300 
    JR  BEGUSG                          ;35d1  18 1e         8284   8301 
                                        ;                    8285   8302 ;
PUPOIT: DEC H                           ;35d3  25            8286   8303 
    LD  A,H                             ;35d4  7c            8287   8304 
    LD  (INTLEN),A                      ;35d5  32 5d 36      8288   8305 
    LD  H,1                             ;35d8  26 01         8289   8306 
PUPOFC: INC H                           ;35da  24            8290   8307 
    LD  A,(DE)                          ;35db  1a            8291   8308 
    INC DE                              ;35dc  13            8292   8309 
    CP  023h                            ;35dd  fe 23         8293   8310 
    JR  Z,PUPOFC                        ;35df  28 f9         8294   8311 
    CP  02Dh                            ;35e1  fe 2d         8295   8312 
    JR  NZ,PUCOPP                       ;35e3  20 06         8296   8313 
    LD  A,1                             ;35e5  3e 01         8297   8314 
    LD  (PUAFMF),A                      ;35e7  32 75 36      8298   8315 
    INC DE                              ;35ea  13            8299   8316 
PUCOPP: DEC DE                          ;35eb  1b            8300   8317 
    DEC H                               ;35ec  25            8301   8318 
    LD  A,H                             ;35ed  7c            8302   8319 
    LD  (FRCLEN),A                      ;35ee  32 21 36      8303   8320 
                                        ;                    8304   8321 ;
BEGUSG: LD  (USGDEB),DE                 ;35f1  ed 53 05 37   8305   8322 
    PUSH    BC                          ;35f5  c5            8306   8323 
    LD  B,4                             ;35f6  06 04         8307   8324 
CHEXPU: LD  A,(DE)                      ;35f8  1a            8308   8325 
    INC DE                              ;35f9  13            8309   8326 
    CP  05Eh                            ;35fa  fe 5e         8310   8327 
    JR  NZ,NEXPPU                       ;35fc  20 0b         8311   8328 
    DJNZ    CHEXPU                      ;35fe  10 f8         8312   8329 
    LD  (USGDEB),DE                     ;3600  ed 53 05 37   8313   8330 
    LD  A,1                             ;3604  3e 01         8314   8331 
    LD  (PUEXPF),A                      ;3606  32 24 36      8315   8332 
NEXPPU: POP BC                          ;3609  c1            8316   8333 
    CALL    FLEXPR                      ;360a  cd 99 22      8317   8334 
    CALL    CHCKRV                      ;360d  cd a2 34      8318   8335 
    LD  (USGBCB),BC                     ;3610  ed 43 02 37   8319   8336 
    INC HL                              ;3614  23            8320   8337 
    LD  A,(HL)                          ;3615  7e            8321   8338 
    RES 7,(HL)                          ;3616  cb be         8322   8339 
    DEC HL                              ;3618  2b            8323   8340 
    LD  (USGSGN),A                      ;3619  32 a3 36      8324   8341 
    LD  A,(INTLEN)                      ;361c  3a 5d 36      8325   8342 
    LD  B,A                             ;361f  47            8326   8343 
    DEFB    03EH                        ;3620  3e            8327   8344 ; LD A,?
FRCLEN: DEFS    1                       ;3621                8328   8345 
    LD  C,A                             ;3622  4f            8329   8346 
    DEFB    03EH                        ;3623  3e            8330   8347 ; LD A,?
PUEXPF: DEFS    1                       ;3624                8331   8348 
    CALL    USGNCV                      ;3625  cd d6 5e      8332   8349 
    PUSH    HL                          ;3628  e5            8333   8350 
    LD  DE,KEYBUF                       ;3629  11 4f 7a      8334   8351 
    LD  A,020h                          ;362c  3e 20         8335   8352 
    LD  (DE),A                          ;362e  12            8336   8353 
    INC DE                              ;362f  13            8337   8354 
    DEFB    03EH                        ;3630  3e            8338   8355 ; LD A,?
PUCOMF: DEFS    1                       ;3631                8339   8356 
    OR  A                               ;3632  b7            8340   8357 
    JR  Z,LADJS1                        ;3633  28 3f         8341   8358 
    PUSH    DE                          ;3635  d5            8342   8359 
    LD  A,(INTLEN)                      ;3636  3a 5d 36      8343   8360 
    LD  L,A                             ;3639  6f            8344   8361 
    LD  H,000h                          ;363a  26 00         8345   8362 
    ADD HL,DE                           ;363c  19            8346   8363 
    DEC HL                              ;363d  2b            8347   8364 
    LD  DE,ZFAC                         ;363e  11 f2 62      8348   8365 
    LD  C,0                             ;3641  0e 00         8349   8366 
COMN3D: LD  B,3                         ;3643  06 03         8350   8367 
COMSK3: LD  A,(HL)                      ;3645  7e            8351   8368 
    CP  020h                            ;3646  fe 20         8352   8369 
    JR  Z,ESCPUC                        ;3648  28 12         8353   8370 
    INC C                               ;364a  0c            8354   8371 
    LD  (DE),A                          ;364b  12            8355   8372 
    INC DE                              ;364c  13            8356   8373 
    DEC HL                              ;364d  2b            8357   8374 
    DJNZ    COMSK3                      ;364e  10 f5         8358   8375 
    LD  A,(HL)                          ;3650  7e            8359   8376 
    CP  020h                            ;3651  fe 20         8360   8377 
    JR  Z,ESCPUC                        ;3653  28 07         8361   8378 
PURTJM: LD  A,02Ch                      ;3655  3e 2c         8362   8379 
    LD  (DE),A                          ;3657  12            8363   8380 
    INC DE                              ;3658  13            8364   8381 
    INC C                               ;3659  0c            8365   8382 
    JR  COMN3D                          ;365a  18 e7         8366   8383 
                                        ;                    8367   8384 ;
ESCPUC: DEFB    03EH                    ;365c  3e            8368   8385 ; LD A,?
INTLEN: DEFS    1                       ;365d                8369   8386 
    CP  C                               ;365e  b9            8370   8387 
    JP  C,FOVER                         ;365f  da a6 5f      8371   8388 
    LD  B,C                             ;3662  41            8372   8389 
    LD  L,A                             ;3663  6f            8373   8390 
    LD  H,0                             ;3664  26 00         8374   8391 
    POP DE                              ;3666  d1            8375   8392 
    PUSH    DE                          ;3667  d5            8376   8393 
    ADD HL,DE                           ;3668  19            8377   8394 
    DEC HL                              ;3669  2b            8378   8395 
    LD  DE,ZFAC                         ;366a  11 f2 62      8379   8396 
COMTPU: LD  A,(DE)                      ;366d  1a            8380   8397 
    LD  (HL),A                          ;366e  77            8381   8398 
    DEC HL                              ;366f  2b            8382   8399 
    INC DE                              ;3670  13            8383   8400 
    DJNZ    COMTPU                      ;3671  10 fa         8384   8401 
    POP DE                              ;3673  d1            8385   8402 
LADJS1: DEFB    03EH                    ;3674  3e            8386   8403 ; LD A,?
PUAFMF: DEFS    1                       ;3675                8387   8404 
    OR  A                               ;3676  b7            8388   8405 
NPUSGN: JP  NZ,LADJS2                   ;3677  c2 ad 36      8389   8406 ; ###-
    DEFB    03EH                        ;367a  3e            8390   8407 ; LD A,?
RPLUSF: DEFS    1                       ;367b                8391   8408 
    OR  A                               ;367c  b7            8392   8409 ; ###+
    JR  NZ,NPUSGN                       ;367d  20 f8         8393   8410 
    DEFB    03EH                        ;367f  3e            8394   8411 ; LD A,?
FPLUSF: DEFS    1                       ;3680                8395   8412 
    OR  A                               ;3681  b7            8396   8413 ; +###
    JR  NZ,PTPLS1                       ;3682  20 1e         8397   8414 
    LD  A,(USGSGN)                      ;3684  3a a3 36      8398   8415 
    RLCA                                ;3687  07            8399   8416 
    JP  NC,LADJS2                       ;3688  d2 ad 36      8400   8417 
    LD  A,(DE)                          ;368b  1a            8401   8418 
    CP  020h                            ;368c  fe 20         8402   8419 
    JP  NZ,FOVER                        ;368e  c2 a6 5f      8403   8420 
    LD  B,02Dh                          ;3691  06 2d         8404   8421 
FPUTER: PUSH    DE                      ;3693  d5            8405   8422 
PUPTML: LD  A,(DE)                      ;3694  1a            8406   8423 
    INC DE                              ;3695  13            8407   8424 
    CP  020h                            ;3696  fe 20         8408   8425 
    JR  Z,PUPTML                        ;3698  28 fa         8409   8426 
    DEC DE                              ;369a  1b            8410   8427 
    DEC DE                              ;369b  1b            8411   8428 
    LD  A,B                             ;369c  78            8412   8429 
    LD  (DE),A                          ;369d  12            8413   8430 
    POP DE                              ;369e  d1            8414   8431 
THISLN1: JP LADJS2                      ;369f  c3 ad 36      8415   8432 
                                        ;                    8416   8433 ;
PTPLS1: DEFB    03EH                    ;36a2  3e            8417   8434 ; LD A,?
USGSGN: DEFS    1                       ;36a3                8418   8435 
    RLCA                                ;36a4  07            8419   8436 
    LD  B,02Bh                          ;36a5  06 2b         8420   8437 
    JR  NC,FPUTER                       ;36a7  30 ea         8421   8438 
    LD  B,02Dh                          ;36a9  06 2d         8422   8439 
    JR  FPUTER                          ;36ab  18 e6         8423   8440 
                                        ;                    8424   8441 ;
LADJS2: DEFB    03EH                    ;36ad  3e            8425   8442 ; LD A,?
PUYENF: DEFS    1                       ;36ae                8426   8443 
    OR  A                               ;36af  b7            8427   8444 
    JR  Z,LADJS3                        ;36b0  28 12         8428   8445 
    LD  A,(DE)                          ;36b2  1a            8429   8446 
    CP  020h                            ;36b3  fe 20         8430   8447 
    JR  NZ,LADJS3                       ;36b5  20 0d         8431   8448 
    PUSH    DE                          ;36b7  d5            8432   8449 
LSDQW1: LD  A,(DE)                      ;36b8  1a            8433   8450 
    INC DE                              ;36b9  13            8434   8451 
    CP  020h                            ;36ba  fe 20         8435   8452 
    JR  Z,LSDQW1                        ;36bc  28 fa         8436   8453 
    DEC DE                              ;36be  1b            8437   8454 
    DEC DE                              ;36bf  1b            8438   8455 
    LD  A,07Ch                          ;36c0  3e 7c         8439   8456 
    LD  (DE),A                          ;36c2  12            8440   8457 
    POP DE                              ;36c3  d1            8441   8458 
LADJS3: DEFB    03EH                    ;36c4  3e            8442   8459 ; LD A,?
PUASTF: DEFS    1                       ;36c5                8443   8460 
    OR  A                               ;36c6  b7            8444   8461 
    JR  Z,LADJS4                        ;36c7  28 0d         8445   8462 
    PUSH    DE                          ;36c9  d5            8446   8463 
ASTFIL: LD  A,(DE)                      ;36ca  1a            8447   8464 
    CP  020h                            ;36cb  fe 20         8448   8465 
    JR  NZ,LADJ4'                       ;36cd  20 06         8449   8466 
    LD  A,02Ah                          ;36cf  3e 2a         8450   8467 
    LD  (DE),A                          ;36d1  12            8451   8468 
    INC DE                              ;36d2  13            8452   8469 
    JR  ASTFIL                          ;36d3  18 f5         8453   8470 
LADJ4': POP DE                          ;36d5  d1            8454   8471 
LADJS4: POP HL                          ;36d6  e1            8455   8472 
    OR  A                               ;36d7  b7            8456   8473 
    SBC HL,DE                           ;36d8  ed 52         8457   8474 
    LD  B,L                             ;36da  45            8458   8475 
    CALL    PRTSDC                      ;36db  cd e1 07      8459   8476 
    LD  A,(RPLUSF)                      ;36de  3a 7b 36      8460   8477 
    OR  A                               ;36e1  b7            8461   8478 
    JR  Z,TST2DH                        ;36e2  28 0f         8462   8479 
    LD  A,(USGSGN)                      ;36e4  3a a3 36      8463   8480 
    RLCA                                ;36e7  07            8464   8481 
    LD  A,02Bh                          ;36e8  3e 2b         8465   8482 
LSDVZR: JR  NC,PULSTX                   ;36ea  30 02         8466   8483 
    LD  A,02Dh                          ;36ec  3e 2d         8467   8484 
PULSTX: CALL    ACCPRT                  ;36ee  cd 64 08      8468   8485 
    JR  RETPU$                          ;36f1  18 0e         8469   8486 
                                        ;                    8470   8487 ;
TST2DH: LD  A,(PUAFMF)                  ;36f3  3a 75 36      8471   8488 
    OR  A                               ;36f6  b7            8472   8489 
    JR  Z,RETPU$                        ;36f7  28 08         8473   8490 
    LD  A,(USGSGN)                      ;36f9  3a a3 36      8474   8491 
    RLCA                                ;36fc  07            8475   8492 
    LD  A,020h                          ;36fd  3e 20         8476   8493 
    JR  LSDVZR                          ;36ff  18 e9         8477   8494 
                                        ;                    8478   8495 ;
RETPU$: DEFB    001H                    ;3701  01            8479   8496 ; LD BC,?
USGBCB: DEFS    2                       ;3702                8480   8497 
    DEFB    011H                        ;3704  11            8481   8498 ; LD DE,?
USGDEB: DEFS    2                       ;3705                8482   8499 
    LD  A,1                             ;3707  3e 01         8483   8500 
    LD  (PRTEDF),A                      ;3709  32 75 34      8484   8501 
    JP  USNGLP                          ;370c  c3 42 34      8485   8502 
                                        ;                    8486   8503 ;
AUTO:   LD  C,L                         ;370f  4d            8487   8504 
    LD  B,H                             ;3710  44            8488   8505 
    LD  HL,10                           ;3711  21 0a 00      8489   8506 ; 그냥 AUTO면 10부터 시작한다.
    LD  (AUTOST),HL                     ;3714  22 45 22      8490   8507 
    LD  (AUTOLN),HL                     ;3717  22 39 22      8491   8508 
    CALL    BCFTCH                      ;371a  cd c4 25      8492   8509 
    DEC BC                              ;371d  0b            8493   8510 
    OR  A                               ;371e  b7            8494   8511 
    JR  Z,AUTOES                        ;371f  28 22         8495   8512 
    CP  03Ah                            ;3721  fe 3a         8496   8513 
    JR  Z,AUTOES                        ;3723  28 1e         8497   8514 
    CP  02Eh                            ;3725  fe 2e         8498   8515 
    JR  NZ,AUTONE                       ;3727  20 09         8499   8516 
    DEFB    021H                        ;3729  21            8500   8517 ; LD HL,?
EDLINE: DEFS    2                       ;372a                8501   8518 
    INC BC                              ;372c  03            8502   8519 
    CALL    BCFTCH                      ;372d  cd c4 25      8503   8520 
    JR  AUTNER                          ;3730  18 03         8504   8521 
AUTONE: CALL    IHLEXP                  ;3732  cd cc 22      8505   8522 
AUTNER: CP  02Ch                        ;3735  fe 2c         8506   8523 
    LD  (AUTOLN),HL                     ;3737  22 39 22      8507   8524 
    JP  NZ,AUTOES                       ;373a  c2 43 37      8508   8525 
    CALL    IHLEXP                      ;373d  cd cc 22      8509   8526 
    LD  (AUTOST),HL                     ;3740  22 45 22      8510   8527 
AUTOES: XOR A                           ;3743  af            8511   8528 
    LD  (AUTOVC),A                      ;3744  32 37 22      8512   8529 
    JP  AUTOBK                          ;3747  c3 8b 14      8513   8530 
                                        ;                    8514   8531 ;
LPOS:   LD  A,(PRINTN)                  ;374a  3a ec 11      8515   8532 
    JR  POSMID                          ;374d  18 03         8516   8533 
                                        ;                    8517   8534 ;
POS:    LD  A,(CURX)                    ;374f  3a ed 11      8518   8535 
POSMID: LD  E,A                         ;3752  5f            8519   8536 
    LD  D,0                             ;3753  16 00         8520   8537 
    JP  FLTHEX                          ;3755  c3 02 29      8521   8538 
                                        ;                    8522   8539 ;
ERR:    LD  A,(ERRCOD)                  ;3758  3a 95 22      8523   8540 
    LD  E,A                             ;375b  5f            8524   8541 
    LD  D,0                             ;375c  16 00         8525   8542 
MIDERS: PUSH    DE                      ;375e  d5            8526   8543 
    LD  DE,8                            ;375f  11 08 00      8527   8544 
    ADD HL,DE                           ;3762  19            8528   8545 
    POP DE                              ;3763  d1            8529   8546 
    CALL    FLTHEX                      ;3764  cd 02 29      8530   8547 
    CALL    ADJERL                      ;3767  cd 78 37      8531   8548 
    LD  A,4                             ;376a  3e 04         8532   8549 
    CALL    CONDFL                      ;376c  cd eb 28      8533   8550 
    JP  BCFTCH                          ;376f  c3 c4 25      8534   8551 
                                        ;                    8535   8552 ;
ERL:    LD  DE,(ERRLNO)                 ;3772  ed 5b 65 22   8536   8553 
    JR  MIDERS                          ;3776  18 e6         8537   8554 
                                        ;                    8538   8555 ;
ADJERL: INC HL                          ;3778  23            8539   8556 
    LD  A,(HL)                          ;3779  7e            8540   8557 
    DEC HL                              ;377a  2b            8541   8558 
    ADD A,A                             ;377b  87            8542   8559 
    RET NC                              ;377c  d0            8543   8560 
    PUSH    BC                          ;377d  c5            8544   8561 
    LD  DE,FLMXD0                       ;377e  11 86 37      8545   8562 
    CALL    ADD                         ;3781  cd a6 6c      8546   8563 
    POP BC                              ;3784  c1            8547   8564 
    RET                                 ;3785  c9            8548   8565 
FLMXD0:                                 ;                    8549   8566 
    DEFB    091H                        ;3786  91            8550   8567 
    DEFB    000H                        ;3787  00            8551   8568 
    DEFB    000H                        ;3788  00            8552   8569 
    DEFB    000H                        ;3789  00            8553   8570 
    DEFB    000H                        ;378a  00            8554   8571 
    DEFB    000H                        ;378b  00            8555   8572 
    DEFB    000H                        ;378c  00            8556   8573 
    DEFB    000H                        ;378d  00            8557   8574 
                                        ;                    8558   8575 ;
DEL:    CALL    HLFTCH                  ;378e  cd 87 29      8559   8576 
    OR  A                               ;3791  b7            8560   8577 
    RET Z                               ;3792  c8            8561   8578 
    CP  03Ah                            ;3793  fe 3a         8562   8579 
    RET Z                               ;3795  c8            8563   8580 
    PUSH    HL                          ;3796  e5            8564   8581 
    CALL    RETLNO                      ;3797  cd 0a 3f      8565   8582 
    CALL    CLR                         ;379a  cd 51 19      8566   8583 
    POP HL                              ;379d  e1            8567   8584 
    CALL    GTSTED                      ;379e  cd c7 3f      8568   8585 
    EX  DE,HL                           ;37a1  eb            8569   8586 
    LD  E,C                             ;37a2  59            8570   8587 
    LD  D,B                             ;37a3  50            8571   8588 
    CALL    DELETE1                     ;37a4  cd a5 31      8572   8589 
    JP  HOTENT                          ;37a7  c3 46 14      8573   8590 
                                        ;                    8574   8591 ;
RENUM:  LD  C,L                         ;37aa  4d            8575   8592 
    LD  B,H                             ;37ab  44            8576   8593 
    LD  HL,10                           ;37ac  21 0a 00      8577   8594 ; 그냥 RENUM이면 10부터 10씩 증가
    LD  (NEWNO),HL                      ;37af  22 34 38      8578   8595 
    LD  (ADDNO),HL                      ;37b2  22 42 38      8579   8596 
    LD  L,0                             ;37b5  2e 00         8580   8597 
    LD  (STLNO),HL                      ;37b7  22 23 38      8581   8598 
    CALL    BCFTCH                      ;37ba  cd c4 25      8582   8599 
    DEC BC                              ;37bd  0b            8583   8600 
    OR  A                               ;37be  b7            8584   8601 
    JR  Z,RNSTRT                        ;37bf  28 39         8585   8602 
    CP  03Ah                            ;37c1  fe 3a         8586   8603 
    JR  Z,RNSTRT                        ;37c3  28 35         8587   8604 
    CP  02Ch                            ;37c5  fe 2c         8588   8605 
    JR  Z,SKIRE1                        ;37c7  28 0b         8589   8606 
    CALL    IHLEXP                      ;37c9  cd cc 22      8590   8607 
    LD  (NEWNO),HL                      ;37cc  22 34 38      8591   8608 
    CP  02Ch                            ;37cf  fe 2c         8592   8609 
    JR  NZ,RNSTRT                       ;37d1  20 27         8593   8610 
    DEC BC                              ;37d3  0b            8594   8611 
SKIRE1: INC BC                          ;37d4  03            8595   8612 
    CALL    BCFTCH                      ;37d5  cd c4 25      8596   8613 
    DEC BC                              ;37d8  0b            8597   8614 
    CP  02Ch                            ;37d9  fe 2c         8598   8615 
    JR  Z,SKMRNU                        ;37db  28 0b         8599   8616 
    CALL    IHLEXP                      ;37dd  cd cc 22      8600   8617 
    LD  (STLNO),HL                      ;37e0  22 23 38      8601   8618 
    CP  02Ch                            ;37e3  fe 2c         8602   8619 
    JR  NZ,RNSTRT                       ;37e5  20 13         8603   8620 
    DEC BC                              ;37e7  0b            8604   8621 
SKMRNU: INC BC                          ;37e8  03            8605   8622 
    CALL    BCFTCH                      ;37e9  cd c4 25      8606   8623 
    DEC BC                              ;37ec  0b            8607   8624 
    OR  A                               ;37ed  b7            8608   8625 
    JR  Z,RNSTRT                        ;37ee  28 0a         8609   8626 
    CP  03Ah                            ;37f0  fe 3a         8610   8627 
    JR  Z,RNSTRT                        ;37f2  28 06         8611   8628 
    CALL    IHLEXP                      ;37f4  cd cc 22      8612   8629 
    LD  (ADDNO),HL                      ;37f7  22 42 38      8613   8630 
RNSTRT: PUSH    BC                      ;37fa  c5            8614   8631 
    LD  HL,(ADDNO)                      ;37fb  2a 42 38      8615   8632 
    LD  A,H                             ;37fe  7c            8616   8633 
    OR  L                               ;37ff  b5            8617   8634 
    JP  Z,IFCALL                        ;3800  ca 36 17      8618   8635 
    LD  HL,(STLNO)                      ;3803  2a 23 38      8619   8636 
    EX  DE,HL                           ;3806  eb            8620   8637 
    LD  HL,(NEWNO)                      ;3807  2a 34 38      8621   8638 
    OR  A                               ;380a  b7            8622   8639 
    SBC HL,DE                           ;380b  ed 52         8623   8640 
    JP  C,IFCALL                        ;380d  da 36 17      8624   8641 
    CALL    LNOADR                      ;3810  cd fd 3e      8625   8642 
    LD  HL,TEXTST                       ;3813  21 4e 7c      8626   8643 
BEGRNS: LD  E,(HL)                      ;3816  5e            8627   8644 
    INC HL                              ;3817  23            8628   8645 
    LD  D,(HL)                          ;3818  56            8629   8646 
    LD  A,D                             ;3819  7a            8630   8647 
    OR  E                               ;381a  b3            8631   8648 
    JR  Z,RNUMED'                       ;381b  28 2f         8632   8649 
    INC HL                              ;381d  23            8633   8650 
    LD  C,(HL)                          ;381e  4e            8634   8651 
    INC HL                              ;381f  23            8635   8652 
    LD  B,(HL)                          ;3820  46            8636   8653 
    PUSH    HL                          ;3821  e5            8637   8654 
    DEFB    021H                        ;3822  21            8638   8655 ; LD HL,?
STLNO:  DEFS    2                       ;3823                8639   8656 
    OR  A                               ;3825  b7            8640   8657 
    SBC HL,BC                           ;3826  ed 42         8641   8658 
    POP HL                              ;3828  e1            8642   8659 
    JR  Z,BEGREN                        ;3829  28 05         8643   8660 
    JR  C,BEGREN                        ;382b  38 03         8644   8661 
    EX  DE,HL                           ;382d  eb            8645   8662 
    JR  BEGRNS                          ;382e  18 e6         8646   8663 
                                        ;                    8647   8664 ;
BEGREN: DEC HL                          ;3830  2b            8648   8665 
    DEC HL                              ;3831  2b            8649   8666 
    DEC HL                              ;3832  2b            8650   8667 
    DEFB    001H                        ;3833  01            8651   8668 ; LD BC,?
NEWNO:  DEFS    2                       ;3834                8652   8669 
REKUML: LD  E,(HL)                      ;3836  5e            8653   8670 
    INC HL                              ;3837  23            8654   8671 
    LD  D,(HL)                          ;3838  56            8655   8672 
    LD  A,D                             ;3839  7a            8656   8673 
    OR  E                               ;383a  b3            8657   8674 
    JR  Z,RNUMED'                       ;383b  28 0f         8658   8675 
    INC HL                              ;383d  23            8659   8676 
    LD  (HL),C                          ;383e  71            8660   8677 
    INC HL                              ;383f  23            8661   8678 
    LD  (HL),B                          ;3840  70            8662   8679 
    DEFB    021H                        ;3841  21            8663   8680 ; LD HL,?
ADDNO:  DEFS    2                       ;3842                8664   8681 
    ADD HL,BC                           ;3844  09            8665   8682 
    JR  C,RENOVR                        ;3845  38 0a         8666   8683 
    LD  C,L                             ;3847  4d            8667   8684 
    LD  B,H                             ;3848  44            8668   8685 
    EX  DE,HL                           ;3849  eb            8669   8686 
    JR  REKUML                          ;384a  18 ea         8670   8687 
                                        ;                    8671   8688 ;
RNUMED':CALL    RETLNO                  ;384c  cd 0a 3f      8672   8689 
    POP HL                              ;384f  e1            8673   8690 
    RET                                 ;3850  c9            8674   8691 
                                        ;                    8675   8692 ;
RENOVR: LD  HL,10                       ;3851  21 0a 00      8676   8693 
    LD  (ADDNO),HL                      ;3854  22 42 38      8677   8694 
    LD  (NEWNO),HL                      ;3857  22 34 38      8678   8695 
    LD  L,0                             ;385a  2e 00         8679   8696 
    LD  (STLNO),HL                      ;385c  22 23 38      8680   8697 
    CALL    RNSTRT                      ;385f  cd fa 37      8681   8698 
    JP  IFCALL                          ;3862  c3 36 17      8682   8699 
                                        ;                    8683   8700 ;
CROPEN: LD  A,(FILEFG)                  ;3865  3a 83 33      8684   8701 
    OR  A                               ;3868  b7            8685   8702 
    JP  NZ,FILEER                       ;3869  c2 3e 18      8686   8703 
    LD  (LOADFN),A                      ;386c  32 c3 38      8687   8704 
    INC A                               ;386f  3c            8688   8705 
    LD  (FILEFG),A                      ;3870  32 83 33      8689   8706 
    CALL    BCFTCH                      ;3873  cd c4 25      8690   8707 
    DEC BC                              ;3876  0b            8691   8708 
    OR  A                               ;3877  b7            8692   8709 
    JR  Z,LOADST                        ;3878  28 24         8693   8710 
    CP  03Ah                            ;387a  fe 3a         8694   8711 
    JR  Z,LOADST                        ;387c  28 20         8695   8712 
    LD  A,001h                          ;387e  3e 01         8696   8713 
    LD  (LOADFN),A                      ;3880  32 c3 38      8697   8714 
    CALL    STREXX                      ;3883  cd 9d 45      8698   8715 
    DEC BC                              ;3886  0b            8699   8716 
    PUSH    BC                          ;3887  c5            8700   8717 
    OR  A                               ;3888  b7            8701   8718 
    JR  Z,LODIFC                        ;3889  28 02         8702   8719 
    CP  17                              ;388b  fe 11         8703   8720 
LODIFC: JP  NC,IFCALL                   ;388d  d2 36 17      8704   8721 
    LD  B,A                             ;3890  47            8705   8722 
    EX  DE,HL                           ;3891  eb            8706   8723 
    LD  DE,KEYBUF                       ;3892  11 4f 7a      8707   8724 
LDFNTR: LD  A,(HL)                      ;3895  7e            8708   8725 
    LD  (DE),A                          ;3896  12            8709   8726 
    INC DE                              ;3897  13            8710   8727 
    INC HL                              ;3898  23            8711   8728 
    DJNZ    LDFNTR                      ;3899  10 fa         8712   8729 
    XOR A                               ;389b  af            8713   8730 
    LD  (DE),A                          ;389c  12            8714   8731 
    POP BC                              ;389d  c1            8715   8732 
LOADST: CALL    FLOAD                   ;389e  cd 10 01      8716   8733 ;0027
    JP  C,BREAK                         ;38a1  da a2 16      8717   8734 
    CALL    CR2                         ;38a4  cd 23 08      8718   8735 
    LD  DE,LFOUM                        ;38a7  11 43 3a      8719   8736 
    PUSH    BC                          ;38aa  c5            8720   8737 
    LD  B,6                             ;38ab  06 06         8721   8738 
    CALL    PRTSDC                      ;38ad  cd e1 07      8722   8739 
    LD  DE,FILMOD                       ;38b0  11 96 13      8723   8740 ;10F0
LFDFNL: INC DE                          ;38b3  13            8724   8741 
    LD  A,(DE)                          ;38b4  1a            8725   8742 
    CP  000h                            ;38b5  fe 00         8726   8743 
    JR  Z,FLFPRE                        ;38b7  28 05         8727   8744 
    CALL    ACCPRT                      ;38b9  cd 64 08      8728   8745 
    JR  LFDFNL                          ;38bc  18 f5         8729   8746 
FLFPRE: POP BC                          ;38be  c1            8730   8747 
    CALL    CR2                         ;38bf  cd 23 08      8731   8748 
    DEFB    03EH                        ;38c2  3e            8732   8749 
LOADFN: DEFS    1                       ;38c3                8733   8750 
    OR  A                               ;38c4  b7            8734   8751 
    JR  Z,LFNOK                         ;38c5  28 16         8735   8752 
    LD  HL,KEYBUF                       ;38c7  21 4f 7a      8736   8753 
    LD  DE,FILNAM                       ;38ca  11 97 13      8737   8754 ;10F1
FNCMPL: LD  A,(DE)                      ;38cd  1a            8738   8755 
    CP  000h                            ;38ce  fe 00         8739   8756 
    JR  Z,LFNLCP                        ;38d0  28 07         8740   8757 
    CP  (HL)                            ;38d2  be            8741   8758 
    INC HL                              ;38d3  23            8742   8759 
    INC DE                              ;38d4  13            8743   8760 
    JR  Z,FNCMPL                        ;38d5  28 f6         8744   8761 
    JR  LOADST                          ;38d7  18 c5         8745   8762 
LFNLCP: LD  A,(HL)                      ;38d9  7e            8746   8763 
    OR  A                               ;38da  b7            8747   8764 
    JR  NZ,LOADST                       ;38db  20 c1         8748   8765 
LFNOK:  PUSH    BC                      ;38dd  c5            8749   8766 
    CALL    BUFCLR                      ;38de  cd 11 45      8750   8767 
    LD  DE,LDINGM                       ;38e1  11 49 3a      8751   8768 
    LD  B,8                             ;38e4  06 08         8752   8769 
    CALL    PRTSDC                      ;38e6  cd e1 07      8753   8770 
    LD  DE,FILNAM                       ;38e9  11 97 13      8754   8771 
    CALL    DEPRT                       ;38ec  cd f3 07      8755   8772 ;0015
    CALL    CR2                         ;38ef  cd 23 08      8756   8773 
    POP BC                              ;38f2  c1            8757   8774 
    RET                                 ;38f3  c9            8758   8775 
                                        ;                    8759   8776 ;
ROPEN:  LD  C,L                         ;38f4  4d            8760   8777 
    LD  B,H                             ;38f5  44            8761   8778 
    CALL    CROPEN                      ;38f6  cd 65 38      8762   8779 
    LD  L,C                             ;38f9  69            8763   8780 
    LD  H,B                             ;38fa  60            8764   8781 
    RET                                 ;38fb  c9            8765   8782 
                                        ;                    8766   8783 ;
VERIFY: INC HL                          ;38fc  23            8767   8784 
    LD  C,L                             ;38fd  4d            8768   8785 
    LD  B,H                             ;38fe  44            8769   8786 
    CALL    CROPEN                      ;38ff  cd 65 38      8770   8787 
    LD  A,(FILMOD)                      ;3902  3a 96 13      8771   8788 
    CP  016h                            ;3905  fe 16         8772   8789 
    JP  Z,FILEER                        ;3907  ca 3e 18      8773   8790 
    CALL    CVSAVE                      ;390a  cd de 39      8774   8791 
    CALL    MVRFY                       ;390d  cd af 01      8775   8792 
    CALL    CVLOAD                      ;3910  cd b9 39      8776   8793 
    LD  A,27                            ;3913  3e 1b         8777   8794 
    JP  C,ERROR                         ;3915  da 96 21      8778   8795 
    RET                                 ;3918  c9            8779   8796 
                                        ;                    8780   8797 ;
MERGE:  XOR A                           ;3919  af            8781   8798 
    LD  (FILEFG),A                      ;391a  32 83 33      8782   8799 
    LD  C,L                             ;391d  4d            8783   8800 
    LD  B,H                             ;391e  44            8784   8801 
    CALL    CROPEN                      ;391f  cd 65 38      8785   8802 
    LD  A,(FILMOD)                      ;3922  3a 96 13      8786   8803 
    CP  004h                            ;3925  fe 04         8787   8804 
    JP  C,FILEER                        ;3927  da 3e 18      8788   8805 
    JR  MRGEVC                          ;392a  18 1d         8789   8806 
                                        ;                    8790   8807 ;
LOAD:   XOR A                           ;392c  af            8791   8808 
    LD  (FILEFG),A                      ;392d  32 83 33      8792   8809 
    LD  (CONTFG),A                      ;3930  32 08 22      8793   8810 
    CALL    HLFTCH                      ;3933  cd 87 29      8794   8811 
    CP  08Ch                            ;3936  fe 8c         8795   8812 
    JR  Z,VERIFY                        ;3938  28 c2         8796   8813 
    LD  C,L                             ;393a  4d            8797   8814 
    LD  B,H                             ;393b  44            8798   8815 
    CALL    CROPEN                      ;393c  cd 65 38      8799   8816 
    LD  A,(FILMOD)                      ;393f  3a 96 13      8800   8817 
    CP  004h                            ;3942  fe 04         8801   8818 
    JR  C,BLOAD                         ;3944  38 32         8802   8819 
    CALL    NEW                         ;3946  cd ac 39      8803   8820 
MRGEVC: CALL    CLR                     ;3949  cd 51 19      8804   8821 
    LD  SP,(STRTOP)                     ;394c  ed 7b 41 7a   8805   8822 
    LD  HL,0FFFFh                       ;3950  21 ff ff      8806   8823 
    PUSH    HL                          ;3953  e5            8807   8824 
    LD  (SPBUF),SP                      ;3954  ed 73 25 22   8808   8825 
    LD  HL,CINPUT                       ;3958  21 f8 39      8809   8826 
    LD  (LODVEC),HL                     ;395b  22 9d 14      8810   8827 
    LD  A,001h                          ;395e  3e 01         8811   8828 
    LD  (NRLDED),A                      ;3960  32 30 3a      8812   8829 
    CALL    BUFCLR                      ;3963  cd 11 45      8813   8830 
    JP  NMESOK                          ;3966  c3 88 14      8814   8831 
                                        ;                    8815   8832 ;
TPRDER: XOR A                           ;3969  af            8816   8833 
    LD  (FILEFG),A                      ;396a  32 83 33      8817   8834 
    LD  A,(FILMOD)                      ;396d  3a 96 13      8818   8835 
    CP  002h                            ;3970  fe 02         8819   8836 
    CALL    Z,NEW                       ;3972  cc ac 39      8820   8837 
    JP  BREAK                           ;3975  c3 a2 16      8821   8838 
                                        ;                    8822   8839 ;
BLOAD:  CP  002h                        ;3978  fe 02         8823   8840 ; basic이면 TEXTST에 로딩
    JR  NZ,MLLOAD                       ;397a  20 28         8824   8841 
    LD  HL,TEXTST                       ;397c  21 4e 7c      8825   8842 
    LD  (MTADRS),HL                     ;397f  22 aa 13      8826   8843 
    LD  DE,(MTBYTE)                     ;3982  ed 5b a8 13   8827   8844 
    ADD HL,DE                           ;3986  19            8828   8845 
    LD  HL,(MEMEND)                     ;3987  2a 47 7a      8829   8846 
    OR  A                               ;398a  b7            8830   8847 
    SBC HL,DE                           ;398b  ed 52         8831   8848 
    JP  C,OMERR                         ;398d  da 88 21      8832   8849 
    CALL    MLOAD                       ;3990  cd 30 01      8833   8850 
    JR  C,TPRDER                        ;3993  38 d4         8834   8851 
    CALL    CVLOAD                      ;3995  cd b9 39      8835   8852 
    LD  HL,PROTCT                       ;3998  21 ae 13      8836   8853 
    LD  A,(HL)                          ;399b  7e            8837   8854 
    CP  03Ah                            ;399c  fe 3a         8838   8855 
    JP  Z,RUN                           ;399e  ca c3 15      8839   8856 
RTBLOD: LD  L,C                         ;39a1  69            8840   8857 
    LD  H,B                             ;39a2  60            8841   8858 
    RET                                 ;39a3  c9            8842   8859 
                                        ;                    8843   8860 ;
MLLOAD: CALL    MLOAD                   ;39a4  cd 30 01      8844   8861 
    JP  C,TPRDER                        ;39a7  da 69 39      8845   8862 
    JR  RTBLOD                          ;39aa  18 f5         8846   8863 
                                        ;                    8847   8864 ;
NEW:    LD  HL,TEXTST                   ;39ac  21 4e 7c      8848   8865 
    XOR A                               ;39af  af            8849   8866 
    LD  (HL),A                          ;39b0  77            8850   8867 
    INC HL                              ;39b1  23            8851   8868 
    LD  (HL),A                          ;39b2  77            8852   8869 
    INC HL                              ;39b3  23            8853   8870 
    LD  (HL),A                          ;39b4  77            8854   8871 
    LD  (VSTART),HL                     ;39b5  22 3b 7a      8855   8872 
    RET                                 ;39b8  c9            8856   8873 
                                        ;                    8857   8874 ;
CVLOAD: PUSH    AF                      ;39b9  f5            8858   8875 
    PUSH    HL                          ;39ba  e5            8859   8876 
    PUSH    DE                          ;39bb  d5            8860   8877 
    LD  HL,TEXTST                       ;39bc  21 4e 7c      8861   8878 
CVLDLP: LD  E,(HL)                      ;39bf  5e            8862   8879 
    INC HL                              ;39c0  23            8863   8880 
    LD  D,(HL)                          ;39c1  56            8864   8881 
    LD  A,E                             ;39c2  7b            8865   8882 
    OR  D                               ;39c3  b2            8866   8883 
    JR  Z,ESCCVL                        ;39c4  28 0b         8867   8884 
    PUSH    HL                          ;39c6  e5            8868   8885 
    ADD HL,DE                           ;39c7  19            8869   8886 
    DEC HL                              ;39c8  2b            8870   8887 
    EX  DE,HL                           ;39c9  eb            8871   8888 
    POP HL                              ;39ca  e1            8872   8889 
    LD  (HL),D                          ;39cb  72            8873   8890 
    DEC HL                              ;39cc  2b            8874   8891 
    LD  (HL),E                          ;39cd  73            8875   8892 
    EX  DE,HL                           ;39ce  eb            8876   8893 
    JR  CVLDLP                          ;39cf  18 ee         8877   8894 
ESCCVL: INC HL                          ;39d1  23            8878   8895 
    LD  (VSTART),HL                     ;39d2  22 3b 7a      8879   8896 
    LD  (HL),0                          ;39d5  36 00         8880   8897 
    LD  (STKLMT),HL                     ;39d7  22 3f 7a      8881   8898 
    POP DE                              ;39da  d1            8882   8899 
    POP HL                              ;39db  e1            8883   8900 
    POP AF                              ;39dc  f1            8884   8901 
    RET                                 ;39dd  c9            8885   8902 
                                        ;                    8886   8903 ;
CVSAVE: PUSH    AF                      ;39de  f5            8887   8904 
    PUSH    HL                          ;39df  e5            8888   8905 
    PUSH    DE                          ;39e0  d5            8889   8906 
    LD  HL,TEXTST                       ;39e1  21 4e 7c      8890   8907 
CVSVLP: LD  E,(HL)                      ;39e4  5e            8891   8908 
    INC HL                              ;39e5  23            8892   8909 
    LD  D,(HL)                          ;39e6  56            8893   8910 
    LD  A,D                             ;39e7  7a            8894   8911 
    OR  E                               ;39e8  b3            8895   8912 
    JR  Z,ESCCVL                        ;39e9  28 e6         8896   8913 
    PUSH    DE                          ;39eb  d5            8897   8914 
    EX  DE,HL                           ;39ec  eb            8898   8915 
    OR  A                               ;39ed  b7            8899   8916 
    DEC DE                              ;39ee  1b            8900   8917 
    SBC HL,DE                           ;39ef  ed 52         8901   8918 
    EX  DE,HL                           ;39f1  eb            8902   8919 
    LD  (HL),E                          ;39f2  73            8903   8920 
    INC HL                              ;39f3  23            8904   8921 
    LD  (HL),D                          ;39f4  72            8905   8922 
    POP HL                              ;39f5  e1            8906   8923 
    JR  CVSVLP                          ;39f6  18 ec         8907   8924 
                                        ;                    8908   8925 ;
CINPUT: PUSH    DE                      ;39f8  d5            8909   8926 
    CALL    CTINP                       ;39f9  cd 21 45      8910   8927 
    JR  C,ABORT                         ;39fc  38 1e         8911   8928 
    CP  00Dh                            ;39fe  fe 0d         8912   8929 
    JR  Z,NRLDED                        ;3a00  28 2e         8913   8930 
    JR  MIDCIP                          ;3a02  18 05         8914   8931 
CLDLP1: CALL    CTINP                   ;3a04  cd 21 45      8915   8932 
    JR  C,ABORT                         ;3a07  38 13         8916   8933 
MIDCIP: OR  A                           ;3a09  b7            8917   8934 
    JP  Z,FILEER                        ;3a0a  ca 3e 18      8918   8935 
    LD  (DE),A                          ;3a0d  12            8919   8936 
    INC DE                              ;3a0e  13            8920   8937 
    CP  00Dh                            ;3a0f  fe 0d         8921   8938 
    JR  NZ,CLDLP1                       ;3a11  20 f1         8922   8939 
    DEC DE                              ;3a13  1b            8923   8940 
    XOR A                               ;3a14  af            8924   8941 
    LD  (DE),A                          ;3a15  12            8925   8942 
    INC DE                              ;3a16  13            8926   8943 
    LD  (DE),A                          ;3a17  12            8927   8944 
    INC DE                              ;3a18  13            8928   8945 
    LD  (DE),A                          ;3a19  12            8929   8946 
    POP DE                              ;3a1a  d1            8930   8947 
    RET                                 ;3a1b  c9            8931   8948 
                                        ;                    8932   8949 ;
ABORT:  LD  HL,LININP                   ;3a1c  21 93 15      8933   8950 
    LD  (LODVEC),HL                     ;3a1f  22 9d 14      8934   8951 
    LD  SP,(SPBUF)                      ;3a22  ed 7b 25 22   8935   8952 
CBREAK: XOR A                           ;3a26  af            8936   8953 
    LD  (FILEFG),A                      ;3a27  32 83 33      8937   8954 
    LD  (CONTFG),A                      ;3a2a  32 08 22      8938   8955 
    JP  BREAK                           ;3a2d  c3 a2 16      8939   8956 
                                        ;                    8940   8957 ;
NRLDED: JP  FILEER                      ;3a30  c3 3e 18      8941   8958 
    LD  HL,LININP                       ;3a33  21 93 15      8942   8959 
    LD  (LODVEC),HL                     ;3a36  22 9d 14      8943   8960 
    LD  SP,(SPBUF)                      ;3a39  ed 7b 25 22   8944   8961 
    CALL    CLOSE                       ;3a3d  cd 82 33      8945   8962 
    JP  OK                              ;3a40  c3 62 14      8946   8963 
                                        ;                    8947   8964 ;
LFOUM:  DEFM    'FOUND:'                ;3a43  46 4f 55 4e   8948   8965 
                                        ;3a47  44 3a         8948   8966
                                        ;                    8949   8967 ;
LDINGM: DEFM    'LOADING:'              ;3a49  4c 4f 41 44   8950   8968 
                                        ;3a4d  49 4e 47 3a   8950   8969
                                        ;                    8951   8970 ;
WOPEN:  CALL    CWOPEN                  ;3a51  cd 5d 3a      8952   8971 
    CALL    FSAVE                       ;3a54  cd 80 00      8953   8972 
    JP  C,CBREAK                        ;3a57  da 26 3a      8954   8973 
    LD  L,C                             ;3a5a  69            8955   8974 
    LD  H,B                             ;3a5b  60            8956   8975 
    RET                                 ;3a5c  c9            8957   8976 
                                        ;                    8958   8977 ;
CWOPEN: LD  A,(FILEFG)                  ;3a5d  3a 83 33      8959   8978 
    OR  A                               ;3a60  b7            8960   8979 
    JP  NZ,FILEER                       ;3a61  c2 3e 18      8961   8980 
    LD  A,2                             ;3a64  3e 02         8962   8981 
    LD  (FILEFG),A                      ;3a66  32 83 33      8963   8982 
    LD  C,L                             ;3a69  4d            8964   8983 
    LD  B,H                             ;3a6a  44            8965   8984 
    CALL    BCFTCH                      ;3a6b  cd c4 25      8966   8985 
    DEC BC                              ;3a6e  0b            8967   8986 
    LD  HL,NULSDC                       ;3a6f  21 25 28      8968   8987 
    OR  A                               ;3a72  b7            8969   8988 
    JR  Z,NULSAV                        ;3a73  28 0a         8970   8989 
    CP  03Ah                            ;3a75  fe 3a         8971   8990 
    LD  A,0                             ;3a77  3e 00         8972   8991 
    JR  Z,NULSAV                        ;3a79  28 04         8973   8992 
    CALL    STREXX                      ;3a7b  cd 9d 45      8974   8993 
    DEC BC                              ;3a7e  0b            8975   8994 
NULSAV: CP  17                          ;3a7f  fe 11         8976   8995 
WOPIFC: JP  NC,IFCALL                   ;3a81  d2 36 17      8977   8996 
    PUSH    BC                          ;3a84  c5            8978   8997 
    LD  B,A                             ;3a85  47            8979   8998 
    EX  DE,HL                           ;3a86  eb            8980   8999 
    LD  DE,FILMOD                       ;3a87  11 96 13      8981   9000 
    LD  A,016h                          ;3a8a  3e 16         8982   9001 
    LD  (DE),A                          ;3a8c  12            8983   9002 
    INC DE                              ;3a8d  13            8984   9003 
    LD  A,B                             ;3a8e  78            8985   9004 
    OR  A                               ;3a8f  b7            8986   9005 
    JR  Z,NULFNM                        ;3a90  28 06         8987   9006 
SAVEFT: LD  A,(HL)                      ;3a92  7e            8988   9007 
    LD  (DE),A                          ;3a93  12            8989   9008 
    INC DE                              ;3a94  13            8990   9009 
    INC HL                              ;3a95  23            8991   9010 
    DJNZ    SAVEFT                      ;3a96  10 fa         8992   9011 
NULFNM: LD  A,000h                      ;3a98  3e 00         8993   9012 
    LD  (DE),A                          ;3a9a  12            8994   9013 
    POP BC                              ;3a9b  c1            8995   9014 
    LD  HL,TEXTST                       ;3a9c  21 4e 7c      8996   9015 
    LD  (MTADRS),HL                     ;3a9f  22 aa 13      8997   9016 
    EX  DE,HL                           ;3aa2  eb            8998   9017 
    LD  HL,(VSTART)                     ;3aa3  2a 3b 7a      8999   9018 
    OR  A                               ;3aa6  b7            9000   9019 
    SBC HL,DE                           ;3aa7  ed 52         9001   9020 
    LD  (MTBYTE),HL                     ;3aa9  22 a8 13      9002   9021 
    LD  HL,0                            ;3aac  21 00 00      9003   9022 
    LD  (MTEXEC),HL                     ;3aaf  22 ac 13      9004   9023 
    LD  A,0                             ;3ab2  3e 00         9005   9024 
    LD  (PROTCT),A                      ;3ab4  32 ae 13      9006   9025 
    CALL    BUFCLR                      ;3ab7  cd 11 45      9007   9026 
    RET                                 ;3aba  c9            9008   9027 
                                        ;                    9009   9028 ;
SAVE$:  XOR A                           ;3abb  af            9010   9029 
    LD  (FILEFG),A                      ;3abc  32 83 33      9011   9030 
    LD  A,(HL)                          ;3abf  7e            9012   9031 
    CP  04Dh                            ;3ac0  fe 4d         9013   9032 
    JR  Z,SAVEM                         ;3ac2  28 4f         9014   9033 
    CALL    CWOPEN                      ;3ac4  cd 5d 3a      9015   9034 
    CALL    BCFTCH                      ;3ac7  cd c4 25      9016   9035 
    CP  02Ch                            ;3aca  fe 2c         9017   9036 
    JR  NZ,BSAVE                        ;3acc  20 28         9018   9037 
    CALL    BCFTCH                      ;3ace  cd c4 25      9019   9038 
    CP  041h                            ;3ad1  fe 41         9020   9039 
    JP  NZ,SERROR                       ;3ad3  c2 3a 17      9021   9040 
    CALL    FSAVE                       ;3ad6  cd 80 00      9022   9041 
    JP  C,CBREAK                        ;3ad9  da 26 3a      9023   9042 
    PUSH    BC                          ;3adc  c5            9024   9043 
    CALL    RETLNO                      ;3add  cd 0a 3f      9025   9044 
    CALL    CLIST                       ;3ae0  cd 5e 40      9026   9045 
    LD  HL,CRTCR2                       ;3ae3  21 0e 41      9027   9046 
    LD  (LSCRVC),HL                     ;3ae6  22 04 41      9028   9047 
    LD  HL,CRTVEC                       ;3ae9  21 fd 40      9029   9048 
    LD  (SAVEVC),HL                     ;3aec  22 f6 40      9030   9049 
    JP  C,BREAK                         ;3aef  da a2 16      9031   9050 
    POP HL                              ;3af2  e1            9032   9051 
    JP  CLOSE                           ;3af3  c3 82 33      9033   9052 
                                        ;                    9034   9053 ;
BSAVE:  DEC BC                          ;3af6  0b            9035   9054 
    PUSH    BC                          ;3af7  c5            9036   9055 
    CALL    RETLNO                      ;3af8  cd 0a 3f      9037   9056 
    CALL    CVSAVE                      ;3afb  cd de 39      9038   9057 
    LD  A,002h                          ;3afe  3e 02         9039   9058 
    LD  (FILMOD),A                      ;3b00  32 96 13      9040   9059 
    CALL    FSAVE                       ;3b03  cd 80 00      9041   9060 
    JR  C,CBREA'                        ;3b06  38 03         9042   9061 
    CALL    MSAVE                       ;3b08  cd b6 00      9043   9062 
CBREA': CALL    CVLOAD                  ;3b0b  cd b9 39      9044   9063 
CBRSHM: POP HL                          ;3b0e  e1            9045   9064 
    JP  C,CBREAK                        ;3b0f  da 26 3a      9046   9065 
    RET                                 ;3b12  c9            9047   9066 
                                        ;                    9048   9067 ;
SAVEM:  INC HL                          ;3b13  23            9049   9068 
    CALL    CWOPEN                      ;3b14  cd 5d 3a      9050   9069 
    CALL    BCFTCH                      ;3b17  cd c4 25      9051   9070 
    CALL    CH2CH                       ;3b1a  cd 61 2d      9052   9071 
    CALL    IHLEXP                      ;3b1d  cd cc 22      9053   9072 
    LD  (MTADRS),HL                     ;3b20  22 aa 13      9054   9073 
    PUSH    HL                          ;3b23  e5            9055   9074 
    CALL    CH2CH                       ;3b24  cd 61 2d      9056   9075 
    CALL    IHLEXP                      ;3b27  cd cc 22      9057   9076 
    POP DE                              ;3b2a  d1            9058   9077 
    OR  A                               ;3b2b  b7            9059   9078 
    SBC HL,DE                           ;3b2c  ed 52         9060   9079 
    INC HL                              ;3b2e  23            9061   9080 
    LD  (MTBYTE),HL                     ;3b2f  22 a8 13      9062   9081 
    CP  02Ch                            ;3b32  fe 2c         9063   9082 
    JR  NZ,SVMNEA                       ;3b34  20 06         9064   9083 
    CALL    IHLEXP                      ;3b36  cd cc 22      9065   9084 
    LD  (MTEXEC),HL                     ;3b39  22 ac 13      9066   9085 
SVMNEA: DEC BC                          ;3b3c  0b            9067   9086 
    PUSH    BC                          ;3b3d  c5            9068   9087 
    LD  A,1                             ;3b3e  3e 01         9069   9088 
    LD  (FILMOD),A                      ;3b40  32 96 13      9070   9089 
    CALL    FSAVE                       ;3b43  cd 80 00      9071   9090 
    JR  C,CBRSHM                        ;3b46  38 c6         9072   9091 
    CALL    MSAVE                       ;3b48  cd b6 00      9073   9092 
    JR  CBRSHM                          ;3b4b  18 c1         9074   9093 
                                        ;                    9075   9094 ;
DEFFN:  CALL    HLFTCH                  ;3b4d  cd 87 29      9076   9095 
    INC A                               ;3b50  3c            9077   9096 
FNSERR: JP  NZ,SERROR                   ;3b51  c2 3a 17      9078   9097 
    INC HL                              ;3b54  23            9079   9098 
    LD  A,(HL)                          ;3b55  7e            9080   9099 
    CP  0A0h                            ;3b56  fe a0         9081   9100 
    JP  Z,DEFCHR                        ;3b58  ca cb 46      9082   9101 
    CP  0BEh                            ;3b5b  fe be         9083   9102 
    JP  Z,DEFUSR                        ;3b5d  ca 40 3c      9084   9103 
    CP  0BDh                            ;3b60  fe bd         9085   9104 
    JR  NZ,FNSERR                       ;3b62  20 ed         9086   9105 
    INC HL                              ;3b64  23            9087   9106 
    LD  C,L                             ;3b65  4d            9088   9107 
    LD  B,H                             ;3b66  44            9089   9108 
    CALL    ILDRCH                      ;3b67  cd 90 3b      9090   9109 
    CALL    BCFTCH                      ;3b6a  cd c4 25      9091   9110 
    CALL    GETFUN                      ;3b6d  cd a1 3b      9092   9111 
    JR  NC,DUPDEF                       ;3b70  30 19         9093   9112 
    LD  HL,(STKLMT)                     ;3b72  2a 3f 7a      9094   9113 
    OR  0C0h                            ;3b75  f6 c0         9095   9114 
    LD  (HL),A                          ;3b77  77            9096   9115 
    INC HL                              ;3b78  23            9097   9116 
    LD  (HL),E                          ;3b79  73            9098   9117 
    INC HL                              ;3b7a  23            9099   9118 
    LD  (HL),D                          ;3b7b  72            9100   9119 
    INC HL                              ;3b7c  23            9101   9120 
    LD  (HL),C                          ;3b7d  71            9102   9121 
    INC HL                              ;3b7e  23            9103   9122 
    LD  (HL),B                          ;3b7f  70            9104   9123 
    INC HL                              ;3b80  23            9105   9124 
    LD  (HL),000h                       ;3b81  36 00         9106   9125 
    LD  (STKLMT),HL                     ;3b83  22 3f 7a      9107   9126 
    LD  L,C                             ;3b86  69            9108   9127 
    LD  H,B                             ;3b87  60            9109   9128 
    JP  DATA                            ;3b88  c3 c8 1c      9110   9129 
                                        ;                    9111   9130 ;
DUPDEF: LD  A,10                        ;3b8b  3e 0a         9112   9131 
ERJVDE: JP  ERROR                       ;3b8d  c3 96 21      9113   9132 
                                        ;                    9114   9133 ;
ILDRCH: PUSH    HL                      ;3b90  e5            9115   9134 
    LD  HL,(LNOBUF)                     ;3b91  2a cc 16      9116   9135 
    INC HL                              ;3b94  23            9117   9136 
    LD  A,H                             ;3b95  7c            9118   9137 
    OR  L                               ;3b96  b5            9119   9138 
    POP HL                              ;3b97  e1            9120   9139 
    RET NZ                              ;3b98  c0            9121   9140 
    LD  A,12                            ;3b99  3e 0c         9122   9141 
    JR  ERJVDE                          ;3b9b  18 f0         9123   9142 
                                        ;                    9124   9143 ;
UNDEFN: LD  A,012h                      ;3b9d  3e 12         9125   9144 
    JR  ERJVDE                          ;3b9f  18 ec         9126   9145 
                                        ;                    9127   9146 ;
GETFUN: CALL    VSRTST                  ;3ba1  cd fe 20      9128   9147 
    CP  028h                            ;3ba4  fe 28         9129   9148 
    JP  NZ,SERROR                       ;3ba6  c2 3a 17      9130   9149 
    DEC BC                              ;3ba9  0b            9131   9150 
    PUSH    BC                          ;3baa  c5            9132   9151 
    LD  A,E                             ;3bab  7b            9133   9152 
    OR  0C0h                            ;3bac  f6 c0         9134   9153 
    EX  DE,HL                           ;3bae  eb            9135   9154 
    LD  B,A                             ;3baf  47            9136   9155 
    LD  HL,(VSTART)                     ;3bb0  2a 3b 7a      9137   9156 
GFNLP1: LD  A,(HL)                      ;3bb3  7e            9138   9157 
    OR  A                               ;3bb4  b7            9139   9158 
    JR  Z,FNNOTF                        ;3bb5  28 37         9140   9159 
    CP  B                               ;3bb7  b8            9141   9160 
    JR  NZ,SKIPN1                       ;3bb8  20 17         9142   9161 
    INC HL                              ;3bba  23            9143   9162 
    LD  A,E                             ;3bbb  7b            9144   9163 
    CP  (HL)                            ;3bbc  be            9145   9164 
    LD  A,004h                          ;3bbd  3e 04         9146   9165 
    JR  NZ,SKIPFN                       ;3bbf  20 25         9147   9166 
    INC HL                              ;3bc1  23            9148   9167 
    LD  A,D                             ;3bc2  7a            9149   9168 
    CP  (HL)                            ;3bc3  be            9150   9169 
    LD  A,3                             ;3bc4  3e 03         9151   9170 
    JR  NZ,SKIPFN                       ;3bc6  20 1e         9152   9171 
    INC HL                              ;3bc8  23            9153   9172 
    CALL    INDRCT                      ;3bc9  cd a3 2a      9154   9173 
    LD  A,B                             ;3bcc  78            9155   9174 
    AND 00Fh                            ;3bcd  e6 0f         9156   9175 
    POP BC                              ;3bcf  c1            9157   9176 
    RET                                 ;3bd0  c9            9158   9177 
                                        ;                    9159   9178 ;
SKIPN1: INC A                           ;3bd1  3c            9160   9179 
    JP  P,SKIPN2                        ;3bd2  f2 e4 3b      9161   9180 
    DEC A                               ;3bd5  3d            9162   9181 
    AND 0C0h                            ;3bd6  e6 c0         9163   9182 
    CP  0C0h                            ;3bd8  fe c0         9164   9183 
    LD  A,5                             ;3bda  3e 05         9165   9184 
    JR  Z,SKIPFN                        ;3bdc  28 08         9166   9185 
    INC HL                              ;3bde  23            9167   9186 
    CALL    INDRCT                      ;3bdf  cd a3 2a      9168   9187 
    JR  GFNLP1                          ;3be2  18 cf         9169   9188 
                                        ;                    9170   9189 ;
SKIPN2: INC A                           ;3be4  3c            9171   9190 
    INC A                               ;3be5  3c            9172   9191 
SKIPFN: ADD A,L                         ;3be6  85            9173   9192 
    LD  L,A                             ;3be7  6f            9174   9193 
    LD  A,000h                          ;3be8  3e 00         9175   9194 
    ADC A,H                             ;3bea  8c            9176   9195 
    LD  H,A                             ;3beb  67            9177   9196 
    JR  GFNLP1                          ;3bec  18 c5         9178   9197 
                                        ;                    9179   9198 ;
FNNOTF: LD  A,B                         ;3bee  78            9180   9199 
    AND 00Fh                            ;3bef  e6 0f         9181   9200 
    POP BC                              ;3bf1  c1            9182   9201 
    SCF                                 ;3bf2  37            9183   9202 
    RET                                 ;3bf3  c9            9184   9203 
                                        ;                    9185   9204 ;
FNOPR:  PUSH    HL                      ;3bf4  e5            9186   9205 
    CALL    BCFTCH                      ;3bf5  cd c4 25      9187   9206 
    CALL    GETFUN                      ;3bf8  cd a1 3b      9188   9207 
    JR  C,UNDEFN                        ;3bfb  38 a0         9189   9208 
    CP  003h                            ;3bfd  fe 03         9190   9209 
    JR  Z,STRFNC                        ;3bff  28 05         9191   9210 
    CALL    CONDFL                      ;3c01  cd eb 28      9192   9211 
    JR  ARGFUN                          ;3c04  18 03         9193   9212 
STRFNC: CALL    CONDSR                  ;3c06  cd d9 28      9194   9213 
ARGFUN: EX  DE,HL                       ;3c09  eb            9195   9214 
    LD  HL,(FUNCNS)                     ;3c0a  2a 2f 26      9196   9215 
    EX  (SP),HL                         ;3c0d  e3            9197   9216 
    CALL    CH28H                       ;3c0e  cd 58 2d      9198   9217 
    PUSH    BC                          ;3c11  c5            9199   9218 
    LD  C,E                             ;3c12  4b            9200   9219 
    LD  B,D                             ;3c13  42            9201   9220 
    CALL    CH28H                       ;3c14  cd 58 2d      9202   9221 
    PUSH    BC                          ;3c17  c5            9203   9222 
    EX  DE,HL                           ;3c18  eb            9204   9223 
    LD  HL,00000h                       ;3c19  21 00 00      9205   9224 
    ADD HL,SP                           ;3c1c  39            9206   9225 
    LD  (FUNCNS),HL                     ;3c1d  22 2f 26      9207   9226 
    EX  DE,HL                           ;3c20  eb            9208   9227 
    CALL    SK2829                      ;3c21  cd 1e 27      9209   9228 
    CALL    BCFTCH                      ;3c24  cd c4 25      9210   9229 
    CP  0F5h                            ;3c27  fe f5         9211   9230 
    JP  NZ,SERROR                       ;3c29  c2 3a 17      9212   9231 
    CALL    EXPRSN                      ;3c2c  cd f2 22      9213   9232 
    POP DE                              ;3c2f  d1            9214   9233 
    POP BC                              ;3c30  c1            9215   9234 
    CALL    SK2829                      ;3c31  cd 1e 27      9216   9235 
    POP DE                              ;3c34  d1            9217   9236 
    LD  (FUNCNS),DE                     ;3c35  ed 53 2f 26   9218   9237 
    JP  BCFTCH                          ;3c39  c3 c4 25      9219   9238 
                                        ;                    9220   9239 ;
DFLTUF: LD  A,0                         ;3c3c  3e 00         9221   9240 
    JR  DFLTZR                          ;3c3e  18 11         9222   9241 
                                        ;                    9223   9242 ;
DEFUSR: INC HL                          ;3c40  23            9224   9243 
    CALL    HLFTCH                      ;3c41  cd 87 29      9225   9244 
    CP  0F5h                            ;3c44  fe f5         9226   9245 
    JR  Z,DFLTUF                        ;3c46  28 f4         9227   9246 
    OR  A                               ;3c48  b7            9228   9247 
    JR  Z,USERSE                        ;3c49  28 26         9229   9248 
    CP  00Bh                            ;3c4b  fe 0b         9230   9249 
    JR  NC,USERSE                       ;3c4d  30 22         9231   9250 
    DEC A                               ;3c4f  3d            9232   9251 
    INC HL                              ;3c50  23            9233   9252 
DFLTZR: PUSH    AF                      ;3c51  f5            9234   9253 
    CALL    HLFTCH                      ;3c52  cd 87 29      9235   9254 
    CP  0F5h                            ;3c55  fe f5         9236   9255 
    JR  NZ,USERSE                       ;3c57  20 18         9237   9256 
    INC HL                              ;3c59  23            9238   9257 
    LD  C,L                             ;3c5a  4d            9239   9258 
    LD  B,H                             ;3c5b  44            9240   9259 
    CALL    IHLEXP                      ;3c5c  cd cc 22      9241   9260 
    LD  DE,USRTBL                       ;3c5f  11 a2 30      9242   9261 
    POP AF                              ;3c62  f1            9243   9262 
    ADD A,A                             ;3c63  87            9244   9263 
    ADD A,E                             ;3c64  83            9245   9264 
    LD  E,A                             ;3c65  5f            9246   9265 
    LD  A,0                             ;3c66  3e 00         9247   9266 
    ADC A,D                             ;3c68  8a            9248   9267 
    LD  D,A                             ;3c69  57            9249   9268 
    EX  DE,HL                           ;3c6a  eb            9250   9269 
    LD  (HL),E                          ;3c6b  73            9251   9270 
    INC HL                              ;3c6c  23            9252   9271 
    LD  (HL),D                          ;3c6d  72            9253   9272 
    JP  RETIRQ                          ;3c6e  c3 39 1b      9254   9273 
                                        ;                    9255   9274 ;
USERSE: JP  SERROR                      ;3c71  c3 3a 17      9256   9275 
                                        ;                    9257   9276 ;
USRDFZ: DEC BC                          ;3c74  0b            9258   9277 
    XOR A                               ;3c75  af            9259   9278 
    JR  USRDZE                          ;3c76  18 0f         9260   9279 
                                        ;                    9261   9280 ;
USROPR: CALL    BCFTCH                  ;3c78  cd c4 25      9262   9281 
    CP  028h                            ;3c7b  fe 28         9263   9282 
    JR  Z,USRDFZ                        ;3c7d  28 f5         9264   9283 
    OR  A                               ;3c7f  b7            9265   9284 
    JR  Z,USERSE                        ;3c80  28 ef         9266   9285 
    CP  00Bh                            ;3c82  fe 0b         9267   9286 
    JR  NC,USERSE                       ;3c84  30 eb         9268   9287 
    DEC A                               ;3c86  3d            9269   9288 
USRDZE: PUSH    AF                      ;3c87  f5            9270   9289 
    CALL    BCFTCH                      ;3c88  cd c4 25      9271   9290 
    CP  028h                            ;3c8b  fe 28         9272   9291 
    JR  NZ,USERSE                       ;3c8d  20 e2         9273   9292 
    CALL    EXPRSN                      ;3c8f  cd f2 22      9274   9293 
    CP  029h                            ;3c92  fe 29         9275   9294 
    JR  NZ,USERSE                       ;3c94  20 db         9276   9295 
    POP AF                              ;3c96  f1            9277   9296 
    PUSH    BC                          ;3c97  c5            9278   9297 
    PUSH    HL                          ;3c98  e5            9279   9298 
    ADD A,A                             ;3c99  87            9280   9299 
    LD  DE,USRTBL                       ;3c9a  11 a2 30      9281   9300 
    ADD A,E                             ;3c9d  83            9282   9301 
    LD  E,A                             ;3c9e  5f            9283   9302 
    LD  A,0                             ;3c9f  3e 00         9284   9303 
    ADC A,D                             ;3ca1  8a            9285   9304 
    LD  D,A                             ;3ca2  57            9286   9305 
    EX  DE,HL                           ;3ca3  eb            9287   9306 
    CALL    INDRCT                      ;3ca4  cd a3 2a      9288   9307 
    EX  DE,HL                           ;3ca7  eb            9289   9308 
    LD  A,D                             ;3ca8  7a            9290   9309 
    OR  E                               ;3ca9  b3            9291   9310 
    JP  Z,UNDEFN                        ;3caa  ca 9d 3b      9292   9311 
    LD  A,(IY+0)                        ;3cad  fd 7e 00      9293   9312 
    CP  003h                            ;3cb0  fe 03         9294   9313 
    CALL    Z,INDRCT                    ;3cb2  cc a3 2a      9295   9314 
    PUSH    HL                          ;3cb5  e5            9296   9315 
    LD  HL,USRBCK                       ;3cb6  21 bc 3c      9297   9316 
    EX  (SP),HL                         ;3cb9  e3            9298   9317 
    PUSH    DE                          ;3cba  d5            9299   9318 
    RET                                 ;3cbb  c9            9300   9319 
                                        ;                    9301   9320 ;
USRBCK: POP HL                          ;3cbc  e1            9302   9321 
    POP BC                              ;3cbd  c1            9303   9322 
    JP  BCFTCH                          ;3cbe  c3 c4 25      9304   9323 
                                        ;                    9305   9324 ;
TIME$:  JP  NINS                        ;3cc1  c3 fa 20      9306   9325 
                                        ;                    9307   9326 ;
SCRN$:  PUSH    HL                      ;3cc4  e5            9308   9327 
    CALL    CH28H                       ;3cc5  cd 58 2d      9309   9328 
    DEC IY                              ;3cc8  fd 2b         9310   9329 
    CALL    HLEXP                       ;3cca  cd c7 22      9311   9330 
    CP  02Ch                            ;3ccd  fe 2c         9312   9331 
SCRNER: JP  NZ,SERROR                   ;3ccf  c2 3a 17      9313   9332 
    CALL    HCHECK                      ;3cd2  cd d8 22      9314   9333 
    CP  32                              ;3cd5  fe 20         9315   9334 
SCRIFC: JP  NC,IFCALL                   ;3cd7  d2 36 17      9316   9335 
    LD  E,A                             ;3cda  5f            9317   9336 
    POP HL                              ;3cdb  e1            9318   9337 
    PUSH    HL                          ;3cdc  e5            9319   9338 
    PUSH    DE                          ;3cdd  d5            9320   9339 
    CALL    HLEXP                       ;3cde  cd c7 22      9321   9340 
    CP  02Ch                            ;3ce1  fe 2c         9322   9341 
    JR  NZ,SCRNER                       ;3ce3  20 ea         9323   9342 
    CALL    HCHECK                      ;3ce5  cd d8 22      9324   9343 
    CP  16                              ;3ce8  fe 10         9325   9344 
    JR  NC,SCRIFC                       ;3cea  30 eb         9326   9345 
    POP HL                              ;3cec  e1            9327   9346 
    LD  H,A                             ;3ced  67            9328   9347 
    PUSH    BC                          ;3cee  c5            9329   9348 
    CALL    ADRCA2                      ;3cef  cd 3b 09      9330   9349 
    LD  D,B                             ;3cf2  50            9331   9350 
    LD  E,C                             ;3cf3  59            9332   9351 
    POP BC                              ;3cf4  c1            9333   9352 
    POP HL                              ;3cf5  e1            9334   9353 
    PUSH    HL                          ;3cf6  e5            9335   9354 
    PUSH    DE                          ;3cf7  d5            9336   9355 
    CALL    HLEXP                       ;3cf8  cd c7 22      9337   9356 
    CP  029h                            ;3cfb  fe 29         9338   9357 
    JR  NZ,SCRNER                       ;3cfd  20 d0         9339   9358 
    CALL    HCHECK                      ;3cff  cd d8 22      9340   9359 
    POP HL                              ;3d02  e1            9341   9360 
    POP DE                              ;3d03  d1            9342   9361 
    PUSH    BC                          ;3d04  c5            9343   9362 
    PUSH    DE                          ;3d05  d5            9344   9363 
    PUSH    AF                          ;3d06  f5            9345   9364 
    LD  C,L                             ;3d07  4d            9346   9365 
    LD  B,H                             ;3d08  44            9347   9366 
    LD  H,A                             ;3d09  67            9348   9367 
    LD  DE,KEYBUF                       ;3d0a  11 4f 7a      9349   9368 
    PUSH    DE                          ;3d0d  d5            9350   9369 
SCRNTL: CALL    AINBC                   ;3d0e  cd 94 07      9351   9370 
    OR  A                               ;3d11  b7            9352   9371 
    JR  NZ,L2900                        ;3d12  20 02         9353   9372 
    LD  A,020h                          ;3d14  3e 20         9354   9373 
L2900:  LD  (DE),A                      ;3d16  12            9355   9374 
    INC BC                              ;3d17  03            9356   9375 
    INC DE                              ;3d18  13            9357   9376 
    DEC H                               ;3d19  25            9358   9377 
    JR  NZ,SCRNTL                       ;3d1a  20 f2         9359   9378 
    POP DE                              ;3d1c  d1            9360   9379 
    POP AF                              ;3d1d  f1            9361   9380 
    LD  B,A                             ;3d1e  47            9362   9381 
    POP HL                              ;3d1f  e1            9363   9382 
    PUSH    DE                          ;3d20  d5            9364   9383 
    LD  DE,00008h                       ;3d21  11 08 00      9365   9384 
    ADD HL,DE                           ;3d24  19            9366   9385 
    POP DE                              ;3d25  d1            9367   9386 
    CALL    ENTSTR                      ;3d26  cd 1a 2b      9368   9387 
    INC IY                              ;3d29  fd 23         9369   9388 
    POP BC                              ;3d2b  c1            9370   9389 
    JP  CONDSB                          ;3d2c  c3 b1 25      9371   9390 
                                        ;                    9372   9391 ;
DUMP:   CALL    HLFTCH                  ;3d2f  cd 87 29      9373   9392 
    CP  023h                            ;3d32  fe 23         9374   9393 
    LD  A,0                             ;3d34  3e 00         9375   9394 
    JR  NZ,STDPDV                       ;3d36  20 03         9376   9395 
    INC HL                              ;3d38  23            9377   9396 
    LD  A,2                             ;3d39  3e 02         9378   9397 
STDPDV: LD  (DISFLG),A                  ;3d3b  32 eb 11      9379   9398 
    PUSH    HL                          ;3d3e  e5            9380   9399 
    LD  HL,(VSTART)                     ;3d3f  2a 3b 7a      9381   9400 
DMPLOP: LD  A,(HL)                      ;3d42  7e            9382   9401 
    OR  A                               ;3d43  b7            9383   9402 
    JP  Z,DUMPRT                        ;3d44  ca e4 3d      9384   9403 
    RLCA                                ;3d47  07            9385   9404 
    JR  NC,ONLYVR                       ;3d48  30 38         9386   9405 
    RLCA                                ;3d4a  07            9387   9406 
    JR  NC,ARYSKP                       ;3d4b  30 07         9388   9407 
    INC HL                              ;3d4d  23            9389   9408 
    INC HL                              ;3d4e  23            9390   9409 
    INC HL                              ;3d4f  23            9391   9410 
    INC HL                              ;3d50  23            9392   9411 
    INC HL                              ;3d51  23            9393   9412 
    JR  DMPLOP                          ;3d52  18 ee         9394   9413 
ARYSKP: LD  A,(HL)                      ;3d54  7e            9395   9414 
    INC HL                              ;3d55  23            9396   9415 
    PUSH    HL                          ;3d56  e5            9397   9416 
    INC HL                              ;3d57  23            9398   9417 
    AND 00Fh                            ;3d58  e6 0f         9399   9418 
    CALL    PRDMVR                      ;3d5a  cd eb 3d      9400   9419 
    LD  B,(HL)                          ;3d5d  46            9401   9420 
    INC HL                              ;3d5e  23            9402   9421 
    LD  A,028h                          ;3d5f  3e 28         9403   9422 
ARDSLP: CALL    ACCPRT                  ;3d61  cd 64 08      9404   9423 
    PUSH    HL                          ;3d64  e5            9405   9424 
    CALL    INDRCT                      ;3d65  cd a3 2a      9406   9425 
    PUSH    BC                          ;3d68  c5            9407   9426 
    CALL    FIVEPR                      ;3d69  cd e5 16      9408   9427 
    POP BC                              ;3d6c  c1            9409   9428 
    POP HL                              ;3d6d  e1            9410   9429 
    INC HL                              ;3d6e  23            9411   9430 
    INC HL                              ;3d6f  23            9412   9431 
    LD  A,02Ch                          ;3d70  3e 2c         9413   9432 
    DJNZ    ARDSLP                      ;3d72  10 ed         9414   9433 
    LD  A,029h                          ;3d74  3e 29         9415   9434 
    CALL    ACCPRT                      ;3d76  cd 64 08      9416   9435 
    CALL    CR1                         ;3d79  cd 43 08      9417   9436 
    POP HL                              ;3d7c  e1            9418   9437 
    CALL    INDRCT                      ;3d7d  cd a3 2a      9419   9438 
    JR  DMPLOP                          ;3d80  18 c0         9420   9439 
ONLYVR: PUSH    HL                      ;3d82  e5            9421   9440 
    LD  A,(HL)                          ;3d83  7e            9422   9441 
    PUSH    AF                          ;3d84  f5            9423   9442 
    CALL    PRDMVR                      ;3d85  cd eb 3d      9424   9443 
    LD  A,03Dh                          ;3d88  3e 3d         9425   9444 
    CALL    ACCPRT                      ;3d8a  cd 64 08      9426   9445 
    LD  A,(IY+0)                        ;3d8d  fd 7e 00      9427   9446 
    CP  003h                            ;3d90  fe 03         9428   9447 
    JR  NZ,STRDMP                       ;3d92  20 15         9429   9448 
    LD  B,(HL)                          ;3d94  46            9430   9449 
    INC HL                              ;3d95  23            9431   9450 
    CALL    INDRCT                      ;3d96  cd a3 2a      9432   9451 
    EX  DE,HL                           ;3d99  eb            9433   9452 
    LD  A,022h                          ;3d9a  3e 22         9434   9453 
    CALL    ACCPRT                      ;3d9c  cd 64 08      9435   9454 
    CALL    PRTSDC                      ;3d9f  cd e1 07      9436   9455 
    LD  A,022h                          ;3da2  3e 22         9437   9456 
    CALL    ACCPRT                      ;3da4  cd 64 08      9438   9457 
    JR  NXTDMP                          ;3da7  18 20         9439   9458 
                                        ;                    9440   9459 ;
STRDMP: CP  002h                        ;3da9  fe 02         9441   9460 
    JR  NZ,RALDMP                       ;3dab  20 0e         9442   9461 
    CALL    INDRCT                      ;3dad  cd a3 2a      9443   9462 
    EX  DE,HL                           ;3db0  eb            9444   9463 
    LD  HL,KEYBUF                       ;3db1  21 4f 7a      9445   9464 
    LD  (IY+0),4                        ;3db4  fd 36 00 04   9446   9465 
    CALL    FLTHEX                      ;3db8  cd 02 29      9447   9466 
RALDMP: LD  DE,USINGB                   ;3dbb  11 b1 46      9448   9467 
    PUSH    DE                          ;3dbe  d5            9449   9468 
    CALL    LDIR8                       ;3dbf  cd a6 73      9450   9469 
    POP HL                              ;3dc2  e1            9451   9470 
    CALL    CVNMFL                      ;3dc3  cd 58 5d      9452   9471 
    CALL    PRTSDC                      ;3dc6  cd e1 07      9453   9472 
NXTDMP: CALL    CR1                     ;3dc9  cd 43 08      9454   9473 
    POP AF                              ;3dcc  f1            9455   9474 
    POP HL                              ;3dcd  e1            9456   9475 
    INC A                               ;3dce  3c            9457   9476 
    INC A                               ;3dcf  3c            9458   9477 
    INC A                               ;3dd0  3c            9459   9478 
    LD  E,A                             ;3dd1  5f            9460   9479 
    LD  D,0                             ;3dd2  16 00         9461   9480 
    ADD HL,DE                           ;3dd4  19            9462   9481 
    LD  A,080h                          ;3dd5  3e 80         9463   9482 
    IN  A,(1)                           ;3dd7  db 01         9464   9483 
    AND 004h                            ;3dd9  e6 04         9465   9484 
    CALL    Z,FLSHGT                    ;3ddb  cc 3c 0d      9466   9485 
    CALL    BRKEY                       ;3dde  cd 5b 0c      9467   9486 
    JP  NZ,DMPLOP                       ;3de1  c2 42 3d      9468   9487 
DUMPRT: POP HL                          ;3de4  e1            9469   9488 
    LD  A,1                             ;3de5  3e 01         9470   9489 
    LD  (DISFLG),A                      ;3de7  32 eb 11      9471   9490 
    RET                                 ;3dea  c9            9472   9491 
                                        ;                    9473   9492 ;
PRDMVR: PUSH    AF                      ;3deb  f5            9474   9493 
    INC HL                              ;3dec  23            9475   9494 
    LD  A,(HL)                          ;3ded  7e            9476   9495 
    CALL    ACCPRT                      ;3dee  cd 64 08      9477   9496 
    INC HL                              ;3df1  23            9478   9497 
    LD  A,(HL)                          ;3df2  7e            9479   9498 
    OR  A                               ;3df3  b7            9480   9499 
    JR  NZ,NTNULD                       ;3df4  20 02         9481   9500 
    LD  A,020h                          ;3df6  3e 20         9482   9501 
NTNULD: CALL    ACCPRT                  ;3df8  cd 64 08      9483   9502 
    INC HL                              ;3dfb  23            9484   9503 
    POP AF                              ;3dfc  f1            9485   9504 
    LD  B,021h                          ;3dfd  06 21         9486   9505 
    CP  004h                            ;3dff  fe 04         9487   9506 
    JR  Z,PTVSBL                        ;3e01  28 0c         9488   9507 
    INC B                               ;3e03  04            9489   9508 
    INC B                               ;3e04  04            9490   9509 
    CP  008h                            ;3e05  fe 08         9491   9510 
    JR  Z,PTVSBL                        ;3e07  28 06         9492   9511 
    INC B                               ;3e09  04            9493   9512 
    CP  003h                            ;3e0a  fe 03         9494   9513 
    JR  Z,PTVSBL                        ;3e0c  28 01         9495   9514 
    INC B                               ;3e0e  04            9496   9515 
PTVSBL: LD  IY,(INTSSP)                 ;3e0f  fd 2a 43 7a   9497   9516 
    LD  (IY+0),A                        ;3e13  fd 77 00      9498   9517 
    LD  A,B                             ;3e16  78            9499   9518 
    CALL    ACCPRT                      ;3e17  cd 64 08      9500   9519 
    RET                                 ;3e1a  c9            9501   9520 
                                        ;                    9502   9521 ;
CONSOL: JP  NINS                        ;3e1b  c3 fa 20      9503   9522 
                                        ;                    9504   9523 ;
KLIST:  PUSH    HL                      ;3e1e  e5            9505   9524 
    CALL    CR2                         ;3e1f  cd 23 08      9506   9525 
    LD  C,0                             ;3e22  0e 00         9507   9526 
KLSTLP: LD  A,C                         ;3e24  79            9508   9527 
    CP  009h                            ;3e25  fe 09         9509   9528 
    JR  Z,KLTEN                         ;3e27  28 07         9510   9529 
    ADD A,031h                          ;3e29  c6 31         9511   9530 
    CALL    ACCPRT                      ;3e2b  cd 64 08      9512   9531 
    JR  KLTAB                           ;3e2e  18 09         9513   9532 
KLTEN:  LD  A,031h                      ;3e30  3e 31         9514   9533 
    CALL    ACCPRT                      ;3e32  cd 64 08      9515   9534 
    DEC A                               ;3e35  3d            9516   9535 
    CALL    ACCPRT                      ;3e36  cd 64 08      9517   9536 
KLTAB:  CALL    TABPRT                  ;3e39  cd 02 08      9518   9537 
    LD  A,C                             ;3e3c  79            9519   9538 
    CALL    KEYBCL                      ;3e3d  cd da 3e      9520   9539 
    LD  B,(HL)                          ;3e40  46            9521   9540 
    INC HL                              ;3e41  23            9522   9541 
    XOR A                               ;3e42  af            9523   9542 
    CP  B                               ;3e43  b8            9524   9543 
    JR  Z,KLESC                         ;3e44  28 07         9525   9544 
KLLP1:  LD  A,(HL)                      ;3e46  7e            9526   9545 
    CALL    CTRLPR                      ;3e47  cd 59 3e      9527   9546 
    INC HL                              ;3e4a  23            9528   9547 
    DJNZ    KLLP1                       ;3e4b  10 f9         9529   9548 
KLESC:  CALL    CR2                     ;3e4d  cd 23 08      9530   9549 
    INC C                               ;3e50  0c            9531   9550 
    LD  A,C                             ;3e51  79            9532   9551 
    CP  10                              ;3e52  fe 0a         9533   9552 
    JR  NZ,KLSTLP                       ;3e54  20 ce         9534   9553 
    POP HL                              ;3e56  e1            9535   9554 
    INC HL                              ;3e57  23            9536   9555 
    RET                                 ;3e58  c9            9537   9556 
                                        ;                    9538   9557 ;
CTRLPR: CP  020h                        ;3e59  fe 20         9539   9558 
    JP  NC,ACCPRT                       ;3e5b  d2 64 08      9540   9559 
    PUSH    AF                          ;3e5e  f5            9541   9560 
    LD  A,05Bh                          ;3e5f  3e 5b         9542   9561 
    CALL    ACCPRT                      ;3e61  cd 64 08      9543   9562 
    POP AF                              ;3e64  f1            9544   9563 
    ADD A,040h                          ;3e65  c6 40         9545   9564 
    CALL    ACCPRT                      ;3e67  cd 64 08      9546   9565 
    LD  A,05Dh                          ;3e6a  3e 5d         9547   9566 
    JP  ACCPRT                          ;3e6c  c3 64 08      9548   9567 
                                        ;                    9549   9568 ;
KEYON:  JP  NINS                        ;3e6f  c3 fa 20      9550   9569 
                                        ;                    9551   9570 ;
KEYOFF: JP  NINS                        ;3e72  c3 fa 20      9552   9571 
                                        ;                    9553   9572 ;
KEY:    CALL    HLFTCH                  ;3e75  cd 87 29      9554   9573 
    CP  086h                            ;3e78  fe 86         9555   9574 
    JP  Z,KLIST                         ;3e7a  ca 1e 3e      9556   9575 
    CP  098h                            ;3e7d  fe 98         9557   9576 
    JR  Z,KEYON                         ;3e7f  28 ee         9558   9577 
    CP  09Ch                            ;3e81  fe 9c         9559   9578 
    JR  Z,KEYOFF                        ;3e83  28 ed         9560   9579 
    LD  C,L                             ;3e85  4d            9561   9580 
    LD  B,H                             ;3e86  44            9562   9581 
    CALL    IHLEXP                      ;3e87  cd cc 22      9563   9582 
    CP  02Ch                            ;3e8a  fe 2c         9564   9583 
    JP  NZ,SERROR                       ;3e8c  c2 3a 17      9565   9584 
    CALL    HCHECK                      ;3e8f  cd d8 22      9566   9585 
    CP  11                              ;3e92  fe 0b         9567   9586 
KIFCVX: JP  NC,IFCALL                   ;3e94  d2 36 17      9568   9587 
    OR  A                               ;3e97  b7            9569   9588 
    JR  Z,KBUFST                        ;3e98  28 25         9570   9589 
    DEC A                               ;3e9a  3d            9571   9590 
    CALL    KEYBCL                      ;3e9b  cd da 3e      9572   9591 
    PUSH    HL                          ;3e9e  e5            9573   9592 
    CALL    STREXX                      ;3e9f  cd 9d 45      9574   9593 
    POP DE                              ;3ea2  d1            9575   9594 
    LD  A,(HL)                          ;3ea3  7e            9576   9595 
    CP  16                              ;3ea4  fe 10         9577   9596 
    JR  C,KLNLMT                        ;3ea6  38 02         9578   9597 
    LD  A,15                            ;3ea8  3e 0f         9579   9598 
KLNLMT: LD  (DE),A                      ;3eaa  12            9580   9599 
    INC DE                              ;3eab  13            9581   9600 
    INC HL                              ;3eac  23            9582   9601 
    PUSH    BC                          ;3ead  c5            9583   9602 
    LD  B,A                             ;3eae  47            9584   9603 
    CALL    INDRCT                      ;3eaf  cd a3 2a      9585   9604 
    XOR A                               ;3eb2  af            9586   9605 
    OR  B                               ;3eb3  b0            9587   9606 
    JR  Z,ESCKPT                        ;3eb4  28 06         9588   9607 
KYPTLP: LD  A,(HL)                      ;3eb6  7e            9589   9608 
    LD  (DE),A                          ;3eb7  12            9590   9609 
    INC DE                              ;3eb8  13            9591   9610 
INDRCT1: INC    HL                      ;3eb9  23            9592   9611 
    DJNZ    KYPTLP                      ;3eba  10 fa         9593   9612 
ESCKPT: POP HL                          ;3ebc  e1            9594   9613 
    DEC HL                              ;3ebd  2b            9595   9614 
    RET                                 ;3ebe  c9            9596   9615 
                                        ;                    9597   9616 ;
KBUFST: CALL    STREXX                  ;3ebf  cd 9d 45      9598   9617 
    DEC DE                              ;3ec2  1b            9599   9618 
    INC A                               ;3ec3  3c            9600   9619 
    INC A                               ;3ec4  3c            9601   9620 
    LD  HL,POINT1                       ;3ec5  21 04 12      9602   9621 
    LD  (HL),0                          ;3ec8  36 00         9603   9622 
    CP  040h                            ;3eca  fe 40         9604   9623 ;KEY BUFF LIMIT
    JR  C,KBUFSL                        ;3ecc  38 02         9605   9624 
    LD  A,040h                          ;3ece  3e 40         9606   9625 
KBUFSL: PUSH    BC                      ;3ed0  c5            9607   9626 
    LD  B,A                             ;3ed1  47            9608   9627 
KBUFLP: INC HL                          ;3ed2  23            9609   9628 
    LD  (HL),A                          ;3ed3  77            9610   9629 
    LD  A,(DE)                          ;3ed4  1a            9611   9630 
    INC DE                              ;3ed5  13            9612   9631 
    DJNZ    KBUFLP                      ;3ed6  10 fa         9613   9632 
    JR  ESCKPT                          ;3ed8  18 e2         9614   9633 
                                        ;                    9615   9634 ;
KEYBCL: ADD A,A                         ;3eda  87            9616   9635 
    ADD A,A                             ;3edb  87            9617   9636 
    ADD A,A                             ;3edc  87            9618   9637 
    ADD A,A                             ;3edd  87            9619   9638 
    LD  HL,FUNBUF                       ;3ede  21 66 12      9620   9639 
    ADD A,L                             ;3ee1  85            9621   9640 
    LD  L,A                             ;3ee2  6f            9622   9641 
    LD  A,0                             ;3ee3  3e 00         9623   9642 
    ADC A,H                             ;3ee5  8c            9624   9643 
    LD  H,A                             ;3ee6  67            9625   9644 
    RET                                 ;3ee7  c9            9626   9645 
                                        ;                    9627   9646 ;
CSRLIN: LD  DE,00008h                   ;3ee8  11 08 00      9628   9647 
    ADD HL,DE                           ;3eeb  19            9629   9648 
    LD  A,(CURY)                        ;3eec  3a ee 11      9630   9649 
    LD  E,A                             ;3eef  5f            9631   9650 
    LD  D,0                             ;3ef0  16 00         9632   9651 
    CALL    FLTHEX                      ;3ef2  cd 02 29      9633   9652 
    LD  A,4                             ;3ef5  3e 04         9634   9653 
    CALL    CONDFL                      ;3ef7  cd eb 28      9635   9654 
    JP  BCFTCH                          ;3efa  c3 c4 25      9636   9655 
                                        ;                    9637   9656 ;
LNOADR: PUSH    DE                      ;3efd  d5            9638   9657 
    PUSH    HL                          ;3efe  e5            9639   9658 
    LD  HL,ADRNVC                       ;3eff  21 4f 3f      9640   9659 
    LD  (RETLNV),HL                     ;3f02  22 33 3f      9641   9660 
    JR  MIDRLN                          ;3f05  18 0b         9642   9661 
                                        ;                    9643   9662 ;
RETLNR: POP HL                          ;3f07  e1            9644   9663 
    POP DE                              ;3f08  d1            9645   9664 
    RET                                 ;3f09  c9            9646   9665 
                                        ;                    9647   9666 ;
RETLNO: PUSH    DE                      ;3f0a  d5            9648   9667 
    PUSH    HL                          ;3f0b  e5            9649   9668 
    LD  HL,RELNVC                       ;3f0c  21 35 3f      9650   9669 
    LD  (RETLNV),HL                     ;3f0f  22 33 3f      9651   9670 
MIDRLN: LD  HL,TEXTST                   ;3f12  21 4e 7c      9652   9671 
    DEC HL                              ;3f15  2b            9653   9672 
RTLLOP: INC HL                          ;3f16  23            9654   9673 
    LD  A,(HL)                          ;3f17  7e            9655   9674 
    INC HL                              ;3f18  23            9656   9675 
    OR  (HL)                            ;3f19  b6            9657   9676 
    JR  Z,RETLNR                        ;3f1a  28 eb         9658   9677 
    INC HL                              ;3f1c  23            9659   9678 
    LD  E,(HL)                          ;3f1d  5e            9660   9679 
    INC HL                              ;3f1e  23            9661   9680 
    LD  D,(HL)                          ;3f1f  56            9662   9681 
    LD  (UDLBUF),DE                     ;3f20  ed 53 82 3f   9663   9682 
RETSTL: CALL    IFSKSB                  ;3f24  cd 40 44      9664   9683 
    OR  A                               ;3f27  b7            9665   9684 
    JR  Z,RTLLOP                        ;3f28  28 ec         9666   9685 
    CP  00Bh                            ;3f2a  fe 0b         9667   9686 
    JR  Z,CVRTLN                        ;3f2c  28 04         9668   9687 
    CP  00Ch                            ;3f2e  fe 0c         9669   9688 
    JR  NZ,RETSTL                       ;3f30  20 f2         9670   9689 
                                        ;                    9671   9690 ;
CVRTLN: DEFB    0C3H                    ;3f32  c3            9672   9691 ; JP ?
RETLNV: DEFW    RELNVC                  ;3f33  35 3f         9673   9692 
RELNVC: CP  00Bh                        ;3f35  fe 0b         9674   9693 
    JR  Z,RETSTL                        ;3f37  28 eb         9675   9694 
                                        ;                    9676   9695 ;
CVLNAD: DEC HL                          ;3f39  2b            9677   9696 
    LD  E,(HL)                          ;3f3a  5e            9678   9697 
    INC HL                              ;3f3b  23            9679   9698 
    LD  D,(HL)                          ;3f3c  56            9680   9699 
    PUSH    HL                          ;3f3d  e5            9681   9700 
    EX  DE,HL                           ;3f3e  eb            9682   9701 
    INC HL                              ;3f3f  23            9683   9702 
    INC HL                              ;3f40  23            9684   9703 
    LD  E,(HL)                          ;3f41  5e            9685   9704 
    INC HL                              ;3f42  23            9686   9705 
    LD  D,(HL)                          ;3f43  56            9687   9706 
    POP HL                              ;3f44  e1            9688   9707 
    LD  (HL),D                          ;3f45  72            9689   9708 
    DEC HL                              ;3f46  2b            9690   9709 
    LD  (HL),E                          ;3f47  73            9691   9710 
    DEC HL                              ;3f48  2b            9692   9711 
    LD  (HL),00Bh                       ;3f49  36 0b         9693   9712 
    INC HL                              ;3f4b  23            9694   9713 
    INC HL                              ;3f4c  23            9695   9714 
RTLSHM: JR  RETSTL                      ;3f4d  18 d5         9696   9715 
                                        ;                    9697   9716 ;
ADRNVC: CP  00Ch                        ;3f4f  fe 0c         9698   9717 
    JR  Z,RETSTL                        ;3f51  28 d1         9699   9718 
    DEC HL                              ;3f53  2b            9700   9719 
    PUSH    HL                          ;3f54  e5            9701   9720 
    CALL    INDRCT                      ;3f55  cd a3 2a      9702   9721 
    LD  E,L                             ;3f58  5d            9703   9722 
    LD  D,H                             ;3f59  54            9704   9723 
    CALL    LNOSER                      ;3f5a  cd 8e 3f      9705   9724 
    JR  C,RENNTF                        ;3f5d  38 0b         9706   9725 
    EX  DE,HL                           ;3f5f  eb            9707   9726 
    POP HL                              ;3f60  e1            9708   9727 
    DEC HL                              ;3f61  2b            9709   9728 
    LD  (HL),00Ch                       ;3f62  36 0c         9710   9729 
    INC HL                              ;3f64  23            9711   9730 
    LD  (HL),E                          ;3f65  73            9712   9731 
    INC HL                              ;3f66  23            9713   9732 
    LD  (HL),D                          ;3f67  72            9714   9733 
RTRNAD: JR  RTLSHM                      ;3f68  18 e3         9715   9734 
                                        ;                    9716   9735 ;
RENNTF: EX  DE,HL                       ;3f6a  eb            9717   9736 
    LD  DE,UDLMES                       ;3f6b  11 1f 6a      9718   9737 
    LD  B,21                            ;3f6e  06 15         9719   9738 
    CALL    PRTSDC                      ;3f70  cd e1 07      9720   9739 
    CALL    SPPRT                       ;3f73  cd 62 08      9721   9740 
    CALL    FIVEPR                      ;3f76  cd e5 16      9722   9741 
    LD  DE,INMES                        ;3f79  11 0a 17      9723   9742 
    LD  B,4                             ;3f7c  06 04         9724   9743 
    CALL    PRTSDC                      ;3f7e  cd e1 07      9725   9744 
    DEFB    021H                        ;3f81  21            9726   9745 ; LD HL,?
UDLBUF: DEFS    2                       ;3f82                9727   9746 
    CALL    FIVEPR                      ;3f84  cd e5 16      9728   9747 
    CALL    CR2                         ;3f87  cd 23 08      9729   9748 
    POP HL                              ;3f8a  e1            9730   9749 
    INC HL                              ;3f8b  23            9731   9750 
    JR  RTRNAD                          ;3f8c  18 da         9732   9751 
                                        ;                    9733   9752 ;
LNOSER: PUSH    BC                      ;3f8e  c5            9734   9753 
    PUSH    DE                          ;3f8f  d5            9735   9754 
    EX  DE,HL                           ;3f90  eb            9736   9755 
    LD  HL,TEXTST                       ;3f91  21 4e 7c      9737   9756 
    LD  (TMPUYS),HL                     ;3f94  22 99 3f      9738   9757 
LNOSLP: PUSH    HL                      ;3f97  e5            9739   9758 
    DEFB    021H                        ;3f98  21            9740   9759 ; LD HL,?
TMPUYS: DEFS    2                       ;3f99                9741   9760 
                                        ;                    9742   9761 ;
    POP HL                              ;3f9b  e1            9743   9762 
    LD  (TMPUYS),HL                     ;3f9c  22 99 3f      9744   9763 
    LD  C,(HL)                          ;3f9f  4e            9745   9764 
    INC HL                              ;3fa0  23            9746   9765 
    LD  B,(HL)                          ;3fa1  46            9747   9766 
    LD  A,B                             ;3fa2  78            9748   9767 
    OR  C                               ;3fa3  b1            9749   9768 
    JR  Z,LMIDET1                       ;3fa4  28 1e         9750   9769 
    PUSH    BC                          ;3fa6  c5            9751   9770 
    INC HL                              ;3fa7  23            9752   9771 
    LD  C,(HL)                          ;3fa8  4e            9753   9772 
    INC HL                              ;3fa9  23            9754   9773 
    LD  B,(HL)                          ;3faa  46            9755   9774 
    LD  A,C                             ;3fab  79            9756   9775 
    CP  E                               ;3fac  bb            9757   9776 
    JR  NZ,NOMTCH                       ;3fad  20 0c         9758   9777 
    LD  A,B                             ;3faf  78            9759   9778 
    CP  D                               ;3fb0  ba            9760   9779 
    DEC HL                              ;3fb1  2b            9761   9780 
    DEC HL                              ;3fb2  2b            9762   9781 
    DEC HL                              ;3fb3  2b            9763   9782 
    JR  NZ,NOMTCH                       ;3fb4  20 05         9764   9783 
    POP BC                              ;3fb6  c1            9765   9784 
    OR  A                               ;3fb7  b7            9766   9785 
NTFRET: POP DE                          ;3fb8  d1            9767   9786 
    POP BC                              ;3fb9  c1            9768   9787 
    RET                                 ;3fba  c9            9769   9788 
                                        ;                    9770   9789 ;
NOMTCH: PUSH    DE                      ;3fbb  d5            9771   9790 
    EX  DE,HL                           ;3fbc  eb            9772   9791 
    OR  A                               ;3fbd  b7            9773   9792 
    SBC HL,BC                           ;3fbe  ed 42         9774   9793 
    POP DE                              ;3fc0  d1            9775   9794 
    POP HL                              ;3fc1  e1            9776   9795 
    JR  NC,LNOSLP                       ;3fc2  30 d3         9777   9796 
LMIDET1: SCF                            ;3fc4  37            9778   9797 
    JR  NTFRET                          ;3fc5  18 f1         9779   9798 
                                        ;                    9780   9799 ;
GTSTED: LD  DE,00000h                   ;3fc7  11 00 00      9781   9800 
    LD  BC,0FFFFh                       ;3fca  01 ff ff      9782   9801 
    CALL    HLFTCH                      ;3fcd  cd 87 29      9783   9802 
    OR  A                               ;3fd0  b7            9784   9803 
    RET Z                               ;3fd1  c8            9785   9804 
    CP  03Ah                            ;3fd2  fe 3a         9786   9805 
    RET Z                               ;3fd4  c8            9787   9806 
    CP  02Dh                            ;3fd5  fe 2d         9788   9807 
    JR  Z,GTNXNM                        ;3fd7  28 2c         9789   9808 
    CP  02Ch                            ;3fd9  fe 2c         9790   9809 
    JR  Z,GTNXNM                        ;3fdb  28 28         9791   9810 
    CP  02Eh                            ;3fdd  fe 2e         9792   9811 
    JR  NZ,FSTNUB                       ;3fdf  20 06         9793   9812 
    LD  DE,(EDLINE)                     ;3fe1  ed 5b 2a 37   9794   9813 
    JR  NX2C2D                          ;3fe5  18 09         9795   9814 
FSTNUB: CP  00Bh                        ;3fe7  fe 0b         9796   9815 
GSESER: JP  NZ,SERROR                   ;3fe9  c2 3a 17      9797   9816 
    INC HL                              ;3fec  23            9798   9817 
    LD  E,(HL)                          ;3fed  5e            9799   9818 
    INC HL                              ;3fee  23            9800   9819 
    LD  D,(HL)                          ;3fef  56            9801   9820 
NX2C2D: INC HL                          ;3ff0  23            9802   9821 
    CALL    HLFTCH                      ;3ff1  cd 87 29      9803   9822 
    CP  02Dh                            ;3ff4  fe 2d         9804   9823 
    JR  Z,GTNXNM                        ;3ff6  28 0d         9805   9824 
    CP  02Ch                            ;3ff8  fe 2c         9806   9825 
    JR  Z,GTNXNM                        ;3ffa  28 09         9807   9826 
    LD  C,E                             ;3ffc  4b            9808   9827 
    LD  B,D                             ;3ffd  42            9809   9828 
    OR  A                               ;3ffe  b7            9810   9829 
    RET Z                               ;3fff  c8            9811   9830 
    CP  03AH                            ;4000  fe 3a         9812   9831 
    RET Z                               ;4002  c8            9813   9832 
    JR  GSESER                          ;4003  18 e4         9814   9833 
                                        ;                    9815   9834 ;
GTNXNM: INC HL                          ;4005  23            9816   9835 
    CALL    HLFTCH                      ;4006  cd 87 29      9817   9836 
    OR  A                               ;4009  b7            9818   9837 
    RET Z                               ;400a  c8            9819   9838 
    CP  03Ah                            ;400b  fe 3a         9820   9839 
    RET Z                               ;400d  c8            9821   9840 
    CP  02Eh                            ;400e  fe 2e         9822   9841 
    JR  NZ,GTEDNO                       ;4010  20 06         9823   9842 
    LD  BC,(EDLINE)                     ;4012  ed 4b 2a 37   9824   9843 
    INC HL                              ;4016  23            9825   9844 
    RET                                 ;4017  c9            9826   9845 
                                        ;                    9827   9846 ;
GTEDNO: CP  00Bh                        ;4018  fe 0b         9828   9847 
    JR  NZ,GSESER                       ;401a  20 cd         9829   9848 
    INC HL                              ;401c  23            9830   9849 
    LD  C,(HL)                          ;401d  4e            9831   9850 
    INC HL                              ;401e  23            9832   9851 
    LD  B,(HL)                          ;401f  46            9833   9852 
    INC HL                              ;4020  23            9834   9853 
    RET                                 ;4021  c9            9835   9854 
                                        ;                    9836   9855 ;
EDIT:   CALL    GTSTED                  ;4022  cd c7 3f      9837   9856 
    PUSH    DE                          ;4025  d5            9838   9857 
    EX  DE,HL                           ;4026  eb            9839   9858 
    CALL    LNOSER                      ;4027  cd 8e 3f      9840   9859 
    JP  C,UDFLNO                        ;402a  da dc 43      9841   9860 
    XOR A                               ;402d  af            9842   9861 
    LD  (DISFLG),A                      ;402e  32 eb 11      9843   9862 
    EX  DE,HL                           ;4031  eb            9844   9863 
    POP HL                              ;4032  e1            9845   9864 
    CALL    FIVEPR                      ;4033  cd e5 16      9846   9865 
    CALL    SPPRT                       ;4036  cd 62 08      9847   9866 
    EX  DE,HL                           ;4039  eb            9848   9867 
    LD  DE,4                            ;403a  11 04 00      9849   9868 
    ADD HL,DE                           ;403d  19            9850   9869 
    CALL    ONELST                      ;403e  cd 28 41      9851   9870 
    LD  A,1                             ;4041  3e 01         9852   9871 
    LD  (DISFLG),A                      ;4043  32 eb 11      9853   9872 
EDBKLP: LD  A,29                        ;4046  3e 1d         9854   9873 ;CURLEFT CODE
    CALL    ACCPRT                      ;4048  cd 64 08      9855   9874 
    DJNZ    EDBKLP                      ;404b  10 f9         9856   9875 
    JP  AUTOBK                          ;404d  c3 8b 14      9857   9876 
                                        ;                    9858   9877 ;
SLIST:  PUSH    BC                      ;4050  c5            9859   9878 
    PUSH    DE                          ;4051  d5            9860   9879 
    PUSH    HL                          ;4052  e5            9861   9880 
    LD  HL,SERVEC                       ;4053  21 58 32      9862   9881 
    LD  (SAVEVC),HL                     ;4056  22 f6 40      9863   9882 
    LD  HL,SER0DH                       ;4059  21 89 32      9864   9883 
    JR  SDXSET                          ;405c  18 0c         9865   9884 
                                        ;                    9866   9885 ;
CLIST:  PUSH    BC                      ;405e  c5            9867   9886 
    PUSH    DE                          ;405f  d5            9868   9887 
    PUSH    HL                          ;4060  e5            9869   9888 
    LD  HL,COUTCH                       ;4061  21 f8 40      9870   9889 
    LD  (SAVEVC),HL                     ;4064  22 f6 40      9871   9890 
    LD  HL,COUT0D                       ;4067  21 06 41      9872   9891 
SDXSET: LD  DE,00000h                   ;406a  11 00 00      9873   9892 
    LD  BC,0FFFFh                       ;406d  01 ff ff      9874   9893 
    JR  CLISTM                          ;4070  18 1f         9875   9894 
                                        ;                    9876   9895 ;
LIST#:  CALL    HLFTCH                  ;4072  cd 87 29      9877   9896 
    CP  02Ch                            ;4075  fe 2c         9878   9897 
    JR  NZ,LIST##                       ;4077  20 01         9879   9898 
    INC HL                              ;4079  23            9880   9899 
LIST##: LD  A,2                         ;407a  3e 02         9881   9900 
    JR  LIST#E                          ;407c  18 01         9882   9901 
                                        ;                    9883   9902 ;
LIST:   XOR A                           ;407e  af            9884   9903 
LIST#E: LD  (DISFLG),A                  ;407f  32 eb 11      9885   9904 
    PUSH    BC                          ;4082  c5            9886   9905 
    PUSH    DE                          ;4083  d5            9887   9906 
    CALL    GTSTED                      ;4084  cd c7 3f      9888   9907 
    PUSH    HL                          ;4087  e5            9889   9908 
    LD  HL,CRTVEC                       ;4088  21 fd 40      9890   9909 
    LD  (SAVEVC),HL                     ;408b  22 f6 40      9891   9910 
    LD  HL,CRTCR2                       ;408e  21 0e 41      9892   9911 
CLISTM: LD  (LSCRVC),HL                 ;4091  22 04 41      9893   9912 
    LD  (LISTSN),DE                     ;4094  ed 53 ae 40   9894   9913 
    LD  (LISTEN),BC                     ;4098  ed 43 bc 40   9895   9914 
    LD  HL,TEXTST                       ;409c  21 4e 7c      9896   9915 
LISTLP: LD  E,(HL)                      ;409f  5e            9897   9916 
    INC HL                              ;40a0  23            9898   9917 
    LD  D,(HL)                          ;40a1  56            9899   9918 
    INC HL                              ;40a2  23            9900   9919 
    LD  A,D                             ;40a3  7a            9901   9920 
    OR  E                               ;40a4  b3            9902   9921 
    JR  Z,LISTE'                        ;40a5  28 1e         9903   9922 
    PUSH    DE                          ;40a7  d5            9904   9923 
    LD  E,(HL)                          ;40a8  5e            9905   9924 
    INC HL                              ;40a9  23            9906   9925 
    LD  D,(HL)                          ;40aa  56            9907   9926 
    INC HL                              ;40ab  23            9908   9927 
    PUSH    HL                          ;40ac  e5            9909   9928 
    DEFB    021H                        ;40ad  21            9910   9929 ; LD HL,?
LISTSN: DEFS    2                       ;40ae                9911   9930 
    OR  A                               ;40b0  b7            9912   9931 
    SBC HL,DE                           ;40b1  ed 52         9913   9932 
    JR  C,LISTRT                        ;40b3  38 06         9914   9933 
    JR  Z,LISTRT                        ;40b5  28 04         9915   9934 
    POP HL                              ;40b7  e1            9916   9935 
    POP HL                              ;40b8  e1            9917   9936 
LISTL': JR  LISTLP                      ;40b9  18 e4         9918   9937 
                                        ;                    9919   9938 ;
LISTRT: DEFB    021H                    ;40bb  21            9920   9939 ; LD HL,?
LISTEN: DEFS    2                       ;40bc                9921   9940 
    OR  A                               ;40be  b7            9922   9941 
    SBC HL,DE                           ;40bf  ed 52         9923   9942 
    JR  NC,LOKJMN                       ;40c1  30 04         9924   9943 
    POP HL                              ;40c3  e1            9925   9944 
    POP HL                              ;40c4  e1            9926   9945 
LISTE': JR  LISTED                      ;40c5  18 58         9927   9946 
                                        ;                    9928   9947 ;
LOKJMN: EX  DE,HL                       ;40c7  eb            9929   9948 
    LD  (EDLINE),HL                     ;40c8  22 2a 37      9930   9949 
    LD  DE,KEYBUF                       ;40cb  11 4f 7a      9931   9950 
    CALL    ASCHL                       ;40ce  cd a8 62      9932   9951 
    LD  HL,00005h                       ;40d1  21 05 00      9933   9952 
    ADD HL,DE                           ;40d4  19            9934   9953 
    LD  (HL),020h                       ;40d5  36 20         9935   9954 
    INC HL                              ;40d7  23            9936   9955 
    EX  DE,HL                           ;40d8  eb            9937   9956 
    POP HL                              ;40d9  e1            9938   9957 
    CALL    CVTXIM                      ;40da  cd 3a 65      9939   9958 
    LD  DE,KEYBUF                       ;40dd  11 4f 7a      9940   9959 
    PUSH    BC                          ;40e0  c5            9941   9960 
    LD  B,5                             ;40e1  06 05         9942   9961 
LZSKL:  LD  A,(DE)                      ;40e3  1a            9943   9962 
    CP  030h                            ;40e4  fe 30         9944   9963 
    INC DE                              ;40e6  13            9945   9964 
    JR  NZ,LTSKZR                       ;40e7  20 02         9946   9965 
    DJNZ    LZSKL                       ;40e9  10 f8         9947   9966 
LTSKZR: POP BC                          ;40eb  c1            9948   9967 
    DEC DE                              ;40ec  1b            9949   9968 
    LD  (SERDIS),DE                     ;40ed  ed 53 78 32   9950   9969 
LIST0L: LD  A,(DE)                      ;40f1  1a            9951   9970 
    OR  A                               ;40f2  b7            9952   9971 
    JR  Z,ESCLOT                        ;40f3  28 0e         9953   9972 
    DEFB    0C3H                        ;40f5  c3            9954   9973 ; JP ?
SAVEVC: DEFS    2                       ;40f6                9955   9974 
COUTCH: CALL    CTOUT                   ;40f8  cd 58 45      9956   9975 
    JR  CTIRTR                          ;40fb  18 03         9957   9976 
                                        ;                    9958   9977 ;
CRTVEC: CALL    ACCPRT                  ;40fd  cd 64 08      9959   9978 
CTIRTR: INC DE                          ;4100  13            9960   9979 
    JR  LIST0L                          ;4101  18 ee         9961   9980 
ESCLOT: DEFB    0C3H                    ;4103  c3            9962   9981 ; JP ?
LSCRVC: DEFS    2                       ;4104                9963   9982 
COUT0D: LD  A,00Dh                      ;4106  3e 0d         9964   9983 
    CALL    CTOUT                       ;4108  cd 58 45      9965   9984 
    POP HL                              ;410b  e1            9966   9985 
    JR  LSTCR'                          ;410c  18 04         9967   9986 
CRTCR2: CALL    CR2                     ;410e  cd 23 08      9968   9987 
                                        ;                    9969   9988 ;
LISCRC: POP HL                          ;4111  e1            9970   9989 
LSTCR': LD  A,080h                      ;4112  3e 80         9971   9990 ;SPACE STOP
    IN  A,(1)                           ;4114  db 01         9972   9991 
    AND 4                               ;4116  e6 04         9973   9992 
    JR  Z,LSTCR'                        ;4118  28 f8         9974   9993 
    CALL    BRKEY                       ;411a  cd 5b 0c      9975   9994 
    JR  NZ,LISTL'                       ;411d  20 9a         9976   9995 
                                        ;                    9977   9996 
LISTED: POP HL                          ;411f  e1            9978   9997 
    POP DE                              ;4120  d1            9979   9998 
    POP BC                              ;4121  c1            9980   9999 
    LD  A,1                             ;4122  3e 01         9981  10000 
    LD  (DISFLG),A                      ;4124  32 eb 11      9982  10001 
    RET                                 ;4127  c9            9983  10002 
                                        ;                    9984  10003 ;
ONELST: PUSH    HL                      ;4128  e5            9985  10004 
    LD  DE,KEYBUF                       ;4129  11 4f 7a      9986  10005 
    CALL    CVTXIM                      ;412c  cd 3a 65      9987  10006 
    LD  B,0                             ;412f  06 00         9988  10007 
ONLZLP: LD  A,(DE)                      ;4131  1a            9989  10008 
    OR  A                               ;4132  b7            9990  10009 
    JR  Z,ONLSRT                        ;4133  28 07         9991  10010 
    CALL    ACCPRT                      ;4135  cd 64 08      9992  10011 
    INC DE                              ;4138  13            9993  10012 
    INC B                               ;4139  04            9994  10013 
    JR  ONLZLP                          ;413a  18 f5         9995  10014 
ONLSRT: POP HL                          ;413c  e1            9996  10015 
    RET                                 ;413d  c9            9997  10016 
                                        ;                    9998  10017 ;
UNTIL:  POP DE                          ;413e  d1            9999  10018 
    POP BC                              ;413f  c1           10000  10019 
    PUSH    BC                          ;4140  c5           10001  10020 
    INC B                               ;4141  04           10002  10021 
UNWTRP: LD  A,24                        ;4142  3e 18        10003  10022 
    JP  NZ,ERROR                        ;4144  c2 96 21     10004  10023 
    LD  A,C                             ;4147  79           10005  10024 
    ADD A,6                             ;4148  c6 06        10006  10025 
    JR  NZ,UNWTRP                       ;414a  20 f6        10007  10026 
    PUSH    DE                          ;414c  d5           10008  10027 
    LD  C,L                             ;414d  4d           10009  10028 
    LD  B,H                             ;414e  44           10010  10029 
    CALL    FLEXPR                      ;414f  cd 99 22     10011  10030 
    LD  A,(HL)                          ;4152  7e           10012  10031 
    OR  A                               ;4153  b7           10013  10032 
    LD  L,C                             ;4154  69           10014  10033 
    LD  H,B                             ;4155  60           10015  10034 
    DEC HL                              ;4156  2b           10016  10035 
    JR  NZ,ESCUTL                       ;4157  20 17        10017  10036 
    LD  HL,4                            ;4159  21 04 00     10018  10037 
UNTILM: ADD HL,SP                       ;415c  39           10019  10038 
    LD  E,(HL)                          ;415d  5e           10020  10039 
    INC HL                              ;415e  23           10021  10040 
    LD  D,(HL)                          ;415f  56           10022  10041 
    INC HL                              ;4160  23           10023  10042 
    LD  (LNOBUF),DE                     ;4161  ed 53 cc 16  10024  10043 
    LD  E,(HL)                          ;4165  5e           10025  10044 
    INC HL                              ;4166  23           10026  10045 
    LD  D,(HL)                          ;4167  56           10027  10046 
    LD  (NXTLPT),DE                     ;4168  ed 53 12 16  10028  10047 
    INC HL                              ;416c  23           10029  10048 
    JP  INDRCT                          ;416d  c3 a3 2a     10030  10049 
                                        ;                   10031  10050 ;
ESCUTL: POP IX                          ;4170  dd e1        10032  10051 
    POP BC                              ;4172  c1           10033  10052 
    POP BC                              ;4173  c1           10034  10053 
    POP BC                              ;4174  c1           10035  10054 
    POP BC                              ;4175  c1           10036  10055 
    JP  (IX)                            ;4176  dd e9        10037  10056 
                                        ;                   10038  10057 ;
RETURN: POP IX                          ;4178  dd e1        10039  10058 
RTAGPO: POP BC                          ;417a  c1           10040  10059 
    INC BC                              ;417b  03           10041  10060 
    LD  A,B                             ;417c  78           10042  10061 
    OR  C                               ;417d  b1           10043  10062 
    JR  Z,RTWGOS                        ;417e  28 1d        10044  10063 
    INC BC                              ;4180  03           10045  10064 
    LD  A,B                             ;4181  78           10046  10065 
    OR  C                               ;4182  b1           10047  10066 
    JR  NZ,FPOPRT                       ;4183  20 1e        10048  10067 
    CALL    HLFTCH                      ;4185  cd 87 29     10049  10068 
    EX  DE,HL                           ;4188  eb           10050  10069 
    POP HL                              ;4189  e1           10051  10070 
    LD  (LNOBUF),HL                     ;418a  22 cc 16     10052  10071 
    POP HL                              ;418d  e1           10053  10072 
    LD  (NXTLPT),HL                     ;418e  22 12 16     10054  10073 
    POP HL                              ;4191  e1           10055  10074 
    PUSH    IX                          ;4192  dd e5        10056  10075 
    CP  03Ah                            ;4194  fe 3a        10057  10076 
    RET Z                               ;4196  c8           10058  10077 
    OR  A                               ;4197  b7           10059  10078 
    RET Z                               ;4198  c8           10060  10079 
    EX  DE,HL                           ;4199  eb           10061  10080 
    JP  GOTO                            ;419a  c3 b1 43     10062  10081 
                                        ;                   10063  10082 ;
RTWGOS: LD  A,3                         ;419d  3e 03        10064  10083 
    PUSH    BC                          ;419f  c5           10065  10084 
    JP  ERROR                           ;41a0  c3 96 21     10066  10085 
                                        ;                   10067  10086 ;
FPOPRT: DEC BC                          ;41a3  0b           10068  10087 
    DEC BC                              ;41a4  0b           10069  10088 
    XOR A                               ;41a5  af           10070  10089 
    CP  C                               ;41a6  b9           10071  10090 
    JR  NZ,RTWGOS                       ;41a7  20 f4        10072  10091 
    EX  DE,HL                           ;41a9  eb           10073  10092 
    LD  HL,22                           ;41aa  21 16 00     10074  10093 
    ADD HL,SP                           ;41ad  39           10075  10094 
    LD  SP,HL                           ;41ae  f9           10076  10095 
    EX  DE,HL                           ;41af  eb           10077  10096 
    JR  RTAGPO                          ;41b0  18 c8        10078  10097 
                                        ;                   10079  10098 ;
WHILE:  POP BC                          ;41b2  c1           10080  10099 
    PUSH    HL                          ;41b3  e5           10081  10100 
    EX  DE,HL                           ;41b4  eb           10082  10101 
    LD  HL,(NXTLPT)                     ;41b5  2a 12 16     10083  10102 
    LD  (WHNLPT),HL                     ;41b8  22 d1 41     10084  10103 
    PUSH    HL                          ;41bb  e5           10085  10104 
    LD  HL,(LNOBUF)                     ;41bc  2a cc 16     10086  10105 
    LD  (WHNLBF),HL                     ;41bf  22 d7 41     10087  10106 
    PUSH    HL                          ;41c2  e5           10088  10107 
    LD  HL,0FFF9h                       ;41c3  21 f9 ff     10089  10108 
    PUSH    HL                          ;41c6  e5           10090  10109 
    CALL    MEMCHK                      ;41c7  cd b0 1e     10091  10110 
    EX  DE,HL                           ;41ca  eb           10092  10111 
    DEC HL                              ;41cb  2b           10093  10112 
    CALL    SKIPWH                      ;41cc  cd 0b 42     10094  10113 
    EX  DE,HL                           ;41cf  eb           10095  10114 
    DEFB    021H                        ;41d0  21           10096  10115 ; LD HL,?
WHNLPT: DEFS    2                       ;41d1               10097  10116 
    LD  (NXTLPT),HL                     ;41d3  22 12 16     10098  10117 
    DEFB    021H                        ;41d6  21           10099  10118 ; LD HL,?
WHNLBF: DEFS    2                       ;41d7               10100  10119 
    LD  (LNOBUF),HL                     ;41d9  22 cc 16     10101  10120 
    EX  DE,HL                           ;41dc  eb           10102  10121 
    PUSH    BC                          ;41dd  c5           10103  10122 
    INC HL                              ;41de  23           10104  10123 
WEND:   POP DE                          ;41df  d1           10105  10124 
    POP BC                              ;41e0  c1           10106  10125 
    PUSH    BC                          ;41e1  c5           10107  10126 
    INC B                               ;41e2  04           10108  10127 
WENDER: LD  A,26                        ;41e3  3e 1a        10109  10128 
    JP  NZ,ERROR                        ;41e5  c2 96 21     10110  10129 
    LD  A,007h                          ;41e8  3e 07        10111  10130 
    ADD A,C                             ;41ea  81           10112  10131 
    JR  NZ,WENDER                       ;41eb  20 f6        10113  10132 
    PUSH    DE                          ;41ed  d5           10114  10133 
    PUSH    HL                          ;41ee  e5           10115  10134 
    LD  HL,10                           ;41ef  21 0a 00     10116  10135 
    ADD HL,SP                           ;41f2  39           10117  10136 
    CALL    INDRCT                      ;41f3  cd a3 2a     10118  10137 
    LD  C,L                             ;41f6  4d           10119  10138 
    LD  B,H                             ;41f7  44           10120  10139 
    CALL    FLEXPR                      ;41f8  cd 99 22     10121  10140 
    LD  A,(HL)                          ;41fb  7e           10122  10141 
    OR  A                               ;41fc  b7           10123  10142 
    POP HL                              ;41fd  e1           10124  10143 
    JP  Z,ESCUTL                        ;41fe  ca 70 41     10125  10144 
    PUSH    BC                          ;4201  c5           10126  10145 
    LD  HL,8                            ;4202  21 08 00     10127  10146 
    CALL    UNTILM                      ;4205  cd 5c 41     10128  10147 
    POP HL                              ;4208  e1           10129  10148 
    DEC HL                              ;4209  2b           10130  10149 
    RET                                 ;420a  c9           10131  10150 
                                        ;                   10132  10151 ;
SKIPWH: CALL    IFSKSB                  ;420b  cd 40 44     10133  10152 
    OR  A                               ;420e  b7           10134  10153 
    JR  Z,SKWHEL                        ;420f  28 0c        10135  10154 
    CP  09Eh                            ;4211  fe 9e        10136  10155 
    RET Z                               ;4213  c8           10137  10156 
    CP  09Dh                            ;4214  fe 9d        10138  10157 
    JR  NZ,SKIPWH                       ;4216  20 f3        10139  10158 
    CALL    SKIPWH                      ;4218  cd 0b 42     10140  10159 
    JR  SKIPWH                          ;421b  18 ee        10141  10160 
                                        ;                   10142  10161 ;
SKWHEL: INC HL                          ;421d  23           10143  10162 
    LD  E,(HL)                          ;421e  5e           10144  10163 
    INC HL                              ;421f  23           10145  10164 
    LD  D,(HL)                          ;4220  56           10146  10165 
    INC HL                              ;4221  23           10147  10166 
    LD  A,D                             ;4222  7a           10148  10167 
    OR  E                               ;4223  b3           10149  10168 
    LD  A,25                            ;4224  3e 19        10150  10169 
    JP  Z,ERROR                         ;4226  ca 96 21     10151  10170 
    LD  (WHNLPT),DE                     ;4229  ed 53 d1 41  10152  10171 
    LD  E,(HL)                          ;422d  5e           10153  10172 
    INC HL                              ;422e  23           10154  10173 
    LD  D,(HL)                          ;422f  56           10155  10174 
    LD  (WHNLBF),DE                     ;4230  ed 53 d7 41  10156  10175 
    JR  SKIPWH                          ;4234  18 d5        10157  10176 
                                        ;                   10158  10177 ;
REPTON: LD  DE,200                      ;4236  11 c8 00     10159  10178 
    JR  REPTST                          ;4239  18 03        10160  10179 
                                        ;                   10161  10180 ;
REPOFF: LD  DE,0FFFFh                   ;423b  11 ff ff     10162  10181 
REPTST: LD  (REPTSW),DE                 ;423e  ed 53 c9 0c  10163  10182 
    INC HL                              ;4242  23           10164  10183 
    RET                                 ;4243  c9           10165  10184 
                                        ;                   10166  10185 ;
REPEAT: CALL    HLFTCH                  ;4244  cd 87 29     10167  10186 
    CP  098h                            ;4247  fe 98        10168  10187 
    JR  Z,REPTON                        ;4249  28 eb        10169  10188 
    CP  09Ch                            ;424b  fe 9c        10170  10189 
    JR  Z,REPOFF                        ;424d  28 ec        10171  10190 
    POP BC                              ;424f  c1           10172  10191 
    PUSH    HL                          ;4250  e5           10173  10192 
    EX  DE,HL                           ;4251  eb           10174  10193 
    LD  HL,(NXTLPT)                     ;4252  2a 12 16     10175  10194 
    PUSH    HL                          ;4255  e5           10176  10195 
    LD  HL,(LNOBUF)                     ;4256  2a cc 16     10177  10196 
    PUSH    HL                          ;4259  e5           10178  10197 
    LD  HL,0FFFAh                       ;425a  21 fa ff     10179  10198 ; REPEAT MARK
    PUSH    HL                          ;425d  e5           10180  10199 
    EX  DE,HL                           ;425e  eb           10181  10200 
    PUSH    BC                          ;425f  c5           10182  10201 
    JP  MEMCHK                          ;4260  c3 b0 1e     10183  10202 
                                        ;                   10184  10203 ;
GOSUB:  POP BC                          ;4263  c1           10185  10204 
    CALL    HLFTCH                      ;4264  cd 87 29     10186  10205 
    CP  00Bh                            ;4267  fe 0b        10187  10206 
    JR  Z,GOSNDQ                        ;4269  28 15        10188  10207 
    CP  00Ch                            ;426b  fe 0c        10189  10208 
    JR  Z,GOSNDQ                        ;426d  28 11        10190  10209 
    PUSH    HL                          ;426f  e5           10191  10210 
    PUSH    BC                          ;4270  c5           10192  10211 
    CALL    STREXZ                      ;4271  cd 9b 45     10193  10212 
    DEC BC                              ;4274  0b           10194  10213 
    LD  L,C                             ;4275  69           10195  10214 
    LD  H,B                             ;4276  60           10196  10215 
    POP BC                              ;4277  c1           10197  10216 
    EX  (SP),HL                         ;4278  e3           10198  10217 
    INC HL                              ;4279  23           10199  10218 
    INC HL                              ;427a  23           10200  10219 
    INC HL                              ;427b  23           10201  10220 
    LD  A,022h                          ;427c  3e 22        10202  10221 
    JR  GOSMID                          ;427e  18 04        10203  10222 
GOSNDQ: INC HL                          ;4280  23           10204  10223 
    INC HL                              ;4281  23           10205  10224 
    INC HL                              ;4282  23           10206  10225 
    PUSH    HL                          ;4283  e5           10207  10226 
GOSMID: EX  DE,HL                       ;4284  eb           10208  10227 
    LD  HL,(NXTLPT)                     ;4285  2a 12 16     10209  10228 
    PUSH    HL                          ;4288  e5           10210  10229 
    LD  HL,(LNOBUF)                     ;4289  2a cc 16     10211  10230 
    PUSH    HL                          ;428c  e5           10212  10231 
    LD  HL,0FFFEh                       ;428d  21 fe ff     10213  10232 
    PUSH    HL                          ;4290  e5           10214  10233 
    EX  DE,HL                           ;4291  eb           10215  10234 
    PUSH    BC                          ;4292  c5           10216  10235 
    CALL    MEMCHK                      ;4293  cd b0 1e     10217  10236 
    DEC HL                              ;4296  2b           10218  10237 
    DEC HL                              ;4297  2b           10219  10238 
    JP  MIDLAG                          ;4298  c3 b5 43     10220  10239 
                                        ;                   10221  10240 ;
OGSJMP: PUSH    HL                      ;429b  e5           10222  10241 
    CALL    DATA                        ;429c  cd c8 1c     10223  10242 
    POP DE                              ;429f  d1           10224  10243 
    POP BC                              ;42a0  c1           10225  10244 
    PUSH    HL                          ;42a1  e5           10226  10245 
    EX  DE,HL                           ;42a2  eb           10227  10246 
    CALL    HLFTCH                      ;42a3  cd 87 29     10228  10247 
    INC HL                              ;42a6  23           10229  10248 
    INC HL                              ;42a7  23           10230  10249 
    INC HL                              ;42a8  23           10231  10250 
    JR  GOSMID                          ;42a9  18 d9        10232  10251 
                                        ;                   10233  10252 ;
LBLGOT: DEC HL                          ;42ab  2b           10234  10253 
    CALL    LBLSER                      ;42ac  cd be 42     10235  10254 
    PUSH    HL                          ;42af  e5           10236  10255 
    LD  HL,(LBLNXT)                     ;42b0  2a d3 42     10237  10256 
    LD  (NXTLPT),HL                     ;42b3  22 12 16     10238  10257 
    DEFB    021H                        ;42b6  21           10239  10258 ; LD HL,?
LBLLNO: DEFS    2                       ;42b7               10240  10259 
    LD  (LNOBUF),HL                     ;42b9  22 cc 16     10241  10260 
    POP HL                              ;42bc  e1           10242  10261 
    RET                                 ;42bd  c9           10243  10262 
                                        ;                   10244  10263 ;
LBLSER: CALL    STREXZ                  ;42be  cd 9b 45     10245  10264 
    OR  A                               ;42c1  b7           10246  10265 
    JP  Z,UDFLNO                        ;42c2  ca dc 43     10247  10266 
    LD  (LBLLEN),A                      ;42c5  32 fd 42     10248  10267 
    LD  (LBLDEB),DE                     ;42c8  ed 53 0c 43  10249  10268 
    LD  HL,TEXTST                       ;42cc  21 4e 7c     10250  10269 
    LD  (LBLNXT),HL                     ;42cf  22 d3 42     10251  10270 
LBLSLP: DEFB    021H                    ;42d2  21           10252  10271 ; LD HL,?
LBLNXT: DEFS    2                       ;42d3               10253  10272 
    LD  (CURLPT),HL                     ;42d5  22 53 43     10254  10273 
    LD  E,(HL)                          ;42d8  5e           10255  10274 
    INC HL                              ;42d9  23           10256  10275 
    LD  D,(HL)                          ;42da  56           10257  10276 
    INC HL                              ;42db  23           10258  10277 
    LD  A,D                             ;42dc  7a           10259  10278 
    OR  E                               ;42dd  b3           10260  10279 
    JP  Z,UDFLNO                        ;42de  ca dc 43     10261  10280 
    LD  (LBLNXT),DE                     ;42e1  ed 53 d3 42  10262  10281 
    LD  E,(HL)                          ;42e5  5e           10263  10282 
    INC HL                              ;42e6  23           10264  10283 
    LD  D,(HL)                          ;42e7  56           10265  10284 
    LD  (LBLLNO),DE                     ;42e8  ed 53 b7 42  10266  10285 
NOTLBL: CALL    IFSKSB                  ;42ec  cd 40 44     10267  10286 ; SKIP SMBL
    OR  A                               ;42ef  b7           10268  10287 
    JR  Z,LBLSLP                        ;42f0  28 e0        10269  10288 
    CP  0C2h                            ;42f2  fe c2        10270  10289 
    JR  NZ,NOTLBL                       ;42f4  20 f6        10271  10290 
    INC HL                              ;42f6  23           10272  10291 
    CALL    STREXZ                      ;42f7  cd 9b 45     10273  10292 
    DEC BC                              ;42fa  0b           10274  10293 
    PUSH    BC                          ;42fb  c5           10275  10294 
    DEFB    0FEH                        ;42fc  fe           10276  10295 ; CP ?
LBLLEN: DEFS    1                       ;42fd               10277  10296 
    JR  NZ,LBLNMT                       ;42fe  20 19        10278  10297 
    LD  C,A                             ;4300  4f           10279  10298 
    LD  B,000h                          ;4301  06 00        10280  10299 
    EX  DE,HL                           ;4303  eb           10281  10300 
    LD  DE,KEYBUF                       ;4304  11 4f 7a     10282  10301 
    PUSH    DE                          ;4307  d5           10283  10302 
    LDIR                                ;4308  ed b0        10284  10303 
    LD  B,A                             ;430a  47           10285  10304 
    DEFB    011H                        ;430b  11           10286  10305 ; LD DE,?
LBLDEB: DEFS    2                       ;430c               10287  10306 
    POP HL                              ;430e  e1           10288  10307 
LBLMTL: LD  A,(DE)                      ;430f  1a           10289  10308 
    CP  (HL)                            ;4310  be           10290  10309 
    JR  NZ,LBLNMT                       ;4311  20 06        10291  10310 
    INC HL                              ;4313  23           10292  10311 
    INC DE                              ;4314  13           10293  10312 
    DJNZ    LBLMTL                      ;4315  10 f8        10294  10313 
    POP HL                              ;4317  e1           10295  10314 
    RET                                 ;4318  c9           10296  10315 
                                        ;                   10297  10316 ;
LBLNMT: POP HL                          ;4319  e1           10298  10317 
    DEC HL                              ;431a  2b           10299  10318 
    JR  NOTLBL                          ;431b  18 cf        10300  10319 
                                        ;                   10301  10320 ;
ONERRG: INC HL                          ;431d  23           10302  10321 
    CALL    HLFTCH                      ;431e  cd 87 29     10303  10322 
    CP  081h                            ;4321  fe 81        10304  10323 
    JP  NZ,SERROR                       ;4323  c2 3a 17     10305  10324 
    INC HL                              ;4326  23           10306  10325 
    CALL    HLFTCH                      ;4327  cd 87 29     10307  10326 
    CP  00Bh                            ;432a  fe 0b        10308  10327 
    JR  NZ,ONERDQ                       ;432c  20 1b        10309  10328 
    INC HL                              ;432e  23           10310  10329 
    PUSH    HL                          ;432f  e5           10311  10330 
    CALL    INDRCT                      ;4330  cd a3 2a     10312  10331 
    LD  A,L                             ;4333  7d           10313  10332 
    OR  H                               ;4334  b4           10314  10333 
    JR  Z,OEROFF                        ;4335  28 2f        10315  10334 
    CALL    LNOSER                      ;4337  cd 8e 3f     10316  10335 
    JP  C,UDFLNO                        ;433a  da dc 43     10317  10336 
    LD  (ERRORV),HL                     ;433d  22 83 21     10318  10337 
    LD  A,1                             ;4340  3e 01        10319  10338 
OEROF': LD  (ERRORF),A                  ;4342  32 50 22     10320  10339 
    POP HL                              ;4345  e1           10321  10340 
    INC HL                              ;4346  23           10322  10341 
    INC HL                              ;4347  23           10323  10342 
    RET                                 ;4348  c9           10324  10343 
                                        ;                   10325  10344 ;
ONERDQ: CP  022h                        ;4349  fe 22        10326  10345 
    JP  NZ,UDFLNO                       ;434b  c2 dc 43     10327  10346 
    PUSH    HL                          ;434e  e5           10328  10347 
    CALL    LBLSER                      ;434f  cd be 42     10329  10348 
    DEFB    021H                        ;4352  21           10330  10349 ; LD HL,?
CURLPT: DEFS    2                       ;4353               10331  10350 
    LD  (ERRORV),HL                     ;4355  22 83 21     10332  10351 
    POP HL                              ;4358  e1           10333  10352 
    CALL    IFDQSK                      ;4359  cd 64 44     10334  10353 
    OR  A                               ;435c  b7           10335  10354 
    JR  Z,DQOENB                        ;435d  28 01        10336  10355 
    INC HL                              ;435f  23           10337  10356 
DQOENB: LD  A,1                         ;4360  3e 01        10338  10357 
    LD  (ERRORF),A                      ;4362  32 50 22     10339  10358 
    RET                                 ;4365  c9           10340  10359 
                                        ;                   10341  10360 ;
OEROFF: LD  A,(ERRORF)                  ;4366  3a 50 22     10342  10361 
    CP  002h                            ;4369  fe 02        10343  10362 
    LD  A,0                             ;436b  3e 00        10344  10363 
    JR  NZ,OEROF'                       ;436d  20 d3        10345  10364 
    JP  RESERR                          ;436f  c3 8d 22     10346  10365 
                                        ;                   10347  10366 ;
ON: LD  C,L                             ;4372  4d           10348  10367 
    LD  B,H                             ;4373  44           10349  10368 
    CALL    HLFTCH                      ;4374  cd 87 29     10350  10369 
    CP  0B5h                            ;4377  fe b5        10351  10370 
    JR  Z,ONERRG                        ;4379  28 a2        10352  10371 
    CALL    FLEXPR                      ;437b  cd 99 22     10353  10372 
    LD  DE,OGSJMP                       ;437e  11 9b 42     10354  10373 
    CP  082h                            ;4381  fe 82        10355  10374 
    JR  Z,OGOSUB                        ;4383  28 08        10356  10375 
    LD  DE,GOTO                         ;4385  11 b1 43     10357  10376 
    CP  081h                            ;4388  fe 81        10358  10377 
    JP  NZ,SERROR                       ;438a  c2 3a 17     10359  10378 
OGOSUB: PUSH    DE                      ;438d  d5           10360  10379 
    CALL    HLFLT                       ;438e  cd 67 61     10361  10380 
    JR  C,ODATA                         ;4391  38 18        10362  10381 
    LD  A,H                             ;4393  7c           10363  10382 
    OR  A                               ;4394  b7           10364  10383 
    JR  NZ,ODATA                        ;4395  20 14        10365  10384 
    LD  A,L                             ;4397  7d           10366  10385 
    OR  A                               ;4398  b7           10367  10386 
    JR  Z,ODATA                         ;4399  28 10        10368  10387 
    LD  L,C                             ;439b  69           10369  10388 
    LD  H,B                             ;439c  60           10370  10389 
    LD  B,A                             ;439d  47           10371  10390 
ONLNOS: DEC B                           ;439e  05           10372  10391 
    RET Z                               ;439f  c8           10373  10392 
    CALL    LNRGCK                      ;43a0  cd eb 43     10374  10393 
    CP  02Ch                            ;43a3  fe 2c        10375  10394 
    INC HL                              ;43a5  23           10376  10395 
    JR  Z,ONLNOS                        ;43a6  28 f6        10377  10396 
    DEC HL                              ;43a8  2b           10378  10397 
    POP DE                              ;43a9  d1           10379  10398 
    RET                                 ;43aa  c9           10380  10399 
                                        ;                   10381  10400 ;
ODATA:  POP DE                          ;43ab  d1           10382  10401 
    LD  L,C                             ;43ac  69           10383  10402 
    LD  H,B                             ;43ad  60           10384  10403 
    JP  DATA                            ;43ae  c3 c8 1c     10385  10404 
                                        ;                   10386  10405 ;
GOTO:   CALL    HLFTCH                  ;43b1  cd 87 29     10387  10406 
IFGOTO: INC HL                          ;43b4  23           10388  10407 
MIDLAG: CP  00Ch                        ;43b5  fe 0c        10389  10408 
    JR  NZ,SERGOT                       ;43b7  20 0a        10390  10409 
    CALL    INDRCT                      ;43b9  cd a3 2a     10391  10410 
LNSGOT: LD  (NXTLPT),HL                 ;43bc  22 12 16     10392  10411 ;"
                                        ;                   10393  10412 ;XOR A
                                        ;                   10394  10413 ;LD (CON
    POP BC                              ;43bf  c1           10395  10414 
    JP  NXLINE                          ;43c0  c3 11 16     10396  10415 
                                        ;                   10397  10416 ;
SERGOT: CP  00Bh                        ;43c3  fe 0b        10398  10417 
    JP  NZ,LBLGOT                       ;43c5  c2 ab 42     10399  10418 
    LD  E,(HL)                          ;43c8  5e           10400  10419 
    INC HL                              ;43c9  23           10401  10420 
    LD  D,(HL)                          ;43ca  56           10402  10421 
    EX  DE,HL                           ;43cb  eb           10403  10422 
    CALL    LNOSER                      ;43cc  cd 8e 3f     10404  10423 
    JR  C,UDFLNO                        ;43cf  38 0b        10405  10424 
    EX  DE,HL                           ;43d1  eb           10406  10425 
    LD  (HL),D                          ;43d2  72           10407  10426 
    DEC HL                              ;43d3  2b           10408  10427 
    LD  (HL),E                          ;43d4  73           10409  10428 
    DEC HL                              ;43d5  2b           10410  10429 
    LD  (HL),00Ch                       ;43d6  36 0c        10411  10430 
    EX  DE,HL                           ;43d8  eb           10412  10431 
    JP  LNSGOT                          ;43d9  c3 bc 43     10413  10432 
                                        ;                   10414  10433 ;
UDFLNO: LD  A,8                         ;43dc  3e 08        10415  10434 
    JP  ERROR                           ;43de  c3 96 21     10416  10435 
                                        ;                   10417  10436 ;
ONGDQT: CALL    IFDQSK                  ;43e1  cd 64 44     10418  10437 
    OR  A                               ;43e4  b7           10419  10438 
    JR  Z,HLFVEC                        ;43e5  28 14        10420  10439 
    INC HL                              ;43e7  23           10421  10440 
    JP  HLFTCH                          ;43e8  c3 87 29     10422  10441 
                                        ;                   10423  10442 ;
LNRGCK: CALL    HLFTCH                  ;43eb  cd 87 29     10424  10443 
    CP  022h                            ;43ee  fe 22        10425  10444 
    JR  Z,ONGDQT                        ;43f0  28 ef        10426  10445 
    INC HL                              ;43f2  23           10427  10446 
    INC HL                              ;43f3  23           10428  10447 
    INC HL                              ;43f4  23           10429  10448 
    CP  00Bh                            ;43f5  fe 0b        10430  10449 
    JR  Z,HLFVEC                        ;43f7  28 02        10431  10450 
    CP  00Ch                            ;43f9  fe 0c        10432  10451 
HLFVEC: JP  Z,HLFTCH                    ;43fb  ca 87 29     10433  10452 
    JP  SERROR                          ;43fe  c3 3a 17     10434  10453 
                                        ;                   10435  10454 ;
IFF:    LD  C,L                         ;4401  4d           10436  10455 
    LD  B,H                             ;4402  44           10437  10456 
    CALL    FLEXPR                      ;4403  cd 99 22     10438  10457 
    EX  AF,AF'                          ;4406  08           10439  10458 
    LD  A,(HL)                          ;4407  7e           10440  10459 
    OR  A                               ;4408  b7           10441  10460 
    LD  L,C                             ;4409  69           10442  10461 
    LD  H,B                             ;440a  60           10443  10462 
    DEC HL                              ;440b  2b           10444  10463 
    JR  Z,IFALSE                        ;440c  28 15        10445  10464 
    EX  AF,AF'                          ;440e  08           10446  10465 
    CP  0E1h                            ;440f  fe e1        10447  10466 
    RET NZ                              ;4411  c0           10448  10467 
ELSEMD: INC HL                          ;4412  23           10449  10468 
    CALL    HLFTCH                      ;4413  cd 87 29     10450  10469 
    CP  00Bh                            ;4416  fe 0b        10451  10470 
    JR  Z,IFGOTO                        ;4418  28 9a        10452  10471 
    CP  00Ch                            ;441a  fe 0c        10453  10472 
    JR  Z,IFGOTO                        ;441c  28 96        10454  10473 
    CP  022h                            ;441e  fe 22        10455  10474 
    JR  Z,IFGOTO                        ;4420  28 92        10456  10475 
    RET                                 ;4422  c9           10457  10476 
                                        ;                   10458  10477 ;
IFALSE: DEC HL                          ;4423  2b           10459  10478 
    CALL    IFSKIP                      ;4424  cd 2d 44     10460  10479 
    JR  NC,ELSEMD                       ;4427  30 e9        10461  10480 
    POP HL                              ;4429  e1           10462  10481 
    JP  NXLINE                          ;442a  c3 11 16     10463  10482 
                                        ;                   10464  10483 ;
IFSKIP: CALL    IFSKSB                  ;442d  cd 40 44     10465  10484 
    OR  A                               ;4430  b7           10466  10485 
    SCF                                 ;4431  37           10467  10486 
    RET Z                               ;4432  c8           10468  10487 
    CP  0B8h                            ;4433  fe b8        10469  10488 
    RET Z                               ;4435  c8           10470  10489 
    CP  08Eh                            ;4436  fe 8e        10471  10490 
    JR  NZ,IFSKIP                       ;4438  20 f3        10472  10491 
IFSKMD: CALL    IFSKIP                  ;443a  cd 2d 44     10473  10492 
    RET C                               ;443d  d8           10474  10493 
    JR  IFSKIP                          ;443e  18 ed        10475  10494 
                                        ;                   10476  10495 ;
IFSKSB: INC HL                          ;4440  23           10477  10496 
    LD  A,(HL)                          ;4441  7e           10478  10497 
    OR  A                               ;4442  b7           10479  10498 
    RET Z                               ;4443  c8           10480  10499 
    CP  0FFh                            ;4444  fe ff        10481  10500 
    JR  Z,FUNCRQ                        ;4446  28 0f        10482  10501 
    CP  022h                            ;4448  fe 22        10483  10502 
    JR  Z,IFDQSK                        ;444a  28 18        10484  10503 
    CP  020h                            ;444c  fe 20        10485  10504 
    RET NC                              ;444e  d0           10486  10505 
    CP  00Bh                            ;444f  fe 0b        10487  10506 
    RET C                               ;4451  d8           10488  10507 
    CP  014h                            ;4452  fe 14        10489  10508 
    JR  NC,ISKFLT                       ;4454  30 03        10490  10509 
    INC HL                              ;4456  23           10491  10510 
FUNCRQ: INC HL                          ;4457  23           10492  10511 
    RET                                 ;4458  c9           10493  10512 
                                        ;                   10494  10513 ;
ISKFLT: AND 00Fh                        ;4459  e6 0f        10495  10514 
    ADD A,L                             ;445b  85           10496  10515 
    LD  L,A                             ;445c  6f           10497  10516 
    LD  A,0                             ;445d  3e 00        10498  10517 
    ADC A,H                             ;445f  8c           10499  10518 
    LD  H,A                             ;4460  67           10500  10519 
    LD  A,020h                          ;4461  3e 20        10501  10520 
    RET                                 ;4463  c9           10502  10521 
                                        ;                   10503  10522 ;
IFDQSK: INC HL                          ;4464  23           10504  10523 
    LD  A,(HL)                          ;4465  7e           10505  10524 
    OR  A                               ;4466  b7           10506  10525 
    RET Z                               ;4467  c8           10507  10526 
    CP  022h                            ;4468  fe 22        10508  10527 
    RET Z                               ;446a  c8           10509  10528 
    JR  IFDQSK                          ;446b  18 f7        10510  10529 
                                        ;                   10511  10530 ;
VPUSH:  LD  C,L                         ;446d  4d           10512  10531 
    LD  B,H                             ;446e  44           10513  10532 
    CALL    ILDRCH                      ;446f  cd 90 3b     10514  10533 
    POP HL                              ;4472  e1           10515  10534 
    LD  (PUSHJV),HL                     ;4473  22 b2 44     10516  10535 
PUSHAG: LD  HL,(INTFAC)                 ;4476  2a 4b 7a     10517  10536 
    LD  IY,(INTSSP)                     ;4479  fd 2a 43 7a  10518  10537 
    LD  (IY+0),0                        ;447d  fd 36 00 00  10519  10538 
    CALL    EXPRSN                      ;4481  cd f2 22     10520  10539 
    EX  AF,AF'                          ;4484  08           10521  10540 
    LD  A,(IY+0)                        ;4485  fd 7e 00     10522  10541 
    CP  003h                            ;4488  fe 03        10523  10542 
    JP  Z,TYPEMS                        ;448a  ca 32 17     10524  10543 
    EX  DE,HL                           ;448d  eb           10525  10544 
    LD  HL,0FFF8h                       ;448e  21 f8 ff     10526  10545 
    ADD HL,SP                           ;4491  39           10527  10546 
    LD  SP,HL                           ;4492  f9           10528  10547 
    PUSH    BC                          ;4493  c5           10529  10548 
    CALL    CLRFAC                      ;4494  cd a9 28     10530  10549 
    LD  B,A                             ;4497  47           10531  10550 
    LD  C,A                             ;4498  4f           10532  10551 
PUTSTRL:LD  A,(DE)                      ;4499  1a           10533  10552 
    LD  (HL),A                          ;449a  77           10534  10553 
    INC HL                              ;449b  23           10535  10554 
    INC DE                              ;449c  13           10536  10555 
    DJNZ    PUTSTRL                     ;449d  10 fa        10537  10556 
    LD  D,C                             ;449f  51           10538  10557 
    POP BC                              ;44a0  c1           10539  10558 
    LD  E,0FDh                          ;44a1  1e fd        10540  10559 
    PUSH    DE                          ;44a3  d5           10541  10560 
    EX  AF,AF'                          ;44a4  08           10542  10561 
    PUSH    AF                          ;44a5  f5           10543  10562 
    CALL    MEMCHK                      ;44a6  cd b0 1e     10544  10563 
    POP AF                              ;44a9  f1           10545  10564 
PUSHL1: CP  02Ch                        ;44aa  fe 2c        10546  10565 
    JR  Z,PUSHAG                        ;44ac  28 c8        10547  10566 
    LD  L,C                             ;44ae  69           10548  10567 
    LD  H,B                             ;44af  60           10549  10568 
RETVCP: DEC HL                          ;44b0  2b           10550  10569 
    DEFB    0C3H                        ;44b1  c3           10551  10570 ; JP ?
PUSHJV: DEFS    2                       ;44b2               10552  10571 
                                        ;                   10553  10572 ;
VPOP:   LD  C,L                         ;44b4  4d           10554  10573 
    LD  B,H                             ;44b5  44           10555  10574 
    CALL    ILDRCH                      ;44b6  cd 90 3b     10556  10575 
    POP HL                              ;44b9  e1           10557  10576 
    LD  (PUSHJV),HL                     ;44ba  22 b2 44     10558  10577 
POPLOP: CALL    GETVAC                  ;44bd  cd d3 1e     10559  10578 
    POP DE                              ;44c0  d1           10560  10579 
    CP  002h                            ;44c1  fe 02        10561  10580 
    JR  Z,INTPOP                        ;44c3  28 32        10562  10581 
    CP  003h                            ;44c5  fe 03        10563  10582 
    JP  Z,TYPEMS                        ;44c7  ca 32 17     10564  10583 
    CP  D                               ;44ca  ba           10565  10584 
    JR  NZ,STKEMP                       ;44cb  20 25        10566  10585 
    LD  A,E                             ;44cd  7b           10567  10586 
    CP  0FDh                            ;44ce  fe fd        10568  10587 
    JR  NZ,STKEMP                       ;44d0  20 20        10569  10588 
    LD  A,D                             ;44d2  7a           10570  10589 
    EX  DE,HL                           ;44d3  eb           10571  10590 
    LD  HL,00000h                       ;44d4  21 00 00     10572  10591 
    ADD HL,SP                           ;44d7  39           10573  10592 
    PUSH    BC                          ;44d8  c5           10574  10593 
    LD  B,A                             ;44d9  47           10575  10594 
POPTRL: LD  A,(HL)                      ;44da  7e           10576  10595 
    LD  (DE),A                          ;44db  12           10577  10596 
    INC HL                              ;44dc  23           10578  10597 
    INC DE                              ;44dd  13           10579  10598 
    DJNZ    POPTRL                      ;44de  10 fa        10580  10599 
    POP BC                              ;44e0  c1           10581  10600 
INTPOR: LD  HL,8                        ;44e1  21 08 00     10582  10601 
    ADD HL,SP                           ;44e4  39           10583  10602 
    LD  SP,HL                           ;44e5  f9           10584  10603 
HEXCUL1: CALL   BCFTCH                  ;44e6  cd c4 25     10585  10604 
    CP  02Ch                            ;44e9  fe 2c        10586  10605 
    JR  Z,POPLOP                        ;44eb  28 d0        10587  10606 
    LD  L,C                             ;44ed  69           10588  10607 
    LD  H,B                             ;44ee  60           10589  10608 
    JP  RETVCP                          ;44ef  c3 b0 44     10590  10609 
                                        ;                   10591  10610 ;
STKEMP: LD  A,30                        ;44f2  3e 1e        10592  10611 
    JP  ERROR                           ;44f4  c3 96 21     10593  10612 
                                        ;                   10594  10613 ;
INTPOP: LD  A,D                         ;44f7  7a           10595  10614 
    CP  003h                            ;44f8  fe 03        10596  10615 
    JR  Z,STKEMP                        ;44fa  28 f6        10597  10616 
    LD  A,E                             ;44fc  7b           10598  10617 
    CP  0FDh                            ;44fd  fe fd        10599  10618 
    JR  NZ,STKEMP                       ;44ff  20 f1        10600  10619 
    LD  A,D                             ;4501  7a           10601  10620 
    EX  DE,HL                           ;4502  eb           10602  10621 
    LD  HL,00000h                       ;4503  21 00 00     10603  10622 
    ADD HL,SP                           ;4506  39           10604  10623 
    CALL    HLFLTO                      ;4507  cd 97 2d     10605  10624 
    EX  DE,HL                           ;450a  eb           10606  10625 
    LD  (HL),E                          ;450b  73           10607  10626 
    INC HL                              ;450c  23           10608  10627 
    LD  (HL),D                          ;450d  72           10609  10628 
    DEC HL                              ;450e  2b           10610  10629 
    JR  INTPOR                          ;450f  18 d0        10611  10630 
                                        ;                   10612  10631 ;
BUFCLR: PUSH    HL                      ;4511  e5           10613  10632 
    LD  HL,0                            ;4512  21 00 00     10614  10633 
    LD  (LNG),HL                        ;4515  22 27 45     10615  10634 
    LD  HL,CTBUF                        ;4518  21 b1 45     10616  10635 
    LD  (ADRES),HL                      ;451b  22 24 45     10617  10636 
    XOR A                               ;451e  af           10618  10637 
    JR  CTRET'                          ;451f  18 31        10619  10638 
                                        ;                   10620  10639 ;
CTINP:  PUSH    HL                      ;4521  e5           10621  10640 
    PUSH    BC                          ;4522  c5           10622  10641 
    DEFB    021H                        ;4523  21           10623  10642 ; LD HL,?
ADRES:  DEFW    CTBUF                   ;4524  b1 45        10624  10643 
    DEFB    001H                        ;4526  01           10625  10644 ; LD BC,?
LNG:    DEFS    2                       ;4527               10626  10645 
    LD  A,B                             ;4529  78           10627  10646 
    OR  C                               ;452a  b1           10628  10647 
    JR  NZ,CTINP1                       ;452b  20 1a        10629  10648 
    LD  HL,CTBUF                        ;452d  21 b1 45     10630  10649 
    LD  (ADRES),HL                      ;4530  22 24 45     10631  10650 
    LD  (MTADRS),HL                     ;4533  22 aa 13     10632  10651 
    LD  BC,00100H                       ;4536  01 00 01     10633  10652 
    LD  (LNG),BC                        ;4539  ed 43 27 45  10634  10653 
    LD  (MTBYTE),BC                     ;453d  ed 43 a8 13  10635  10654 
    CALL    MLOAD                       ;4541  cd 30 01     10636  10655 
    JP  C,CTERR                         ;4544  da 54 45     10637  10656 
CTINP1: LD  A,(HL)                      ;4547  7e           10638  10657 
    INC HL                              ;4548  23           10639  10658 
    DEC BC                              ;4549  0b           10640  10659 
    LD  (ADRES),HL                      ;454a  22 24 45     10641  10660 
    LD  (LNG),BC                        ;454d  ed 43 27 45  10642  10661 
CTRETN: POP BC                          ;4551  c1           10643  10662 
CTRET': POP HL                          ;4552  e1           10644  10663 
    RET                                 ;4553  c9           10645  10664 
                                        ;                   10646  10665 ;
CTERR:  POP HL                          ;4554  e1           10647  10666 
    POP BC                              ;4555  c1           10648  10667 
    SCF                                 ;4556  37           10649  10668 
    RET                                 ;4557  c9           10650  10669 
                                        ;                   10651  10670 ;
CTOUT:  PUSH    BC                      ;4558  c5           10652  10671 
    PUSH    HL                          ;4559  e5           10653  10672 
    LD  HL,(ADRES)                      ;455a  2a 24 45     10654  10673 
    LD  BC,(LNG)                        ;455d  ed 4b 27 45  10655  10674 
    LD  (HL),A                          ;4561  77           10656  10675 
    INC HL                              ;4562  23           10657  10676 
    INC BC                              ;4563  03           10658  10677 
    LD  (ADRES),HL                      ;4564  22 24 45     10659  10678 
    LD  A,B                             ;4567  78           10660  10679 
    CP  1                               ;4568  fe 01        10661  10680 
    JR  NZ,CTOUT1                       ;456a  20 10        10662  10681 
    LD  HL,CTBUF                        ;456c  21 b1 45     10663  10682 
    LD  (MTADRS),HL                     ;456f  22 aa 13     10664  10683 
    LD  (MTBYTE),BC                     ;4572  ed 43 a8 13  10665  10684 
    CALL    MSAVE                       ;4576  cd b6 00     10666  10685 
    LD  BC,0                            ;4579  01 00 00     10667  10686 
CTOUT1: LD  (LNG),BC                    ;457c  ed 43 27 45  10668  10687 
    LD  (ADRES),HL                      ;4580  22 24 45     10669  10688 
    OR  A                               ;4583  b7           10670  10689 
    JR  CTRETN                          ;4584  18 cb        10671  10690 
                                        ;                   10672  10691 ;
CTCLOS: PUSH    BC                      ;4586  c5           10673  10692 
    PUSH    HL                          ;4587  e5           10674  10693 
    LD  HL,CTBUF                        ;4588  21 b1 45     10675  10694 
    LD  (MTADRS),HL                     ;458b  22 aa 13     10676  10695 
    LD  HL,00100H                       ;458e  21 00 01     10677  10696 
    LD  (MTBYTE),HL                     ;4591  22 a8 13     10678  10697 
    CALL    MSAVE                       ;4594  cd b6 00     10679  10698 
    JR  C,CTERR                         ;4597  38 bb        10680  10699 
    JR  CTRETN                          ;4599  18 b6        10681  10700 
                                        ;                   10682  10701 ;
STREXZ: LD  C,L                         ;459b  4d           10683  10702 
    LD  B,H                             ;459c  44           10684  10703 
STREXX: LD  HL,(INTFAC)                 ;459d  2a 4b 7a     10685  10704 
    LD  IY,(INTSSP)                     ;45a0  fd 2a 43 7a  10686  10705 
    LD  (IY+0),0                        ;45a4  fd 36 00 00  10687  10706 
    CALL    STEXPR                      ;45a8  cd b2 22     10688  10707 
    CALL    CONDMZ                      ;45ab  cd f6 6b     10689  10708 
    JP  CVDSAD                          ;45ae  c3 0e 17     10690  10709 
                                        ;                   10691  10710 ;
CTBUF:  DEFW    $FLOAT                  ;45b1  c0 6b        10692  10711 
    DEFW    $EDIT                       ;45b3  1b 63        10693  10712 
    DEFW    ADDDEG                      ;45b5  4a 5b        10694  10713 ; $CONV hard coding
    DEFW    00000h                      ;45b7  00 00        10695  10714 ; $IOCS hard coding
    DEFW    $ERTXT                      ;45b9  b2 69        10696  10715 
    DEFW    VSTART                      ;45bb  3b 7a        10697  10716 ; $WORK hard coding 
    DEFW    LDIR1                       ;45bd  a3 73        10698  10717 ; $FUNC hard coding
    DEFS    242                         ;45bf               10699  10718 
USINGB: DEFS    26                      ;46b1               10700  10719 
                                        ;                   10701  10720 ;
                                        ;                   10702  10721 ;	CHAIN	,GRAPH
                                        ;                   10703  10722 ;
                                        ;                   10704  10723 ; GRAPH
                                        ;                   10705  10724 ;
                                        ;                   10706  10725 ;
DEFCHR: INC HL                          ;46cb  23           10707  10726 
    LD  A,(GMODEF)                      ;46cc  3a 06 1c     10708  10727 
    CP  2                               ;46cf  fe 02        10709  10728 
    JP  NC,IFCALL                       ;46d1  d2 36 17     10710  10729 
    CALL    HLFTCH                      ;46d4  cd 87 29     10711  10730 
    CP  028h                            ;46d7  fe 28        10712  10731 
    JP  NZ,SERROR                       ;46d9  c2 3a 17     10713  10732 
    INC HL                              ;46dc  23           10714  10733 
    LD  C,L                             ;46dd  4d           10715  10734 
    LD  B,H                             ;46de  44           10716  10735 
    CALL    IHLEXP                      ;46df  cd cc 22     10717  10736 
    CALL    CH29H                       ;46e2  cd 66 2d     10718  10737 
    CALL    HCHECK                      ;46e5  cd d8 22     10719  10738 
    CP  080h                            ;46e8  fe 80        10720  10739 
    JP  C,IFCALL                        ;46ea  da 36 17     10721  10740 
    CP  0E0h                            ;46ed  fe e0        10722  10741 
    JP  NC,IFCALL                       ;46ef  d2 36 17     10723  10742 
    AND 07Fh                            ;46f2  e6 7f        10724  10743 
    PUSH    AF                          ;46f4  f5           10725  10744 
    CALL    BCFTCH                      ;46f5  cd c4 25     10726  10745 
    CP  0F5h                            ;46f8  fe f5        10727  10746 
    JP  NZ,SERROR                       ;46fa  c2 3a 17     10728  10747 
    CALL    STREXX                      ;46fd  cd 9d 45     10729  10748 
    CP  12                              ;4700  fe 0c        10730  10749 
    JP  NZ,IFCALL                       ;4702  c2 36 17     10731  10750 
    LD  H,A                             ;4705  67           10732  10751 
    POP AF                              ;4706  f1           10733  10752 
    PUSH    BC                          ;4707  c5           10734  10753 
    PUSH    HL                          ;4708  e5           10735  10754 
    LD  L,A                             ;4709  6f           10736  10755 
    LD  H,0                             ;470a  26 00        10737  10756 
    ADD HL,HL                           ;470c  29           10738  10757 
    ADD HL,HL                           ;470d  29           10739  10758 
    ADD HL,HL                           ;470e  29           10740  10759 
    ADD HL,HL                           ;470f  29           10741  10760 
    LD  BC,01000h                       ;4710  01 00 10     10742  10761 
    ADD HL,BC                           ;4713  09           10743  10762 
    LD  C,L                             ;4714  4d           10744  10763 
    LD  B,H                             ;4715  44           10745  10764 
    POP HL                              ;4716  e1           10746  10765 
DEFCHL: LD  A,(DE)                      ;4717  1a           10747  10766 
    OUT (C),A                           ;4718  ed 79        10748  10767 
    INC DE                              ;471a  13           10749  10768 
    INC BC                              ;471b  03           10750  10769 
    DEC H                               ;471c  25           10751  10770 
    JR  NZ,DEFCHL                       ;471d  20 f8        10752  10771 
    POP HL                              ;471f  e1           10753  10772 
    DEC HL                              ;4720  2b           10754  10773 
    RET                                 ;4721  c9           10755  10774 
                                        ;                   10756  10775 ;
                                        ;                   10757  10776 ;
SOUND:  LD  B,H                         ;4722  44           10758  10777 
    LD  C,L                             ;4723  4d           10759  10778 
    CALL    IHLEXP                      ;4724  cd cc 22     10760  10779 
    CALL    CH2CH                       ;4727  cd 61 2d     10761  10780 
    CALL    HCHECK                      ;472a  cd d8 22     10762  10781 
    CP  14                              ;472d  fe 0e        10763  10782 
    JP  NC,IFCALL                       ;472f  d2 36 17     10764  10783 
    PUSH    AF                          ;4732  f5           10765  10784 
    CALL    IHLEXP                      ;4733  cd cc 22     10766  10785 
    CALL    HCHECK                      ;4736  cd d8 22     10767  10786 
    POP HL                              ;4739  e1           10768  10787 
    LD  L,A                             ;473a  6f           10769  10788 
    PUSH    BC                          ;473b  c5           10770  10789 
    LD  BC,04000h                       ;473c  01 00 40     10771  10790 
    OUT (C),H                           ;473f  ed 61        10772  10791 
    INC C                               ;4741  0c           10773  10792 
    OUT (C),L                           ;4742  ed 69        10774  10793 
    POP BC                              ;4744  c1           10775  10794 
    JP  RETIRQ                          ;4745  c3 39 1b     10776  10795 
                                        ;                   10777  10796 ;
BEEPOP: LD  B,H                         ;4748  44           10778  10797 
    LD  C,L                             ;4749  4d           10779  10798 
    CALL    EDCEK                       ;474a  cd 6f 49     10780  10799 
    JR  Z,BEEP                          ;474d  28 29        10781  10800 
    CALL    IBYTE                       ;474f  cd df 22     10782  10801 
    CP  128                             ;4752  fe 80        10783  10802 
    JP  NC,IFCALL                       ;4754  d2 36 17     10784  10803 
    LD  D,A                             ;4757  57           10785  10804 
    LD  E,0                             ;4758  1e 00        10786  10805 
    DEC BC                              ;475a  0b           10787  10806 
    CALL    EDCEK                       ;475b  cd 6f 49     10788  10807 
    JR  Z,BEEPA                         ;475e  28 12        10789  10808 
    CP  02Ch                            ;4760  fe 2c        10790  10809 
    JP  NZ,SERROR                       ;4762  c2 3a 17     10791  10810 
    INC BC                              ;4765  03           10792  10811 
    PUSH    DE                          ;4766  d5           10793  10812 
    CALL    IBYTE                       ;4767  cd df 22     10794  10813 
    POP DE                              ;476a  d1           10795  10814 
    CP  3                               ;476b  fe 03        10796  10815 
    JP  NC,IFCALL                       ;476d  d2 36 17     10797  10816 
    DEC BC                              ;4770  0b           10798  10817 
    LD  E,A                             ;4771  5f           10799  10818 
BEEPA:  PUSH    BC                      ;4772  c5           10800  10819 
    CALL    SOUNDS                      ;4773  cd 99 10     10801  10820 ;D,E
    POP HL                              ;4776  e1           10802  10821 
    RET                                 ;4777  c9           10803  10822 
                                        ;                   10804  10823 ;
BEEP:   PUSH    BC                      ;4778  c5           10805  10824 
    CALL    BELL                        ;4779  cd ca 06     10806  10825 
    LD  BC,04000h                       ;477c  01 00 40     10807  10826 
    LD  A,7                             ;477f  3e 07        10808  10827 
    OUT (C),A                           ;4781  ed 79        10809  10828 
    INC C                               ;4783  0c           10810  10829 
    IN  A,(C)                           ;4784  ed 78        10811  10830 
    OR  03Fh                            ;4786  f6 3f        10812  10831 
    OUT (C),A                           ;4788  ed 79        10813  10832 
    POP HL                              ;478a  e1           10814  10833 
    RET                                 ;478b  c9           10815  10834 
                                        ;                   10816  10835 ;
PLAY:   LD  C,L                         ;478c  4d           10817  10836 
    LD  B,H                             ;478d  44           10818  10837 
    CALL    SETSSP                      ;478e  cd f9 21     10819  10838 
    LD  (IY+0),0                        ;4791  fd 36 00 00  10820  10839 
    CALL    EXPRSN                      ;4795  cd f2 22     10821  10840 
    LD  A,(IY+0)                        ;4798  fd 7e 00     10822  10841 
    CP  003h                            ;479b  fe 03        10823  10842 
    JR  NZ,TEMPO                        ;479d  20 20        10824  10843 
    CALL    CONDMZ                      ;479f  cd f6 6b     10825  10844 
    CALL    CVDSAD                      ;47a2  cd 0e 17     10826  10845 
    PUSH    BC                          ;47a5  c5           10827  10846 
    LD  B,A                             ;47a6  47           10828  10847 
    OR  A                               ;47a7  b7           10829  10848 
    JR  Z,ESCPLY                        ;47a8  28 12        10830  10849 
    LD  HL,KEYBUF                       ;47aa  21 4f 7a     10831  10850 
    PUSH    HL                          ;47ad  e5           10832  10851 
    LD  C,B                             ;47ae  48           10833  10852 
KBSTMS: LD  A,(DE)                      ;47af  1a           10834  10853 
    LD  (HL),A                          ;47b0  77           10835  10854 
    INC DE                              ;47b1  13           10836  10855 
    INC HL                              ;47b2  23           10837  10856 
    DJNZ    KBSTMS                      ;47b3  10 fa        10838  10857 
    LD  (HL),03Ah                       ;47b5  36 3a        10839  10858 
    LD  B,C                             ;47b7  41           10840  10859 
    POP DE                              ;47b8  d1           10841  10860 
    CALL    MUSIC                       ;47b9  cd cd 0e     10842  10861 
ESCPLY: POP HL                          ;47bc  e1           10843  10862 
    DEC HL                              ;47bd  2b           10844  10863 
    RET                                 ;47be  c9           10845  10864 
                                        ;                   10846  10865 ;
TEMPO:  EX  DE,HL                       ;47bf  eb           10847  10866 
    LD  HL,KEYBUF                       ;47c0  21 4f 7a     10848  10867 
    PUSH    HL                          ;47c3  e5           10849  10868 
    LD  (IY+0),4                        ;47c4  fd 36 00 04  10850  10869 
    LD  (HL),08Dh                       ;47c8  36 8d        10851  10870 
    INC HL                              ;47ca  23           10852  10871 
    LD  (HL),06Ah                       ;47cb  36 6a        10853  10872 
    INC HL                              ;47cd  23           10854  10873 
    LD  (HL),060h                       ;47ce  36 60        10855  10874 
    INC HL                              ;47d0  23           10856  10875 
    LD  (HL),0                          ;47d1  36 00        10857  10876 
    POP HL                              ;47d3  e1           10858  10877 
    PUSH    BC                          ;47d4  c5           10859  10878 
    CALL    DIV                         ;47d5  cd bd 70     10860  10879 
    CALL    HLFLTO                      ;47d8  cd 97 2d     10861  10880 
    CALL    HCHECK                      ;47db  cd d8 22     10862  10881 
    OR  A                               ;47de  b7           10863  10882 
    JP  Z,IFCALL                        ;47df  ca 36 17     10864  10883 
    CALL    XTEMPO                      ;47e2  cd 95 10     10865  10884 
    POP BC                              ;47e5  c1           10866  10885 
    JP  RETIRQ                          ;47e6  c3 39 1b     10867  10886 
                                        ;                   10868  10887 ;
                                        ;                   10869  10888 ;
COLOR:  LD  C,L                         ;47e9  4d           10870  10889 
    LD  B,H                             ;47ea  44           10871  10890 
    CALL    IBYTE                       ;47eb  cd df 22     10872  10891 
    CP  9                               ;47ee  fe 09        10873  10892 
    JP  NC,IFCALL                       ;47f0  d2 36 17     10874  10893 
    LD  (COLORF),A                      ;47f3  32 80 11     10875  10894 
    DEC BC                              ;47f6  0b           10876  10895 
    LD  L,C                             ;47f7  69           10877  10896 
    LD  H,B                             ;47f8  60           10878  10897 
    RET                                 ;47f9  c9           10879  10898 
                                        ;                   10880  10899 ;
                                        ;                   10881  10900 ;
PRESET: CALL    PSETXY                  ;47fa  cd 24 49     10882  10901 
    XOR A                               ;47fd  af           10883  10902 
    LD  (GCOLOR),A                      ;47fe  32 81 11     10884  10903 
    JR  L33F0                           ;4801  18 03        10885  10904 
PSET:                                   ;                   10886  10905 
    CALL    PSETXY                      ;4803  cd 24 49     10887  10906 ;(X,Y,C)
L33F0:  PUSH    BC                      ;4806  c5           10888  10907 
    CALL    PSETSB                      ;4807  cd 0c 48     10889  10908 
    POP HL                              ;480a  e1           10890  10909 
    RET                                 ;480b  c9           10891  10910 
                                        ;                   10892  10911 ;
                                        ;                   10893  10912 ;
                                        ;                   10894  10913 ;
                                        ;                   10895  10914 ;  PSET(RESET(DE,HL)
PSETSB: CALL    CULADR                  ;480c  cd 23 48     10896  10915 
    RET C                               ;480f  d8           10897  10916 
    PUSH    HL                          ;4810  e5           10898  10917 
    LD  HL,CULTBL                       ;4811  21 1b 48     10899  10918 
    ADD HL,DE                           ;4814  19           10900  10919 
    LD  E,(HL)                          ;4815  5e           10901  10920 
    INC HL                              ;4816  23           10902  10921 
    LD  D,(HL)                          ;4817  56           10903  10922 
    EX  DE,HL                           ;4818  eb           10904  10923 
    EX  (SP),HL                         ;4819  e3           10905  10924 
    RET                                 ;481a  c9           10906  10925 
                                        ;                   10907  10926 ;
CULTBL: DEFW    CULAD0                  ;481b  4e 48        10908  10927 ;TEXT0
    DEFW    CULAD1                      ;481d  93 48        10909  10928 ;TEXT1
    DEFW    CULAD3                      ;481f  da 48        10910  10929 ;GRAPHIC2,3
    DEFW    CULAD5                      ;4821  05 49        10911  10930 ;GRAPHIC4,5
                                        ;                   10912  10931 ;
                                        ;                   10913  10932 ;
CULADR: PUSH    HL                      ;4823  e5           10914  10933 
SCRNYE: LD  BC, 04764h                  ;4824  01 64 47     10915  10934 ;LIMIT Y
    ADD HL,BC                           ;4827  09           10916  10935 
    JR  C,CULERR                        ;4828  38 07        10917  10936 
    EX  DE,HL                           ;482a  eb           10918  10937 
    PUSH    HL                          ;482b  e5           10919  10938 
SCRNXE: LD  BC, 0472Ch                  ;482c  01 2c 47     10920  10939 ;LIMIT X
    ADD HL,BC                           ;482f  09           10921  10940 
    POP DE                              ;4830  d1           10922  10941 
CULERR: POP HL                          ;4831  e1           10923  10942 
    RET C                               ;4832  d8           10924  10943 
CALADR: JP  CALAD0                      ;4833  c3 36 48     10925  10944 
                                        ;                   10926  10945 ;
CALAD0: LD  BC,(CHRSTA)                 ;4836  ed 4b d6 0a  10927  10946 
    LD  A,L                             ;483a  7d           10928  10947 
    RES 0,L                             ;483b  cb 85        10929  10948 
    ADD HL,HL                           ;483d  29           10930  10949 
    ADD HL,HL                           ;483e  29           10931  10950 
    ADD HL,HL                           ;483f  29           10932  10951 
    ADD HL,HL                           ;4840  29           10933  10952 
    AND 1                               ;4841  e6 01        10934  10953 
    SRL E                               ;4843  cb 3b        10935  10954 
    CCF                                 ;4845  3f           10936  10955 
    RLA                                 ;4846  17           10937  10956 
    ADD HL,DE                           ;4847  19           10938  10957 
    ADD HL,BC                           ;4848  09           10939  10958 
    LD  DE,00000h                       ;4849  11 00 00     10940  10959 
    OR  A                               ;484c  b7           10941  10960 
    RET                                 ;484d  c9           10942  10961 
                                        ;                   10943  10962 ;
CULAD0: LD  C,L                         ;484e  4d           10944  10963 
    LD  B,H                             ;484f  44           10945  10964 
    SET 3,B                             ;4850  cb d8        10946  10965 ;
    LD  E,4                             ;4852  1e 04        10947  10966 ;
    OUT (C),E                           ;4854  ed 59        10948  10967 ;
    LD  E,1                             ;4856  1e 01        10949  10968 
    OR  A                               ;4858  b7           10950  10969 
    JR  Z,PATCH2                        ;4859  28 05        10951  10970 
L3445:  RLC E                           ;485b  cb 03        10952  10971 
    DEC A                               ;485d  3d           10953  10972 
    JR  NZ,L3445                        ;485e  20 fb        10954  10973 
PATCH2: LD  A,(GCOLOR)                  ;4860  3a 81 11     10955  10974 
    OR  A                               ;4863  b7           10956  10975 
    JP  Z,PRESOK                        ;4864  ca c0 48     10957  10976 
    DEC A                               ;4867  3d           10958  10977 
    AND 7                               ;4868  e6 07        10959  10978 
    RLCA                                ;486a  07           10960  10979 
    RLCA                                ;486b  07           10961  10980 
    RLCA                                ;486c  07           10962  10981 
    RLCA                                ;486d  07           10963  10982 
    OR  E                               ;486e  b3           10964  10983 
    LD  E,A                             ;486f  5f           10965  10984 
    LD  D,00Fh                          ;4870  16 0f        10966  10985 
    JP  PSTRES                          ;4872  c3 1b 49     10967  10986 
                                        ;                   10968  10987 ;
CALAD1: LD  BC,(CHRSTA)                 ;4875  ed 4b d6 0a  10969  10988 
    LD  A,L                             ;4879  7d           10970  10989 
    LD  L,0FFh                          ;487a  2e ff        10971  10990 
CALA21: INC L                           ;487c  2c           10972  10991 
    SUB 3                               ;487d  d6 03        10973  10992 
    JR  NC,CALA21                       ;487f  30 fb        10974  10993 
    ADD A,3                             ;4881  c6 03        10975  10994 
    SRL E                               ;4883  cb 3b        10976  10995 
    CCF                                 ;4885  3f           10977  10996 
    RLA                                 ;4886  17           10978  10997 
    ADD HL,HL                           ;4887  29           10979  10998 
    ADD HL,HL                           ;4888  29           10980  10999 
    ADD HL,HL                           ;4889  29           10981  11000 
    ADD HL,HL                           ;488a  29           10982  11001 
    ADD HL,HL                           ;488b  29           10983  11002 
    ADD HL,DE                           ;488c  19           10984  11003 
    ADD HL,BC                           ;488d  09           10985  11004 
    LD  DE,00002h                       ;488e  11 02 00     10986  11005 
    OR  A                               ;4891  b7           10987  11006 
    RET                                 ;4892  c9           10988  11007 
                                        ;                   10989  11008 ;
CULAD1: LD  C,L                         ;4893  4d           10990  11009 
    LD  B,H                             ;4894  44           10991  11010 
    SET 3,B                             ;4895  cb d8        10992  11011 
    LD  D,00Ch                          ;4897  16 0c        10993  11012 
    OUT (C),D                           ;4899  ed 51        10994  11013 
    LD  E,1                             ;489b  1e 01        10995  11014 
    OR  A                               ;489d  b7           10996  11015 
    JR  Z,PATCH3                        ;489e  28 05        10997  11016 
L348A:  RLC E                           ;48a0  cb 03        10998  11017 
    DEC A                               ;48a2  3d           10999  11018 
    JR  NZ,L348A                        ;48a3  20 fb        11000  11019 
PATCH3: LD  A,(GCOLOR)                  ;48a5  3a 81 11     11001  11020 
    OR  A                               ;48a8  b7           11002  11021 
    JP  Z,PRESOK                        ;48a9  ca c0 48     11003  11022 
    DEC A                               ;48ac  3d           11004  11023 
    CP  4                               ;48ad  fe 04        11005  11024 
    JR  C,L349F                         ;48af  38 04        11006  11025 
    SET 1,D                             ;48b1  cb ca        11007  11026 
    OUT (C),D                           ;48b3  ed 51        11008  11027 
L349F:  AND 003h                        ;48b5  e6 03        11009  11028 
    RRCA                                ;48b7  0f           11010  11029 
    RRCA                                ;48b8  0f           11011  11030 
    OR  E                               ;48b9  b3           11012  11031 
    LD  E,A                             ;48ba  5f           11013  11032 
    LD  D,03Fh                          ;48bb  16 3f        11014  11033 
    JP  PSTRES                          ;48bd  c3 1b 49     11015  11034 
                                        ;                   11016  11035 ;
PRESOK: LD  C,L                         ;48c0  4d           11017  11036 
    LD  B,H                             ;48c1  44           11018  11037 
    IN  L,(C)                           ;48c2  ed 68        11019  11038 
    LD  A,E                             ;48c4  7b           11020  11039 
    CPL                                 ;48c5  2f           11021  11040 
    AND L                               ;48c6  a5           11022  11041 
    OUT (C),A                           ;48c7  ed 79        11023  11042 
    RET                                 ;48c9  c9           11024  11043 
                                        ;                   11025  11044 ;
                                        ;                   11026  11045 ;
CALAD2:                                 ;                   11027  11046 
CALAD3: ADD HL,HL                       ;48ca  29           11028  11047 
    ADD HL,HL                           ;48cb  29           11029  11048 
    ADD HL,HL                           ;48cc  29           11030  11049 
    ADD HL,HL                           ;48cd  29           11031  11050 
    ADD HL,HL                           ;48ce  29           11032  11051 
    LD  A,E                             ;48cf  7b           11033  11052 
    SRL E                               ;48d0  cb 3b        11034  11053 
    SRL E                               ;48d2  cb 3b        11035  11054 
    ADD HL,DE                           ;48d4  19           11036  11055 
    LD  DE,00004h                       ;48d5  11 04 00     11037  11056 
    OR  A                               ;48d8  b7           11038  11057 
    RET                                 ;48d9  c9           11039  11058 
                                        ;                   11040  11059 ;
CULAD3: AND 003h                        ;48da  e6 03        11041  11060 
    INC A                               ;48dc  3c           11042  11061 
    LD  B,A                             ;48dd  47           11043  11062 
    LD  A,(GCOLOR)                      ;48de  3a 81 11     11044  11063 
    AND 003h                            ;48e1  e6 03        11045  11064 
    LD  E,A                             ;48e3  5f           11046  11065 
    LD  D,0FCh                          ;48e4  16 fc        11047  11066 
CALA31: RRC E                           ;48e6  cb 0b        11048  11067 
    RRC E                               ;48e8  cb 0b        11049  11068 
    RRC D                               ;48ea  cb 0a        11050  11069 
    RRC D                               ;48ec  cb 0a        11051  11070 
    DJNZ    CALA31                      ;48ee  10 f6        11052  11071 
    JP  PSTRES                          ;48f0  c3 1b 49     11053  11072 
                                        ;                   11054  11073 ;
CALAD4:                                 ;                   11055  11074 
CALAD5: ADD HL,HL                       ;48f3  29           11056  11075 
    ADD HL,HL                           ;48f4  29           11057  11076 
    ADD HL,HL                           ;48f5  29           11058  11077 
    ADD HL,HL                           ;48f6  29           11059  11078 
    ADD HL,HL                           ;48f7  29           11060  11079 
    LD  A,E                             ;48f8  7b           11061  11080 
    SRL E                               ;48f9  cb 3b        11062  11081 
    SRL E                               ;48fb  cb 3b        11063  11082 
    SRL E                               ;48fd  cb 3b        11064  11083 
    ADD HL,DE                           ;48ff  19           11065  11084 
    LD  DE,00006H                       ;4900  11 06 00     11066  11085 
    OR  A                               ;4903  b7           11067  11086 
    RET                                 ;4904  c9           11068  11087 
                                        ;                   11069  11088 ;
CULAD5: AND 7                           ;4905  e6 07        11070  11089 
    LD  E,080h                          ;4907  1e 80        11071  11090 
    OR  A                               ;4909  b7           11072  11091 
    JR  Z,L34FB                         ;490a  28 05        11073  11092 
L34F6:  RRC E                           ;490c  cb 0b        11074  11093 
    DEC A                               ;490e  3d           11075  11094 
    JR  NZ,L34F6                        ;490f  20 fb        11076  11095 
L34FB:  LD  A,(GCOLOR)                  ;4911  3a 81 11     11077  11096 
    AND 001h                            ;4914  e6 01        11078  11097 
    JP  Z,PRESOK                        ;4916  ca c0 48     11079  11098 
    LD  D,0FFh                          ;4919  16 ff        11080  11099 
                                        ;                   11081  11100 ;
PSTRES: LD  C,L                         ;491b  4d           11082  11101 
    LD  B,H                             ;491c  44           11083  11102 
    IN  A,(C)                           ;491d  ed 78        11084  11103 
    AND D                               ;491f  a2           11085  11104 
    OR  E                               ;4920  b3           11086  11105 
    OUT (C),A                           ;4921  ed 79        11087  11106 
    RET                                 ;4923  c9           11088  11107 
                                        ;                   11089  11108 ;
PSETXY: LD  C,L                         ;4924  4d           11090  11109 
    LD  B,H                             ;4925  44           11091  11110 
    CALL    SETXY3                      ;4926  cd 4d 49     11092  11111 
    CP  029h                            ;4929  fe 29        11093  11112 ;)
    JR  Z,COLFST                        ;492b  28 1b        11094  11113 
    CALL    CH2CH                       ;492d  cd 61 2d     11095  11114 
    PUSH    DE                          ;4930  d5           11096  11115 
    PUSH    HL                          ;4931  e5           11097  11116 
    CALL    IHLEXP                      ;4932  cd cc 22     11098  11117 
    CP  029h                            ;4935  fe 29        11099  11118 ;)
    JP  NZ,SERROR                       ;4937  c2 3a 17     11100  11119 
    CALL    HCHECK                      ;493a  cd d8 22     11101  11120 
    CP  9                               ;493d  fe 09        11102  11121 
    JP  NC,IFCALL                       ;493f  d2 36 17     11103  11122 
    POP HL                              ;4942  e1           11104  11123 
    POP DE                              ;4943  d1           11105  11124 
COLFSL: LD  (GCOLOR),A                  ;4944  32 81 11     11106  11125 
    RET                                 ;4947  c9           11107  11126 
COLFST: LD  A,(COLORF)                  ;4948  3a 80 11     11108  11127 
    JR  COLFSL                          ;494b  18 f7        11109  11128 
                                        ;                   11110  11129 ;
SETXY3: CALL    BCFTCH                  ;494d  cd c4 25     11111  11130 
    CP  028h                            ;4950  fe 28        11112  11131 ;(
    JP  NZ,SERROR                       ;4952  c2 3a 17     11113  11132 
    CALL    IHLEXP                      ;4955  cd cc 22     11114  11133 
    PUSH    HL                          ;4958  e5           11115  11134 
    CALL    CH2CH                       ;4959  cd 61 2d     11116  11135 
    CALL    IHLEXP                      ;495c  cd cc 22     11117  11136 
    POP DE                              ;495f  d1           11118  11137 
    RET                                 ;4960  c9           11119  11138 
                                        ;                   11120  11139 ;
                                        ;                   11121  11140 ;
SETXY2: CALL    SETXY3                  ;4961  cd 4d 49     11122  11141 
    CALL    CH29H                       ;4964  cd 66 2d     11123  11142 
BCFTC2: LD  A,(BC)                      ;4967  0a           11124  11143 
    CP  020h                            ;4968  fe 20        11125  11144 
    RET NZ                              ;496a  c0           11126  11145 
    INC BC                              ;496b  03           11127  11146 
    JR  BCFTC2                          ;496c  18 f9        11128  11147 
                                        ;                   11129  11148 ;
                                        ;                   11130  11149 ;
EDCEKL: INC BC                          ;496e  03           11131  11150 
EDCEK:  LD  A,(BC)                      ;496f  0a           11132  11151 
    CP  020h                            ;4970  fe 20        11133  11152 
    JR  Z,EDCEKL                        ;4972  28 fa        11134  11153 
    OR  A                               ;4974  b7           11135  11154 
    RET Z                               ;4975  c8           11136  11155 
    CP  03Ah                            ;4976  fe 3a        11137  11156 
    RET                                 ;4978  c9           11138  11157 
                                        ;                   11139  11158 ;
                                        ;                   11140  11159 ;
LINE@:  CALL    COLFST                  ;4979  cd 48 49     11141  11160 
    DEC BC                              ;497c  0b           11142  11161 
    CALL    BCFTC2                      ;497d  cd 67 49     11143  11162 
    CP  0F9h                            ;4980  fe f9        11144  11163 ;-
    JR  NZ,NOMLIN                       ;4982  20 0e        11145  11164 
    LD  HL,(LINEXE+1)                   ;4984  2a 45 4a     11146  11165 
    LD  (LINEXS+1),HL                   ;4987  22 40 4a     11147  11166 
    LD  HL,(LINEYE+1)                   ;498a  2a 62 4a     11148  11167 
    LD  (LINEYS+1),HL                   ;498d  22 5d 4a     11149  11168 
    JR  ENDLIN                          ;4990  18 0e        11150  11169 
NOMLIN: CALL    SETXY2                  ;4992  cd 61 49     11151  11170 
    LD  (LINEXS+1),DE                   ;4995  ed 53 40 4a  11152  11171 
    LD  (LINEYS+1),HL                   ;4999  22 5d 4a     11153  11172 
    CP  0F9h                            ;499c  fe f9        11154  11173 
    JR  NZ,LIMODE                       ;499e  20 10        11155  11174 
ENDLIN: INC BC                          ;49a0  03           11156  11175 
    CALL    SETXY2                      ;49a1  cd 61 49     11157  11176 
    LD  (LINEXE+1),DE                   ;49a4  ed 53 45 4a  11158  11177 
    LD  (LINEYE+1),HL                   ;49a8  22 62 4a     11159  11178 
    CP  0F9h                            ;49ab  fe f9        11160  11179 ;-
    JP  Z,NINS                          ;49ad  ca fa 20     11161  11180 ;CONNECT
LIMODE: CP  02Ch                        ;49b0  fe 2c        11162  11181 ;,
    JP  NZ,SERROR                       ;49b2  c2 3a 17     11163  11182 
    INC BC                              ;49b5  03           11164  11183 
    CALL    BCFTC2                      ;49b6  cd 67 49     11165  11184 
    CP  0C7h                            ;49b9  fe c7        11166  11185 ;PSET
    JR  Z,MDST2                         ;49bb  28 16        11167  11186 
    CP  0C8h                            ;49bd  fe c8        11168  11187 ;PRESET
    LD  A,0                             ;49bf  3e 00        11169  11188 
    JR  Z,MDST22                        ;49c1  28 37        11170  11189 
CHRMD1: CALL    STREXX                  ;49c3  cd 9d 45     11171  11190 
    OR  A                               ;49c6  b7           11172  11191 
    JR  Z,L35B4                         ;49c7  28 01        11173  11192 
    LD  A,(DE)                          ;49c9  1a           11174  11193 
L35B4:  DEC BC                          ;49ca  0b           11175  11194 
    LD  (CHRCOD+1),A                    ;49cb  32 da 4b     11176  11195 
    LD  HL,TEXTSB                       ;49ce  21 c7 4b     11177  11196 
    JR  MDST3                           ;49d1  18 04        11178  11197 
MDST2:  INC BC                          ;49d3  03           11179  11198 
    LD  HL,PSETSB                       ;49d4  21 0c 48     11180  11199 
MDST3:  LD  (LINEMD+1),HL               ;49d7  22 b9 4a     11181  11200 
    LD  (BOXMD+1),HL                    ;49da  22 4f 4b     11182  11201 
    LD  DE,LINESB                       ;49dd  11 7d 4a     11183  11202 
    CALL    EDCEK                       ;49e0  cd 6f 49     11184  11203 
    JR  Z,LINE1                         ;49e3  28 3a        11185  11204 
    CALL    CH2CH                       ;49e5  cd 61 2d     11186  11205 
    INC BC                              ;49e8  03           11187  11206 
    CALL    BCFTC2                      ;49e9  cd 67 49     11188  11207 
    CP  042h                            ;49ec  fe 42        11189  11208 ;B/BF
    JR  Z,BBFLMD                        ;49ee  28 22        11190  11209 
    CALL    IBYTE                       ;49f0  cd df 22     11191  11210 
    CP  9                               ;49f3  fe 09        11192  11211 
    JP  NC,IFCALL                       ;49f5  d2 36 17     11193  11212 
    DEC BC                              ;49f8  0b           11194  11213 
    DEC BC                              ;49f9  0b           11195  11214 
MDST22: LD  (GCOLOR),A                  ;49fa  32 81 11     11196  11215 
    INC BC                              ;49fd  03           11197  11216 
    LD  DE,LINESB                       ;49fe  11 7d 4a     11198  11217 
    CALL    EDCEK                       ;4a01  cd 6f 49     11199  11218 
    JR  Z,LINE1                         ;4a04  28 19        11200  11219 
    CALL    CH2CH                       ;4a06  cd 61 2d     11201  11220 
    INC BC                              ;4a09  03           11202  11221 
    CALL    BCFTC2                      ;4a0a  cd 67 49     11203  11222 
    CP  042h                            ;4a0d  fe 42        11204  11223 ;B/BF
    JP  NZ,SERROR                       ;4a0f  c2 3a 17     11205  11224 
BBFLMD: LD  DE,BOX                      ;4a12  11 01 4b     11206  11225 
    INC BC                              ;4a15  03           11207  11226 
    LD  A,(BC)                          ;4a16  0a           11208  11227 
    CP  046h                            ;4a17  fe 46        11209  11228 ;F
    JR  NZ,LINE1                        ;4a19  20 04        11210  11229 
    INC BC                              ;4a1b  03           11211  11230 
    LD  DE,BOXFUL                       ;4a1c  11 5b 4b     11212  11231 
LINE1:  LD  (LNBOXF+1),DE               ;4a1f  ed 53 7b 4a  11213  11232 
    PUSH    BC                          ;4a23  c5           11214  11233 
    CALL    LINES1                      ;4a24  cd 2b 4a     11215  11234 
    POP BC                              ;4a27  c1           11216  11235 
    LD  L,C                             ;4a28  69           11217  11236 
    LD  H,B                             ;4a29  60           11218  11237 
    RET                                 ;4a2a  c9           11219  11238 
                                        ;                   11220  11239 ;
LINES1: LD  HL,0                        ;4a2b  21 00 00     11221  11240 
    LD  (YINC1+1),HL                    ;4a2e  22 cb 4a     11222  11241 
    LD  (YINC3+1),HL                    ;4a31  22 bf 4a     11223  11242 
    LD  BC,08000h                       ;4a34  01 00 80     11224  11243 
    LD  (YMOD+1),BC                     ;4a37  ed 43 aa 4a  11225  11244 
    LD  (XMOD+1),BC                     ;4a3b  ed 43 a7 4a  11226  11245 
LINEXS: LD  HL,0                        ;4a3f  21 00 00     11227  11246 ;(XS
    ADD HL,BC                           ;4a42  09           11228  11247 
    EX  DE,HL                           ;4a43  eb           11229  11248 
LINEXE: LD  HL,255                      ;4a44  21 ff 00     11230  11249 ;-,XE
    ADD HL,BC                           ;4a47  09           11231  11250 
    OR  A                               ;4a48  b7           11232  11251 
    SBC HL,DE                           ;4a49  ed 52        11233  11252 
    LD  DE,1                            ;4a4b  11 01 00     11234  11253 
    JR  NC,LINEL0                       ;4a4e  30 06        11235  11254 
    EX  DE,HL                           ;4a50  eb           11236  11255 
    SBC HL,DE                           ;4a51  ed 52        11237  11256 
    LD  DE,0FFFFh                       ;4a53  11 ff ff     11238  11257 
LINEL0: PUSH    HL                      ;4a56  e5           11239  11258 
    LD  (XINC0+1),DE                    ;4a57  ed 53 d2 4a  11240  11259 
    LD  A,E                             ;4a5b  7b           11241  11260 
LINEYS: LD  HL,0                        ;4a5c  21 00 00     11242  11261 ;(,YS)
    ADD HL,BC                           ;4a5f  09           11243  11262 
    EX  DE,HL                           ;4a60  eb           11244  11263 
LINEYE: LD  HL,192                      ;4a61  21 c0 00     11245  11264 ;-,YE)
    ADD HL,BC                           ;4a64  09           11246  11265 
    OR  A                               ;4a65  b7           11247  11266 
    SBC HL,DE                           ;4a66  ed 52        11248  11267 
    LD  DE,1                            ;4a68  11 01 00     11249  11268 
    JR  NC,LINEL1                       ;4a6b  30 06        11250  11269 
    EX  DE,HL                           ;4a6d  eb           11251  11270 
    SBC HL,DE                           ;4a6e  ed 52        11252  11271 
    LD  DE,0FFFFh                       ;4a70  11 ff ff     11253  11272 
LINEL1: LD  (YINC2+1),DE                ;4a73  ed 53 c4 4a  11254  11273 
    LD  B,A                             ;4a77  47           11255  11274 
    LD  C,E                             ;4a78  4b           11256  11275 
    POP DE                              ;4a79  d1           11257  11276 
LNBOXF: JP  LINESB                      ;4a7a  c3 7d 4a     11258  11277 ;BOX/BOXFUL
LINESB: PUSH    HL                      ;4a7d  e5           11259  11278 
    SBC HL,DE                           ;4a7e  ed 52        11260  11279 
    POP HL                              ;4a80  e1           11261  11280 
    PUSH    DE                          ;4a81  d5           11262  11281 
    JR  Z,LINEL2                        ;4a82  28 20        11263  11282 
    JR  NC,LINEL3                       ;4a84  30 58        11264  11283 
    CALL    DIVH$D                      ;4a86  cd 90 4b     11265  11284 
    DEC C                               ;4a89  0d           11266  11285 
    LD  DE,0                            ;4a8a  11 00 00     11267  11286 
    JR  Z,LINEL4                        ;4a8d  28 0e        11268  11287 
    XOR A                               ;4a8f  af           11269  11288 
    EX  DE,HL                           ;4a90  eb           11270  11289 
    SBC HL,DE                           ;4a91  ed 52        11271  11290 
    LD  DE,07F7Fh                       ;4a93  11 7f 7f     11272  11291 
    LD  (YMOD+1),DE                     ;4a96  ed 53 aa 4a  11273  11292 
    LD  DE,0FFFFh                       ;4a9a  11 ff ff     11274  11293 
LINEL4: LD  (YINC2+1),DE                ;4a9d  ed 53 c4 4a  11275  11294 
    LD  (YINC3+1),HL                    ;4aa1  22 bf 4a     11276  11295 
LINEL2: POP BC                          ;4aa4  c1           11277  11296 
    EXX                                 ;4aa5  d9           11278  11297 
XMOD:   LD  DE,08000h                   ;4aa6  11 00 80     11279  11298 
YMOD:   LD  HL,08000h                   ;4aa9  21 00 80     11280  11299 
    EXX                                 ;4aac  d9           11281  11300 
    LD  DE,(LINEXS+1)                   ;4aad  ed 5b 40 4a  11282  11301 
    LD  HL,(LINEYS+1)                   ;4ab1  2a 5d 4a     11283  11302 
    INC BC                              ;4ab4  03           11284  11303 
LINELP: PUSH    BC                      ;4ab5  c5           11285  11304 
    PUSH    DE                          ;4ab6  d5           11286  11305 
    PUSH    HL                          ;4ab7  e5           11287  11306 
LINEMD: CALL    PSETSB                  ;4ab8  cd 0c 48     11288  11307 ;PSETTX
    POP HL                              ;4abb  e1           11289  11308 
    POP DE                              ;4abc  d1           11290  11309 
    EXX                                 ;4abd  d9           11291  11310 
YINC3:  LD  BC,00000h                   ;4abe  01 00 00     11292  11311 
    ADD HL,BC                           ;4ac1  09           11293  11312 
    EXX                                 ;4ac2  d9           11294  11313 
YINC2:  LD  BC,00001h                   ;4ac3  01 01 00     11295  11314 
    ADC HL,BC                           ;4ac6  ed 4a        11296  11315 
    EXX                                 ;4ac8  d9           11297  11316 
    EX  DE,HL                           ;4ac9  eb           11298  11317 
YINC1:  LD  BC,00000h                   ;4aca  01 00 00     11299  11318 
    ADD HL,BC                           ;4acd  09           11300  11319 
    EX  DE,HL                           ;4ace  eb           11301  11320 
    EXX                                 ;4acf  d9           11302  11321 
    EX  DE,HL                           ;4ad0  eb           11303  11322 
XINC0:  LD  BC,00001h                   ;4ad1  01 01 00     11304  11323 
    ADC HL,BC                           ;4ad4  ed 4a        11305  11324 
    EX  DE,HL                           ;4ad6  eb           11306  11325 
    POP BC                              ;4ad7  c1           11307  11326 
    DEC BC                              ;4ad8  0b           11308  11327 
    LD  A,B                             ;4ad9  78           11309  11328 
    OR  C                               ;4ada  b1           11310  11329 
    JR  NZ,LINELP                       ;4adb  20 d8        11311  11330 
    RET                                 ;4add  c9           11312  11331 
                                        ;                   11313  11332 ;
LINEL3: LD  E,L                         ;4ade  5d           11314  11333 
    LD  D,H                             ;4adf  54           11315  11334 
    EX  (SP),HL                         ;4ae0  e3           11316  11335 
    CALL    DIVH$D                      ;4ae1  cd 90 4b     11317  11336 
    DEC B                               ;4ae4  05           11318  11337 
    LD  DE,0                            ;4ae5  11 00 00     11319  11338 
    JR  Z,LINEL5                        ;4ae8  28 0e        11320  11339 
    XOR A                               ;4aea  af           11321  11340 
    EX  DE,HL                           ;4aeb  eb           11322  11341 
    SBC HL,DE                           ;4aec  ed 52        11323  11342 
    LD  DE,07F7Fh                       ;4aee  11 7f 7f     11324  11343 
    LD  (XMOD+1),DE                     ;4af1  ed 53 a7 4a  11325  11344 
    LD  DE,0FFFFh                       ;4af5  11 ff ff     11326  11345 
LINEL5: LD  (XINC0+1),DE                ;4af8  ed 53 d2 4a  11327  11346 
    LD  (YINC1+1),HL                    ;4afc  22 cb 4a     11328  11347 
    JR  LINEL2                          ;4aff  18 a3        11329  11348 
                                        ;                   11330  11349 ;
                                        ;                   11331  11350 ; BOX
BOX:    PUSH    DE                      ;4b01  d5           11332  11351 
    PUSH    BC                          ;4b02  c5           11333  11352 
    LD  A,023h                          ;4b03  3e 23        11334  11353 
    DEC C                               ;4b05  0d           11335  11354 
    JR  Z,BOXYAD                        ;4b06  28 02        11336  11355 
    LD  A,02Bh                          ;4b08  3e 2b        11337  11356 
BOXYAD: LD  (XBOXAD),A                  ;4b0a  32 55 4b     11338  11357 
    PUSH    HL                          ;4b0d  e5           11339  11358 
    POP BC                              ;4b0e  c1           11340  11359 
    LD  DE,(LINEXS+1)                   ;4b0f  ed 5b 40 4a  11341  11360 
    LD  HL,(LINEYS+1)                   ;4b13  2a 5d 4a     11342  11361 
    PUSH    BC                          ;4b16  c5           11343  11362 
    PUSH    HL                          ;4b17  e5           11344  11363 
    CALL    LINEY                       ;4b18  cd 45 4b     11345  11364 
    POP HL                              ;4b1b  e1           11346  11365 
    POP BC                              ;4b1c  c1           11347  11366 
    LD  DE,(LINEXE+1)                   ;4b1d  ed 5b 45 4a  11348  11367 
    CALL    LINEY                       ;4b21  cd 45 4b     11349  11368 
    POP BC                              ;4b24  c1           11350  11369 
    LD  A,013h                          ;4b25  3e 13        11351  11370 
    DEC B                               ;4b27  05           11352  11371 
    JR  Z,BOXXAD                        ;4b28  28 02        11353  11372 
    LD  A,01Bh                          ;4b2a  3e 1b        11354  11373 
BOXXAD: LD  (XBOXAD),A                  ;4b2c  32 55 4b     11355  11374 
    POP BC                              ;4b2f  c1           11356  11375 
    INC BC                              ;4b30  03           11357  11376 
    LD  DE,(LINEXS+1)                   ;4b31  ed 5b 40 4a  11358  11377 
    LD  HL,(LINEYS+1)                   ;4b35  2a 5d 4a     11359  11378 
    PUSH    BC                          ;4b38  c5           11360  11379 
    PUSH    DE                          ;4b39  d5           11361  11380 
    CALL    LINEX                       ;4b3a  cd 56 4b     11362  11381 
    POP DE                              ;4b3d  d1           11363  11382 
    POP BC                              ;4b3e  c1           11364  11383 
    LD  HL,(LINEYE+1)                   ;4b3f  2a 62 4a     11365  11384 
    JP  LINEX                           ;4b42  c3 56 4b     11366  11385 
LINEY:  LD  A,B                         ;4b45  78           11367  11386 
    OR  C                               ;4b46  b1           11368  11387 
    RET Z                               ;4b47  c8           11369  11388 
    JP  BOXDEC                          ;4b48  c3 54 4b     11370  11389 
BOXLOP: PUSH    HL                      ;4b4b  e5           11371  11390 
    PUSH    DE                          ;4b4c  d5           11372  11391 
    PUSH    BC                          ;4b4d  c5           11373  11392 
BOXMD:  CALL    PSETSB                  ;4b4e  cd 0c 48     11374  11393 ;PSETTX
    POP BC                              ;4b51  c1           11375  11394 
    POP DE                              ;4b52  d1           11376  11395 
    POP HL                              ;4b53  e1           11377  11396 
BOXDEC: DEC BC                          ;4b54  0b           11378  11397 
XBOXAD: NOP                             ;4b55  00           11379  11398 ;INC/DEL DEL/HL
LINEX:  LD  A,B                         ;4b56  78           11380  11399 
    OR  C                               ;4b57  b1           11381  11400 
    JR  NZ,BOXLOP                       ;4b58  20 f1        11382  11401 
    RET                                 ;4b5a  c9           11383  11402 
                                        ;                   11384  11403 ;
                                        ;                   11385  11404 ;
                                        ;                   11386  11405 ; BOX FU
BOXFUL: LD  A,013h                      ;4b5b  3e 13        11387  11406 
    DEC B                               ;4b5d  05           11388  11407 
    JR  Z,FULAD1                        ;4b5e  28 02        11389  11408 
    LD  A,01Bh                          ;4b60  3e 1b        11390  11409 
FULAD1: LD  (XBOXAD),A                  ;4b62  32 55 4b     11391  11410 
    LD  A,023h                          ;4b65  3e 23        11392  11411 
    DEC C                               ;4b67  0d           11393  11412 
    JR  Z,FULAD2                        ;4b68  28 02        11394  11413 
    LD  A,02Bh                          ;4b6a  3e 2b        11395  11414 
FULAD2: LD  (FULINC),A                  ;4b6c  32 88 4b     11396  11415 
    PUSH    HL                          ;4b6f  e5           11397  11416 
    POP BC                              ;4b70  c1           11398  11417 
    INC BC                              ;4b71  03           11399  11418 
    EX  DE,HL                           ;4b72  eb           11400  11419 
    INC HL                              ;4b73  23           11401  11420 
    LD  (LINEBC+1),HL                   ;4b74  22 81 4b     11402  11421 
    LD  DE,(LINEXS+1)                   ;4b77  ed 5b 40 4a  11403  11422 
    LD  HL,(LINEYS+1)                   ;4b7b  2a 5d 4a     11404  11423 
FULLOP: PUSH    DE                      ;4b7e  d5           11405  11424 
    PUSH    BC                          ;4b7f  c5           11406  11425 
LINEBC: LD  BC,00001h                   ;4b80  01 01 00     11407  11426 
    CALL    LINEX                       ;4b83  cd 56 4b     11408  11427 
    POP BC                              ;4b86  c1           11409  11428 
    POP DE                              ;4b87  d1           11410  11429 
FULINC: INC HL                          ;4b88  23           11411  11430 
    DEC BC                              ;4b89  0b           11412  11431 
    LD  A,B                             ;4b8a  78           11413  11432 
    OR  C                               ;4b8b  b1           11414  11433 
    JP  NZ,FULLOP                       ;4b8c  c2 7e 4b     11415  11434 
    RET                                 ;4b8f  c9           11416  11435 
                                        ;                   11417  11436 ;
DIVH$D: LD  A,H                         ;4b90  7c           11418  11437 
    OR  L                               ;4b91  b5           11419  11438 
    RET Z                               ;4b92  c8           11420  11439 
    PUSH    BC                          ;4b93  c5           11421  11440 
    LD  A,17                            ;4b94  3e 11        11422  11441 
    EXX                                 ;4b96  d9           11423  11442 
    LD  HL,0                            ;4b97  21 00 00     11424  11443 
    LD  DE,0                            ;4b9a  11 00 00     11425  11444 
    EXX                                 ;4b9d  d9           11426  11445 
DIVLP:  PUSH    HL                      ;4b9e  e5           11427  11446 
    OR  A                               ;4b9f  b7           11428  11447 
    SBC HL,DE                           ;4ba0  ed 52        11429  11448 
    EXX                                 ;4ba2  d9           11430  11449 
    PUSH    HL                          ;4ba3  e5           11431  11450 
    SBC HL,DE                           ;4ba4  ed 52        11432  11451 
    JR  C,DIV01                         ;4ba6  38 06        11433  11452 
    EX  (SP),HL                         ;4ba8  e3           11434  11453 
    POP HL                              ;4ba9  e1           11435  11454 
    EXX                                 ;4baa  d9           11436  11455 
    EX  (SP),HL                         ;4bab  e3           11437  11456 
    EXX                                 ;4bac  d9           11438  11457 
    PUSH    HL                          ;4bad  e5           11439  11458 
DIV01:  POP HL                          ;4bae  e1           11440  11459 
    EXX                                 ;4baf  d9           11441  11460 
    POP HL                              ;4bb0  e1           11442  11461 
    CCF                                 ;4bb1  3f           11443  11462 
    RL  C                               ;4bb2  cb 11        11444  11463 
    RL  B                               ;4bb4  cb 10        11445  11464 
    SLA L                               ;4bb6  cb 25        11446  11465 
    RL  H                               ;4bb8  cb 14        11447  11466 
    EXX                                 ;4bba  d9           11448  11467 
    RL  L                               ;4bbb  cb 15        11449  11468 
    RL  H                               ;4bbd  cb 14        11450  11469 
    EXX                                 ;4bbf  d9           11451  11470 
    DEC A                               ;4bc0  3d           11452  11471 
    JR  NZ,DIVLP                        ;4bc1  20 db        11453  11472 
    LD  L,C                             ;4bc3  69           11454  11473 
    LD  H,B                             ;4bc4  60           11455  11474 
    POP BC                              ;4bc5  c1           11456  11475 
    RET                                 ;4bc6  c9           11457  11476 
                                        ;                   11458  11477 ;
                                        ;                   11459  11478 ;
TEXTSB: XOR A                           ;4bc7  af           11460  11479 
    CP  D                               ;4bc8  ba           11461  11480 
    RET NZ                              ;4bc9  c0           11462  11481 
    CP  H                               ;4bca  bc           11463  11482 
    RET NZ                              ;4bcb  c0           11464  11483 
    LD  D,L                             ;4bcc  55           11465  11484 
    LD  A,E                             ;4bcd  7b           11466  11485 
    CP  32                              ;4bce  fe 20        11467  11486 
    RET NC                              ;4bd0  d0           11468  11487 
    LD  A,D                             ;4bd1  7a           11469  11488 
    CP  16                              ;4bd2  fe 10        11470  11489 
    RET NC                              ;4bd4  d0           11471  11490 
    EX  DE,HL                           ;4bd5  eb           11472  11491 
    CALL    ADRCA2                      ;4bd6  cd 3b 09     11473  11492 
CHRCOD: LD  A,041h                      ;4bd9  3e 41        11474  11493 ;"A"
    JP  BCOUTA                          ;4bdb  c3 3f 0a     11475  11494 
                                        ;                   11476  11495 ;
CIRCLE: LD  C,L                         ;4bde  4d           11477  11496 
    LD  B,H                             ;4bdf  44           11478  11497 
    CALL    SETXY2                      ;4be0  cd 61 49     11479  11498 
    CALL    CH2CH                       ;4be3  cd 61 2d     11480  11499 
    INC BC                              ;4be6  03           11481  11500 
    LD  (SINSX+1),DE                    ;4be7  ed 53 9f 4d  11482  11501 
    LD  (SINSY+1),HL                    ;4beb  22 a6 4d     11483  11502 
    LD  A,(BC)                          ;4bee  0a           11484  11503 
    CP  05Bh                            ;4bef  fe 5b        11485  11504 ;[
    JR  NZ,CIRRST                       ;4bf1  20 13        11486  11505 
    INC BC                              ;4bf3  03           11487  11506 
    CALL    IHLEXP                      ;4bf4  cd cc 22     11488  11507 
    CALL    CH2CH                       ;4bf7  cd 61 2d     11489  11508 
    PUSH    HL                          ;4bfa  e5           11490  11509 
    CALL    IHLEXP                      ;4bfb  cd cc 22     11491  11510 
    CP  05Dh                            ;4bfe  fe 5d        11492  11511 ;]
    JP  NZ,SERROR                       ;4c00  c2 3a 17     11493  11512 
    POP DE                              ;4c03  d1           11494  11513 
    JR  CRRROK                          ;4c04  18 06        11495  11514 
CIRRST: CALL    IHLEXP                  ;4c06  cd cc 22     11496  11515 
    DEC BC                              ;4c09  0b           11497  11516 
    LD  D,H                             ;4c0a  54           11498  11517 
    LD  E,L                             ;4c0b  5d           11499  11518 
CRRROK: LD  (SINRX+1),DE                ;4c0c  ed 53 cc 4d  11500  11519 
    LD  (SINRY+1),HL                    ;4c10  22 d2 4d     11501  11520 
    CALL    EDCEK                       ;4c13  cd 6f 49     11502  11521 
    LD  HL,10                           ;4c16  21 0a 00     11503  11522 
    JR  Z,POLYE1                        ;4c19  28 45        11504  11523 
    CALL    CH2CH                       ;4c1b  cd 61 2d     11505  11524 
    INC BC                              ;4c1e  03           11506  11525 
    CALL    IHLEXP                      ;4c1f  cd cc 22     11507  11526 
    LD  (SIND+1),HL                     ;4c22  22 ba 4c     11508  11527 
    DEC BC                              ;4c25  0b           11509  11528 
    CALL    EDCEK                       ;4c26  cd 6f 49     11510  11529 
    JR  Z,POLYE2                        ;4c29  28 38        11511  11530 
    INC BC                              ;4c2b  03           11512  11531 
    LD  A,(BC)                          ;4c2c  0a           11513  11532 
    CP  02Ch                            ;4c2d  fe 2c        11514  11533 
    LD  A,(COLORF)                      ;4c2f  3a 80 11     11515  11534 
    JR  Z,SKPCOL                        ;4c32  28 09        11516  11535 
    CALL    IBYTE                       ;4c34  cd df 22     11517  11536 
    CP  9                               ;4c37  fe 09        11518  11537 
    JP  NC,IFCALL                       ;4c39  d2 36 17     11519  11538 
    DEC BC                              ;4c3c  0b           11520  11539 
SKPCOL: LD  (GCOLOR),A                  ;4c3d  32 81 11     11521  11540 
    LD  A,(BC)                          ;4c40  0a           11522  11541 
    CALL    EDCEK                       ;4c41  cd 6f 49     11523  11542 
    JR  Z,POLYE3                        ;4c44  28 23        11524  11543 
    CALL    CH2CH                       ;4c46  cd 61 2d     11525  11544 
    INC BC                              ;4c49  03           11526  11545 
    CALL    IHLEXP                      ;4c4a  cd cc 22     11527  11546 
    LD  (SINSTA+1),HL                   ;4c4d  22 a6 4c     11528  11547 
    DEC BC                              ;4c50  0b           11529  11548 
    CALL    EDCEK                       ;4c51  cd 6f 49     11530  11549 
    JR  Z,POLYE4                        ;4c54  28 19        11531  11550 
    CALL    CH2CH                       ;4c56  cd 61 2d     11532  11551 
    INC BC                              ;4c59  03           11533  11552 
    CALL    IHLEXP                      ;4c5a  cd cc 22     11534  11553 
    DEC BC                              ;4c5d  0b           11535  11554 
    JR  POLYE5                          ;4c5e  18 12        11536  11555 
                                        ;                   11537  11556 ;
POLYE1: LD  (SIND+1),HL                 ;4c60  22 ba 4c     11538  11557 
POLYE2: LD  A,(COLORF)                  ;4c63  3a 80 11     11539  11558 
    LD  (GCOLOR),A                      ;4c66  32 81 11     11540  11559 
POLYE3: LD  HL,0                        ;4c69  21 00 00     11541  11560 
    LD  (SINSTA+1),HL                   ;4c6c  22 a6 4c     11542  11561 
POLYE4: LD  HL,360                      ;4c6f  21 68 01     11543  11562 
POLYE5: LD  (SINEND+1),HL               ;4c72  22 c3 4c     11544  11563 
    PUSH    BC                          ;4c75  c5           11545  11564 
    LD  HL,LINESB                       ;4c76  21 7d 4a     11546  11565 
    LD  (LNBOXF+1),HL                   ;4c79  22 7b 4a     11547  11566 
    LD  HL,PSETSB                       ;4c7c  21 0c 48     11548  11567 
    LD  (LINEMD+1),HL                   ;4c7f  22 b9 4a     11549  11568 
    LD  HL,(SIND+1)                     ;4c82  2a ba 4c     11550  11569 
    LD  A,H                             ;4c85  7c           11551  11570 
    OR  L                               ;4c86  b5           11552  11571 
    JR  Z,POLYLN                        ;4c87  28 05        11553  11572 
    CALL    SINSTA                      ;4c89  cd a5 4c     11554  11573 
    POP HL                              ;4c8c  e1           11555  11574 
    RET                                 ;4c8d  c9           11556  11575 
POLYLN: LD  HL,(SINSX+1)                ;4c8e  2a 9f 4d     11557  11576 
    LD  (LINEXS+1),HL                   ;4c91  22 40 4a     11558  11577 
    LD  HL,(SINSY+1)                    ;4c94  2a a6 4d     11559  11578 
    LD  (LINEYS+1),HL                   ;4c97  22 5d 4a     11560  11579 
    LD  HL,(SINSTA+1)                   ;4c9a  2a a6 4c     11561  11580 
    CALL    SINXYS                      ;4c9d  cd d5 4c     11562  11581 
    CALL    LINES1                      ;4ca0  cd 2b 4a     11563  11582 
    POP HL                              ;4ca3  e1           11564  11583 
    RET                                 ;4ca4  c9           11565  11584 
                                        ;                   11566  11585 ;
SINSTA: LD  HL,0                        ;4ca5  21 00 00     11567  11586 ;DEG START
    PUSH    HL                          ;4ca8  e5           11568  11587 
    CALL    SINXYS                      ;4ca9  cd d5 4c     11569  11588 
CIRCLP: LD  HL,(LINEXE+1)               ;4cac  2a 45 4a     11570  11589 
    LD  (LINEXS+1),HL                   ;4caf  22 40 4a     11571  11590 
    LD  HL,(LINEYE+1)                   ;4cb2  2a 62 4a     11572  11591 
    LD  (LINEYS+1),HL                   ;4cb5  22 5d 4a     11573  11592 
    POP HL                              ;4cb8  e1           11574  11593 
SIND:   LD  BC,00001h                   ;4cb9  01 01 00     11575  11594 ;DEG STEP
    ADD HL,BC                           ;4cbc  09           11576  11595 
    PUSH    HL                          ;4cbd  e5           11577  11596 
    LD  BC,08000h                       ;4cbe  01 00 80     11578  11597 
    ADD HL,BC                           ;4cc1  09           11579  11598 
SINEND: LD  DE,360                      ;4cc2  11 68 01     11580  11599 ;DEG END
    EX  DE,HL                           ;4cc5  eb           11581  11600 
    ADD HL,BC                           ;4cc6  09           11582  11601 
    OR  A                               ;4cc7  b7           11583  11602 
    SBC HL,DE                           ;4cc8  ed 52        11584  11603 
    POP HL                              ;4cca  e1           11585  11604 
    RET C                               ;4ccb  d8           11586  11605 
    PUSH    HL                          ;4ccc  e5           11587  11606 
    CALL    SINXYS                      ;4ccd  cd d5 4c     11588  11607 
    CALL    LINES1                      ;4cd0  cd 2b 4a     11589  11608 
    JR  CIRCLP                          ;4cd3  18 d7        11590  11609 
                                        ;                   11591  11610 ;
SINXYS: BIT 7,H                         ;4cd5  cb 7c        11592  11611 ;HL=DEG
    JR  Z,SIN!                          ;4cd7  28 08        11593  11612 
    LD  DE,360                          ;4cd9  11 68 01     11594  11613 
L38C6:  ADD HL,DE                       ;4cdc  19           11595  11614 
    JR  NC,L38C6                        ;4cdd  30 fd        11596  11615 
    JR  SINOK                           ;4cdf  18 0a        11597  11616 
SIN!:   LD  DE,0FE98h                   ;4ce1  11 98 fe     11598  11617 ;-360
L38CE:  ADD HL,DE                       ;4ce4  19           11599  11618 
    JR  C,L38CE                         ;4ce5  38 fd        11600  11619 
    LD  DE,360                          ;4ce7  11 68 01     11601  11620 
    ADD HL,DE                           ;4cea  19           11602  11621 
SINOK:  LD  A,H                         ;4ceb  7c           11603  11622 
    OR  L                               ;4cec  b5           11604  11623 
    JP  Z,SIN00                         ;4ced  ca 7a 4d     11605  11624 
    LD  DE,1                            ;4cf0  11 01 00     11606  11625 
    LD  BC,90                           ;4cf3  01 5a 00     11607  11626 
    SBC HL,BC                           ;4cf6  ed 42        11608  11627 
    JP  Z,SIN90                         ;4cf8  ca 7f 4d     11609  11628 
    JR  C,SIN45                         ;4cfb  38 13        11610  11629 
    SBC HL,BC                           ;4cfd  ed 42        11611  11630 
    JP  Z,SIN180                        ;4cff  ca 84 4d     11612  11631 
    JR  C,SIN135                        ;4d02  38 14        11613  11632 
    SBC HL,BC                           ;4d04  ed 42        11614  11633 
    JP  Z,SIN270                        ;4d06  ca 89 4d     11615  11634 
    JR  C,SIN225                        ;4d09  38 13        11616  11635 
    LD  BC,00000h                       ;4d0b  01 00 00     11617  11636 ;X>0,Y>0
    JR  SINOK1                          ;4d0e  18 14        11618  11637 
SIN45:  EX  DE,HL                       ;4d10  eb           11619  11638 ;0-90
    SBC HL,DE                           ;4d11  ed 52        11620  11639 
    LD  BC,000FFh                       ;4d13  01 ff 00     11621  11640 ;X>0,Y<0
    JR  SINOK1                          ;4d16  18 0c        11622  11641 
SIN135: ADD HL,BC                       ;4d18  09           11623  11642 ;180-90
    LD  BC,0FFFFh                       ;4d19  01 ff ff     11624  11643 ;X<0,Y<0
    JR  SINOK1                          ;4d1c  18 06        11625  11644 
SIN225: EX  DE,HL                       ;4d1e  eb           11626  11645 
    SBC HL,DE                           ;4d1f  ed 52        11627  11646 
    LD  BC,0FF00h                       ;4d21  01 00 ff     11628  11647 ;X<0,Y>0
SINOK1: ADD HL,HL                       ;4d24  29           11629  11648 
    EX  DE,HL                           ;4d25  eb           11630  11649 
    LD  A,B                             ;4d26  78           11631  11650 
    LD  (XMULHI+1),A                    ;4d27  32 5d 4d     11632  11651 
    LD  A,C                             ;4d2a  79           11633  11652 
    LD  (YMULHI+1),A                    ;4d2b  32 6b 4d     11634  11653 
    LD  HL,SINTBL                       ;4d2e  21 0b 4e     11635  11654 
    ADD HL,DE                           ;4d31  19           11636  11655 
    LD  A,(HL)                          ;4d32  7e           11637  11656 
    INC HL                              ;4d33  23           11638  11657 
    LD  H,(HL)                          ;4d34  66           11639  11658 
    LD  L,A                             ;4d35  6f           11640  11659 
    INC B                               ;4d36  04           11641  11660 
    JR  NZ,SINXOK                       ;4d37  20 08        11642  11661 
    PUSH    DE                          ;4d39  d5           11643  11662 
    LD  DE,0                            ;4d3a  11 00 00     11644  11663 
    EX  DE,HL                           ;4d3d  eb           11645  11664 
    SBC HL,DE                           ;4d3e  ed 52        11646  11665 
    POP DE                              ;4d40  d1           11647  11666 
SINXOK: LD  (XMULLO+1),HL               ;4d41  22 61 4d     11648  11667 
    LD  HL,COSTBL                       ;4d44  21 bf 4e     11649  11668 
    OR  A                               ;4d47  b7           11650  11669 
    SBC HL,DE                           ;4d48  ed 52        11651  11670 
    LD  A,(HL)                          ;4d4a  7e           11652  11671 
    INC HL                              ;4d4b  23           11653  11672 
    LD  H,(HL)                          ;4d4c  66           11654  11673 
    LD  L,A                             ;4d4d  6f           11655  11674 
    INC C                               ;4d4e  0c           11656  11675 
    JR  NZ,SINYOK                       ;4d4f  20 08        11657  11676 
    PUSH    DE                          ;4d51  d5           11658  11677 
    LD  DE,0                            ;4d52  11 00 00     11659  11678 
    EX  DE,HL                           ;4d55  eb           11660  11679 
    SBC HL,DE                           ;4d56  ed 52        11661  11680 
    POP DE                              ;4d58  d1           11662  11681 
SINYOK: LD  (YMULLO+1),HL               ;4d59  22 6f 4d     11663  11682 
XMULHI: LD  L,0                         ;4d5c  2e 00        11664  11683 
    LD  H,L                             ;4d5e  65           11665  11684 
    EXX                                 ;4d5f  d9           11666  11685 
XMULLO: LD  HL,0                        ;4d60  21 00 00     11667  11686 
    EXX                                 ;4d63  d9           11668  11687 
    CALL    DEHLMX                      ;4d64  cd ca 4d     11669  11688 
    LD  (SINXAD+1),HL                   ;4d67  22 9b 4d     11670  11689 
YMULHI: LD  L,0                         ;4d6a  2e 00        11671  11690 
    LD  H,L                             ;4d6c  65           11672  11691 
    EXX                                 ;4d6d  d9           11673  11692 
YMULLO: LD  HL,0                        ;4d6e  21 00 00     11674  11693 
    EXX                                 ;4d71  d9           11675  11694 
    CALL    DEHLMY                      ;4d72  cd d0 4d     11676  11695 
    LD  (SINYAD+1),HL                   ;4d75  22 a9 4d     11677  11696 
    JR  SINXAD                          ;4d78  18 20        11678  11697 
SIN00:  LD  BC,00100H                   ;4d7a  01 00 01     11679  11698 ;X=1,Y=0
    JR  SINJST                          ;4d7d  18 0d        11680  11699 
SIN90:  LD  BC,000FFh                   ;4d7f  01 ff 00     11681  11700 ;X=0,Y=-1
    JR  SINJST                          ;4d82  18 08        11682  11701 
SIN180: LD  BC,0FF00h                   ;4d84  01 00 ff     11683  11702 ;X=0,Y=0
    JR  SINJST                          ;4d87  18 03        11684  11703 
SIN270: LD  BC,00001h                   ;4d89  01 01 00     11685  11704 ;X=0,Y=1
SINJST: LD  A,B                         ;4d8c  78           11686  11705 
    CALL    RMULAX                      ;4d8d  cd bb 4d     11687  11706 
    LD  (SINXAD+1),HL                   ;4d90  22 9b 4d     11688  11707 
    LD  A,C                             ;4d93  79           11689  11708 
    CALL    RMULAY                      ;4d94  cd b0 4d     11690  11709 
    LD  (SINYAD+1),HL                   ;4d97  22 a9 4d     11691  11710 
SINXAD: LD  HL,00000h                   ;4d9a  21 00 00     11692  11711 ;ADD X
WIDTH3: NOP                             ;4d9d  00           11693  11712 ;40/ADD HL,HL
SINSX:                                  ;                   11694  11713 
    LD  DE,00000h                       ;4d9e  11 00 00     11695  11714 ;CENTER X
    ADD HL,DE                           ;4da1  19           11696  11715 
    LD  (LINEXE+1),HL                   ;4da2  22 45 4a     11697  11716 
SINSY:  LD  HL,00000h                   ;4da5  21 00 00     11698  11717 ;CENTER Y
SINYAD: LD  DE,00000h                   ;4da8  11 00 00     11699  11718 ;ADD Y
    ADD HL,DE                           ;4dab  19           11700  11719 
    LD  (LINEYE+1),HL                   ;4dac  22 62 4a     11701  11720 
    RET                                 ;4daf  c9           11702  11721 
                                        ;                   11703  11722 ;
RMULAY: LD  HL,0                        ;4db0  21 00 00     11704  11723 
    OR  A                               ;4db3  b7           11705  11724 
    RET Z                               ;4db4  c8           11706  11725 
    EX  DE,HL                           ;4db5  eb           11707  11726 
    LD  HL,(SINRY+1)                    ;4db6  2a d2 4d     11708  11727 
    JR  RMULXY                          ;4db9  18 09        11709  11728 
RMULAX: LD  HL,0                        ;4dbb  21 00 00     11710  11729 
    OR  A                               ;4dbe  b7           11711  11730 
    RET Z                               ;4dbf  c8           11712  11731 
    EX  DE,HL                           ;4dc0  eb           11713  11732 
    LD  HL,(SINRX+1)                    ;4dc1  2a cc 4d     11714  11733 
RMULXY: INC A                           ;4dc4  3c           11715  11734 
    RET NZ                              ;4dc5  c0           11716  11735 
    EX  DE,HL                           ;4dc6  eb           11717  11736 
    SBC HL,DE                           ;4dc7  ed 52        11718  11737 
    RET                                 ;4dc9  c9           11719  11738 
                                        ;                   11720  11739 ;
DEHLMX: EXX                             ;4dca  d9           11721  11740 
SINRX:  LD  BC,00001h                   ;4dcb  01 01 00     11722  11741 ;XR
    JR  DEHLMS                          ;4dce  18 04        11723  11742 
DEHLMY: EXX                             ;4dd0  d9           11724  11743 
SINRY:  LD  BC,00001h                   ;4dd1  01 01 00     11725  11744 ;YR
DEHLMS: LD  DE,0                        ;4dd4  11 00 00     11726  11745 
    EXX                                 ;4dd7  d9           11727  11746 
    LD  B,16                            ;4dd8  06 10        11728  11747 
    LD  DE,0                            ;4dda  11 00 00     11729  11748 
MULOP1: EXX                             ;4ddd  d9           11730  11749 
    EX  DE,HL                           ;4dde  eb           11731  11750 
    ADD HL,HL                           ;4ddf  29           11732  11751 
    EX  DE,HL                           ;4de0  eb           11733  11752 
    EXX                                 ;4de1  d9           11734  11753 
    EX  DE,HL                           ;4de2  eb           11735  11754 
    ADC HL,HL                           ;4de3  ed 6a        11736  11755 
    EX  DE,HL                           ;4de5  eb           11737  11756 
    EXX                                 ;4de6  d9           11738  11757 
    SLA C                               ;4de7  cb 21        11739  11758 
    RL  B                               ;4de9  cb 10        11740  11759 
    JR  NC,MULOP2                       ;4deb  30 09        11741  11760 
    EX  DE,HL                           ;4ded  eb           11742  11761 
    ADD HL,DE                           ;4dee  19           11743  11762 
    EX  DE,HL                           ;4def  eb           11744  11763 
    EXX                                 ;4df0  d9           11745  11764 
    EX  DE,HL                           ;4df1  eb           11746  11765 
    ADC HL,DE                           ;4df2  ed 5a        11747  11766 
    EX  DE,HL                           ;4df4  eb           11748  11767 
    EXX                                 ;4df5  d9           11749  11768 
MULOP2: EXX                             ;4df6  d9           11750  11769 
    DJNZ    MULOP1                      ;4df7  10 e4        11751  11770 
    LD  A,080h                          ;4df9  3e 80        11752  11771 
    BIT 7,D                             ;4dfb  cb 7a        11753  11772 
    EXX                                 ;4dfd  d9           11754  11773 
    JR  Z,MULOP3                        ;4dfe  28 01        11755  11774 
    CPL                                 ;4e00  2f           11756  11775 
MULOP3: LD  H,A                         ;4e01  67           11757  11776 
    LD  L,A                             ;4e02  6f           11758  11777 
    ADD HL,DE                           ;4e03  19           11759  11778 
    EXX                                 ;4e04  d9           11760  11779 
    LD  HL,0                            ;4e05  21 00 00     11761  11780 
    ADC HL,DE                           ;4e08  ed 5a        11762  11781 
    RET                                 ;4e0a  c9           11763  11782 
                                        ;                   11764  11783 ;
SINTBL: DEFW    0                       ;4e0b  00 00        11765  11784 
    DEFW    00478H                      ;4e0d  78 04        11766  11785 
    DEFW    008F0H                      ;4e0f  f0 08        11767  11786 
    DEFW    00D66H                      ;4e11  66 0d        11768  11787 
    DEFW    011DCH                      ;4e13  dc 11        11769  11788 
    DEFW    01650H                      ;4e15  50 16        11770  11789 
    DEFW    01AC3H                      ;4e17  c3 1a        11771  11790 
    DEFW    01F33H                      ;4e19  33 1f        11772  11791 
    DEFW    023A1H                      ;4e1b  a1 23        11773  11792 
    DEFW    0280CH                      ;4e1d  0c 28        11774  11793 
    DEFW    02C75H                      ;4e1f  75 2c        11775  11794 
    DEFW    030D9H                      ;4e21  d9 30        11776  11795 
    DEFW    0353AH                      ;4e23  3a 35        11777  11796 
    DEFW    03997H                      ;4e25  97 39        11778  11797 
    DEFW    03DEFH                      ;4e27  ef 3d        11779  11798 
    DEFW    04242H                      ;4e29  42 42        11780  11799 
    DEFW    04691H                      ;4e2b  91 46        11781  11800 
    DEFW    04AD9H                      ;4e2d  d9 4a        11782  11801 
    DEFW    04F1CH                      ;4e2f  1c 4f        11783  11802 
    DEFW    05359H                      ;4e31  59 53        11784  11803 
    DEFW    0578FH                      ;4e33  8f 57        11785  11804 
    DEFW    05BBEH                      ;4e35  be 5b        11786  11805 
    DEFW    05FE7H                      ;4e37  e7 5f        11787  11806 
    DEFW    06407H                      ;4e39  07 64        11788  11807 
    DEFW    06820H                      ;4e3b  20 68        11789  11808 
    DEFW    06C2FH                      ;4e3d  2f 6c        11790  11809 
    DEFW    07039H                      ;4e3f  39 70        11791  11810 
    DEFW    07439H                      ;4e41  39 74        11792  11811 
    DEFW    07830H                      ;4e43  30 78        11793  11812 
    DEFW    07C1DH                      ;4e45  1d 7c        11794  11813 
    DEFW    08000H                      ;4e47  00 80        11795  11814 
    DEFW    083DAH                      ;4e49  da 83        11796  11815 
    DEFW    087A9H                      ;4e4b  a9 87        11797  11816 
    DEFW    08B6EH                      ;4e4d  6e 8b        11798  11817 
    DEFW    08F28H                      ;4e4f  28 8f        11799  11818 
    DEFW    092D6H                      ;4e51  d6 92        11800  11819 
    DEFW    09679H                      ;4e53  79 96        11801  11820 
    DEFW    09A11H                      ;4e55  11 9a        11802  11821 
    DEFW    09D9CH                      ;4e57  9c 9d        11803  11822 
    DEFW    0A11BH                      ;4e59  1b a1        11804  11823 
    DEFW    0A48EH                      ;4e5b  8e a4        11805  11824 
    DEFW    0A7F4H                      ;4e5d  f4 a7        11806  11825 
    DEFW    0AB4CH                      ;4e5f  4c ab        11807  11826 
    DEFW    0AE98H                      ;4e61  98 ae        11808  11827 
    DEFW    0B1F0H                      ;4e63  f0 b1        11809  11828 
    DEFW    0B58BH                      ;4e65  8b b5        11810  11829 
    DEFW    0B840H                      ;4e67  40 b8        11811  11830 
    DEFW    0BB50H                      ;4e69  50 bb        11812  11831 
    DEFW    0BE3FH                      ;4e6b  3f be        11813  11832 
    DEFW    0C135H                      ;4e6d  35 c1        11814  11833 
    DEFW    0C41CH                      ;4e6f  1c c4        11815  11834 
    DEFW    0C6F3H                      ;4e71  f3 c6        11816  11835 
    DEFW    0C9BBH                      ;4e73  bb c9        11817  11836 
    DEFW    0CC74H                      ;4e75  74 cc        11818  11837 
    DEFW    0CF1CH                      ;4e77  1c cf        11819  11838 
    DEFW    0D1B4H                      ;4e79  b4 d1        11820  11839 
    DEFW    0D43CH                      ;4e7b  3c d4        11821  11840 
    DEFW    0D6B3H                      ;4e7d  b3 d6        11822  11841 
    DEFW    0D91AH                      ;4e7f  1a d9        11823  11842 
    DEFW    0DB70H                      ;4e81  70 db        11824  11843 
    DEFW    0DDB4H                      ;4e83  b4 dd        11825  11844 
    DEFW    0DF40H                      ;4e85  40 df        11826  11845 
    DEFW    0E1E0H                      ;4e87  e0 e1        11827  11846 
    DEFW    0E497H                      ;4e89  97 e4        11828  11847 
    DEFW    0E61BH                      ;4e8b  1b e6        11829  11848 
    DEFW    0E804H                      ;4e8d  04 e8        11830  11849 
    DEFW    0E9DEH                      ;4e8f  de e9        11831  11850 
    DEFW    0EBA7H                      ;4e91  a7 eb        11832  11851 
    DEFW    0ED5CH                      ;4e93  5c ed        11833  11852 
    DEFW    0EEFFH                      ;4e95  ff ee        11834  11853 
    DEFW    0F090H                      ;4e97  90 f0        11835  11854 
    DEFW    0F20EH                      ;4e99  0e f2        11836  11855 
    DEFW    0F379H                      ;4e9b  79 f3        11837  11856 
    DEFW    0F4D1H                      ;4e9d  d1 f4        11838  11857 
    DEFW    0F616H                      ;4e9f  16 f6        11839  11858 
    DEFW    0F747H                      ;4ea1  47 f7        11840  11859 
    DEFW    0F866H                      ;4ea3  66 f8        11841  11860 
    DEFW    0F971H                      ;4ea5  71 f9        11842  11861 
    DEFW    0FA68H                      ;4ea7  68 fa        11843  11862 
    DEFW    0FB4CH                      ;4ea9  4c fb        11844  11863 
    DEFW    0FC1DH                      ;4eab  1d fc        11845  11864 
    DEFW    0FCD9H                      ;4ead  d9 fc        11846  11865 
    DEFW    0FD83H                      ;4eaf  83 fd        11847  11866 
    DEFW    0FE18H                      ;4eb1  18 fe        11848  11867 
    DEFW    0FE99H                      ;4eb3  99 fe        11849  11868 
    DEFW    0FF07H                      ;4eb5  07 ff        11850  11869 
    DEFW    0FF61H                      ;4eb7  61 ff        11851  11870 
    DEFW    0FFA7H                      ;4eb9  a7 ff        11852  11871 
    DEFW    0FFD8H                      ;4ebb  d8 ff        11853  11872 
    DEFW    0FFF6H                      ;4ebd  f6 ff        11854  11873 
COSTBL: DEFW    0                       ;4ebf  00 00        11855  11874 
                                        ;                   11856  11875 ;
PAINT:  LD  C,L                         ;4ec1  4d           11857  11876 
    LD  B,H                             ;4ec2  44           11858  11877 
    CALL    SETXY2                      ;4ec3  cd 61 49     11859  11878 
    PUSH    HL                          ;4ec6  e5           11860  11879 ;Y
    PUSH    DE                          ;4ec7  d5           11861  11880 ;X
    LD  HL,PACOLB                       ;4ec8  21 1f 50     11862  11881 
    LD  D,9                             ;4ecb  16 09        11863  11882 
    LD  A,(COLORF)                      ;4ecd  3a 80 11     11864  11883 
    LD  (HL),A                          ;4ed0  77           11865  11884 
    CALL    PACOLS                      ;4ed1  cd 03 4f     11866  11885 
    LD  HL,PACOLB                       ;4ed4  21 1f 50     11867  11886 
    LD  E,8                             ;4ed7  1e 08        11868  11887 
    LD  A,(HL)                          ;4ed9  7e           11869  11888 
PACINT: INC HL                          ;4eda  23           11870  11889 
    LD  (HL),A                          ;4edb  77           11871  11890 
    DEC E                               ;4edc  1d           11872  11891 
    JR  NZ,PACINT                       ;4edd  20 fb        11873  11892 
    LD  HL,PACOLB+1                     ;4edf  21 20 50     11874  11893 
    JR  L3AD1                           ;4ee2  18 03        11875  11894 
PACOSL: CALL    PACOLS                  ;4ee4  cd 03 4f     11876  11895 
L3AD1:  DEC D                           ;4ee7  15           11877  11896 
    JR  NZ,PACOSL                       ;4ee8  20 fa        11878  11897 
    LD  HL,PSETSB                       ;4eea  21 0c 48     11879  11898 
    LD  (BOXMD+1),HL                    ;4eed  22 4f 4b     11880  11899 
    LD  A,013h                          ;4ef0  3e 13        11881  11900 
    LD  (XBOXAD),A                      ;4ef2  32 55 4b     11882  11901 
    LD  A,(PACOLB)                      ;4ef5  3a 1f 50     11883  11902 
    LD  (GCOLOR),A                      ;4ef8  32 81 11     11884  11903 
    POP DE                              ;4efb  d1           11885  11904 
    POP HL                              ;4efc  e1           11886  11905 
    PUSH    BC                          ;4efd  c5           11887  11906 
    CALL    PAINTS                      ;4efe  cd 1f 4f     11888  11907 
    POP HL                              ;4f01  e1           11889  11908 
    RET                                 ;4f02  c9           11890  11909 
                                        ;                   11891  11910 ;
PACOLS: CALL    EDCEK                   ;4f03  cd 6f 49     11892  11911 
    JR  Z,PACEND                        ;4f06  28 14        11893  11912 
    CALL    CH2CH                       ;4f08  cd 61 2d     11894  11913 
    INC BC                              ;4f0b  03           11895  11914 
    PUSH    DE                          ;4f0c  d5           11896  11915 
    PUSH    HL                          ;4f0d  e5           11897  11916 
    CALL    IBYTE                       ;4f0e  cd df 22     11898  11917 
    POP HL                              ;4f11  e1           11899  11918 
    POP DE                              ;4f12  d1           11900  11919 
    CP  9                               ;4f13  fe 09        11901  11920 
    JP  NC,IFCALL                       ;4f15  d2 36 17     11902  11921 
    LD  (HL),A                          ;4f18  77           11903  11922 
    INC HL                              ;4f19  23           11904  11923 
    DEC BC                              ;4f1a  0b           11905  11924 
    RET                                 ;4f1b  c9           11906  11925 
PACEND: LD  D,1                         ;4f1c  16 01        11907  11926 
    RET                                 ;4f1e  c9           11908  11927 
                                        ;                   11909  11928 ;
                                        ;                   11910  11929 ;
PAINTS: LD  BC,08000h                   ;4f1f  01 00 80     11911  11930 
    PUSH    BC                          ;4f22  c5           11912  11931 
    PUSH    HL                          ;4f23  e5           11913  11932 
    PUSH    DE                          ;4f24  d5           11914  11933 
                                        ;                   11915  11934 ;
PAIN01: POP DE                          ;4f25  d1           11916  11935 
    POP HL                              ;4f26  e1           11917  11936 
    XOR A                               ;4f27  af           11918  11937 
    CP  E                               ;4f28  bb           11919  11938 
    JR  NZ,PAIN02                       ;4f29  20 06        11920  11939 
    LD  A,080h                          ;4f2b  3e 80        11921  11940 
    CP  D                               ;4f2d  ba           11922  11941 
    JR  NZ,PAIN02                       ;4f2e  20 01        11923  11942 
    JP  (HL)                            ;4f30  e9           11924  11943 
                                        ;                   11925  11944 ;
PAIN02: CALL    POICEK                  ;4f31  cd 87 4f     11926  11945 
    JP  Z,PAIN01                        ;4f34  ca 25 4f     11927  11946 
PAIN03: DEC DE                          ;4f37  1b           11928  11947 ;X=X-1
    CALL    POICEK                      ;4f38  cd 87 4f     11929  11948 
    JR  NZ,PAIN03                       ;4f3b  20 fa        11930  11949 
    INC DE                              ;4f3d  13           11931  11950 
    LD  BC,00000h                       ;4f3e  01 00 00     11932  11951 ;FLG CLR
    PUSH    DE                          ;4f41  d5           11933  11952 
    EXX                                 ;4f42  d9           11934  11953 
    POP DE                              ;4f43  d1           11935  11954 ;DE'=STERT X (START의 오타?)
    EXX                                 ;4f44  d9           11936  11955 
PAIN11: CALL    POICEK                  ;4f45  cd 87 4f     11937  11956 
    JR  Z,PAIN04                        ;4f48  28 2d        11938  11957 
    DEC HL                              ;4f4a  2b           11939  11958 ;UP LINE CHECK
    CALL    POICEK                      ;4f4b  cd 87 4f     11940  11959 
    JR  Z,PAIN05                        ;4f4e  28 0c        11941  11960 
    DEC B                               ;4f50  05           11942  11961 
    JR  Z,PAIN06                        ;4f51  28 05        11943  11962 
    PUSH    HL                          ;4f53  e5           11944  11963 ;NEXT POINT SET
    PUSH    DE                          ;4f54  d5           11945  11964 
    CALL    MEMCHK                      ;4f55  cd b0 1e     11946  11965 ;SP CHK
PAIN06: LD  B,1                         ;4f58  06 01        11947  11966 ;UP FLAG SET
    JR  PAIN07                          ;4f5a  18 02        11948  11967 
PAIN05: LD  B,0                         ;4f5c  06 00        11949  11968 ;UP FLAG CLR
PAIN07: INC HL                          ;4f5e  23           11950  11969 ;
    INC HL                              ;4f5f  23           11951  11970 ;DOUN LINE CHECK (DOWN의 오타?)
    CALL    POICEK                      ;4f60  cd 87 4f     11952  11971 
    JR  Z,PAIN08                        ;4f63  28 0c        11953  11972 
    DEC C                               ;4f65  0d           11954  11973 
    JR  Z,PAIN09                        ;4f66  28 05        11955  11974 
    PUSH    HL                          ;4f68  e5           11956  11975 ;NEXT POINT SET
    PUSH    DE                          ;4f69  d5           11957  11976 
    CALL    MEMCHK                      ;4f6a  cd b0 1e     11958  11977 ;SP CHK
PAIN09: LD  C,1                         ;4f6d  0e 01        11959  11978 ;DOUN FLG SET
    JR  PAIN10                          ;4f6f  18 02        11960  11979 
PAIN08: LD  C,0                         ;4f71  0e 00        11961  11980 ;DOUN FLG CLR
PAIN10: DEC HL                          ;4f73  2b           11962  11981 
    INC DE                              ;4f74  13           11963  11982 ;X=X+1
    JR  PAIN11                          ;4f75  18 ce        11964  11983 
                                        ;                   11965  11984 ;
PAIN04: PUSH    HL                      ;4f77  e5           11966  11985 
    PUSH    DE                          ;4f78  d5           11967  11986 
    EXX                                 ;4f79  d9           11968  11987 
    POP HL                              ;4f7a  e1           11969  11988 
    OR  A                               ;4f7b  b7           11970  11989 
    SBC HL,DE                           ;4f7c  ed 52        11971  11990 
    LD  C,L                             ;4f7e  4d           11972  11991 
    LD  B,H                             ;4f7f  44           11973  11992 
    POP HL                              ;4f80  e1           11974  11993 
    CALL    LINEX                       ;4f81  cd 56 4b     11975  11994 
    JP  PAIN01                          ;4f84  c3 25 4f     11976  11995 
                                        ;                   11977  11996 ;
POICEK: PUSH    BC                      ;4f87  c5           11978  11997 
    PUSH    DE                          ;4f88  d5           11979  11998 
    PUSH    HL                          ;4f89  e5           11980  11999 
    CALL    CULADR                      ;4f8a  cd 23 48     11981  12000 
    JR  C,POIZER                        ;4f8d  38 0a        11982  12001 
    EX  DE,HL                           ;4f8f  eb           11983  12002 
    LD  BC,POITBL                       ;4f90  01 9e 4f     11984  12003 
    ADD HL,BC                           ;4f93  09           11985  12004 
    LD  C,(HL)                          ;4f94  4e           11986  12005 
    INC HL                              ;4f95  23           11987  12006 
    LD  B,(HL)                          ;4f96  46           11988  12007 
    PUSH    BC                          ;4f97  c5           11989  12008 
    RET                                 ;4f98  c9           11990  12009 
                                        ;                   11991  12010 ;
POIZER: XOR A                           ;4f99  af           11992  12011 
POINRT: POP HL                          ;4f9a  e1           11993  12012 
    POP DE                              ;4f9b  d1           11994  12013 
    POP BC                              ;4f9c  c1           11995  12014 
    RET                                 ;4f9d  c9           11996  12015 
                                        ;                   11997  12016 ;
POITBL: DEFW    POIST0                  ;4f9e  a6 4f        11998  12017 
    DEFW    POIST1                      ;4fa0  cf 4f        11999  12018 
    DEFW    POIST3                      ;4fa2  f4 4f        12000  12019 
    DEFW    POIST5                      ;4fa4  0c 50        12001  12020 
                                        ;                   12002  12021 ;
POIST0: LD  C,E                         ;4fa6  4b           12003  12022 
    LD  B,D                             ;4fa7  42           12004  12023 
    IN  E,(C)                           ;4fa8  ed 58        12005  12024 
    RLCA                                ;4faa  07           12006  12025 
    RLCA                                ;4fab  07           12007  12026 
    RLCA                                ;4fac  07           12008  12027 
    AND 038h                            ;4fad  e6 38        12009  12028 
    ADD A,043h                          ;4faf  c6 43        12010  12029 
    LD  (BTTST1+1),A                    ;4fb1  32 b6 4f     12011  12030 
    XOR A                               ;4fb4  af           12012  12031 
BTTST1: BIT 0,E                         ;4fb5  cb 43        12013  12032 
    JR  Z,POINCK                        ;4fb7  28 08        12014  12033 
    LD  A,E                             ;4fb9  7b           12015  12034 
    RRCA                                ;4fba  0f           12016  12035 
    RRCA                                ;4fbb  0f           12017  12036 
    RRCA                                ;4fbc  0f           12018  12037 
    RRCA                                ;4fbd  0f           12019  12038 
    AND 00Fh                            ;4fbe  e6 0f        12020  12039 
    INC A                               ;4fc0  3c           12021  12040 
POINCK: LD  HL,PACOLB                   ;4fc1  21 1f 50     12022  12041 
    LD  B,9                             ;4fc4  06 09        12023  12042 
POINC1: CP  (HL)                        ;4fc6  be           12024  12043 
    JR  Z,POICKR                        ;4fc7  28 03        12025  12044 
    INC HL                              ;4fc9  23           12026  12045 
    DJNZ    POINC1                      ;4fca  10 fa        12027  12046 
POICKR: JP  POINRT                      ;4fcc  c3 9a 4f     12028  12047 
                                        ;                   12029  12048 ;
POIST1: LD  C,E                         ;4fcf  4b           12030  12049 
    LD  B,D                             ;4fd0  42           12031  12050 
    IN  E,(C)                           ;4fd1  ed 58        12032  12051 
    RLCA                                ;4fd3  07           12033  12052 
    RLCA                                ;4fd4  07           12034  12053 
    RLCA                                ;4fd5  07           12035  12054 
    AND 038h                            ;4fd6  e6 38        12036  12055 
    ADD A,043h                          ;4fd8  c6 43        12037  12056 
    LD  (BTTST2+1),A                    ;4fda  32 df 4f     12038  12057 
    XOR A                               ;4fdd  af           12039  12058 
BTTST2: BIT 0,E                         ;4fde  cb 43        12040  12059 
    JR  Z,POINCK                        ;4fe0  28 df        12041  12060 
    LD  A,E                             ;4fe2  7b           12042  12061 
    RLCA                                ;4fe3  07           12043  12062 
    RLCA                                ;4fe4  07           12044  12063 
    AND 3                               ;4fe5  e6 03        12045  12064 
    INC A                               ;4fe7  3c           12046  12065 
    SET 3,B                             ;4fe8  cb d8        12047  12066 
    IN  D,(C)                           ;4fea  ed 50        12048  12067 
    BIT 1,D                             ;4fec  cb 4a        12049  12068 
    JR  Z,POINCK                        ;4fee  28 d1        12050  12069 
    ADD A,4                             ;4ff0  c6 04        12051  12070 
    JR  POINCK                          ;4ff2  18 cd        12052  12071 
                                        ;                   12053  12072 ;
POIST3: LD  C,E                         ;4ff4  4b           12054  12073 
    LD  B,D                             ;4ff5  42           12055  12074 
    IN  E,(C)                           ;4ff6  ed 58        12056  12075 
    AND 3                               ;4ff8  e6 03        12057  12076 
    JR  Z,POIS33                        ;4ffa  28 07        12058  12077 
POIS3L: RL  E                           ;4ffc  cb 13        12059  12078 
    RL  E                               ;4ffe  cb 13        12060  12079 
    DEC A                               ;5000  3d           12061  12080 
    JR  NZ,POIS3L                       ;5001  20 f9        12062  12081 
POIS33: XOR A                           ;5003  af           12063  12082 
    RL  E                               ;5004  cb 13        12064  12083 
    RLA                                 ;5006  17           12065  12084 
    RL  E                               ;5007  cb 13        12066  12085 
    RLA                                 ;5009  17           12067  12086 
    JR  POINCK                          ;500a  18 b5        12068  12087 
                                        ;                   12069  12088 ;
POIST5: LD  C,E                         ;500c  4b           12070  12089 
    LD  B,D                             ;500d  42           12071  12090 
    IN  E,(C)                           ;500e  ed 58        12072  12091 
    AND 7                               ;5010  e6 07        12073  12092 
    JR  Z,POIS55                        ;5012  28 05        12074  12093 
POIS5L: RL  E                           ;5014  cb 13        12075  12094 
    DEC A                               ;5016  3d           12076  12095 
    JR  NZ,POIS5L                       ;5017  20 fb        12077  12096 
POIS55: XOR A                           ;5019  af           12078  12097 
    RL  E                               ;501a  cb 13        12079  12098 
    RLA                                 ;501c  17           12080  12099 
    JR  POINCK                          ;501d  18 a2        12081  12100 
                                        ;                   12082  12101 ;
                                        ;                   12083  12102 ;
PACOLB: DEFS    9                       ;501f               12084  12103 
                                        ;                   12085  12104 ;
PATTEN: LD  A,(GMODEF)                  ;5028  3a 06 1c     12086  12105 
    CP  4                               ;502b  fe 04        12087  12106 
    JP  C,IFCALL                        ;502d  da 36 17     12088  12107 
    LD  C,L                             ;5030  4d           12089  12108 
    LD  B,H                             ;5031  44           12090  12109 
    CALL    SETXY2                      ;5032  cd 61 49     12091  12110 
    CALL    CH2CH                       ;5035  cd 61 2d     12092  12111 
    LD  (PATX+1),DE                     ;5038  ed 53 73 50  12093  12112 
    LD  (PATY+1),HL                     ;503c  22 79 50     12094  12113 
    INC BC                              ;503f  03           12095  12114 
    CALL    IHLEXP                      ;5040  cd cc 22     12096  12115 
    CALL    CH2CH                       ;5043  cd 61 2d     12097  12116 
    LD  A,H                             ;5046  7c           12098  12117 
    OR  A                               ;5047  b7           12099  12118 
    LD  DE,0FFE0h                       ;5048  11 e0 ff     12100  12119 
    JR  Z,PATOK1                        ;504b  28 0c        12101  12120 
    CP  0FFh                            ;504d  fe ff        12102  12121 
    JP  NZ,IFCALL                       ;504f  c2 36 17     12103  12122 
    LD  DE,00020h                       ;5052  11 20 00     12104  12123 
    LD  A,L                             ;5055  7d           12105  12124 
    NEG                                 ;5056  ed 44        12106  12125 
    LD  L,A                             ;5058  6f           12107  12126 
PATOK1: LD  (PATYAD+1),DE               ;5059  ed 53 a6 50  12108  12127 
    LD  A,L                             ;505d  7d           12109  12128 
    OR  A                               ;505e  b7           12110  12129 
    JP  Z,IFCALL                        ;505f  ca 36 17     12111  12130 
    LD  (PATYLN+1),A                    ;5062  32 9d 50     12112  12131 
    CALL    STREXX                      ;5065  cd 9d 45     12113  12132 
    PUSH    BC                          ;5068  c5           12114  12133 
    LD  B,A                             ;5069  47           12115  12134 
    OR  A                               ;506a  b7           12116  12135 
    CALL    NZ,PATSUB                   ;506b  c4 71 50     12117  12136 
    POP HL                              ;506e  e1           12118  12137 
    DEC HL                              ;506f  2b           12119  12138 
    RET                                 ;5070  c9           12120  12139 
                                        ;                   12121  12140 ;
PATSUB: EXX                             ;5071  d9           12122  12141 
PATX:   LD  DE,0                        ;5072  11 00 00     12123  12142 
    LD  A,D                             ;5075  7a           12124  12143 
    OR  A                               ;5076  b7           12125  12144 
    RET NZ                              ;5077  c0           12126  12145 
PATY:   LD  HL,0                        ;5078  21 00 00     12127  12146 
    LD  A,H                             ;507b  7c           12128  12147 
    OR  A                               ;507c  b7           12129  12148 
    RET NZ                              ;507d  c0           12130  12149 
    LD  A,L                             ;507e  7d           12131  12150 
    CP  192                             ;507f  fe c0        12132  12151 
    RET NC                              ;5081  d0           12133  12152 
    ADD HL,HL                           ;5082  29           12134  12153 
    ADD HL,HL                           ;5083  29           12135  12154 
    ADD HL,HL                           ;5084  29           12136  12155 
    ADD HL,HL                           ;5085  29           12137  12156 
    ADD HL,HL                           ;5086  29           12138  12157 
    LD  A,E                             ;5087  7b           12139  12158 
    SRL E                               ;5088  cb 3b        12140  12159 
    SRL E                               ;508a  cb 3b        12141  12160 
    SRL E                               ;508c  cb 3b        12142  12161 
    ADD HL,DE                           ;508e  19           12143  12162 
    LD  C,L                             ;508f  4d           12144  12163 
    LD  B,H                             ;5090  44           12145  12164 
    AND 7                               ;5091  e6 07        12146  12165 
    LD  D,080h                          ;5093  16 80        12147  12166 
    JR  Z,PATYLN                        ;5095  28 05        12148  12167 
L3C81:  SRL D                           ;5097  cb 3a        12149  12168 
    DEC A                               ;5099  3d           12150  12169 
    JR  NZ,L3C81                        ;509a  20 fb        12151  12170 
PATYLN: LD  E,1                         ;509c  1e 01        12152  12171 
    PUSH    BC                          ;509e  c5           12153  12172 
PATLP1: EXX                             ;509f  d9           12154  12173 
    LD  A,(DE)                          ;50a0  1a           12155  12174 
    EXX                                 ;50a1  d9           12156  12175 
    CALL    PATST                       ;50a2  cd ba 50     12157  12176 
PATYAD: LD  HL,00020h                   ;50a5  21 20 00     12158  12177 
    ADD HL,BC                           ;50a8  09           12159  12178 
    LD  C,L                             ;50a9  4d           12160  12179 
    LD  B,H                             ;50aa  44           12161  12180 
    EXX                                 ;50ab  d9           12162  12181 
    INC DE                              ;50ac  13           12163  12182 
    DEC B                               ;50ad  05           12164  12183 
    JR  Z,PATEND                        ;50ae  28 08        12165  12184 
    EXX                                 ;50b0  d9           12166  12185 
    DEC E                               ;50b1  1d           12167  12186 
    JR  NZ,PATLP1                       ;50b2  20 eb        12168  12187 
    POP BC                              ;50b4  c1           12169  12188 
    INC BC                              ;50b5  03           12170  12189 
    JR  PATYLN                          ;50b6  18 e4        12171  12190 
PATEND: POP BC                          ;50b8  c1           12172  12191 
    RET                                 ;50b9  c9           12173  12192 
                                        ;                   12174  12193 ;
PATST:  PUSH    BC                      ;50ba  c5           12175  12194 
    PUSH    DE                          ;50bb  d5           12176  12195 
    LD  L,A                             ;50bc  6f           12177  12196 
    LD  H,8                             ;50bd  26 08        12178  12197 
PATSTL: RLC L                           ;50bf  cb 05        12179  12198 
    JR  NC,L3CB2                        ;50c1  30 05        12180  12199 
    IN  A,(C)                           ;50c3  ed 78        12181  12200 
    OR  D                               ;50c5  b2           12182  12201 
    OUT (C),A                           ;50c6  ed 79        12183  12202 
L3CB2:  RRC D                           ;50c8  cb 0a        12184  12203 
    JR  NC,L3CB7                        ;50ca  30 01        12185  12204 
    INC BC                              ;50cc  03           12186  12205 
L3CB7:  DEC H                           ;50cd  25           12187  12206 
    JR  NZ,PATSTL                       ;50ce  20 ef        12188  12207 
    POP DE                              ;50d0  d1           12189  12208 
    POP BC                              ;50d1  c1           12190  12209 
    RET                                 ;50d2  c9           12191  12210 
                                        ;                   12192  12211 ;
                                        ;                   12193  12212 ;
                                        ;                   12194  12213 ;
HCOPY:  PUSH    HL                      ;50d3  e5           12195  12214 
    LD  A,01Bh                          ;50d4  3e 1b        12196  12215 ;ESC
    CALL    PRINTR                      ;50d6  cd 87 08     12197  12216 
    LD  A,041h                          ;50d9  3e 41        12198  12217 ;A
    CALL    PRINTR                      ;50db  cd 87 08     12199  12218 
    LD  A,007h                          ;50de  3e 07        12200  12219 ;7
    CALL    PRINTR                      ;50e0  cd 87 08     12201  12220 
    LD  A,(GMODEF)                      ;50e3  3a 06 1c     12202  12221 
    CP  2                               ;50e6  fe 02        12203  12222 
    JR  NC,COPYGM                       ;50e8  30 0c        12204  12223 
    LD  HL,COPYTX                       ;50ea  21 aa 51     12205  12224 
    LD  DE,COPYTA                       ;50ed  11 6f 51     12206  12225 
    LD  BC,(CHRSTA)                     ;50f0  ed 4b d6 0a  12207  12226 
    JR  COPYM4                          ;50f4  18 09        12208  12227 
COPYGM: LD  HL,COPYGR                   ;50f6  21 95 51     12209  12228 
    LD  DE,COPYGA                       ;50f9  11 6b 51     12210  12229 
    LD  BC,0                            ;50fc  01 00 00     12211  12230 
COPYM4: LD  (COPYM2+1),HL               ;50ff  22 10 51     12212  12231 
    LD  (COPYM3+1),DE                   ;5102  ed 53 4d 51  12213  12232 
    LD  D,0                             ;5106  16 00        12214  12233 
HCOPY1: CALL    PRTESC                  ;5108  cd 7e 51     12215  12234 
    LD  E,32                            ;510b  1e 20        12216  12235 
HCOPY2: PUSH    BC                      ;510d  c5           12217  12236 
    PUSH    DE                          ;510e  d5           12218  12237 
COPYM2: CALL    COPYGR                  ;510f  cd 95 51     12219  12238 
    LD  B,8                             ;5112  06 08        12220  12239 
HCOPY3: XOR A                           ;5114  af           12221  12240 
    RLCA                                ;5115  07           12222  12241 
    RLCA                                ;5116  07           12223  12242 
    RLC E                               ;5117  cb 03        12224  12243 
    JR  NC,L3D07                        ;5119  30 02        12225  12244 
    ADD A,3                             ;511b  c6 03        12226  12245 
L3D07:  RLCA                            ;511d  07           12227  12246 
    RLCA                                ;511e  07           12228  12247 
    RLC D                               ;511f  cb 02        12229  12248 
    JR  NC,L3D0F                        ;5121  30 02        12230  12249 
    ADD A,3                             ;5123  c6 03        12231  12250 
L3D0F:  RLCA                            ;5125  07           12232  12251 
    RLCA                                ;5126  07           12233  12252 
    RLC L                               ;5127  cb 05        12234  12253 
    JR  NC,L3D17                        ;5129  30 02        12235  12254 
    ADD A,3                             ;512b  c6 03        12236  12255 
L3D17:  RLCA                            ;512d  07           12237  12256 
    RLCA                                ;512e  07           12238  12257 
    RLC H                               ;512f  cb 04        12239  12258 
    JR  NC,L3D1F                        ;5131  30 02        12240  12259 
    ADD A,3                             ;5133  c6 03        12241  12260 
L3D1F:  EXX                             ;5135  d9           12242  12261 
    PUSH    AF                          ;5136  f5           12243  12262 
    CALL    PRINTR                      ;5137  cd 87 08     12244  12263 
    POP AF                              ;513a  f1           12245  12264 
    PUSH    AF                          ;513b  f5           12246  12265 
    CALL    PRINTR                      ;513c  cd 87 08     12247  12266 
    POP AF                              ;513f  f1           12248  12267 
    CALL    PRINTR                      ;5140  cd 87 08     12249  12268 
    EXX                                 ;5143  d9           12250  12269 
    DJNZ    HCOPY3                      ;5144  10 ce        12251  12270 
    POP DE                              ;5146  d1           12252  12271 
    POP BC                              ;5147  c1           12253  12272 
    INC BC                              ;5148  03           12254  12273 
    DEC E                               ;5149  1d           12255  12274 
    JR  NZ,HCOPY2                       ;514a  20 c1        12256  12275 
COPYM3: CALL    COPYGA                  ;514c  cd 6b 51     12257  12276 
    ADD HL,BC                           ;514f  09           12258  12277 
    LD  C,L                             ;5150  4d           12259  12278 
    LD  B,H                             ;5151  44           12260  12279 
    LD  A,00Ah                          ;5152  3e 0a        12261  12280 
    EXX                                 ;5154  d9           12262  12281 
    CALL    PRINTR                      ;5155  cd 87 08     12263  12282 
    EXX                                 ;5158  d9           12264  12283 
    INC D                               ;5159  14           12265  12284 
    LD  A,D                             ;515a  7a           12266  12285 
    CP  48                              ;515b  fe 30        12267  12286 
    JR  NZ,HCOPY1                       ;515d  20 a9        12268  12287 
    LD  A,01Bh                          ;515f  3e 1b        12269  12288 
    CALL    PRINTR                      ;5161  cd 87 08     12270  12289 
    LD  A,032h                          ;5164  3e 32        12271  12290 
    CALL    PRINTR                      ;5166  cd 87 08     12272  12291 
    POP HL                              ;5169  e1           12273  12292 
    RET                                 ;516a  c9           12274  12293 
                                        ;                   12275  12294 ;
COPYGA: LD  HL,00060h                   ;516b  21 60 00     12276  12295 
    RET                                 ;516e  c9           12277  12296 
                                        ;                   12278  12297 ;
COPYTA: LD  A,D                         ;516f  7a           12279  12298 
COPYTL: SUB 3                           ;5170  d6 03        12280  12299 
    JR  NC,COPYTL                       ;5172  30 fc        12281  12300 
    CP  0FFh                            ;5174  fe ff        12282  12301 
    LD  HL,0                            ;5176  21 00 00     12283  12302 
    RET Z                               ;5179  c8           12284  12303 
    LD  HL,0FFE0h                       ;517a  21 e0 ff     12285  12304 
    RET                                 ;517d  c9           12286  12305 
                                        ;                   12287  12306 ;
PRTESC: EXX                             ;517e  d9           12288  12307 
    LD  A,01Bh                          ;517f  3e 1b        12289  12308 
    CALL    PRINTR                      ;5181  cd 87 08     12290  12309 
    LD  A,04Ch                          ;5184  3e 4c        12291  12310 ;L
    CALL    PRINTR                      ;5186  cd 87 08     12292  12311 
    LD  A,0                             ;5189  3e 00        12293  12312 
    CALL    PRINTR                      ;518b  cd 87 08     12294  12313 
    LD  A,3                             ;518e  3e 03        12295  12314 
    CALL    PRINTR                      ;5190  cd 87 08     12296  12315 
    EXX                                 ;5193  d9           12297  12316 
    RET                                 ;5194  c9           12298  12317 
                                        ;                   12299  12318 ;
COPYGR: IN  E,(C)                       ;5195  ed 58        12300  12319 
    LD  A,020h                          ;5197  3e 20        12301  12320 
    ADD A,C                             ;5199  81           12302  12321 
    LD  C,A                             ;519a  4f           12303  12322 
    IN  D,(C)                           ;519b  ed 50        12304  12323 
    LD  A,020h                          ;519d  3e 20        12305  12324 
    ADD A,C                             ;519f  81           12306  12325 
    LD  C,A                             ;51a0  4f           12307  12326 
    IN  L,(C)                           ;51a1  ed 68        12308  12327 
    LD  A,020h                          ;51a3  3e 20        12309  12328 
    ADD A,C                             ;51a5  81           12310  12329 
    LD  C,A                             ;51a6  4f           12311  12330 
    IN  H,(C)                           ;51a7  ed 60        12312  12331 
    RET                                 ;51a9  c9           12313  12332 
                                        ;                   12314  12333 ;
                                        ;                   12315  12334 ;
                                        ;                   12316  12335 ;
COPYTX: IN  H,(C)                       ;51aa  ed 60        12317  12336 
    SET 3,B                             ;51ac  cb d8        12318  12337 
    IN  A,(C)                           ;51ae  ed 78        12319  12338 
    AND 00Fh                            ;51b0  e6 0f        12320  12339 
    SUB 4                               ;51b2  d6 04        12321  12340 
    JR  C,ROMTX                         ;51b4  38 3f        12322  12341 
    SUB 4                               ;51b6  d6 04        12323  12342 
    JR  C,LGR22                         ;51b8  38 1d        12324  12343 
    SUB 4                               ;51ba  d6 04        12325  12344 
    JR  C,RAMTX                         ;51bc  38 53        12326  12345 
    LD  A,D                             ;51be  7a           12327  12346 
SUB3L:  SUB 3                           ;51bf  d6 03        12328  12347 
    JR  NC,SUB3L                        ;51c1  30 fc        12329  12348 
    ADD A,3                             ;51c3  c6 03        12330  12349 
    LD  B,A                             ;51c5  47           12331  12350 
    INC B                               ;51c6  04           12332  12351 
    JR  L3DB7                           ;51c7  18 04        12333  12352 
LGR23L: RRC H                           ;51c9  cb 0c        12334  12353 
    RRC H                               ;51cb  cb 0c        12335  12354 
L3DB7:  DJNZ    LGR23L                  ;51cd  10 fa        12336  12355 
LGR223: CALL    RRCHAS                  ;51cf  cd 3d 52     12337  12356 
    LD  E,A                             ;51d2  5f           12338  12357 
    LD  D,A                             ;51d3  57           12339  12358 
    LD  L,A                             ;51d4  6f           12340  12359 
    LD  H,A                             ;51d5  67           12341  12360 
    RET                                 ;51d6  c9           12342  12361 
                                        ;                   12343  12362 ;
LGR22:  LD  A,D                         ;51d7  7a           12344  12363 
SUB3L1: SUB 3                           ;51d8  d6 03        12345  12364 
    JR  NC,SUB3L1                       ;51da  30 fc        12346  12365 
    ADD A,3                             ;51dc  c6 03        12347  12366 
    JR  Z,LGR223                        ;51de  28 ef        12348  12367 
    CP  2                               ;51e0  fe 02        12349  12368 
    JR  NZ,LGR232                       ;51e2  20 06        12350  12369 
    RRC H                               ;51e4  cb 0c        12351  12370 
    RRC H                               ;51e6  cb 0c        12352  12371 
    JR  LGR223                          ;51e8  18 e5        12353  12372 
LGR232: CALL    RRCHAS                  ;51ea  cd 3d 52     12354  12373 
    LD  E,A                             ;51ed  5f           12355  12374 
    LD  D,A                             ;51ee  57           12356  12375 
    CALL    RRCHAS                      ;51ef  cd 3d 52     12357  12376 
    LD  L,A                             ;51f2  6f           12358  12377 
    LD  H,A                             ;51f3  67           12359  12378 
    RET                                 ;51f4  c9           12360  12379 
                                        ;                   12361  12380 ;
ROMTX:  LD  A,H                         ;51f5  7c           12362  12381 
    AND 07Fh                            ;51f6  e6 7f        12363  12382 
    SUB 020h                            ;51f8  d6 20        12364  12383 
    JR  NC,L3DE7                        ;51fa  30 01        12365  12384 
    XOR A                               ;51fc  af           12366  12385 
L3DE7:  LD  H,A                         ;51fd  67           12367  12386 
    CALL    TXCULC                      ;51fe  cd 26 52     12368  12387 
    LD  D,0                             ;5201  16 00        12369  12388 
    ADD HL,DE                           ;5203  19           12370  12389 
    LD  DE,CGCHR                        ;5204  11 4a 52     12371  12390 
    ADD HL,DE                           ;5207  19           12372  12391 
    LD  E,(HL)                          ;5208  5e           12373  12392 
    INC HL                              ;5209  23           12374  12393 
    LD  D,(HL)                          ;520a  56           12375  12394 
    INC HL                              ;520b  23           12376  12395 
    LD  A,(HL)                          ;520c  7e           12377  12396 
    INC HL                              ;520d  23           12378  12397 
    LD  H,(HL)                          ;520e  66           12379  12398 
    LD  L,A                             ;520f  6f           12380  12399 
    RET                                 ;5210  c9           12381  12400 
                                        ;                   12382  12401 ;
RAMTX:  CALL    TXCULC                  ;5211  cd 26 52     12383  12402 
    ADD HL,BC                           ;5214  09           12384  12403 
    LD  D,010h                          ;5215  16 10        12385  12404 
    ADD HL,DE                           ;5217  19           12386  12405 
    LD  C,L                             ;5218  4d           12387  12406 
    LD  B,H                             ;5219  44           12388  12407 
    IN  E,(C)                           ;521a  ed 58        12389  12408 
    INC BC                              ;521c  03           12390  12409 
    IN  D,(C)                           ;521d  ed 50        12391  12410 
    INC BC                              ;521f  03           12392  12411 
    IN  L,(C)                           ;5220  ed 68        12393  12412 
    INC BC                              ;5222  03           12394  12413 
    IN  H,(C)                           ;5223  ed 60        12395  12414 
    RET                                 ;5225  c9           12396  12415 
                                        ;                   12397  12416 ;
TXCULC: LD  A,D                         ;5226  7a           12398  12417 
SUB3L2: SUB 3                           ;5227  d6 03        12399  12418 
    JR  NC,SUB3L2                       ;5229  30 fc        12400  12419 
    ADD A,003h                          ;522b  c6 03        12401  12420 
    RLCA                                ;522d  07           12402  12421 
    RLCA                                ;522e  07           12403  12422 
    LD  E,A                             ;522f  5f           12404  12423 
    LD  A,H                             ;5230  7c           12405  12424 
    AND 07Fh                            ;5231  e6 7f        12406  12425 
    LD  L,A                             ;5233  6f           12407  12426 
    LD  H,0                             ;5234  26 00        12408  12427 
    ADD HL,HL                           ;5236  29           12409  12428 
    ADD HL,HL                           ;5237  29           12410  12429 
    LD  C,L                             ;5238  4d           12411  12430 
    LD  B,H                             ;5239  44           12412  12431 
    ADD HL,HL                           ;523a  29           12413  12432 
    ADD HL,BC                           ;523b  09           12414  12433 
    RET                                 ;523c  c9           12415  12434 
                                        ;                   12416  12435 ;
RRCHAS: XOR A                           ;523d  af           12417  12436 
    RRC H                               ;523e  cb 0c        12418  12437 
    JR  NC,L3E2E                        ;5240  30 02        12419  12438 
    LD  A,00Fh                          ;5242  3e 0f        12420  12439 
L3E2E:  RRC H                           ;5244  cb 0c        12421  12440 
    RET NC                              ;5246  d0           12422  12441 
    ADD A,0F0h                          ;5247  c6 f0        12423  12442 
    RET                                 ;5249  c9           12424  12443 
                                        ;                   12425  12444 
                                        ;                   12426  12445 ;
                                        ;                   12427  12446 ;	ORG	0524AH
                                        ;                   12428  12447 ;    
CGCHR:                                  ;                   12429  12448 
                                        ;                   12430  12449 ;CHR$(&H20)
    DEFB    000H                        ;524a  00           12431  12450 
    DEFB    000H                        ;524b  00           12432  12451 
    DEFB    000H                        ;524c  00           12433  12452 
    DEFB    000H                        ;524d  00           12434  12453 
    DEFB    000H                        ;524e  00           12435  12454 
    DEFB    000H                        ;524f  00           12436  12455 
    DEFB    000H                        ;5250  00           12437  12456 
    DEFB    000H                        ;5251  00           12438  12457 
    DEFB    000H                        ;5252  00           12439  12458 
    DEFB    000H                        ;5253  00           12440  12459 
    DEFB    000H                        ;5254  00           12441  12460 
    DEFB    000H                        ;5255  00           12442  12461 
                                        ;                   12443  12462 ;
                                        ;                   12444  12463 ;CHR$(&H21)
    DEFB    000H                        ;5256  00           12445  12464 
    DEFB    000H                        ;5257  00           12446  12465 
    DEFB    010H                        ;5258  10           12447  12466 
    DEFB    010H                        ;5259  10           12448  12467 
    DEFB    010H                        ;525a  10           12449  12468 
    DEFB    010H                        ;525b  10           12450  12469 
    DEFB    010H                        ;525c  10           12451  12470 
    DEFB    000H                        ;525d  00           12452  12471 
    DEFB    010H                        ;525e  10           12453  12472 
    DEFB    000H                        ;525f  00           12454  12473 
    DEFB    000H                        ;5260  00           12455  12474 
    DEFB    000H                        ;5261  00           12456  12475 
                                        ;                   12457  12476 ;
                                        ;                   12458  12477 ;CHR$(&H22)
    DEFB    000H                        ;5262  00           12459  12478 
    DEFB    000H                        ;5263  00           12460  12479 
    DEFB    028H                        ;5264  28           12461  12480 
    DEFB    028H                        ;5265  28           12462  12481 
    DEFB    028H                        ;5266  28           12463  12482 
    DEFB    000H                        ;5267  00           12464  12483 
    DEFB    000H                        ;5268  00           12465  12484 
    DEFB    000H                        ;5269  00           12466  12485 
    DEFB    000H                        ;526a  00           12467  12486 
    DEFB    000H                        ;526b  00           12468  12487 
    DEFB    000H                        ;526c  00           12469  12488 
    DEFB    000H                        ;526d  00           12470  12489 
                                        ;                   12471  12490 ;
                                        ;                   12472  12491 ;CHR$(&H23)
    DEFB    000H                        ;526e  00           12473  12492 
    DEFB    000H                        ;526f  00           12474  12493 
    DEFB    024H                        ;5270  24           12475  12494 
    DEFB    024H                        ;5271  24           12476  12495 
    DEFB    07EH                        ;5272  7e           12477  12496 
    DEFB    024H                        ;5273  24           12478  12497 
    DEFB    07EH                        ;5274  7e           12479  12498 
    DEFB    024H                        ;5275  24           12480  12499 
    DEFB    024H                        ;5276  24           12481  12500 
    DEFB    000H                        ;5277  00           12482  12501 
    DEFB    000H                        ;5278  00           12483  12502 
    DEFB    000H                        ;5279  00           12484  12503 
                                        ;                   12485  12504 ;
                                        ;                   12486  12505 ;CHR$(&H24)
    DEFB    000H                        ;527a  00           12487  12506 
    DEFB    000H                        ;527b  00           12488  12507 
    DEFB    010H                        ;527c  10           12489  12508 
    DEFB    03CH                        ;527d  3c           12490  12509 
    DEFB    050H                        ;527e  50           12491  12510 
    DEFB    038H                        ;527f  38           12492  12511 
    DEFB    014H                        ;5280  14           12493  12512 
    DEFB    078H                        ;5281  78           12494  12513 
    DEFB    010H                        ;5282  10           12495  12514 
    DEFB    000H                        ;5283  00           12496  12515 
    DEFB    000H                        ;5284  00           12497  12516 
    DEFB    000H                        ;5285  00           12498  12517 
                                        ;                   12499  12518 ;
                                        ;                   12500  12519 ;CHR$(&H25)
    DEFB    000H                        ;5286  00           12501  12520 
    DEFB    000H                        ;5287  00           12502  12521 
    DEFB    000H                        ;5288  00           12503  12522 
    DEFB    062H                        ;5289  62           12504  12523 
    DEFB    064H                        ;528a  64           12505  12524 
    DEFB    008H                        ;528b  08           12506  12525 
    DEFB    010H                        ;528c  10           12507  12526 
    DEFB    026H                        ;528d  26           12508  12527 
    DEFB    046H                        ;528e  46           12509  12528 
    DEFB    000H                        ;528f  00           12510  12529 
    DEFB    000H                        ;5290  00           12511  12530 
    DEFB    000H                        ;5291  00           12512  12531 
                                        ;                   12513  12532 ;
                                        ;                   12514  12533 ;CHR$(&H26)
    DEFB    000H                        ;5292  00           12515  12534 
    DEFB    000H                        ;5293  00           12516  12535 
    DEFB    030H                        ;5294  30           12517  12536 
    DEFB    048H                        ;5295  48           12518  12537 
    DEFB    048H                        ;5296  48           12519  12538 
    DEFB    030H                        ;5297  30           12520  12539 
    DEFB    04AH                        ;5298  4a           12521  12540 
    DEFB    044H                        ;5299  44           12522  12541 
    DEFB    03AH                        ;529a  3a           12523  12542 
    DEFB    000H                        ;529b  00           12524  12543 
    DEFB    000H                        ;529c  00           12525  12544 
    DEFB    000H                        ;529d  00           12526  12545 
                                        ;                   12527  12546 ;
                                        ;                   12528  12547 ;CHR$(&H27)	'
    DEFB    000H                        ;529e  00           12529  12548 
    DEFB    000H                        ;529f  00           12530  12549 
    DEFB    030H                        ;52a0  30           12531  12550 
    DEFB    010H                        ;52a1  10           12532  12551 
    DEFB    020H                        ;52a2  20           12533  12552 
    DEFB    000H                        ;52a3  00           12534  12553 
    DEFB    000H                        ;52a4  00           12535  12554 
    DEFB    000H                        ;52a5  00           12536  12555 
    DEFB    000H                        ;52a6  00           12537  12556 
    DEFB    000H                        ;52a7  00           12538  12557 
    DEFB    000H                        ;52a8  00           12539  12558 
    DEFB    000H                        ;52a9  00           12540  12559 
                                        ;                   12541  12560 ;
                                        ;                   12542  12561 ;CHR$(&H28)	(
    DEFB    000H                        ;52aa  00           12543  12562 
    DEFB    000H                        ;52ab  00           12544  12563 
    DEFB    008H                        ;52ac  08           12545  12564 
    DEFB    010H                        ;52ad  10           12546  12565 
    DEFB    020H                        ;52ae  20           12547  12566 
    DEFB    020H                        ;52af  20           12548  12567 
    DEFB    020H                        ;52b0  20           12549  12568 
    DEFB    010H                        ;52b1  10           12550  12569 
    DEFB    008H                        ;52b2  08           12551  12570 
    DEFB    000H                        ;52b3  00           12552  12571 
    DEFB    000H                        ;52b4  00           12553  12572 
    DEFB    000H                        ;52b5  00           12554  12573 
                                        ;                   12555  12574 ;
                                        ;                   12556  12575 ;CHR$(&H29)	)
    DEFB    000H                        ;52b6  00           12557  12576 
    DEFB    000H                        ;52b7  00           12558  12577 
    DEFB    020H                        ;52b8  20           12559  12578 
    DEFB    010H                        ;52b9  10           12560  12579 
    DEFB    008H                        ;52ba  08           12561  12580 
    DEFB    008H                        ;52bb  08           12562  12581 
    DEFB    008H                        ;52bc  08           12563  12582 
    DEFB    010H                        ;52bd  10           12564  12583 
    DEFB    020H                        ;52be  20           12565  12584 
    DEFB    000H                        ;52bf  00           12566  12585 
    DEFB    000H                        ;52c0  00           12567  12586 
    DEFB    000H                        ;52c1  00           12568  12587 
                                        ;                   12569  12588 ;
                                        ;                   12570  12589 ;CHR$(&H2A)	*
    DEFB    000H                        ;52c2  00           12571  12590 
    DEFB    000H                        ;52c3  00           12572  12591 
    DEFB    010H                        ;52c4  10           12573  12592 
    DEFB    054H                        ;52c5  54           12574  12593 
    DEFB    038H                        ;52c6  38           12575  12594 
    DEFB    07CH                        ;52c7  7c           12576  12595 
    DEFB    038H                        ;52c8  38           12577  12596 
    DEFB    054H                        ;52c9  54           12578  12597 
    DEFB    010H                        ;52ca  10           12579  12598 
    DEFB    000H                        ;52cb  00           12580  12599 
    DEFB    000H                        ;52cc  00           12581  12600 
    DEFB    000H                        ;52cd  00           12582  12601 
                                        ;                   12583  12602 ;
                                        ;                   12584  12603 ;CHR$(&H2B)	+
    DEFB    000H                        ;52ce  00           12585  12604 
    DEFB    000H                        ;52cf  00           12586  12605 
    DEFB    000H                        ;52d0  00           12587  12606 
    DEFB    010H                        ;52d1  10           12588  12607 
    DEFB    010H                        ;52d2  10           12589  12608 
    DEFB    07CH                        ;52d3  7c           12590  12609 
    DEFB    010H                        ;52d4  10           12591  12610 
    DEFB    010H                        ;52d5  10           12592  12611 
    DEFB    000H                        ;52d6  00           12593  12612 
    DEFB    000H                        ;52d7  00           12594  12613 
    DEFB    000H                        ;52d8  00           12595  12614 
    DEFB    000H                        ;52d9  00           12596  12615 
                                        ;                   12597  12616 ;
                                        ;                   12598  12617 ;CHR$(&H2C)	,
    DEFB    000H                        ;52da  00           12599  12618 
    DEFB    000H                        ;52db  00           12600  12619 
    DEFB    000H                        ;52dc  00           12601  12620 
    DEFB    000H                        ;52dd  00           12602  12621 
    DEFB    000H                        ;52de  00           12603  12622 
    DEFB    000H                        ;52df  00           12604  12623 
    DEFB    030H                        ;52e0  30           12605  12624 
    DEFB    010H                        ;52e1  10           12606  12625 
    DEFB    020H                        ;52e2  20           12607  12626 
    DEFB    000H                        ;52e3  00           12608  12627 
    DEFB    000H                        ;52e4  00           12609  12628 
    DEFB    000H                        ;52e5  00           12610  12629 
                                        ;                   12611  12630 ;
                                        ;                   12612  12631 ;CHR$(&H2D)	-
    DEFB    000H                        ;52e6  00           12613  12632 
    DEFB    000H                        ;52e7  00           12614  12633 
    DEFB    000H                        ;52e8  00           12615  12634 
    DEFB    000H                        ;52e9  00           12616  12635 
    DEFB    000H                        ;52ea  00           12617  12636 
    DEFB    07CH                        ;52eb  7c           12618  12637 
    DEFB    000H                        ;52ec  00           12619  12638 
    DEFB    000H                        ;52ed  00           12620  12639 
    DEFB    000H                        ;52ee  00           12621  12640 
    DEFB    000H                        ;52ef  00           12622  12641 
    DEFB    000H                        ;52f0  00           12623  12642 
    DEFB    000H                        ;52f1  00           12624  12643 
                                        ;                   12625  12644 ;
                                        ;                   12626  12645 ;CHR$(&H2E)	.
    DEFB    000H                        ;52f2  00           12627  12646 
    DEFB    000H                        ;52f3  00           12628  12647 
    DEFB    000H                        ;52f4  00           12629  12648 
    DEFB    000H                        ;52f5  00           12630  12649 
    DEFB    000H                        ;52f6  00           12631  12650 
    DEFB    000H                        ;52f7  00           12632  12651 
    DEFB    030H                        ;52f8  30           12633  12652 
    DEFB    030H                        ;52f9  30           12634  12653 
    DEFB    000H                        ;52fa  00           12635  12654 
    DEFB    000H                        ;52fb  00           12636  12655 
    DEFB    000H                        ;52fc  00           12637  12656 
    DEFB    000H                        ;52fd  00           12638  12657 
                                        ;                   12639  12658 ;
                                        ;                   12640  12659 ;CHR$(&H2F)	/
    DEFB    000H                        ;52fe  00           12641  12660 
    DEFB    000H                        ;52ff  00           12642  12661 
    DEFB    000H                        ;5300  00           12643  12662 
    DEFB    002H                        ;5301  02           12644  12663 
    DEFB    004H                        ;5302  04           12645  12664 
    DEFB    008H                        ;5303  08           12646  12665 
    DEFB    010H                        ;5304  10           12647  12666 
    DEFB    020H                        ;5305  20           12648  12667 
    DEFB    040H                        ;5306  40           12649  12668 
    DEFB    000H                        ;5307  00           12650  12669 
    DEFB    000H                        ;5308  00           12651  12670 
    DEFB    000H                        ;5309  00           12652  12671 
                                        ;                   12653  12672 ;
                                        ;                   12654  12673 ;CHR$(&H30)	0
    DEFB    000H                        ;530a  00           12655  12674 
    DEFB    000H                        ;530b  00           12656  12675 
    DEFB    03CH                        ;530c  3c           12657  12676 
    DEFB    042H                        ;530d  42           12658  12677 
    DEFB    046H                        ;530e  46           12659  12678 
    DEFB    05AH                        ;530f  5a           12660  12679 
    DEFB    062H                        ;5310  62           12661  12680 
    DEFB    042H                        ;5311  42           12662  12681 
    DEFB    03CH                        ;5312  3c           12663  12682 
    DEFB    000H                        ;5313  00           12664  12683 
    DEFB    000H                        ;5314  00           12665  12684 
    DEFB    000H                        ;5315  00           12666  12685 
                                        ;                   12667  12686 ;
                                        ;                   12668  12687 ;CHR$(&H31)	1
    DEFB    000H                        ;5316  00           12669  12688 
    DEFB    000H                        ;5317  00           12670  12689 
    DEFB    010H                        ;5318  10           12671  12690 
    DEFB    030H                        ;5319  30           12672  12691 
    DEFB    050H                        ;531a  50           12673  12692 
    DEFB    010H                        ;531b  10           12674  12693 
    DEFB    010H                        ;531c  10           12675  12694 
    DEFB    010H                        ;531d  10           12676  12695 
    DEFB    07CH                        ;531e  7c           12677  12696 
    DEFB    000H                        ;531f  00           12678  12697 
    DEFB    000H                        ;5320  00           12679  12698 
    DEFB    000H                        ;5321  00           12680  12699 
                                        ;                   12681  12700 ;
                                        ;                   12682  12701 ;CHR$(&H32)	2
    DEFB    000H                        ;5322  00           12683  12702 
    DEFB    000H                        ;5323  00           12684  12703 
    DEFB    03CH                        ;5324  3c           12685  12704 
    DEFB    042H                        ;5325  42           12686  12705 
    DEFB    002H                        ;5326  02           12687  12706 
    DEFB    00CH                        ;5327  0c           12688  12707 
    DEFB    030H                        ;5328  30           12689  12708 
    DEFB    040H                        ;5329  40           12690  12709 
    DEFB    07EH                        ;532a  7e           12691  12710 
    DEFB    000H                        ;532b  00           12692  12711 
    DEFB    000H                        ;532c  00           12693  12712 
    DEFB    000H                        ;532d  00           12694  12713 
                                        ;                   12695  12714 ;
                                        ;                   12696  12715 ;CHR$(&H33)	3
    DEFB    000H                        ;532e  00           12697  12716 
    DEFB    000H                        ;532f  00           12698  12717 
    DEFB    03CH                        ;5330  3c           12699  12718 
    DEFB    042H                        ;5331  42           12700  12719 
    DEFB    002H                        ;5332  02           12701  12720 
    DEFB    03CH                        ;5333  3c           12702  12721 
    DEFB    002H                        ;5334  02           12703  12722 
    DEFB    042H                        ;5335  42           12704  12723 
    DEFB    03CH                        ;5336  3c           12705  12724 
    DEFB    000H                        ;5337  00           12706  12725 
    DEFB    000H                        ;5338  00           12707  12726 
    DEFB    000H                        ;5339  00           12708  12727 
                                        ;                   12709  12728 ;
                                        ;                   12710  12729 ;CHR$(&H34)	4
    DEFB    000H                        ;533a  00           12711  12730 
    DEFB    000H                        ;533b  00           12712  12731 
    DEFB    004H                        ;533c  04           12713  12732 
    DEFB    00CH                        ;533d  0c           12714  12733 
    DEFB    014H                        ;533e  14           12715  12734 
    DEFB    024H                        ;533f  24           12716  12735 
    DEFB    07EH                        ;5340  7e           12717  12736 
    DEFB    004H                        ;5341  04           12718  12737 
    DEFB    004H                        ;5342  04           12719  12738 
    DEFB    000H                        ;5343  00           12720  12739 
    DEFB    000H                        ;5344  00           12721  12740 
    DEFB    000H                        ;5345  00           12722  12741 
                                        ;                   12723  12742 ;
                                        ;                   12724  12743 ;CHR$(&H35)	5
    DEFB    000H                        ;5346  00           12725  12744 
    DEFB    000H                        ;5347  00           12726  12745 
    DEFB    07EH                        ;5348  7e           12727  12746 
    DEFB    040H                        ;5349  40           12728  12747 
    DEFB    078H                        ;534a  78           12729  12748 
    DEFB    004H                        ;534b  04           12730  12749 
    DEFB    002H                        ;534c  02           12731  12750 
    DEFB    044H                        ;534d  44           12732  12751 
    DEFB    038H                        ;534e  38           12733  12752 
    DEFB    000H                        ;534f  00           12734  12753 
    DEFB    000H                        ;5350  00           12735  12754 
    DEFB    000H                        ;5351  00           12736  12755 
                                        ;                   12737  12756 ;
                                        ;                   12738  12757 ;CHR$(&H36)	6
    DEFB    000H                        ;5352  00           12739  12758 
    DEFB    000H                        ;5353  00           12740  12759 
    DEFB    01CH                        ;5354  1c           12741  12760 
    DEFB    020H                        ;5355  20           12742  12761 
    DEFB    040H                        ;5356  40           12743  12762 
    DEFB    07CH                        ;5357  7c           12744  12763 
    DEFB    042H                        ;5358  42           12745  12764 
    DEFB    042H                        ;5359  42           12746  12765 
    DEFB    03CH                        ;535a  3c           12747  12766 
    DEFB    000H                        ;535b  00           12748  12767 
    DEFB    000H                        ;535c  00           12749  12768 
    DEFB    000H                        ;535d  00           12750  12769 
                                        ;                   12751  12770 ;
                                        ;                   12752  12771 ;CHR$(&H37)	7
    DEFB    000H                        ;535e  00           12753  12772 
    DEFB    000H                        ;535f  00           12754  12773 
    DEFB    07EH                        ;5360  7e           12755  12774 
    DEFB    042H                        ;5361  42           12756  12775 
    DEFB    004H                        ;5362  04           12757  12776 
    DEFB    008H                        ;5363  08           12758  12777 
    DEFB    010H                        ;5364  10           12759  12778 
    DEFB    010H                        ;5365  10           12760  12779 
    DEFB    010H                        ;5366  10           12761  12780 
    DEFB    000H                        ;5367  00           12762  12781 
    DEFB    000H                        ;5368  00           12763  12782 
    DEFB    000H                        ;5369  00           12764  12783 
                                        ;                   12765  12784 ;
                                        ;                   12766  12785 ;CHR$(&H38)	8
    DEFB    000H                        ;536a  00           12767  12786 
    DEFB    000H                        ;536b  00           12768  12787 
    DEFB    03CH                        ;536c  3c           12769  12788 
    DEFB    042H                        ;536d  42           12770  12789 
    DEFB    042H                        ;536e  42           12771  12790 
    DEFB    03CH                        ;536f  3c           12772  12791 
    DEFB    042H                        ;5370  42           12773  12792 
    DEFB    042H                        ;5371  42           12774  12793 
    DEFB    03CH                        ;5372  3c           12775  12794 
    DEFB    000H                        ;5373  00           12776  12795 
    DEFB    000H                        ;5374  00           12777  12796 
    DEFB    000H                        ;5375  00           12778  12797 
                                        ;                   12779  12798 ;
                                        ;                   12780  12799 ;CHR$(&H39)	9
    DEFB    000H                        ;5376  00           12781  12800 
    DEFB    000H                        ;5377  00           12782  12801 
    DEFB    03CH                        ;5378  3c           12783  12802 
    DEFB    042H                        ;5379  42           12784  12803 
    DEFB    042H                        ;537a  42           12785  12804 
    DEFB    03EH                        ;537b  3e           12786  12805 
    DEFB    002H                        ;537c  02           12787  12806 
    DEFB    004H                        ;537d  04           12788  12807 
    DEFB    038H                        ;537e  38           12789  12808 
    DEFB    000H                        ;537f  00           12790  12809 
    DEFB    000H                        ;5380  00           12791  12810 
    DEFB    000H                        ;5381  00           12792  12811 
                                        ;                   12793  12812 ;
                                        ;                   12794  12813 ;CHR$(&H3A)	:
    DEFB    000H                        ;5382  00           12795  12814 
    DEFB    000H                        ;5383  00           12796  12815 
    DEFB    000H                        ;5384  00           12797  12816 
    DEFB    030H                        ;5385  30           12798  12817 
    DEFB    030H                        ;5386  30           12799  12818 
    DEFB    000H                        ;5387  00           12800  12819 
    DEFB    030H                        ;5388  30           12801  12820 
    DEFB    030H                        ;5389  30           12802  12821 
    DEFB    000H                        ;538a  00           12803  12822 
    DEFB    000H                        ;538b  00           12804  12823 
    DEFB    000H                        ;538c  00           12805  12824 
    DEFB    000H                        ;538d  00           12806  12825 
                                        ;                   12807  12826 ;
                                        ;                   12808  12827 ;CHR$(&H3B)	;
    DEFB    000H                        ;538e  00           12809  12828 
    DEFB    000H                        ;538f  00           12810  12829 
    DEFB    000H                        ;5390  00           12811  12830 
    DEFB    030H                        ;5391  30           12812  12831 
    DEFB    030H                        ;5392  30           12813  12832 
    DEFB    000H                        ;5393  00           12814  12833 
    DEFB    030H                        ;5394  30           12815  12834 
    DEFB    010H                        ;5395  10           12816  12835 
    DEFB    020H                        ;5396  20           12817  12836 
    DEFB    000H                        ;5397  00           12818  12837 
    DEFB    000H                        ;5398  00           12819  12838 
    DEFB    000H                        ;5399  00           12820  12839 
                                        ;                   12821  12840 ;
                                        ;                   12822  12841 ;CHR$(&H3C)	<
    DEFB    000H                        ;539a  00           12823  12842 
    DEFB    000H                        ;539b  00           12824  12843 
    DEFB    00EH                        ;539c  0e           12825  12844 
    DEFB    018H                        ;539d  18           12826  12845 
    DEFB    030H                        ;539e  30           12827  12846 
    DEFB    060H                        ;539f  60           12828  12847 
    DEFB    030H                        ;53a0  30           12829  12848 
    DEFB    018H                        ;53a1  18           12830  12849 
    DEFB    00EH                        ;53a2  0e           12831  12850 
    DEFB    000H                        ;53a3  00           12832  12851 
    DEFB    000H                        ;53a4  00           12833  12852 
    DEFB    000H                        ;53a5  00           12834  12853 
                                        ;                   12835  12854 ;
                                        ;                   12836  12855 ;CHR$(&H3D)	=
    DEFB    000H                        ;53a6  00           12837  12856 
    DEFB    000H                        ;53a7  00           12838  12857 
    DEFB    000H                        ;53a8  00           12839  12858 
    DEFB    000H                        ;53a9  00           12840  12859 
    DEFB    07EH                        ;53aa  7e           12841  12860 
    DEFB    000H                        ;53ab  00           12842  12861 
    DEFB    07EH                        ;53ac  7e           12843  12862 
    DEFB    000H                        ;53ad  00           12844  12863 
    DEFB    000H                        ;53ae  00           12845  12864 
    DEFB    000H                        ;53af  00           12846  12865 
    DEFB    000H                        ;53b0  00           12847  12866 
    DEFB    000H                        ;53b1  00           12848  12867 
                                        ;                   12849  12868 ;
                                        ;                   12850  12869 ;CHR$(&H3E)	>
    DEFB    000H                        ;53b2  00           12851  12870 
    DEFB    000H                        ;53b3  00           12852  12871 
    DEFB    070H                        ;53b4  70           12853  12872 
    DEFB    018H                        ;53b5  18           12854  12873 
    DEFB    00CH                        ;53b6  0c           12855  12874 
    DEFB    006H                        ;53b7  06           12856  12875 
    DEFB    00CH                        ;53b8  0c           12857  12876 
    DEFB    018H                        ;53b9  18           12858  12877 
    DEFB    070H                        ;53ba  70           12859  12878 
    DEFB    000H                        ;53bb  00           12860  12879 
    DEFB    000H                        ;53bc  00           12861  12880 
    DEFB    000H                        ;53bd  00           12862  12881 
                                        ;                   12863  12882 ;
                                        ;                   12864  12883 ;CHR$(&H3F)	?
    DEFB    000H                        ;53be  00           12865  12884 
    DEFB    000H                        ;53bf  00           12866  12885 
    DEFB    03CH                        ;53c0  3c           12867  12886 
    DEFB    042H                        ;53c1  42           12868  12887 
    DEFB    002H                        ;53c2  02           12869  12888 
    DEFB    00CH                        ;53c3  0c           12870  12889 
    DEFB    010H                        ;53c4  10           12871  12890 
    DEFB    000H                        ;53c5  00           12872  12891 
    DEFB    010H                        ;53c6  10           12873  12892 
    DEFB    000H                        ;53c7  00           12874  12893 
    DEFB    000H                        ;53c8  00           12875  12894 
    DEFB    000H                        ;53c9  00           12876  12895 
                                        ;                   12877  12896 ;
                                        ;                   12878  12897 ;CHR$(&H40)	@
    DEFB    000H                        ;53ca  00           12879  12898 
    DEFB    000H                        ;53cb  00           12880  12899 
    DEFB    01CH                        ;53cc  1c           12881  12900 
    DEFB    022H                        ;53cd  22           12882  12901 
    DEFB    04AH                        ;53ce  4a           12883  12902 
    DEFB    056H                        ;53cf  56           12884  12903 
    DEFB    04CH                        ;53d0  4c           12885  12904 
    DEFB    020H                        ;53d1  20           12886  12905 
    DEFB    01EH                        ;53d2  1e           12887  12906 
    DEFB    000H                        ;53d3  00           12888  12907 
    DEFB    000H                        ;53d4  00           12889  12908 
    DEFB    000H                        ;53d5  00           12890  12909 
                                        ;                   12891  12910 ;
                                        ;                   12892  12911 ;CHR$(&H41)	A
    DEFB    000H                        ;53d6  00           12893  12912 
    DEFB    000H                        ;53d7  00           12894  12913 
    DEFB    018H                        ;53d8  18           12895  12914 
    DEFB    024H                        ;53d9  24           12896  12915 
    DEFB    042H                        ;53da  42           12897  12916 
    DEFB    07EH                        ;53db  7e           12898  12917 
    DEFB    042H                        ;53dc  42           12899  12918 
    DEFB    042H                        ;53dd  42           12900  12919 
    DEFB    042H                        ;53de  42           12901  12920 
    DEFB    000H                        ;53df  00           12902  12921 
    DEFB    000H                        ;53e0  00           12903  12922 
    DEFB    000H                        ;53e1  00           12904  12923 
                                        ;                   12905  12924 ;
                                        ;                   12906  12925 ;CHR$(&H42)	B
    DEFB    000H                        ;53e2  00           12907  12926 
    DEFB    000H                        ;53e3  00           12908  12927 
    DEFB    07CH                        ;53e4  7c           12909  12928 
    DEFB    042H                        ;53e5  42           12910  12929 
    DEFB    042H                        ;53e6  42           12911  12930 
    DEFB    07CH                        ;53e7  7c           12912  12931 
    DEFB    042H                        ;53e8  42           12913  12932 
    DEFB    042H                        ;53e9  42           12914  12933 
    DEFB    07CH                        ;53ea  7c           12915  12934 
    DEFB    000H                        ;53eb  00           12916  12935 
    DEFB    000H                        ;53ec  00           12917  12936 
    DEFB    000H                        ;53ed  00           12918  12937 
                                        ;                   12919  12938 ;
                                        ;                   12920  12939 ;CHR$(&H43)	C
    DEFB    000H                        ;53ee  00           12921  12940 
    DEFB    000H                        ;53ef  00           12922  12941 
    DEFB    01CH                        ;53f0  1c           12923  12942 
    DEFB    022H                        ;53f1  22           12924  12943 
    DEFB    040H                        ;53f2  40           12925  12944 
    DEFB    040H                        ;53f3  40           12926  12945 
    DEFB    040H                        ;53f4  40           12927  12946 
    DEFB    022H                        ;53f5  22           12928  12947 
    DEFB    01CH                        ;53f6  1c           12929  12948 
    DEFB    000H                        ;53f7  00           12930  12949 
    DEFB    000H                        ;53f8  00           12931  12950 
    DEFB    000H                        ;53f9  00           12932  12951 
                                        ;                   12933  12952 ;
                                        ;                   12934  12953 ;CHR$(&H44)	D
    DEFB    000H                        ;53fa  00           12935  12954 
    DEFB    000H                        ;53fb  00           12936  12955 
    DEFB    078H                        ;53fc  78           12937  12956 
    DEFB    024H                        ;53fd  24           12938  12957 
    DEFB    022H                        ;53fe  22           12939  12958 
    DEFB    022H                        ;53ff  22           12940  12959 
    DEFB    022H                        ;5400  22           12941  12960 
    DEFB    024H                        ;5401  24           12942  12961 
    DEFB    078H                        ;5402  78           12943  12962 
    DEFB    000H                        ;5403  00           12944  12963 
    DEFB    000H                        ;5404  00           12945  12964 
    DEFB    000H                        ;5405  00           12946  12965 
                                        ;                   12947  12966 ;
                                        ;                   12948  12967 ;CHR$(&H45)	E
    DEFB    000H                        ;5406  00           12949  12968 
    DEFB    000H                        ;5407  00           12950  12969 
    DEFB    07EH                        ;5408  7e           12951  12970 
    DEFB    040H                        ;5409  40           12952  12971 
    DEFB    040H                        ;540a  40           12953  12972 
    DEFB    078H                        ;540b  78           12954  12973 
    DEFB    040H                        ;540c  40           12955  12974 
    DEFB    040H                        ;540d  40           12956  12975 
    DEFB    07EH                        ;540e  7e           12957  12976 
    DEFB    000H                        ;540f  00           12958  12977 
    DEFB    000H                        ;5410  00           12959  12978 
    DEFB    000H                        ;5411  00           12960  12979 
                                        ;                   12961  12980 ;
                                        ;                   12962  12981 ;CHR$(&H46)	F
    DEFB    000H                        ;5412  00           12963  12982 
    DEFB    000H                        ;5413  00           12964  12983 
    DEFB    07EH                        ;5414  7e           12965  12984 
    DEFB    040H                        ;5415  40           12966  12985 
    DEFB    040H                        ;5416  40           12967  12986 
    DEFB    078H                        ;5417  78           12968  12987 
    DEFB    040H                        ;5418  40           12969  12988 
    DEFB    040H                        ;5419  40           12970  12989 
    DEFB    040H                        ;541a  40           12971  12990 
    DEFB    000H                        ;541b  00           12972  12991 
    DEFB    000H                        ;541c  00           12973  12992 
    DEFB    000H                        ;541d  00           12974  12993 
                                        ;                   12975  12994 ;
                                        ;                   12976  12995 ;CHR$(&H47)	G
    DEFB    000H                        ;541e  00           12977  12996 
    DEFB    000H                        ;541f  00           12978  12997 
    DEFB    01CH                        ;5420  1c           12979  12998 
    DEFB    022H                        ;5421  22           12980  12999 
    DEFB    040H                        ;5422  40           12981  13000 
    DEFB    04EH                        ;5423  4e           12982  13001 
    DEFB    042H                        ;5424  42           12983  13002 
    DEFB    022H                        ;5425  22           12984  13003 
    DEFB    01CH                        ;5426  1c           12985  13004 
    DEFB    000H                        ;5427  00           12986  13005 
    DEFB    000H                        ;5428  00           12987  13006 
    DEFB    000H                        ;5429  00           12988  13007 
                                        ;                   12989  13008 ;
                                        ;                   12990  13009 ;CHR$(&H48)	H
    DEFB    000H                        ;542a  00           12991  13010 
    DEFB    000H                        ;542b  00           12992  13011 
    DEFB    042H                        ;542c  42           12993  13012 
    DEFB    042H                        ;542d  42           12994  13013 
    DEFB    042H                        ;542e  42           12995  13014 
    DEFB    07EH                        ;542f  7e           12996  13015 
    DEFB    042H                        ;5430  42           12997  13016 
    DEFB    042H                        ;5431  42           12998  13017 
    DEFB    042H                        ;5432  42           12999  13018 
    DEFB    000H                        ;5433  00           13000  13019 
    DEFB    000H                        ;5434  00           13001  13020 
    DEFB    000H                        ;5435  00           13002  13021 
                                        ;                   13003  13022 ;
                                        ;                   13004  13023 ;CHR$(&H49)	I
    DEFB    000H                        ;5436  00           13005  13024 
    DEFB    000H                        ;5437  00           13006  13025 
    DEFB    038H                        ;5438  38           13007  13026 
    DEFB    010H                        ;5439  10           13008  13027 
    DEFB    010H                        ;543a  10           13009  13028 
    DEFB    010H                        ;543b  10           13010  13029 
    DEFB    010H                        ;543c  10           13011  13030 
    DEFB    010H                        ;543d  10           13012  13031 
    DEFB    038H                        ;543e  38           13013  13032 
    DEFB    000H                        ;543f  00           13014  13033 
    DEFB    000H                        ;5440  00           13015  13034 
    DEFB    000H                        ;5441  00           13016  13035 
                                        ;                   13017  13036 ;
                                        ;                   13018  13037 ;CHR$(&H4A)	J
    DEFB    000H                        ;5442  00           13019  13038 
    DEFB    000H                        ;5443  00           13020  13039 
    DEFB    00EH                        ;5444  0e           13021  13040 
    DEFB    004H                        ;5445  04           13022  13041 
    DEFB    004H                        ;5446  04           13023  13042 
    DEFB    004H                        ;5447  04           13024  13043 
    DEFB    004H                        ;5448  04           13025  13044 
    DEFB    044H                        ;5449  44           13026  13045 
    DEFB    038H                        ;544a  38           13027  13046 
    DEFB    000H                        ;544b  00           13028  13047 
    DEFB    000H                        ;544c  00           13029  13048 
    DEFB    000H                        ;544d  00           13030  13049 
                                        ;                   13031  13050 ;
                                        ;                   13032  13051 ;CHR$(&H4B)	K
    DEFB    000H                        ;544e  00           13033  13052 
    DEFB    000H                        ;544f  00           13034  13053 
    DEFB    042H                        ;5450  42           13035  13054 
    DEFB    044H                        ;5451  44           13036  13055 
    DEFB    048H                        ;5452  48           13037  13056 
    DEFB    070H                        ;5453  70           13038  13057 
    DEFB    048H                        ;5454  48           13039  13058 
    DEFB    044H                        ;5455  44           13040  13059 
    DEFB    042H                        ;5456  42           13041  13060 
    DEFB    000H                        ;5457  00           13042  13061 
    DEFB    000H                        ;5458  00           13043  13062 
    DEFB    000H                        ;5459  00           13044  13063 
                                        ;                   13045  13064 ;
                                        ;                   13046  13065 ;CHR$(&H4C)	L
    DEFB    000H                        ;545a  00           13047  13066 
    DEFB    000H                        ;545b  00           13048  13067 
    DEFB    040H                        ;545c  40           13049  13068 
    DEFB    040H                        ;545d  40           13050  13069 
    DEFB    040H                        ;545e  40           13051  13070 
    DEFB    040H                        ;545f  40           13052  13071 
    DEFB    040H                        ;5460  40           13053  13072 
    DEFB    040H                        ;5461  40           13054  13073 
    DEFB    07EH                        ;5462  7e           13055  13074 
    DEFB    000H                        ;5463  00           13056  13075 
    DEFB    000H                        ;5464  00           13057  13076 
    DEFB    000H                        ;5465  00           13058  13077 
                                        ;                   13059  13078 ;
                                        ;                   13060  13079 ;CHR$(&H4D)	M
    DEFB    000H                        ;5466  00           13061  13080 
    DEFB    000H                        ;5467  00           13062  13081 
    DEFB    042H                        ;5468  42           13063  13082 
    DEFB    066H                        ;5469  66           13064  13083 
    DEFB    05AH                        ;546a  5a           13065  13084 
    DEFB    05AH                        ;546b  5a           13066  13085 
    DEFB    042H                        ;546c  42           13067  13086 
    DEFB    042H                        ;546d  42           13068  13087 
    DEFB    042H                        ;546e  42           13069  13088 
    DEFB    000H                        ;546f  00           13070  13089 
    DEFB    000H                        ;5470  00           13071  13090 
    DEFB    000H                        ;5471  00           13072  13091 
                                        ;                   13073  13092 ;
                                        ;                   13074  13093 ;CHR$(&H4E)	N
    DEFB    000H                        ;5472  00           13075  13094 
    DEFB    000H                        ;5473  00           13076  13095 
    DEFB    042H                        ;5474  42           13077  13096 
    DEFB    062H                        ;5475  62           13078  13097 
    DEFB    052H                        ;5476  52           13079  13098 
    DEFB    04AH                        ;5477  4a           13080  13099 
    DEFB    046H                        ;5478  46           13081  13100 
    DEFB    042H                        ;5479  42           13082  13101 
    DEFB    042H                        ;547a  42           13083  13102 
    DEFB    000H                        ;547b  00           13084  13103 
    DEFB    000H                        ;547c  00           13085  13104 
    DEFB    000H                        ;547d  00           13086  13105 
                                        ;                   13087  13106 ;
                                        ;                   13088  13107 ;CHR$(&H4F)	O
    DEFB    000H                        ;547e  00           13089  13108 
    DEFB    000H                        ;547f  00           13090  13109 
    DEFB    018H                        ;5480  18           13091  13110 
    DEFB    024H                        ;5481  24           13092  13111 
    DEFB    042H                        ;5482  42           13093  13112 
    DEFB    042H                        ;5483  42           13094  13113 
    DEFB    042H                        ;5484  42           13095  13114 
    DEFB    024H                        ;5485  24           13096  13115 
    DEFB    018H                        ;5486  18           13097  13116 
    DEFB    000H                        ;5487  00           13098  13117 
    DEFB    000H                        ;5488  00           13099  13118 
    DEFB    000H                        ;5489  00           13100  13119 
                                        ;                   13101  13120 ;
                                        ;                   13102  13121 ;CHR$(&H50)	P
    DEFB    000H                        ;548a  00           13103  13122 
    DEFB    000H                        ;548b  00           13104  13123 
    DEFB    07CH                        ;548c  7c           13105  13124 
    DEFB    042H                        ;548d  42           13106  13125 
    DEFB    042H                        ;548e  42           13107  13126 
    DEFB    07CH                        ;548f  7c           13108  13127 
    DEFB    040H                        ;5490  40           13109  13128 
    DEFB    040H                        ;5491  40           13110  13129 
    DEFB    040H                        ;5492  40           13111  13130 
    DEFB    000H                        ;5493  00           13112  13131 
    DEFB    000H                        ;5494  00           13113  13132 
    DEFB    000H                        ;5495  00           13114  13133 
                                        ;                   13115  13134 ;
                                        ;                   13116  13135 ;CHR$(&H51)	Q
    DEFB    000H                        ;5496  00           13117  13136 
    DEFB    000H                        ;5497  00           13118  13137 
    DEFB    018H                        ;5498  18           13119  13138 
    DEFB    024H                        ;5499  24           13120  13139 
    DEFB    042H                        ;549a  42           13121  13140 
    DEFB    042H                        ;549b  42           13122  13141 
    DEFB    04AH                        ;549c  4a           13123  13142 
    DEFB    024H                        ;549d  24           13124  13143 
    DEFB    01AH                        ;549e  1a           13125  13144 
    DEFB    000H                        ;549f  00           13126  13145 
    DEFB    000H                        ;54a0  00           13127  13146 
    DEFB    000H                        ;54a1  00           13128  13147 
                                        ;                   13129  13148 ;
                                        ;                   13130  13149 ;CHR$(&H52)	R
    DEFB    000H                        ;54a2  00           13131  13150 
    DEFB    000H                        ;54a3  00           13132  13151 
    DEFB    07CH                        ;54a4  7c           13133  13152 
    DEFB    042H                        ;54a5  42           13134  13153 
    DEFB    042H                        ;54a6  42           13135  13154 
    DEFB    07CH                        ;54a7  7c           13136  13155 
    DEFB    048H                        ;54a8  48           13137  13156 
    DEFB    044H                        ;54a9  44           13138  13157 
    DEFB    042H                        ;54aa  42           13139  13158 
    DEFB    000H                        ;54ab  00           13140  13159 
    DEFB    000H                        ;54ac  00           13141  13160 
    DEFB    000H                        ;54ad  00           13142  13161 
                                        ;                   13143  13162 ;
                                        ;                   13144  13163 ;CHR$(&H53)	S
    DEFB    000H                        ;54ae  00           13145  13164 
    DEFB    000H                        ;54af  00           13146  13165 
    DEFB    03CH                        ;54b0  3c           13147  13166 
    DEFB    042H                        ;54b1  42           13148  13167 
    DEFB    040H                        ;54b2  40           13149  13168 
    DEFB    03CH                        ;54b3  3c           13150  13169 
    DEFB    002H                        ;54b4  02           13151  13170 
    DEFB    042H                        ;54b5  42           13152  13171 
    DEFB    03CH                        ;54b6  3c           13153  13172 
    DEFB    000H                        ;54b7  00           13154  13173 
    DEFB    000H                        ;54b8  00           13155  13174 
    DEFB    000H                        ;54b9  00           13156  13175 
                                        ;                   13157  13176 ;
                                        ;                   13158  13177 ;CHR$(&H54)	T
    DEFB    000H                        ;54ba  00           13159  13178 
    DEFB    000H                        ;54bb  00           13160  13179 
    DEFB    07CH                        ;54bc  7c           13161  13180 
    DEFB    010H                        ;54bd  10           13162  13181 
    DEFB    010H                        ;54be  10           13163  13182 
    DEFB    010H                        ;54bf  10           13164  13183 
    DEFB    010H                        ;54c0  10           13165  13184 
    DEFB    010H                        ;54c1  10           13166  13185 
    DEFB    010H                        ;54c2  10           13167  13186 
    DEFB    000H                        ;54c3  00           13168  13187 
    DEFB    000H                        ;54c4  00           13169  13188 
    DEFB    000H                        ;54c5  00           13170  13189 
                                        ;                   13171  13190 ;
                                        ;                   13172  13191 ;CHR$(&H55)	U
    DEFB    000H                        ;54c6  00           13173  13192 
    DEFB    000H                        ;54c7  00           13174  13193 
    DEFB    042H                        ;54c8  42           13175  13194 
    DEFB    042H                        ;54c9  42           13176  13195 
    DEFB    042H                        ;54ca  42           13177  13196 
    DEFB    042H                        ;54cb  42           13178  13197 
    DEFB    042H                        ;54cc  42           13179  13198 
    DEFB    042H                        ;54cd  42           13180  13199 
    DEFB    03CH                        ;54ce  3c           13181  13200 
    DEFB    000H                        ;54cf  00           13182  13201 
    DEFB    000H                        ;54d0  00           13183  13202 
    DEFB    000H                        ;54d1  00           13184  13203 
                                        ;                   13185  13204 ;
                                        ;                   13186  13205 ;CHR$(&H56)	V
    DEFB    000H                        ;54d2  00           13187  13206 
    DEFB    000H                        ;54d3  00           13188  13207 
    DEFB    042H                        ;54d4  42           13189  13208 
    DEFB    042H                        ;54d5  42           13190  13209 
    DEFB    042H                        ;54d6  42           13191  13210 
    DEFB    024H                        ;54d7  24           13192  13211 
    DEFB    024H                        ;54d8  24           13193  13212 
    DEFB    018H                        ;54d9  18           13194  13213 
    DEFB    018H                        ;54da  18           13195  13214 
    DEFB    000H                        ;54db  00           13196  13215 
    DEFB    000H                        ;54dc  00           13197  13216 
    DEFB    000H                        ;54dd  00           13198  13217 
                                        ;                   13199  13218 ;
                                        ;                   13200  13219 ;CHR$(&H57)	W
    DEFB    000H                        ;54de  00           13201  13220 
    DEFB    000H                        ;54df  00           13202  13221 
    DEFB    042H                        ;54e0  42           13203  13222 
    DEFB    042H                        ;54e1  42           13204  13223 
    DEFB    042H                        ;54e2  42           13205  13224 
    DEFB    05AH                        ;54e3  5a           13206  13225 
    DEFB    05AH                        ;54e4  5a           13207  13226 
    DEFB    066H                        ;54e5  66           13208  13227 
    DEFB    042H                        ;54e6  42           13209  13228 
    DEFB    000H                        ;54e7  00           13210  13229 
    DEFB    000H                        ;54e8  00           13211  13230 
    DEFB    000H                        ;54e9  00           13212  13231 
                                        ;                   13213  13232 ;
                                        ;                   13214  13233 ;CHR$(&H58)	X
    DEFB    000H                        ;54ea  00           13215  13234 
    DEFB    000H                        ;54eb  00           13216  13235 
    DEFB    042H                        ;54ec  42           13217  13236 
    DEFB    042H                        ;54ed  42           13218  13237 
    DEFB    024H                        ;54ee  24           13219  13238 
    DEFB    018H                        ;54ef  18           13220  13239 
    DEFB    024H                        ;54f0  24           13221  13240 
    DEFB    042H                        ;54f1  42           13222  13241 
    DEFB    042H                        ;54f2  42           13223  13242 
    DEFB    000H                        ;54f3  00           13224  13243 
    DEFB    000H                        ;54f4  00           13225  13244 
    DEFB    000H                        ;54f5  00           13226  13245 
                                        ;                   13227  13246 ;
                                        ;                   13228  13247 ;CHR$(&H59)	Y
    DEFB    000H                        ;54f6  00           13229  13248 
    DEFB    000H                        ;54f7  00           13230  13249 
    DEFB    044H                        ;54f8  44           13231  13250 
    DEFB    044H                        ;54f9  44           13232  13251 
    DEFB    044H                        ;54fa  44           13233  13252 
    DEFB    038H                        ;54fb  38           13234  13253 
    DEFB    010H                        ;54fc  10           13235  13254 
    DEFB    010H                        ;54fd  10           13236  13255 
    DEFB    010H                        ;54fe  10           13237  13256 
    DEFB    000H                        ;54ff  00           13238  13257 
    DEFB    000H                        ;5500  00           13239  13258 
    DEFB    000H                        ;5501  00           13240  13259 
                                        ;                   13241  13260 ;
                                        ;                   13242  13261 ;CHR$(&H5A)	Z
    DEFB    000H                        ;5502  00           13243  13262 
    DEFB    000H                        ;5503  00           13244  13263 
    DEFB    07EH                        ;5504  7e           13245  13264 
    DEFB    002H                        ;5505  02           13246  13265 
    DEFB    004H                        ;5506  04           13247  13266 
    DEFB    018H                        ;5507  18           13248  13267 
    DEFB    020H                        ;5508  20           13249  13268 
    DEFB    040H                        ;5509  40           13250  13269 
    DEFB    07EH                        ;550a  7e           13251  13270 
    DEFB    000H                        ;550b  00           13252  13271 
    DEFB    000H                        ;550c  00           13253  13272 
    DEFB    000H                        ;550d  00           13254  13273 
                                        ;                   13255  13274 ;
                                        ;                   13256  13275 ;CHR$(&H5B)	[
    DEFB    000H                        ;550e  00           13257  13276 
    DEFB    000H                        ;550f  00           13258  13277 
    DEFB    03CH                        ;5510  3c           13259  13278 
    DEFB    020H                        ;5511  20           13260  13279 
    DEFB    020H                        ;5512  20           13261  13280 
    DEFB    020H                        ;5513  20           13262  13281 
    DEFB    020H                        ;5514  20           13263  13282 
    DEFB    020H                        ;5515  20           13264  13283 
    DEFB    03CH                        ;5516  3c           13265  13284 
    DEFB    000H                        ;5517  00           13266  13285 
    DEFB    000H                        ;5518  00           13267  13286 
    DEFB    000H                        ;5519  00           13268  13287 
                                        ;                   13269  13288 ;
                                        ;                   13270  13289 ;CHR$(&H5C)
    DEFB    000H                        ;551a  00           13271  13290 
    DEFB    080H                        ;551b  80           13272  13291 
    DEFB    080H                        ;551c  80           13273  13292 
    DEFB    040H                        ;551d  40           13274  13293 
    DEFB    020H                        ;551e  20           13275  13294 
    DEFB    010H                        ;551f  10           13276  13295 
    DEFB    008H                        ;5520  08           13277  13296 
    DEFB    004H                        ;5521  04           13278  13297 
    DEFB    002H                        ;5522  02           13279  13298 
    DEFB    001H                        ;5523  01           13280  13299 
    DEFB    001H                        ;5524  01           13281  13300 
    DEFB    000H                        ;5525  00           13282  13301 
                                        ;                   13283  13302 ;
                                        ;                   13284  13303 ;CHR$(&H5D)	]
    DEFB    000H                        ;5526  00           13285  13304 
    DEFB    000H                        ;5527  00           13286  13305 
    DEFB    078H                        ;5528  78           13287  13306 
    DEFB    008H                        ;5529  08           13288  13307 
    DEFB    008H                        ;552a  08           13289  13308 
    DEFB    008H                        ;552b  08           13290  13309 
    DEFB    008H                        ;552c  08           13291  13310 
    DEFB    008H                        ;552d  08           13292  13311 
    DEFB    078H                        ;552e  78           13293  13312 
    DEFB    000H                        ;552f  00           13294  13313 
    DEFB    000H                        ;5530  00           13295  13314 
    DEFB    000H                        ;5531  00           13296  13315 
                                        ;                   13297  13316 ;
                                        ;                   13298  13317 ;CHR$(&H5E)	↑
    DEFB    000H                        ;5532  00           13299  13318 
    DEFB    000H                        ;5533  00           13300  13319 
    DEFB    010H                        ;5534  10           13301  13320 
    DEFB    028H                        ;5535  28           13302  13321 
    DEFB    044H                        ;5536  44           13303  13322 
    DEFB    010H                        ;5537  10           13304  13323 
    DEFB    010H                        ;5538  10           13305  13324 
    DEFB    010H                        ;5539  10           13306  13325 
    DEFB    010H                        ;553a  10           13307  13326 
    DEFB    000H                        ;553b  00           13308  13327 
    DEFB    000H                        ;553c  00           13309  13328 
    DEFB    000H                        ;553d  00           13310  13329 
                                        ;                   13311  13330 ;
                                        ;                   13312  13331 ;CHR$(&H5F)	←
    DEFB    000H                        ;553e  00           13313  13332 
    DEFB    000H                        ;553f  00           13314  13333 
    DEFB    020H                        ;5540  20           13315  13334 
    DEFB    040H                        ;5541  40           13316  13335 
    DEFB    0FEH                        ;5542  fe           13317  13336 
    DEFB    040H                        ;5543  40           13318  13337 
    DEFB    020H                        ;5544  20           13319  13338 
    DEFB    000H                        ;5545  00           13320  13339 
    DEFB    000H                        ;5546  00           13321  13340 
    DEFB    000H                        ;5547  00           13322  13341 
    DEFB    000H                        ;5548  00           13323  13342 
    DEFB    000H                        ;5549  00           13324  13343 
                                        ;                   13325  13344 ;
                                        ;                   13326  13345 ;
                                        ;                   13327  13346 ;
$CGBUF:                                 ;                   13328  13347 
                                        ;                   13329  13348 ;
                                        ;                   13330  13349 ;CHR$(&H80)
    DEFB    000H                        ;554a  00           13331  13350 
    DEFB    000H                        ;554b  00           13332  13351 
    DEFB    000H                        ;554c  00           13333  13352 
    DEFB    000H                        ;554d  00           13334  13353 
    DEFB    000H                        ;554e  00           13335  13354 
    DEFB    000H                        ;554f  00           13336  13355 
    DEFB    000H                        ;5550  00           13337  13356 
    DEFB    000H                        ;5551  00           13338  13357 
    DEFB    000H                        ;5552  00           13339  13358 
    DEFB    000H                        ;5553  00           13340  13359 
    DEFB    000H                        ;5554  00           13341  13360 
    DEFB    000H                        ;5555  00           13342  13361 
                                        ;                   13343  13362 ;
                                        ;                   13344  13363 ;CHR$(&H81)
    DEFB    000H                        ;5556  00           13345  13364 
    DEFB    000H                        ;5557  00           13346  13365 
    DEFB    000H                        ;5558  00           13347  13366 
    DEFB    03CH                        ;5559  3c           13348  13367 
    DEFB    042H                        ;555a  42           13349  13368 
    DEFB    042H                        ;555b  42           13350  13369 
    DEFB    042H                        ;555c  42           13351  13370 
    DEFB    042H                        ;555d  42           13352  13371 
    DEFB    03CH                        ;555e  3c           13353  13372 
    DEFB    000H                        ;555f  00           13354  13373 
    DEFB    000H                        ;5560  00           13355  13374 
    DEFB    000H                        ;5561  00           13356  13375 
                                        ;                   13357  13376 ;
                                        ;                   13358  13377 ;CHR$(&H82)
    DEFB    000H                        ;5562  00           13359  13378 
    DEFB    000H                        ;5563  00           13360  13379 
    DEFB    000H                        ;5564  00           13361  13380 
    DEFB    03CH                        ;5565  3c           13362  13381 
    DEFB    07EH                        ;5566  7e           13363  13382 
    DEFB    07EH                        ;5567  7e           13364  13383 
    DEFB    07EH                        ;5568  7e           13365  13384 
    DEFB    07EH                        ;5569  7e           13366  13385 
    DEFB    03CH                        ;556a  3c           13367  13386 
    DEFB    000H                        ;556b  00           13368  13387 
    DEFB    000H                        ;556c  00           13369  13388 
    DEFB    000H                        ;556d  00           13370  13389 
                                        ;                   13371  13390 ;
                                        ;                   13372  13391 ;CHR$(&H83)
    DEFB    000H                        ;556e  00           13373  13392 
    DEFB    000H                        ;556f  00           13374  13393 
    DEFB    000H                        ;5570  00           13375  13394 
    DEFB    008H                        ;5571  08           13376  13395 
    DEFB    008H                        ;5572  08           13377  13396 
    DEFB    008H                        ;5573  08           13378  13397 
    DEFB    02AH                        ;5574  2a           13379  13398 
    DEFB    01CH                        ;5575  1c           13380  13399 
    DEFB    008H                        ;5576  08           13381  13400 
    DEFB    000H                        ;5577  00           13382  13401 
    DEFB    000H                        ;5578  00           13383  13402 
    DEFB    000H                        ;5579  00           13384  13403 
                                        ;                   13385  13404 ;
                                        ;                   13386  13405 ;CHR$(&H84)
    DEFB    000H                        ;557a  00           13387  13406 
    DEFB    000H                        ;557b  00           13388  13407 
    DEFB    000H                        ;557c  00           13389  13408 
    DEFB    008H                        ;557d  08           13390  13409 
    DEFB    004H                        ;557e  04           13391  13410 
    DEFB    07EH                        ;557f  7e           13392  13411 
    DEFB    004H                        ;5580  04           13393  13412 
    DEFB    008H                        ;5581  08           13394  13413 
    DEFB    000H                        ;5582  00           13395  13414 
    DEFB    000H                        ;5583  00           13396  13415 
    DEFB    000H                        ;5584  00           13397  13416 
    DEFB    000H                        ;5585  00           13398  13417 
                                        ;                   13399  13418 ;
                                        ;                   13400  13419 ;CHR$(&H85)
    DEFB    000H                        ;5586  00           13401  13420 
    DEFB    000H                        ;5587  00           13402  13421 
    DEFB    000H                        ;5588  00           13403  13422 
    DEFB    000H                        ;5589  00           13404  13423 
    DEFB    000H                        ;558a  00           13405  13424 
    DEFB    0F0H                        ;558b  f0           13406  13425 
    DEFB    010H                        ;558c  10           13407  13426 
    DEFB    010H                        ;558d  10           13408  13427 
    DEFB    010H                        ;558e  10           13409  13428 
    DEFB    010H                        ;558f  10           13410  13429 
    DEFB    010H                        ;5590  10           13411  13430 
    DEFB    010H                        ;5591  10           13412  13431 
                                        ;                   13413  13432 ;
                                        ;                   13414  13433 ;CHR$(&H86)
    DEFB    010H                        ;5592  10           13415  13434 
    DEFB    010H                        ;5593  10           13416  13435 
    DEFB    010H                        ;5594  10           13417  13436 
    DEFB    010H                        ;5595  10           13418  13437 
    DEFB    010H                        ;5596  10           13419  13438 
    DEFB    0F0H                        ;5597  f0           13420  13439 
    DEFB    000H                        ;5598  00           13421  13440 
    DEFB    000H                        ;5599  00           13422  13441 
    DEFB    000H                        ;559a  00           13423  13442 
    DEFB    000H                        ;559b  00           13424  13443 
    DEFB    000H                        ;559c  00           13425  13444 
    DEFB    000H                        ;559d  00           13426  13445 
                                        ;                   13427  13446 ;
                                        ;                   13428  13447 ;CHR$(&H87)
    DEFB    000H                        ;559e  00           13429  13448 
    DEFB    000H                        ;559f  00           13430  13449 
    DEFB    000H                        ;55a0  00           13431  13450 
    DEFB    000H                        ;55a1  00           13432  13451 
    DEFB    000H                        ;55a2  00           13433  13452 
    DEFB    01FH                        ;55a3  1f           13434  13453 
    DEFB    010H                        ;55a4  10           13435  13454 
    DEFB    010H                        ;55a5  10           13436  13455 
    DEFB    010H                        ;55a6  10           13437  13456 
    DEFB    010H                        ;55a7  10           13438  13457 
    DEFB    010H                        ;55a8  10           13439  13458 
    DEFB    010H                        ;55a9  10           13440  13459 
                                        ;                   13441  13460 ;
                                        ;                   13442  13461 ;CHR$(&H88)
    DEFB    010H                        ;55aa  10           13443  13462 
    DEFB    010H                        ;55ab  10           13444  13463 
    DEFB    010H                        ;55ac  10           13445  13464 
    DEFB    010H                        ;55ad  10           13446  13465 
    DEFB    010H                        ;55ae  10           13447  13466 
    DEFB    01FH                        ;55af  1f           13448  13467 
    DEFB    000H                        ;55b0  00           13449  13468 
    DEFB    000H                        ;55b1  00           13450  13469 
    DEFB    000H                        ;55b2  00           13451  13470 
    DEFB    000H                        ;55b3  00           13452  13471 
    DEFB    000H                        ;55b4  00           13453  13472 
    DEFB    000H                        ;55b5  00           13454  13473 
                                        ;                   13455  13474 ;
                                        ;                   13456  13475 ;CHR$(&H89)
    DEFB    010H                        ;55b6  10           13457  13476 
    DEFB    010H                        ;55b7  10           13458  13477 
    DEFB    010H                        ;55b8  10           13459  13478 
    DEFB    010H                        ;55b9  10           13460  13479 
    DEFB    010H                        ;55ba  10           13461  13480 
    DEFB    0FFH                        ;55bb  ff           13462  13481 
    DEFB    010H                        ;55bc  10           13463  13482 
    DEFB    010H                        ;55bd  10           13464  13483 
    DEFB    010H                        ;55be  10           13465  13484 
    DEFB    010H                        ;55bf  10           13466  13485 
    DEFB    010H                        ;55c0  10           13467  13486 
    DEFB    010H                        ;55c1  10           13468  13487 
                                        ;                   13469  13488 ;
                                        ;                   13470  13489 ;CHR$(&H8A)
    DEFB    010H                        ;55c2  10           13471  13490 
    DEFB    010H                        ;55c3  10           13472  13491 
    DEFB    010H                        ;55c4  10           13473  13492 
    DEFB    010H                        ;55c5  10           13474  13493 
    DEFB    010H                        ;55c6  10           13475  13494 
    DEFB    010H                        ;55c7  10           13476  13495 
    DEFB    010H                        ;55c8  10           13477  13496 
    DEFB    010H                        ;55c9  10           13478  13497 
    DEFB    010H                        ;55ca  10           13479  13498 
    DEFB    010H                        ;55cb  10           13480  13499 
    DEFB    010H                        ;55cc  10           13481  13500 
    DEFB    010H                        ;55cd  10           13482  13501 
                                        ;                   13483  13502 ;
                                        ;                   13484  13503 ;CHR$(&H8B)
    DEFB    000H                        ;55ce  00           13485  13504 
    DEFB    000H                        ;55cf  00           13486  13505 
    DEFB    000H                        ;55d0  00           13487  13506 
    DEFB    000H                        ;55d1  00           13488  13507 
    DEFB    000H                        ;55d2  00           13489  13508 
    DEFB    0FFH                        ;55d3  ff           13490  13509 
    DEFB    000H                        ;55d4  00           13491  13510 
    DEFB    000H                        ;55d5  00           13492  13511 
    DEFB    000H                        ;55d6  00           13493  13512 
    DEFB    000H                        ;55d7  00           13494  13513 
    DEFB    000H                        ;55d8  00           13495  13514 
    DEFB    000H                        ;55d9  00           13496  13515 
                                        ;                   13497  13516 ;
                                        ;                   13498  13517 ;CHR$(&H8C)
    DEFB    010H                        ;55da  10           13499  13518 
    DEFB    010H                        ;55db  10           13500  13519 
    DEFB    010H                        ;55dc  10           13501  13520 
    DEFB    010H                        ;55dd  10           13502  13521 
    DEFB    010H                        ;55de  10           13503  13522 
    DEFB    0FFH                        ;55df  ff           13504  13523 
    DEFB    000H                        ;55e0  00           13505  13524 
    DEFB    000H                        ;55e1  00           13506  13525 
    DEFB    000H                        ;55e2  00           13507  13526 
    DEFB    000H                        ;55e3  00           13508  13527 
    DEFB    000H                        ;55e4  00           13509  13528 
    DEFB    000H                        ;55e5  00           13510  13529 
                                        ;                   13511  13530 ;
                                        ;                   13512  13531 ;CHR$(&H8D)
    DEFB    000H                        ;55e6  00           13513  13532 
    DEFB    000H                        ;55e7  00           13514  13533 
    DEFB    000H                        ;55e8  00           13515  13534 
    DEFB    000H                        ;55e9  00           13516  13535 
    DEFB    000H                        ;55ea  00           13517  13536 
    DEFB    0FFH                        ;55eb  ff           13518  13537 
    DEFB    010H                        ;55ec  10           13519  13538 
    DEFB    010H                        ;55ed  10           13520  13539 
    DEFB    010H                        ;55ee  10           13521  13540 
    DEFB    010H                        ;55ef  10           13522  13541 
    DEFB    010H                        ;55f0  10           13523  13542 
    DEFB    010H                        ;55f1  10           13524  13543 
                                        ;                   13525  13544 ;
                                        ;                   13526  13545 ;CHR$(&H8E)
    DEFB    010H                        ;55f2  10           13527  13546 
    DEFB    010H                        ;55f3  10           13528  13547 
    DEFB    010H                        ;55f4  10           13529  13548 
    DEFB    010H                        ;55f5  10           13530  13549 
    DEFB    010H                        ;55f6  10           13531  13550 
    DEFB    0F0H                        ;55f7  f0           13532  13551 
    DEFB    010H                        ;55f8  10           13533  13552 
    DEFB    010H                        ;55f9  10           13534  13553 
    DEFB    010H                        ;55fa  10           13535  13554 
    DEFB    010H                        ;55fb  10           13536  13555 
    DEFB    010H                        ;55fc  10           13537  13556 
    DEFB    010H                        ;55fd  10           13538  13557 
                                        ;                   13539  13558 ;
                                        ;                   13540  13559 ;CHR$(&H8F)
    DEFB    010H                        ;55fe  10           13541  13560 
    DEFB    010H                        ;55ff  10           13542  13561 
    DEFB    010H                        ;5600  10           13543  13562 
    DEFB    010H                        ;5601  10           13544  13563 
    DEFB    010H                        ;5602  10           13545  13564 
    DEFB    01FH                        ;5603  1f           13546  13565 
    DEFB    010H                        ;5604  10           13547  13566 
    DEFB    010H                        ;5605  10           13548  13567 
    DEFB    010H                        ;5606  10           13549  13568 
    DEFB    010H                        ;5607  10           13550  13569 
    DEFB    010H                        ;5608  10           13551  13570 
    DEFB    010H                        ;5609  10           13552  13571 
                                        ;                   13553  13572 ;
                                        ;                   13554  13573 ;CHR$(&H90)
    DEFB    000H                        ;560a  00           13555  13574 
    DEFB    072H                        ;560b  72           13556  13575 
    DEFB    08AH                        ;560c  8a           13557  13576 
    DEFB    08AH                        ;560d  8a           13558  13577 
    DEFB    072H                        ;560e  72           13559  13578 
    DEFB    002H                        ;560f  02           13560  13579 
    DEFB    03EH                        ;5610  3e           13561  13580 
    DEFB    002H                        ;5611  02           13562  13581 
    DEFB    03EH                        ;5612  3e           13563  13582 
    DEFB    020H                        ;5613  20           13564  13583 
    DEFB    03EH                        ;5614  3e           13565  13584 
    DEFB    000H                        ;5615  00           13566  13585 
                                        ;                   13567  13586 ;
                                        ;                   13568  13587 ;CHR$(&H91)
    DEFB    000H                        ;5616  00           13569  13588 
    DEFB    072H                        ;5617  72           13570  13589 
    DEFB    08AH                        ;5618  8a           13571  13590 
    DEFB    072H                        ;5619  72           13572  13591 
    DEFB    0FAH                        ;561a  fa           13573  13592 
    DEFB    02EH                        ;561b  2e           13574  13593 
    DEFB    042H                        ;561c  42           13575  13594 
    DEFB    03EH                        ;561d  3e           13576  13595 
    DEFB    03EH                        ;561e  3e           13577  13596 
    DEFB    020H                        ;561f  20           13578  13597 
    DEFB    03EH                        ;5620  3e           13579  13598 
    DEFB    000H                        ;5621  00           13580  13599 
                                        ;                   13581  13600 ;
                                        ;                   13582  13601 ;CHR$(&H92)
    DEFB    000H                        ;5622  00           13583  13602 
    DEFB    022H                        ;5623  22           13584  13603 
    DEFB    022H                        ;5624  22           13585  13604 
    DEFB    0FAH                        ;5625  fa           13586  13605 
    DEFB    002H                        ;5626  02           13587  13606 
    DEFB    072H                        ;5627  72           13588  13607 
    DEFB    08BH                        ;5628  8b           13589  13608 
    DEFB    08AH                        ;5629  8a           13590  13609 
    DEFB    072H                        ;562a  72           13591  13610 
    DEFB    022H                        ;562b  22           13592  13611 
    DEFB    0FAH                        ;562c  fa           13593  13612 
    DEFB    000H                        ;562d  00           13594  13613 
                                        ;                   13595  13614 ;
                                        ;                   13596  13615 ;CHR$(&H93)
    DEFB    000H                        ;562e  00           13597  13616 
    DEFB    010H                        ;562f  10           13598  13617 
    DEFB    010H                        ;5630  10           13599  13618 
    DEFB    028H                        ;5631  28           13600  13619 
    DEFB    044H                        ;5632  44           13601  13620 
    DEFB    082H                        ;5633  82           13602  13621 
    DEFB    000H                        ;5634  00           13603  13622 
    DEFB    0FEH                        ;5635  fe           13604  13623 
    DEFB    010H                        ;5636  10           13605  13624 
    DEFB    010H                        ;5637  10           13606  13625 
    DEFB    010H                        ;5638  10           13607  13626 
    DEFB    010H                        ;5639  10           13608  13627 
                                        ;                   13609  13628 ;
                                        ;                   13610  13629 ;CHR$(&H94)
    DEFB    000H                        ;563a  00           13611  13630 
    DEFB    07CH                        ;563b  7c           13612  13631 
    DEFB    044H                        ;563c  44           13613  13632 
    DEFB    07CH                        ;563d  7c           13614  13633 
    DEFB    010H                        ;563e  10           13615  13634 
    DEFB    0FEH                        ;563f  fe           13616  13635 
    DEFB    000H                        ;5640  00           13617  13636 
    DEFB    07CH                        ;5641  7c           13618  13637 
    DEFB    004H                        ;5642  04           13619  13638 
    DEFB    004H                        ;5643  04           13620  13639 
    DEFB    004H                        ;5644  04           13621  13640 
    DEFB    000H                        ;5645  00           13622  13641 
                                        ;                   13623  13642 ;
                                        ;                   13624  13643 ;CHR$(&H95)
    DEFB    000H                        ;5646  00           13625  13644 
    DEFB    07CH                        ;5647  7c           13626  13645 
    DEFB    004H                        ;5648  04           13627  13646 
    DEFB    004H                        ;5649  04           13628  13647 
    DEFB    000H                        ;564a  00           13629  13648 
    DEFB    0FEH                        ;564b  fe           13630  13649 
    DEFB    000H                        ;564c  00           13631  13650 
    DEFB    07CH                        ;564d  7c           13632  13651 
    DEFB    044H                        ;564e  44           13633  13652 
    DEFB    044H                        ;564f  44           13634  13653 
    DEFB    07CH                        ;5650  7c           13635  13654 
    DEFB    000H                        ;5651  00           13636  13655 
                                        ;                   13637  13656 ;
                                        ;                   13638  13657 ;CHR$(&H96)
    DEFB    000H                        ;5652  00           13639  13658 
    DEFB    07CH                        ;5653  7c           13640  13659 
    DEFB    040H                        ;5654  40           13641  13660 
    DEFB    078H                        ;5655  78           13642  13661 
    DEFB    040H                        ;5656  40           13643  13662 
    DEFB    040H                        ;5657  40           13644  13663 
    DEFB    07CH                        ;5658  7c           13645  13664 
    DEFB    010H                        ;5659  10           13646  13665 
    DEFB    010H                        ;565a  10           13647  13666 
    DEFB    010H                        ;565b  10           13648  13667 
    DEFB    0FEH                        ;565c  fe           13649  13668 
    DEFB    000H                        ;565d  00           13650  13669 
                                        ;                   13651  13670 ;
                                        ;                   13652  13671 ;CHR$(&H97)
    DEFB    000H                        ;565e  00           13653  13672 
    DEFB    082H                        ;565f  82           13654  13673 
    DEFB    08EH                        ;5660  8e           13655  13674 
    DEFB    082H                        ;5661  82           13656  13675 
    DEFB    08EH                        ;5662  8e           13657  13676 
    DEFB    082H                        ;5663  82           13658  13677 
    DEFB    0FAH                        ;5664  fa           13659  13678 
    DEFB    002H                        ;5665  02           13660  13679 
    DEFB    040H                        ;5666  40           13661  13680 
    DEFB    040H                        ;5667  40           13662  13681 
    DEFB    07EH                        ;5668  7e           13663  13682 
    DEFB    000H                        ;5669  00           13664  13683 
                                        ;                   13665  13684 ;
                                        ;                   13666  13685 ;CHR$(&H98)
    DEFB    000H                        ;566a  00           13667  13686 
    DEFB    002H                        ;566b  02           13668  13687 
    DEFB    022H                        ;566c  22           13669  13688 
    DEFB    022H                        ;566d  22           13670  13689 
    DEFB    022H                        ;566e  22           13671  13690 
    DEFB    052H                        ;566f  52           13672  13691 
    DEFB    052H                        ;5670  52           13673  13692 
    DEFB    08AH                        ;5671  8a           13674  13693 
    DEFB    08AH                        ;5672  8a           13675  13694 
    DEFB    002H                        ;5673  02           13676  13695 
    DEFB    002H                        ;5674  02           13677  13696 
    DEFB    000H                        ;5675  00           13678  13697 
                                        ;                   13679  13698 ;
                                        ;                   13680  13699 ;CHR$(&H99)
    DEFB    000H                        ;5676  00           13681  13700 
    DEFB    044H                        ;5677  44           13682  13701 
    DEFB    07CH                        ;5678  7c           13683  13702 
    DEFB    044H                        ;5679  44           13684  13703 
    DEFB    07CH                        ;567a  7c           13685  13704 
    DEFB    000H                        ;567b  00           13686  13705 
    DEFB    0FEH                        ;567c  fe           13687  13706 
    DEFB    010H                        ;567d  10           13688  13707 
    DEFB    050H                        ;567e  50           13689  13708 
    DEFB    040H                        ;567f  40           13690  13709 
    DEFB    07CH                        ;5680  7c           13691  13710 
    DEFB    000H                        ;5681  00           13692  13711 
                                        ;                   13693  13712 ;
                                        ;                   13694  13713 ;CHR$(&H9A)
    DEFB    000H                        ;5682  00           13695  13714 
    DEFB    010H                        ;5683  10           13696  13715 
    DEFB    010H                        ;5684  10           13697  13716 
    DEFB    0FEH                        ;5685  fe           13698  13717 
    DEFB    028H                        ;5686  28           13699  13718 
    DEFB    044H                        ;5687  44           13700  13719 
    DEFB    082H                        ;5688  82           13701  13720 
    DEFB    010H                        ;5689  10           13702  13721 
    DEFB    010H                        ;568a  10           13703  13722 
    DEFB    010H                        ;568b  10           13704  13723 
    DEFB    0FEH                        ;568c  fe           13705  13724 
    DEFB    000H                        ;568d  00           13706  13725 
                                        ;                   13707  13726 ;
                                        ;                   13708  13727 ;CHR$(&H9B)
    DEFB    000H                        ;568e  00           13709  13728 
    DEFB    001H                        ;568f  01           13710  13729 
    DEFB    005H                        ;5690  05           13711  13730 
    DEFB    0F5H                        ;5691  f5           13712  13731 
    DEFB    015H                        ;5692  15           13713  13732 
    DEFB    015H                        ;5693  15           13714  13733 
    DEFB    017H                        ;5694  17           13715  13734 
    DEFB    025H                        ;5695  25           13716  13735 
    DEFB    045H                        ;5696  45           13717  13736 
    DEFB    085H                        ;5697  85           13718  13737 
    DEFB    005H                        ;5698  05           13719  13738 
    DEFB    000H                        ;5699  00           13720  13739 
                                        ;                   13721  13740 ;
                                        ;                   13722  13741 ;CHR$(&H9C)
    DEFB    000H                        ;569a  00           13723  13742 
    DEFB    001H                        ;569b  01           13724  13743 
    DEFB    005H                        ;569c  05           13725  13744 
    DEFB    0F5H                        ;569d  f5           13726  13745 
    DEFB    085H                        ;569e  85           13727  13746 
    DEFB    085H                        ;569f  85           13728  13747 
    DEFB    087H                        ;56a0  87           13729  13748 
    DEFB    085H                        ;56a1  85           13730  13749 
    DEFB    0F5H                        ;56a2  f5           13731  13750 
    DEFB    005H                        ;56a3  05           13732  13751 
    DEFB    005H                        ;56a4  05           13733  13752 
    DEFB    000H                        ;56a5  00           13734  13753 
                                        ;                   13735  13754 ;
                                        ;                   13736  13755 ;CHR$(&H9D)
    DEFB    000H                        ;56a6  00           13737  13756 
    DEFB    002H                        ;56a7  02           13738  13757 
    DEFB    072H                        ;56a8  72           13739  13758 
    DEFB    08AH                        ;56a9  8a           13740  13759 
    DEFB    08AH                        ;56aa  8a           13741  13760 
    DEFB    08AH                        ;56ab  8a           13742  13761 
    DEFB    072H                        ;56ac  72           13743  13762 
    DEFB    002H                        ;56ad  02           13744  13763 
    DEFB    042H                        ;56ae  42           13745  13764 
    DEFB    040H                        ;56af  40           13746  13765 
    DEFB    07EH                        ;56b0  7e           13747  13766 
    DEFB    000H                        ;56b1  00           13748  13767 
                                        ;                   13749  13768 ;
                                        ;                   13750  13769 ;CHR$(&H9E)
    DEFB    000H                        ;56b2  00           13751  13770 
    DEFB    000H                        ;56b3  00           13752  13771 
    DEFB    07CH                        ;56b4  7c           13753  13772 
    DEFB    040H                        ;56b5  40           13754  13773 
    DEFB    040H                        ;56b6  40           13755  13774 
    DEFB    040H                        ;56b7  40           13756  13775 
    DEFB    07CH                        ;56b8  7c           13757  13776 
    DEFB    010H                        ;56b9  10           13758  13777 
    DEFB    010H                        ;56ba  10           13759  13778 
    DEFB    010H                        ;56bb  10           13760  13779 
    DEFB    0FEH                        ;56bc  fe           13761  13780 
    DEFB    000H                        ;56bd  00           13762  13781 
                                        ;                   13763  13782 ;
                                        ;                   13764  13783 ;CHR$(&H9F)
    DEFB    000H                        ;56be  00           13765  13784 
    DEFB    002H                        ;56bf  02           13766  13785 
    DEFB    072H                        ;56c0  72           13767  13786 
    DEFB    08AH                        ;56c1  8a           13768  13787 
    DEFB    072H                        ;56c2  72           13769  13788 
    DEFB    0FAH                        ;56c3  fa           13770  13789 
    DEFB    02EH                        ;56c4  2e           13771  13790 
    DEFB    042H                        ;56c5  42           13772  13791 
    DEFB    022H                        ;56c6  22           13773  13792 
    DEFB    020H                        ;56c7  20           13774  13793 
    DEFB    03EH                        ;56c8  3e           13775  13794 
    DEFB    000H                        ;56c9  00           13776  13795 
                                        ;                   13777  13796 ;
                                        ;                   13778  13797 ;CHR$(&HA0)
    DEFB    000H                        ;56ca  00           13779  13798 
    DEFB    000H                        ;56cb  00           13780  13799 
    DEFB    000H                        ;56cc  00           13781  13800 
    DEFB    03EH                        ;56cd  3e           13782  13801 
    DEFB    022H                        ;56ce  22           13783  13802 
    DEFB    03EH                        ;56cf  3e           13784  13803 
    DEFB    022H                        ;56d0  22           13785  13804 
    DEFB    03EH                        ;56d1  3e           13786  13805 
    DEFB    000H                        ;56d2  00           13787  13806 
    DEFB    000H                        ;56d3  00           13788  13807 
    DEFB    000H                        ;56d4  00           13789  13808 
    DEFB    000H                        ;56d5  00           13790  13809 
                                        ;                   13791  13810 ;
                                        ;                   13792  13811 ;CHR$(&HA1)
    DEFB    000H                        ;56d6  00           13793  13812 
    DEFB    000H                        ;56d7  00           13794  13813 
    DEFB    03EH                        ;56d8  3e           13795  13814 
    DEFB    022H                        ;56d9  22           13796  13815 
    DEFB    03EH                        ;56da  3e           13797  13816 
    DEFB    022H                        ;56db  22           13798  13817 
    DEFB    03EH                        ;56dc  3e           13799  13818 
    DEFB    022H                        ;56dd  22           13800  13819 
    DEFB    042H                        ;56de  42           13801  13820 
    DEFB    000H                        ;56df  00           13802  13821 
    DEFB    000H                        ;56e0  00           13803  13822 
    DEFB    000H                        ;56e1  00           13804  13823 
                                        ;                   13805  13824 ;
                                        ;                   13806  13825 ;CHR$(&HA2)
    DEFB    000H                        ;56e2  00           13807  13826 
    DEFB    000H                        ;56e3  00           13808  13827 
    DEFB    010H                        ;56e4  10           13809  13828 
    DEFB    054H                        ;56e5  54           13810  13829 
    DEFB    054H                        ;56e6  54           13811  13830 
    DEFB    010H                        ;56e7  10           13812  13831 
    DEFB    028H                        ;56e8  28           13813  13832 
    DEFB    044H                        ;56e9  44           13814  13833 
    DEFB    082H                        ;56ea  82           13815  13834 
    DEFB    000H                        ;56eb  00           13816  13835 
    DEFB    000H                        ;56ec  00           13817  13836 
    DEFB    000H                        ;56ed  00           13818  13837 
                                        ;                   13819  13838 ;
                                        ;                   13820  13839 ;CHR$(&HA3)
    DEFB    000H                        ;56ee  00           13821  13840 
    DEFB    000H                        ;56ef  00           13822  13841 
    DEFB    010H                        ;56f0  10           13823  13842 
    DEFB    012H                        ;56f1  12           13824  13843 
    DEFB    0FCH                        ;56f2  fc           13825  13844 
    DEFB    038H                        ;56f3  38           13826  13845 
    DEFB    034H                        ;56f4  34           13827  13846 
    DEFB    052H                        ;56f5  52           13828  13847 
    DEFB    091H                        ;56f6  91           13829  13848 
    DEFB    000H                        ;56f7  00           13830  13849 
    DEFB    000H                        ;56f8  00           13831  13850 
    DEFB    000H                        ;56f9  00           13832  13851 
                                        ;                   13833  13852 ;
                                        ;                   13834  13853 ;CHR$(&HA4)
    DEFB    000H                        ;56fa  00           13835  13854 
    DEFB    000H                        ;56fb  00           13836  13855 
    DEFB    010H                        ;56fc  10           13837  13856 
    DEFB    010H                        ;56fd  10           13838  13857 
    DEFB    0FEH                        ;56fe  fe           13839  13858 
    DEFB    010H                        ;56ff  10           13840  13859 
    DEFB    038H                        ;5700  38           13841  13860 
    DEFB    054H                        ;5701  54           13842  13861 
    DEFB    092H                        ;5702  92           13843  13862 
    DEFB    000H                        ;5703  00           13844  13863 
    DEFB    000H                        ;5704  00           13845  13864 
    DEFB    000H                        ;5705  00           13846  13865 
                                        ;                   13847  13866 ;
                                        ;                   13848  13867 ;CHR$(&HA5)
    DEFB    000H                        ;5706  00           13849  13868 
    DEFB    000H                        ;5707  00           13850  13869 
    DEFB    010H                        ;5708  10           13851  13870 
    DEFB    028H                        ;5709  28           13852  13871 
    DEFB    07CH                        ;570a  7c           13853  13872 
    DEFB    092H                        ;570b  92           13854  13873 
    DEFB    07CH                        ;570c  7c           13855  13874 
    DEFB    054H                        ;570d  54           13856  13875 
    DEFB    0FEH                        ;570e  fe           13857  13876 
    DEFB    000H                        ;570f  00           13858  13877 
    DEFB    000H                        ;5710  00           13859  13878 
    DEFB    000H                        ;5711  00           13860  13879 
                                        ;                   13861  13880 ;
                                        ;                   13862  13881 ;CHR$(&HA6)
    DEFB    000H                        ;5712  00           13863  13882 
    DEFB    000H                        ;5713  00           13864  13883 
    DEFB    010H                        ;5714  10           13865  13884 
    DEFB    010H                        ;5715  10           13866  13885 
    DEFB    010H                        ;5716  10           13867  13886 
    DEFB    07CH                        ;5717  7c           13868  13887 
    DEFB    010H                        ;5718  10           13869  13888 
    DEFB    010H                        ;5719  10           13870  13889 
    DEFB    0FEH                        ;571a  fe           13871  13890 
    DEFB    000H                        ;571b  00           13872  13891 
    DEFB    000H                        ;571c  00           13873  13892 
    DEFB    000H                        ;571d  00           13874  13893 
                                        ;                   13875  13894 ;
                                        ;                   13876  13895 ;CHR$(&HA7)
    DEFB    000H                        ;571e  00           13877  13896 
    DEFB    000H                        ;571f  00           13878  13897 
    DEFB    020H                        ;5720  20           13879  13898 
    DEFB    07EH                        ;5721  7e           13880  13899 
    DEFB    080H                        ;5722  80           13881  13900 
    DEFB    07CH                        ;5723  7c           13882  13901 
    DEFB    050H                        ;5724  50           13883  13902 
    DEFB    0FEH                        ;5725  fe           13884  13903 
    DEFB    010H                        ;5726  10           13885  13904 
    DEFB    000H                        ;5727  00           13886  13905 
    DEFB    000H                        ;5728  00           13887  13906 
    DEFB    000H                        ;5729  00           13888  13907 
                                        ;                   13889  13908 ;
                                        ;                   13890  13909 ;CHR$(&HA8)
    DEFB    000H                        ;572a  00           13891  13910 
    DEFB    000H                        ;572b  00           13892  13911 
    DEFB    008H                        ;572c  08           13893  13912 
    DEFB    0FCH                        ;572d  fc           13894  13913 
    DEFB    0A8H                        ;572e  a8           13895  13914 
    DEFB    0FEH                        ;572f  fe           13896  13915 
    DEFB    0A4H                        ;5730  a4           13897  13916 
    DEFB    0FEH                        ;5731  fe           13898  13917 
    DEFB    014H                        ;5732  14           13899  13918 
    DEFB    004H                        ;5733  04           13900  13919 
    DEFB    000H                        ;5734  00           13901  13920 
    DEFB    000H                        ;5735  00           13902  13921 
                                        ;                   13903  13922 ;
                                        ;                   13904  13923 ;CHR$(&HA9)
    DEFB    000H                        ;5736  00           13905  13924 
    DEFB    000H                        ;5737  00           13906  13925 
    DEFB    010H                        ;5738  10           13907  13926 
    DEFB    028H                        ;5739  28           13908  13927 
    DEFB    044H                        ;573a  44           13909  13928 
    DEFB    0FEH                        ;573b  fe           13910  13929 
    DEFB    014H                        ;573c  14           13911  13930 
    DEFB    024H                        ;573d  24           13912  13931 
    DEFB    048H                        ;573e  48           13913  13932 
    DEFB    000H                        ;573f  00           13914  13933 
    DEFB    000H                        ;5740  00           13915  13934 
    DEFB    000H                        ;5741  00           13916  13935 
                                        ;                   13917  13936 ;
                                        ;                   13918  13937 ;CHR$(&HAA)
    DEFB    000H                        ;5742  00           13919  13938 
    DEFB    000H                        ;5743  00           13920  13939 
    DEFB    074H                        ;5744  74           13921  13940 
    DEFB    024H                        ;5745  24           13922  13941 
    DEFB    0F5H                        ;5746  f5           13923  13942 
    DEFB    065H                        ;5747  65           13924  13943 
    DEFB    0B2H                        ;5748  b2           13925  13944 
    DEFB    0A4H                        ;5749  a4           13926  13945 
    DEFB    028H                        ;574a  28           13927  13946 
    DEFB    000H                        ;574b  00           13928  13947 
    DEFB    000H                        ;574c  00           13929  13948 
    DEFB    000H                        ;574d  00           13930  13949 
                                        ;                   13931  13950 ;
                                        ;                   13932  13951 ;CHR$(&HAB)
    DEFB    000H                        ;574e  00           13933  13952 
    DEFB    000H                        ;574f  00           13934  13953 
    DEFB    010H                        ;5750  10           13935  13954 
    DEFB    010H                        ;5751  10           13936  13955 
    DEFB    010H                        ;5752  10           13937  13956 
    DEFB    054H                        ;5753  54           13938  13957 
    DEFB    092H                        ;5754  92           13939  13958 
    DEFB    030H                        ;5755  30           13940  13959 
    DEFB    010H                        ;5756  10           13941  13960 
    DEFB    000H                        ;5757  00           13942  13961 
    DEFB    000H                        ;5758  00           13943  13962 
    DEFB    000H                        ;5759  00           13944  13963 
                                        ;                   13945  13964 ;
                                        ;                   13946  13965 ;CHR$(&HAC)
    DEFB    000H                        ;575a  00           13947  13966 
    DEFB    000H                        ;575b  00           13948  13967 
    DEFB    010H                        ;575c  10           13949  13968 
    DEFB    010H                        ;575d  10           13950  13969 
    DEFB    0FEH                        ;575e  fe           13951  13970 
    DEFB    010H                        ;575f  10           13952  13971 
    DEFB    028H                        ;5760  28           13953  13972 
    DEFB    044H                        ;5761  44           13954  13973 
    DEFB    082H                        ;5762  82           13955  13974 
    DEFB    000H                        ;5763  00           13956  13975 
    DEFB    000H                        ;5764  00           13957  13976 
    DEFB    000H                        ;5765  00           13958  13977 
                                        ;                   13959  13978 ;
                                        ;                   13960  13979 ;CHR$(&HAD)
    DEFB    000H                        ;5766  00           13961  13980 
    DEFB    000H                        ;5767  00           13962  13981 
    DEFB    000H                        ;5768  00           13963  13982 
    DEFB    010H                        ;5769  10           13964  13983 
    DEFB    010H                        ;576a  10           13965  13984 
    DEFB    010H                        ;576b  10           13966  13985 
    DEFB    028H                        ;576c  28           13967  13986 
    DEFB    044H                        ;576d  44           13968  13987 
    DEFB    082H                        ;576e  82           13969  13988 
    DEFB    000H                        ;576f  00           13970  13989 
    DEFB    000H                        ;5770  00           13971  13990 
    DEFB    000H                        ;5771  00           13972  13991 
                                        ;                   13973  13992 ;
                                        ;                   13974  13993 ;CHR$(&HAE)
    DEFB    000H                        ;5772  00           13975  13994 
    DEFB    000H                        ;5773  00           13976  13995 
    DEFB    010H                        ;5774  10           13977  13996 
    DEFB    028H                        ;5775  28           13978  13997 
    DEFB    07CH                        ;5776  7c           13979  13998 
    DEFB    082H                        ;5777  82           13980  13999 
    DEFB    07CH                        ;5778  7c           13981  14000 
    DEFB    044H                        ;5779  44           13982  14001 
    DEFB    07CH                        ;577a  7c           13983  14002 
    DEFB    000H                        ;577b  00           13984  14003 
    DEFB    000H                        ;577c  00           13985  14004 
    DEFB    000H                        ;577d  00           13986  14005 
                                        ;                   13987  14006 ;
                                        ;                   13988  14007 ;CHR$(&HAF)
    DEFB    000H                        ;577e  00           13989  14008 
    DEFB    000H                        ;577f  00           13990  14009 
    DEFB    03CH                        ;5780  3c           13991  14010 
    DEFB    044H                        ;5781  44           13992  14011 
    DEFB    0A8H                        ;5782  a8           13993  14012 
    DEFB    010H                        ;5783  10           13994  14013 
    DEFB    03EH                        ;5784  3e           13995  14014 
    DEFB    0E2H                        ;5785  e2           13996  14015 
    DEFB    03EH                        ;5786  3e           13997  14016 
    DEFB    000H                        ;5787  00           13998  14017 
    DEFB    000H                        ;5788  00           13999  14018 
    DEFB    000H                        ;5789  00           14000  14019 
                                        ;                   14001  14020 ;
                                        ;                   14002  14021 ;CHR$(&H90)
    DEFB    000H                        ;578a  00           14003  14022 
    DEFB    000H                        ;578b  00           14004  14023 
    DEFB    000H                        ;578c  00           14005  14024 
    DEFB    008H                        ;578d  08           14006  14025 
    DEFB    07FH                        ;578e  7f           14007  14026 
    DEFB    008H                        ;578f  08           14008  14027 
    DEFB    07FH                        ;5790  7f           14009  14028 
    DEFB    008H                        ;5791  08           14010  14029 
    DEFB    000H                        ;5792  00           14011  14030 
    DEFB    000H                        ;5793  00           14012  14031 
    DEFB    000H                        ;5794  00           14013  14032 
    DEFB    000H                        ;5795  00           14014  14033 
                                        ;                   14015  14034 ;
                                        ;                   14016  14035 ;CHR$(&HB1)
    DEFB    000H                        ;5796  00           14017  14036 
    DEFB    000H                        ;5797  00           14018  14037 
    DEFB    006H                        ;5798  06           14019  14038 
    DEFB    018H                        ;5799  18           14020  14039 
    DEFB    020H                        ;579a  20           14021  14040 
    DEFB    018H                        ;579b  18           14022  14041 
    DEFB    006H                        ;579c  06           14023  14042 
    DEFB    000H                        ;579d  00           14024  14043 
    DEFB    03EH                        ;579e  3e           14025  14044 
    DEFB    000H                        ;579f  00           14026  14045 
    DEFB    000H                        ;57a0  00           14027  14046 
    DEFB    000H                        ;57a1  00           14028  14047 
                                        ;                   14029  14048 ;
                                        ;                   14030  14049 ;CHR$(&HB2)
    DEFB    000H                        ;57a2  00           14031  14050 
    DEFB    000H                        ;57a3  00           14032  14051 
    DEFB    030H                        ;57a4  30           14033  14052 
    DEFB    00CH                        ;57a5  0c           14034  14053 
    DEFB    002H                        ;57a6  02           14035  14054 
    DEFB    00CH                        ;57a7  0c           14036  14055 
    DEFB    030H                        ;57a8  30           14037  14056 
    DEFB    000H                        ;57a9  00           14038  14057 
    DEFB    03EH                        ;57aa  3e           14039  14058 
    DEFB    000H                        ;57ab  00           14040  14059 
    DEFB    000H                        ;57ac  00           14041  14060 
    DEFB    000H                        ;57ad  00           14042  14061 
                                        ;                   14043  14062 ;
                                        ;                   14044  14063 ;CHR$(&HB3)
    DEFB    000H                        ;57ae  00           14045  14064 
    DEFB    000H                        ;57af  00           14046  14065 
    DEFB    008H                        ;57b0  08           14047  14066 
    DEFB    008H                        ;57b1  08           14048  14067 
    DEFB    03EH                        ;57b2  3e           14049  14068 
    DEFB    008H                        ;57b3  08           14050  14069 
    DEFB    008H                        ;57b4  08           14051  14070 
    DEFB    000H                        ;57b5  00           14052  14071 
    DEFB    03EH                        ;57b6  3e           14053  14072 
    DEFB    000H                        ;57b7  00           14054  14073 
    DEFB    000H                        ;57b8  00           14055  14074 
    DEFB    000H                        ;57b9  00           14056  14075 
                                        ;                   14057  14076 ;
                                        ;                   14058  14077 ;CHR$(&HB4)
    DEFB    000H                        ;57ba  00           14059  14078 
    DEFB    000H                        ;57bb  00           14060  14079 
    DEFB    000H                        ;57bc  00           14061  14080 
    DEFB    022H                        ;57bd  22           14062  14081 
    DEFB    014H                        ;57be  14           14063  14082 
    DEFB    008H                        ;57bf  08           14064  14083 
    DEFB    014H                        ;57c0  14           14065  14084 
    DEFB    022H                        ;57c1  22           14066  14085 
    DEFB    000H                        ;57c2  00           14067  14086 
    DEFB    000H                        ;57c3  00           14068  14087 
    DEFB    000H                        ;57c4  00           14069  14088 
    DEFB    000H                        ;57c5  00           14070  14089 
                                        ;                   14071  14090 ;
                                        ;                   14072  14091 ;CHR$(&HB5)
    DEFB    000H                        ;57c6  00           14073  14092 
    DEFB    000H                        ;57c7  00           14074  14093 
    DEFB    000H                        ;57c8  00           14075  14094 
    DEFB    03EH                        ;57c9  3e           14076  14095 
    DEFB    049H                        ;57ca  49           14077  14096 
    DEFB    07FH                        ;57cb  7f           14078  14097 
    DEFB    049H                        ;57cc  49           14079  14098 
    DEFB    03EH                        ;57cd  3e           14080  14099 
    DEFB    000H                        ;57ce  00           14081  14100 
    DEFB    000H                        ;57cf  00           14082  14101 
    DEFB    000H                        ;57d0  00           14083  14102 
    DEFB    000H                        ;57d1  00           14084  14103 
                                        ;                   14085  14104 ;
                                        ;                   14086  14105 ;CHR$(&HB6)
    DEFB    000H                        ;57d2  00           14087  14106 
    DEFB    000H                        ;57d3  00           14088  14107 
    DEFB    000H                        ;57d4  00           14089  14108 
    DEFB    000H                        ;57d5  00           14090  14109 
    DEFB    000H                        ;57d6  00           14091  14110 
    DEFB    008H                        ;57d7  08           14092  14111 
    DEFB    000H                        ;57d8  00           14093  14112 
    DEFB    000H                        ;57d9  00           14094  14113 
    DEFB    000H                        ;57da  00           14095  14114 
    DEFB    000H                        ;57db  00           14096  14115 
    DEFB    000H                        ;57dc  00           14097  14116 
    DEFB    000H                        ;57dd  00           14098  14117 
                                        ;                   14099  14118 ;
                                        ;                   14100  14119 ;CHR$(&HB7)
    DEFB    000H                        ;57de  00           14101  14120 
    DEFB    000H                        ;57df  00           14102  14121 
    DEFB    000H                        ;57e0  00           14103  14122 
    DEFB    000H                        ;57e1  00           14104  14123 
    DEFB    008H                        ;57e2  08           14105  14124 
    DEFB    014H                        ;57e3  14           14106  14125 
    DEFB    022H                        ;57e4  22           14107  14126 
    DEFB    07FH                        ;57e5  7f           14108  14127 
    DEFB    000H                        ;57e6  00           14109  14128 
    DEFB    000H                        ;57e7  00           14110  14129 
    DEFB    000H                        ;57e8  00           14111  14130 
    DEFB    000H                        ;57e9  00           14112  14131 
                                        ;                   14113  14132 ;
                                        ;                   14114  14133 ;CHR$(&HB8)
    DEFB    000H                        ;57ea  00           14115  14134 
    DEFB    000H                        ;57eb  00           14116  14135 
    DEFB    000H                        ;57ec  00           14117  14136 
    DEFB    000H                        ;57ed  00           14118  14137 
    DEFB    07FH                        ;57ee  7f           14119  14138 
    DEFB    022H                        ;57ef  22           14120  14139 
    DEFB    014H                        ;57f0  14           14121  14140 
    DEFB    008H                        ;57f1  08           14122  14141 
    DEFB    000H                        ;57f2  00           14123  14142 
    DEFB    000H                        ;57f3  00           14124  14143 
    DEFB    000H                        ;57f4  00           14125  14144 
    DEFB    000H                        ;57f5  00           14126  14145 
                                        ;                   14127  14146 ;
                                        ;                   14128  14147 ;CHR$(&HB9)
    DEFB    000H                        ;57f6  00           14129  14148 
    DEFB    000H                        ;57f7  00           14130  14149 
    DEFB    000H                        ;57f8  00           14131  14150 
    DEFB    000H                        ;57f9  00           14132  14151 
    DEFB    000H                        ;57fa  00           14133  14152 
    DEFB    008H                        ;57fb  08           14134  14153 
    DEFB    000H                        ;57fc  00           14135  14154 
    DEFB    000H                        ;57fd  00           14136  14155 
    DEFB    022H                        ;57fe  22           14137  14156 
    DEFB    000H                        ;57ff  00           14138  14157 
    DEFB    000H                        ;5800  00           14139  14158 
    DEFB    000H                        ;5801  00           14140  14159 
                                        ;                   14141  14160 ;
                                        ;                   14142  14161 ;CHR$(&HBA)
    DEFB    000H                        ;5802  00           14143  14162 
    DEFB    000H                        ;5803  00           14144  14163 
    DEFB    008H                        ;5804  08           14145  14164 
    DEFB    000H                        ;5805  00           14146  14165 
    DEFB    008H                        ;5806  08           14147  14166 
    DEFB    008H                        ;5807  08           14148  14167 
    DEFB    008H                        ;5808  08           14149  14168 
    DEFB    008H                        ;5809  08           14150  14169 
    DEFB    008H                        ;580a  08           14151  14170 
    DEFB    000H                        ;580b  00           14152  14171 
    DEFB    000H                        ;580c  00           14153  14172 
    DEFB    000H                        ;580d  00           14154  14173 
                                        ;                   14155  14174 ;
                                        ;                   14156  14175 ;CHR$(&HBB)
    DEFB    000H                        ;580e  00           14157  14176 
    DEFB    000H                        ;580f  00           14158  14177 
    DEFB    000H                        ;5810  00           14159  14178 
    DEFB    000H                        ;5811  00           14160  14179 
    DEFB    000H                        ;5812  00           14161  14180 
    DEFB    022H                        ;5813  22           14162  14181 
    DEFB    000H                        ;5814  00           14163  14182 
    DEFB    000H                        ;5815  00           14164  14183 
    DEFB    008H                        ;5816  08           14165  14184 
    DEFB    000H                        ;5817  00           14166  14185 
    DEFB    000H                        ;5818  00           14167  14186 
    DEFB    000H                        ;5819  00           14168  14187 
                                        ;                   14169  14188 ;
                                        ;                   14170  14189 ;CHR$(&HBC)
    DEFB    00CH                        ;581a  0c           14171  14190 
    DEFB    010H                        ;581b  10           14172  14191 
    DEFB    010H                        ;581c  10           14173  14192 
    DEFB    010H                        ;581d  10           14174  14193 
    DEFB    010H                        ;581e  10           14175  14194 
    DEFB    010H                        ;581f  10           14176  14195 
    DEFB    010H                        ;5820  10           14177  14196 
    DEFB    010H                        ;5821  10           14178  14197 
    DEFB    010H                        ;5822  10           14179  14198 
    DEFB    010H                        ;5823  10           14180  14199 
    DEFB    010H                        ;5824  10           14181  14200 
    DEFB    060H                        ;5825  60           14182  14201 
                                        ;                   14183  14202 ;
                                        ;                   14184  14203 ;CHR$(&HBD)
    DEFB    000H                        ;5826  00           14185  14204 
    DEFB    00FH                        ;5827  0f           14186  14205 
    DEFB    008H                        ;5828  08           14187  14206 
    DEFB    008H                        ;5829  08           14188  14207 
    DEFB    008H                        ;582a  08           14189  14208 
    DEFB    048H                        ;582b  48           14190  14209 
    DEFB    0A8H                        ;582c  a8           14191  14210 
    DEFB    018H                        ;582d  18           14192  14211 
    DEFB    008H                        ;582e  08           14193  14212 
    DEFB    000H                        ;582f  00           14194  14213 
    DEFB    000H                        ;5830  00           14195  14214 
    DEFB    000H                        ;5831  00           14196  14215 
                                        ;                   14197  14216 ;
                                        ;                   14198  14217 ;CHR$(&HBE)
    DEFB    000H                        ;5832  00           14199  14218 
    DEFB    000H                        ;5833  00           14200  14219 
    DEFB    000H                        ;5834  00           14201  14220 
    DEFB    07EH                        ;5835  7e           14202  14221 
    DEFB    020H                        ;5836  20           14203  14222 
    DEFB    010H                        ;5837  10           14204  14223 
    DEFB    020H                        ;5838  20           14205  14224 
    DEFB    07EH                        ;5839  7e           14206  14225 
    DEFB    000H                        ;583a  00           14207  14226 
    DEFB    000H                        ;583b  00           14208  14227 
    DEFB    000H                        ;583c  00           14209  14228 
    DEFB    000H                        ;583d  00           14210  14229 
                                        ;                   14211  14230 ;
                                        ;                   14212  14231 ;CHR$(&HBF)
    DEFB    000H                        ;583e  00           14213  14232 
    DEFB    000H                        ;583f  00           14214  14233 
    DEFB    000H                        ;5840  00           14215  14234 
    DEFB    03EH                        ;5841  3e           14216  14235 
    DEFB    014H                        ;5842  14           14217  14236 
    DEFB    014H                        ;5843  14           14218  14237 
    DEFB    014H                        ;5844  14           14219  14238 
    DEFB    014H                        ;5845  14           14220  14239 
    DEFB    000H                        ;5846  00           14221  14240 
    DEFB    000H                        ;5847  00           14222  14241 
    DEFB    000H                        ;5848  00           14223  14242 
    DEFB    000H                        ;5849  00           14224  14243 
                                        ;                   14225  14244 ;
                                        ;                   14226  14245 ;CHR$(&HC0)
    DEFB    000H                        ;584a  00           14227  14246 
    DEFB    060H                        ;584b  60           14228  14247 
    DEFB    090H                        ;584c  90           14229  14248 
    DEFB    090H                        ;584d  90           14230  14249 
    DEFB    090H                        ;584e  90           14231  14250 
    DEFB    060H                        ;584f  60           14232  14251 
    DEFB    000H                        ;5850  00           14233  14252 
    DEFB    000H                        ;5851  00           14234  14253 
    DEFB    000H                        ;5852  00           14235  14254 
    DEFB    000H                        ;5853  00           14236  14255 
    DEFB    000H                        ;5854  00           14237  14256 
    DEFB    000H                        ;5855  00           14238  14257 
                                        ;                   14239  14258 ;
                                        ;                   14240  14259 ;CHR$(&HC1)
    DEFB    000H                        ;5856  00           14241  14260 
    DEFB    020H                        ;5857  20           14242  14261 
    DEFB    060H                        ;5858  60           14243  14262 
    DEFB    020H                        ;5859  20           14244  14263 
    DEFB    020H                        ;585a  20           14245  14264 
    DEFB    020H                        ;585b  20           14246  14265 
    DEFB    000H                        ;585c  00           14247  14266 
    DEFB    000H                        ;585d  00           14248  14267 
    DEFB    000H                        ;585e  00           14249  14268 
    DEFB    000H                        ;585f  00           14250  14269 
    DEFB    000H                        ;5860  00           14251  14270 
    DEFB    000H                        ;5861  00           14252  14271 
                                        ;                   14253  14272 ;
                                        ;                   14254  14273 ;CHR$(&HC2)
    DEFB    000H                        ;5862  00           14255  14274 
    DEFB    060H                        ;5863  60           14256  14275 
    DEFB    090H                        ;5864  90           14257  14276 
    DEFB    020H                        ;5865  20           14258  14277 
    DEFB    040H                        ;5866  40           14259  14278 
    DEFB    0F0H                        ;5867  f0           14260  14279 
    DEFB    000H                        ;5868  00           14261  14280 
    DEFB    000H                        ;5869  00           14262  14281 
    DEFB    000H                        ;586a  00           14263  14282 
    DEFB    000H                        ;586b  00           14264  14283 
    DEFB    000H                        ;586c  00           14265  14284 
    DEFB    000H                        ;586d  00           14266  14285 
                                        ;                   14267  14286 ;
                                        ;                   14268  14287 ;CHR$(&HC3)
    DEFB    000H                        ;586e  00           14269  14288 
    DEFB    060H                        ;586f  60           14270  14289 
    DEFB    090H                        ;5870  90           14271  14290 
    DEFB    020H                        ;5871  20           14272  14291 
    DEFB    090H                        ;5872  90           14273  14292 
    DEFB    060H                        ;5873  60           14274  14293 
    DEFB    000H                        ;5874  00           14275  14294 
    DEFB    000H                        ;5875  00           14276  14295 
    DEFB    000H                        ;5876  00           14277  14296 
    DEFB    000H                        ;5877  00           14278  14297 
    DEFB    000H                        ;5878  00           14279  14298 
    DEFB    000H                        ;5879  00           14280  14299 
                                        ;                   14281  14300 ;
                                        ;                   14282  14301 ;CHR$(&HC4)
    DEFB    000H                        ;587a  00           14283  14302 
    DEFB    060H                        ;587b  60           14284  14303 
    DEFB    0A0H                        ;587c  a0           14285  14304 
    DEFB    0A0H                        ;587d  a0           14286  14305 
    DEFB    0F0H                        ;587e  f0           14287  14306 
    DEFB    020H                        ;587f  20           14288  14307 
    DEFB    000H                        ;5880  00           14289  14308 
    DEFB    000H                        ;5881  00           14290  14309 
    DEFB    000H                        ;5882  00           14291  14310 
    DEFB    000H                        ;5883  00           14292  14311 
    DEFB    000H                        ;5884  00           14293  14312 
    DEFB    000H                        ;5885  00           14294  14313 
                                        ;                   14295  14314 ;
                                        ;                   14296  14315 ;CHR$(&HC5)
    DEFB    000H                        ;5886  00           14297  14316 
    DEFB    0F0H                        ;5887  f0           14298  14317 
    DEFB    080H                        ;5888  80           14299  14318 
    DEFB    0F0H                        ;5889  f0           14300  14319 
    DEFB    010H                        ;588a  10           14301  14320 
    DEFB    0E0H                        ;588b  e0           14302  14321 
    DEFB    000H                        ;588c  00           14303  14322 
    DEFB    000H                        ;588d  00           14304  14323 
    DEFB    000H                        ;588e  00           14305  14324 
    DEFB    000H                        ;588f  00           14306  14325 
    DEFB    000H                        ;5890  00           14307  14326 
    DEFB    000H                        ;5891  00           14308  14327 
                                        ;                   14309  14328 ;
                                        ;                   14310  14329 ;CHR$(&HC6)
    DEFB    000H                        ;5892  00           14311  14330 
    DEFB    060H                        ;5893  60           14312  14331 
    DEFB    080H                        ;5894  80           14313  14332 
    DEFB    0F0H                        ;5895  f0           14314  14333 
    DEFB    090H                        ;5896  90           14315  14334 
    DEFB    060H                        ;5897  60           14316  14335 
    DEFB    000H                        ;5898  00           14317  14336 
    DEFB    000H                        ;5899  00           14318  14337 
    DEFB    000H                        ;589a  00           14319  14338 
    DEFB    000H                        ;589b  00           14320  14339 
    DEFB    000H                        ;589c  00           14321  14340 
    DEFB    000H                        ;589d  00           14322  14341 
                                        ;                   14323  14342 ;
                                        ;                   14324  14343 ;CHR$(&HC7)
    DEFB    000H                        ;589e  00           14325  14344 
    DEFB    0F0H                        ;589f  f0           14326  14345 
    DEFB    010H                        ;58a0  10           14327  14346 
    DEFB    020H                        ;58a1  20           14328  14347 
    DEFB    020H                        ;58a2  20           14329  14348 
    DEFB    020H                        ;58a3  20           14330  14349 
    DEFB    000H                        ;58a4  00           14331  14350 
    DEFB    000H                        ;58a5  00           14332  14351 
    DEFB    000H                        ;58a6  00           14333  14352 
    DEFB    000H                        ;58a7  00           14334  14353 
    DEFB    000H                        ;58a8  00           14335  14354 
    DEFB    000H                        ;58a9  00           14336  14355 
                                        ;                   14337  14356 ;
                                        ;                   14338  14357 ;CHR$(&HC8)
    DEFB    000H                        ;58aa  00           14339  14358 
    DEFB    060H                        ;58ab  60           14340  14359 
    DEFB    090H                        ;58ac  90           14341  14360 
    DEFB    060H                        ;58ad  60           14342  14361 
    DEFB    090H                        ;58ae  90           14343  14362 
    DEFB    060H                        ;58af  60           14344  14363 
    DEFB    000H                        ;58b0  00           14345  14364 
    DEFB    000H                        ;58b1  00           14346  14365 
    DEFB    000H                        ;58b2  00           14347  14366 
    DEFB    000H                        ;58b3  00           14348  14367 
    DEFB    000H                        ;58b4  00           14349  14368 
    DEFB    000H                        ;58b5  00           14350  14369 
                                        ;                   14351  14370 ;
                                        ;                   14352  14371 ;CHR$(&HC9)
    DEFB    000H                        ;58b6  00           14353  14372 
    DEFB    060H                        ;58b7  60           14354  14373 
    DEFB    090H                        ;58b8  90           14355  14374 
    DEFB    0F0H                        ;58b9  f0           14356  14375 
    DEFB    010H                        ;58ba  10           14357  14376 
    DEFB    060H                        ;58bb  60           14358  14377 
    DEFB    000H                        ;58bc  00           14359  14378 
    DEFB    000H                        ;58bd  00           14360  14379 
    DEFB    000H                        ;58be  00           14361  14380 
    DEFB    000H                        ;58bf  00           14362  14381 
    DEFB    000H                        ;58c0  00           14363  14382 
    DEFB    000H                        ;58c1  00           14364  14383 
                                        ;                   14365  14384 ;
                                        ;                   14366  14385 ;CHR$(&HCA)
    DEFB    000H                        ;58c2  00           14367  14386 
    DEFB    000H                        ;58c3  00           14368  14387 
    DEFB    000H                        ;58c4  00           14369  14388 
    DEFB    000H                        ;58c5  00           14370  14389 
    DEFB    002H                        ;58c6  02           14371  14390 
    DEFB    034H                        ;58c7  34           14372  14391 
    DEFB    048H                        ;58c8  48           14373  14392 
    DEFB    048H                        ;58c9  48           14374  14393 
    DEFB    036H                        ;58ca  36           14375  14394 
    DEFB    000H                        ;58cb  00           14376  14395 
    DEFB    000H                        ;58cc  00           14377  14396 
    DEFB    000H                        ;58cd  00           14378  14397 
                                        ;                   14379  14398 ;
                                        ;                   14380  14399 ;CHR$(&HCB)
    DEFB    000H                        ;58ce  00           14381  14400 
    DEFB    000H                        ;58cf  00           14382  14401 
    DEFB    018H                        ;58d0  18           14383  14402 
    DEFB    024H                        ;58d1  24           14384  14403 
    DEFB    038H                        ;58d2  38           14385  14404 
    DEFB    024H                        ;58d3  24           14386  14405 
    DEFB    024H                        ;58d4  24           14387  14406 
    DEFB    038H                        ;58d5  38           14388  14407 
    DEFB    020H                        ;58d6  20           14389  14408 
    DEFB    000H                        ;58d7  00           14390  14409 
    DEFB    000H                        ;58d8  00           14391  14410 
    DEFB    000H                        ;58d9  00           14392  14411 
                                        ;                   14393  14412 ;
                                        ;                   14394  14413 ;CHR$(&HCC)
    DEFB    000H                        ;58da  00           14395  14414 
    DEFB    000H                        ;58db  00           14396  14415 
    DEFB    000H                        ;58dc  00           14397  14416 
    DEFB    000H                        ;58dd  00           14398  14417 
    DEFB    04EH                        ;58de  4e           14399  14418 
    DEFB    030H                        ;58df  30           14400  14419 
    DEFB    020H                        ;58e0  20           14401  14420 
    DEFB    020H                        ;58e1  20           14402  14421 
    DEFB    020H                        ;58e2  20           14403  14422 
    DEFB    000H                        ;58e3  00           14404  14423 
    DEFB    000H                        ;58e4  00           14405  14424 
    DEFB    000H                        ;58e5  00           14406  14425 
                                        ;                   14407  14426 ;
                                        ;                   14408  14427 ;CHR$(&HCD)
    DEFB    000H                        ;58e6  00           14409  14428 
    DEFB    000H                        ;58e7  00           14410  14429 
    DEFB    018H                        ;58e8  18           14411  14430 
    DEFB    024H                        ;58e9  24           14412  14431 
    DEFB    024H                        ;58ea  24           14413  14432 
    DEFB    03CH                        ;58eb  3c           14414  14433 
    DEFB    024H                        ;58ec  24           14415  14434 
    DEFB    024H                        ;58ed  24           14416  14435 
    DEFB    018H                        ;58ee  18           14417  14436 
    DEFB    000H                        ;58ef  00           14418  14437 
    DEFB    000H                        ;58f0  00           14419  14438 
    DEFB    000H                        ;58f1  00           14420  14439 
                                        ;                   14421  14440 ;
                                        ;                   14422  14441 ;CHR$(&HCE)
    DEFB    000H                        ;58f2  00           14423  14442 
    DEFB    000H                        ;58f3  00           14424  14443 
    DEFB    01CH                        ;58f4  1c           14425  14444 
    DEFB    020H                        ;58f5  20           14426  14445 
    DEFB    020H                        ;58f6  20           14427  14446 
    DEFB    018H                        ;58f7  18           14428  14447 
    DEFB    024H                        ;58f8  24           14429  14448 
    DEFB    024H                        ;58f9  24           14430  14449 
    DEFB    018H                        ;58fa  18           14431  14450 
    DEFB    000H                        ;58fb  00           14432  14451 
    DEFB    000H                        ;58fc  00           14433  14452 
    DEFB    000H                        ;58fd  00           14434  14453 
                                        ;                   14435  14454 ;
                                        ;                   14436  14455 ;CHR$(&HCF)
    DEFB    000H                        ;58fe  00           14437  14456 
    DEFB    000H                        ;58ff  00           14438  14457 
    DEFB    000H                        ;5900  00           14439  14458 
    DEFB    008H                        ;5901  08           14440  14459 
    DEFB    01CH                        ;5902  1c           14441  14460 
    DEFB    02AH                        ;5903  2a           14442  14461 
    DEFB    02AH                        ;5904  2a           14443  14462 
    DEFB    01CH                        ;5905  1c           14444  14463 
    DEFB    008H                        ;5906  08           14445  14464 
    DEFB    000H                        ;5907  00           14446  14465 
    DEFB    000H                        ;5908  00           14447  14466 
    DEFB    000H                        ;5909  00           14448  14467 
                                        ;                   14449  14468 ;
                                        ;                   14450  14469 ;CHR$(&HD0)
    DEFB    080H                        ;590a  80           14451  14470 
    DEFB    040H                        ;590b  40           14452  14471 
    DEFB    040H                        ;590c  40           14453  14472 
    DEFB    020H                        ;590d  20           14454  14473 
    DEFB    010H                        ;590e  10           14455  14474 
    DEFB    010H                        ;590f  10           14456  14475 
    DEFB    008H                        ;5910  08           14457  14476 
    DEFB    004H                        ;5911  04           14458  14477 
    DEFB    004H                        ;5912  04           14459  14478 
    DEFB    002H                        ;5913  02           14460  14479 
    DEFB    001H                        ;5914  01           14461  14480 
    DEFB    001H                        ;5915  01           14462  14481 
                                        ;                   14463  14482 ;
                                        ;                   14464  14483 ;CHR$(&HD1)
    DEFB    000H                        ;5916  00           14465  14484 
    DEFB    000H                        ;5917  00           14466  14485 
    DEFB    000H                        ;5918  00           14467  14486 
    DEFB    000H                        ;5919  00           14468  14487 
    DEFB    000H                        ;591a  00           14469  14488 
    DEFB    000H                        ;591b  00           14470  14489 
    DEFB    0FEH                        ;591c  fe           14471  14490 
    DEFB    000H                        ;591d  00           14472  14491 
    DEFB    000H                        ;591e  00           14473  14492 
    DEFB    000H                        ;591f  00           14474  14493 
    DEFB    000H                        ;5920  00           14475  14494 
    DEFB    000H                        ;5921  00           14476  14495 
                                        ;                   14477  14496 ;
                                        ;                   14478  14497 ;CHR$(&HD2)
    DEFB    000H                        ;5922  00           14479  14498 
    DEFB    000H                        ;5923  00           14480  14499 
    DEFB    000H                        ;5924  00           14481  14500 
    DEFB    000H                        ;5925  00           14482  14501 
    DEFB    000H                        ;5926  00           14483  14502 
    DEFB    07CH                        ;5927  7c           14484  14503 
    DEFB    000H                        ;5928  00           14485  14504 
    DEFB    000H                        ;5929  00           14486  14505 
    DEFB    0FEH                        ;592a  fe           14487  14506 
    DEFB    000H                        ;592b  00           14488  14507 
    DEFB    000H                        ;592c  00           14489  14508 
    DEFB    000H                        ;592d  00           14490  14509 
                                        ;                   14491  14510 ;
                                        ;                   14492  14511 ;CHR$(&HD3)
    DEFB    000H                        ;592e  00           14493  14512 
    DEFB    000H                        ;592f  00           14494  14513 
    DEFB    000H                        ;5930  00           14495  14514 
    DEFB    000H                        ;5931  00           14496  14515 
    DEFB    07CH                        ;5932  7c           14497  14516 
    DEFB    000H                        ;5933  00           14498  14517 
    DEFB    07CH                        ;5934  7c           14499  14518 
    DEFB    000H                        ;5935  00           14500  14519 
    DEFB    0FEH                        ;5936  fe           14501  14520 
    DEFB    000H                        ;5937  00           14502  14521 
    DEFB    000H                        ;5938  00           14503  14522 
    DEFB    000H                        ;5939  00           14504  14523 
                                        ;                   14505  14524 ;
                                        ;                   14506  14525 ;CHR$(&HD4)
    DEFB    000H                        ;593a  00           14507  14526 
    DEFB    000H                        ;593b  00           14508  14527 
    DEFB    000H                        ;593c  00           14509  14528 
    DEFB    000H                        ;593d  00           14510  14529 
    DEFB    0FEH                        ;593e  fe           14511  14530 
    DEFB    0AAH                        ;593f  aa           14512  14531 
    DEFB    0AAH                        ;5940  aa           14513  14532 
    DEFB    0AAH                        ;5941  aa           14514  14533 
    DEFB    0FEH                        ;5942  fe           14515  14534 
    DEFB    000H                        ;5943  00           14516  14535 
    DEFB    000H                        ;5944  00           14517  14536 
    DEFB    000H                        ;5945  00           14518  14537 
                                        ;                   14519  14538 ;
                                        ;                   14520  14539 ;CHR$(&HD5)
    DEFB    000H                        ;5946  00           14521  14540 
    DEFB    000H                        ;5947  00           14522  14541 
    DEFB    000H                        ;5948  00           14523  14542 
    DEFB    07CH                        ;5949  7c           14524  14543 
    DEFB    010H                        ;594a  10           14525  14544 
    DEFB    07CH                        ;594b  7c           14526  14545 
    DEFB    014H                        ;594c  14           14527  14546 
    DEFB    014H                        ;594d  14           14528  14547 
    DEFB    0FEH                        ;594e  fe           14529  14548 
    DEFB    000H                        ;594f  00           14530  14549 
    DEFB    000H                        ;5950  00           14531  14550 
    DEFB    000H                        ;5951  00           14532  14551 
                                        ;                   14533  14552 ;
                                        ;                   14534  14553 ;CHR$(&HD6)
    DEFB    000H                        ;5952  00           14535  14554 
    DEFB    000H                        ;5953  00           14536  14555 
    DEFB    010H                        ;5954  10           14537  14556 
    DEFB    010H                        ;5955  10           14538  14557 
    DEFB    0FEH                        ;5956  fe           14539  14558 
    DEFB    000H                        ;5957  00           14540  14559 
    DEFB    028H                        ;5958  28           14541  14560 
    DEFB    044H                        ;5959  44           14542  14561 
    DEFB    082H                        ;595a  82           14543  14562 
    DEFB    000H                        ;595b  00           14544  14563 
    DEFB    000H                        ;595c  00           14545  14564 
    DEFB    000H                        ;595d  00           14546  14565 
                                        ;                   14547  14566 ;
                                        ;                   14548  14567 ;CHR$(&HD7)
    DEFB    000H                        ;595e  00           14549  14568 
    DEFB    000H                        ;595f  00           14550  14569 
    DEFB    020H                        ;5960  20           14551  14570 
    DEFB    020H                        ;5961  20           14552  14571 
    DEFB    020H                        ;5962  20           14553  14572 
    DEFB    0FEH                        ;5963  fe           14554  14573 
    DEFB    020H                        ;5964  20           14555  14574 
    DEFB    020H                        ;5965  20           14556  14575 
    DEFB    03EH                        ;5966  3e           14557  14576 
    DEFB    000H                        ;5967  00           14558  14577 
    DEFB    000H                        ;5968  00           14559  14578 
    DEFB    000H                        ;5969  00           14560  14579 
                                        ;                   14561  14580 ;
                                        ;                   14562  14581 ;CHR$(&HD8)
    DEFB    000H                        ;596a  00           14563  14582 
    DEFB    000H                        ;596b  00           14564  14583 
    DEFB    000H                        ;596c  00           14565  14584 
    DEFB    000H                        ;596d  00           14566  14585 
    DEFB    000H                        ;596e  00           14567  14586 
    DEFB    028H                        ;596f  28           14568  14587 
    DEFB    044H                        ;5970  44           14569  14588 
    DEFB    082H                        ;5971  82           14570  14589 
    DEFB    000H                        ;5972  00           14571  14590 
    DEFB    000H                        ;5973  00           14572  14591 
    DEFB    000H                        ;5974  00           14573  14592 
    DEFB    000H                        ;5975  00           14574  14593 
                                        ;                   14575  14594 ;
                                        ;                   14576  14595 ;CHR$(&HD9)
    DEFB    000H                        ;5976  00           14577  14596 
    DEFB    000H                        ;5977  00           14578  14597 
    DEFB    020H                        ;5978  20           14579  14598 
    DEFB    020H                        ;5979  20           14580  14599 
    DEFB    0FCH                        ;597a  fc           14581  14600 
    DEFB    024H                        ;597b  24           14582  14601 
    DEFB    024H                        ;597c  24           14583  14602 
    DEFB    044H                        ;597d  44           14584  14603 
    DEFB    086H                        ;597e  86           14585  14604 
    DEFB    000H                        ;597f  00           14586  14605 
    DEFB    000H                        ;5980  00           14587  14606 
    DEFB    000H                        ;5981  00           14588  14607 
                                        ;                   14589  14608 ;
                                        ;                   14590  14609 ;CHR$(&HDA)
    DEFB    000H                        ;5982  00           14591  14610 
    DEFB    000H                        ;5983  00           14592  14611 
    DEFB    000H                        ;5984  00           14593  14612 
    DEFB    000H                        ;5985  00           14594  14613 
    DEFB    036H                        ;5986  36           14595  14614 
    DEFB    049H                        ;5987  49           14596  14615 
    DEFB    036H                        ;5988  36           14597  14616 
    DEFB    000H                        ;5989  00           14598  14617 
    DEFB    000H                        ;598a  00           14599  14618 
    DEFB    000H                        ;598b  00           14600  14619 
    DEFB    000H                        ;598c  00           14601  14620 
    DEFB    000H                        ;598d  00           14602  14621 
                                        ;                   14603  14622 ;
                                        ;                   14604  14623 ;CHR$(&HDB)
    DEFB    000H                        ;598e  00           14605  14624 
    DEFB    000H                        ;598f  00           14606  14625 
    DEFB    018H                        ;5990  18           14607  14626 
    DEFB    020H                        ;5991  20           14608  14627 
    DEFB    018H                        ;5992  18           14609  14628 
    DEFB    024H                        ;5993  24           14610  14629 
    DEFB    018H                        ;5994  18           14611  14630 
    DEFB    004H                        ;5995  04           14612  14631 
    DEFB    018H                        ;5996  18           14613  14632 
    DEFB    000H                        ;5997  00           14614  14633 
    DEFB    000H                        ;5998  00           14615  14634 
    DEFB    000H                        ;5999  00           14616  14635 
                                        ;                   14617  14636 ;
                                        ;                   14618  14637 ;CHR$(&HDC)
    DEFB    000H                        ;599a  00           14619  14638 
    DEFB    000H                        ;599b  00           14620  14639 
    DEFB    008H                        ;599c  08           14621  14640 
    DEFB    022H                        ;599d  22           14622  14641 
    DEFB    014H                        ;599e  14           14623  14642 
    DEFB    049H                        ;599f  49           14624  14643 
    DEFB    014H                        ;59a0  14           14625  14644 
    DEFB    022H                        ;59a1  22           14626  14645 
    DEFB    008H                        ;59a2  08           14627  14646 
    DEFB    000H                        ;59a3  00           14628  14647 
    DEFB    000H                        ;59a4  00           14629  14648 
    DEFB    000H                        ;59a5  00           14630  14649 
                                        ;                   14631  14650 ;
                                        ;                   14632  14651 ;CHR$(&HDD)
    DEFB    000H                        ;59a6  00           14633  14652 
    DEFB    000H                        ;59a7  00           14634  14653 
    DEFB    000H                        ;59a8  00           14635  14654 
    DEFB    038H                        ;59a9  38           14636  14655 
    DEFB    000H                        ;59aa  00           14637  14656 
    DEFB    07CH                        ;59ab  7c           14638  14657 
    DEFB    010H                        ;59ac  10           14639  14658 
    DEFB    010H                        ;59ad  10           14640  14659 
    DEFB    010H                        ;59ae  10           14641  14660 
    DEFB    000H                        ;59af  00           14642  14661 
    DEFB    000H                        ;59b0  00           14643  14662 
    DEFB    000H                        ;59b1  00           14644  14663 
                                        ;                   14645  14664 ;
                                        ;                   14646  14665 ;CHR$(&HDE)
    DEFB    000H                        ;59b2  00           14647  14666 
    DEFB    060H                        ;59b3  60           14648  14667 
    DEFB    090H                        ;59b4  90           14649  14668 
    DEFB    06EH                        ;59b5  6e           14650  14669 
    DEFB    011H                        ;59b6  11           14651  14670 
    DEFB    010H                        ;59b7  10           14652  14671 
    DEFB    010H                        ;59b8  10           14653  14672 
    DEFB    011H                        ;59b9  11           14654  14673 
    DEFB    00EH                        ;59ba  0e           14655  14674 
    DEFB    000H                        ;59bb  00           14656  14675 
    DEFB    000H                        ;59bc  00           14657  14676 
    DEFB    000H                        ;59bd  00           14658  14677 
                                        ;                   14659  14678 ;
                                        ;                   14660  14679 ;CHR$(&HDF)
    DEFB    001H                        ;59be  01           14661  14680 
    DEFB    002H                        ;59bf  02           14662  14681 
    DEFB    002H                        ;59c0  02           14663  14682 
    DEFB    004H                        ;59c1  04           14664  14683 
    DEFB    008H                        ;59c2  08           14665  14684 
    DEFB    008H                        ;59c3  08           14666  14685 
    DEFB    010H                        ;59c4  10           14667  14686 
    DEFB    020H                        ;59c5  20           14668  14687 
    DEFB    020H                        ;59c6  20           14669  14688 
    DEFB    040H                        ;59c7  40           14670  14689 
    DEFB    080H                        ;59c8  80           14671  14690 
    DEFB    080H                        ;59c9  80           14672  14691 
                                        ;                   14673  14692 ;
                                        ;                   14674  14693 ;CHR$(&HE0)
    DEFB    000H                        ;59ca  00           14675  14694 
    DEFB    000H                        ;59cb  00           14676  14695 
    DEFB    020H                        ;59cc  20           14677  14696 
    DEFB    010H                        ;59cd  10           14678  14697 
    DEFB    008H                        ;59ce  08           14679  14698 
    DEFB    000H                        ;59cf  00           14680  14699 
    DEFB    000H                        ;59d0  00           14681  14700 
    DEFB    000H                        ;59d1  00           14682  14701 
    DEFB    000H                        ;59d2  00           14683  14702 
    DEFB    000H                        ;59d3  00           14684  14703 
    DEFB    000H                        ;59d4  00           14685  14704 
    DEFB    000H                        ;59d5  00           14686  14705 
                                        ;                   14687  14706 ;
                                        ;                   14688  14707 ;CHR$(&HE1)
    DEFB    000H                        ;59d6  00           14689  14708 
    DEFB    000H                        ;59d7  00           14690  14709 
    DEFB    000H                        ;59d8  00           14691  14710 
    DEFB    000H                        ;59d9  00           14692  14711 
    DEFB    03CH                        ;59da  3c           14693  14712 
    DEFB    002H                        ;59db  02           14694  14713 
    DEFB    01EH                        ;59dc  1e           14695  14714 
    DEFB    022H                        ;59dd  22           14696  14715 
    DEFB    01FH                        ;59de  1f           14697  14716 
    DEFB    000H                        ;59df  00           14698  14717 
    DEFB    000H                        ;59e0  00           14699  14718 
    DEFB    000H                        ;59e1  00           14700  14719 
                                        ;                   14701  14720 ;
                                        ;                   14702  14721 ;CHR$(&HE2)
    DEFB    000H                        ;59e2  00           14703  14722 
    DEFB    000H                        ;59e3  00           14704  14723 
    DEFB    020H                        ;59e4  20           14705  14724 
    DEFB    020H                        ;59e5  20           14706  14725 
    DEFB    02CH                        ;59e6  2c           14707  14726 
    DEFB    032H                        ;59e7  32           14708  14727 
    DEFB    022H                        ;59e8  22           14709  14728 
    DEFB    032H                        ;59e9  32           14710  14729 
    DEFB    02CH                        ;59ea  2c           14711  14730 
    DEFB    000H                        ;59eb  00           14712  14731 
    DEFB    000H                        ;59ec  00           14713  14732 
    DEFB    000H                        ;59ed  00           14714  14733 
                                        ;                   14715  14734 ;
                                        ;                   14716  14735 ;CHR$(&HE3)
    DEFB    000H                        ;59ee  00           14717  14736 
    DEFB    000H                        ;59ef  00           14718  14737 
    DEFB    000H                        ;59f0  00           14719  14738 
    DEFB    000H                        ;59f1  00           14720  14739 
    DEFB    01CH                        ;59f2  1c           14721  14740 
    DEFB    022H                        ;59f3  22           14722  14741 
    DEFB    020H                        ;59f4  20           14723  14742 
    DEFB    022H                        ;59f5  22           14724  14743 
    DEFB    01CH                        ;59f6  1c           14725  14744 
    DEFB    000H                        ;59f7  00           14726  14745 
    DEFB    000H                        ;59f8  00           14727  14746 
    DEFB    000H                        ;59f9  00           14728  14747 
                                        ;                   14729  14748 ;
                                        ;                   14730  14749 ;CHR$(&HE4)
    DEFB    000H                        ;59fa  00           14731  14750 
    DEFB    000H                        ;59fb  00           14732  14751 
    DEFB    002H                        ;59fc  02           14733  14752 
    DEFB    002H                        ;59fd  02           14734  14753 
    DEFB    01AH                        ;59fe  1a           14735  14754 
    DEFB    026H                        ;59ff  26           14736  14755 
    DEFB    022H                        ;5a00  22           14737  14756 
    DEFB    026H                        ;5a01  26           14738  14757 
    DEFB    01AH                        ;5a02  1a           14739  14758 
    DEFB    000H                        ;5a03  00           14740  14759 
    DEFB    000H                        ;5a04  00           14741  14760 
    DEFB    000H                        ;5a05  00           14742  14761 
                                        ;                   14743  14762 ;
                                        ;                   14744  14763 ;CHR$(&HE5)
    DEFB    000H                        ;5a06  00           14745  14764 
    DEFB    000H                        ;5a07  00           14746  14765 
    DEFB    000H                        ;5a08  00           14747  14766 
    DEFB    000H                        ;5a09  00           14748  14767 
    DEFB    01CH                        ;5a0a  1c           14749  14768 
    DEFB    022H                        ;5a0b  22           14750  14769 
    DEFB    03EH                        ;5a0c  3e           14751  14770 
    DEFB    020H                        ;5a0d  20           14752  14771 
    DEFB    01EH                        ;5a0e  1e           14753  14772 
    DEFB    000H                        ;5a0f  00           14754  14773 
    DEFB    000H                        ;5a10  00           14755  14774 
    DEFB    000H                        ;5a11  00           14756  14775 
                                        ;                   14757  14776 ;
                                        ;                   14758  14777 ;CHR$(&HE6)
    DEFB    000H                        ;5a12  00           14759  14778 
    DEFB    000H                        ;5a13  00           14760  14779 
    DEFB    00CH                        ;5a14  0c           14761  14780 
    DEFB    010H                        ;5a15  10           14762  14781 
    DEFB    010H                        ;5a16  10           14763  14782 
    DEFB    07CH                        ;5a17  7c           14764  14783 
    DEFB    010H                        ;5a18  10           14765  14784 
    DEFB    010H                        ;5a19  10           14766  14785 
    DEFB    010H                        ;5a1a  10           14767  14786 
    DEFB    000H                        ;5a1b  00           14768  14787 
    DEFB    000H                        ;5a1c  00           14769  14788 
    DEFB    000H                        ;5a1d  00           14770  14789 
                                        ;                   14771  14790 ;
                                        ;                   14772  14791 ;CHR$(&HE7)
    DEFB    000H                        ;5a1e  00           14773  14792 
    DEFB    000H                        ;5a1f  00           14774  14793 
    DEFB    000H                        ;5a20  00           14775  14794 
    DEFB    000H                        ;5a21  00           14776  14795 
    DEFB    01AH                        ;5a22  1a           14777  14796 
    DEFB    026H                        ;5a23  26           14778  14797 
    DEFB    022H                        ;5a24  22           14779  14798 
    DEFB    026H                        ;5a25  26           14780  14799 
    DEFB    01AH                        ;5a26  1a           14781  14800 
    DEFB    002H                        ;5a27  02           14782  14801 
    DEFB    01CH                        ;5a28  1c           14783  14802 
    DEFB    000H                        ;5a29  00           14784  14803 
                                        ;                   14785  14804 ;
                                        ;                   14786  14805 ;CHR$(&HE8)
    DEFB    000H                        ;5a2a  00           14787  14806 
    DEFB    000H                        ;5a2b  00           14788  14807 
    DEFB    020H                        ;5a2c  20           14789  14808 
    DEFB    020H                        ;5a2d  20           14790  14809 
    DEFB    02CH                        ;5a2e  2c           14791  14810 
    DEFB    032H                        ;5a2f  32           14792  14811 
    DEFB    022H                        ;5a30  22           14793  14812 
    DEFB    022H                        ;5a31  22           14794  14813 
    DEFB    022H                        ;5a32  22           14795  14814 
    DEFB    000H                        ;5a33  00           14796  14815 
    DEFB    000H                        ;5a34  00           14797  14816 
    DEFB    000H                        ;5a35  00           14798  14817 
                                        ;                   14799  14818 ;
                                        ;                   14800  14819 ;CHR$(&HE9)
    DEFB    000H                        ;5a36  00           14801  14820 
    DEFB    000H                        ;5a37  00           14802  14821 
    DEFB    008H                        ;5a38  08           14803  14822 
    DEFB    000H                        ;5a39  00           14804  14823 
    DEFB    018H                        ;5a3a  18           14805  14824 
    DEFB    008H                        ;5a3b  08           14806  14825 
    DEFB    008H                        ;5a3c  08           14807  14826 
    DEFB    008H                        ;5a3d  08           14808  14827 
    DEFB    01CH                        ;5a3e  1c           14809  14828 
    DEFB    000H                        ;5a3f  00           14810  14829 
    DEFB    000H                        ;5a40  00           14811  14830 
    DEFB    000H                        ;5a41  00           14812  14831 
                                        ;                   14813  14832 ;
                                        ;                   14814  14833 ;CHR$(&HEA)
    DEFB    000H                        ;5a42  00           14815  14834 
    DEFB    000H                        ;5a43  00           14816  14835 
    DEFB    004H                        ;5a44  04           14817  14836 
    DEFB    000H                        ;5a45  00           14818  14837 
    DEFB    00CH                        ;5a46  0c           14819  14838 
    DEFB    004H                        ;5a47  04           14820  14839 
    DEFB    004H                        ;5a48  04           14821  14840 
    DEFB    004H                        ;5a49  04           14822  14841 
    DEFB    024H                        ;5a4a  24           14823  14842 
    DEFB    018H                        ;5a4b  18           14824  14843 
    DEFB    000H                        ;5a4c  00           14825  14844 
    DEFB    000H                        ;5a4d  00           14826  14845 
                                        ;                   14827  14846 ;
                                        ;                   14828  14847 ;CHR$(&HEB)
    DEFB    000H                        ;5a4e  00           14829  14848 
    DEFB    000H                        ;5a4f  00           14830  14849 
    DEFB    020H                        ;5a50  20           14831  14850 
    DEFB    020H                        ;5a51  20           14832  14851 
    DEFB    022H                        ;5a52  22           14833  14852 
    DEFB    024H                        ;5a53  24           14834  14853 
    DEFB    028H                        ;5a54  28           14835  14854 
    DEFB    034H                        ;5a55  34           14836  14855 
    DEFB    022H                        ;5a56  22           14837  14856 
    DEFB    000H                        ;5a57  00           14838  14857 
    DEFB    000H                        ;5a58  00           14839  14858 
    DEFB    000H                        ;5a59  00           14840  14859 
                                        ;                   14841  14860 ;
                                        ;                   14842  14861 ;CHR$(&HEC)
    DEFB    000H                        ;5a5a  00           14843  14862 
    DEFB    000H                        ;5a5b  00           14844  14863 
    DEFB    018H                        ;5a5c  18           14845  14864 
    DEFB    008H                        ;5a5d  08           14846  14865 
    DEFB    008H                        ;5a5e  08           14847  14866 
    DEFB    008H                        ;5a5f  08           14848  14867 
    DEFB    008H                        ;5a60  08           14849  14868 
    DEFB    008H                        ;5a61  08           14850  14869 
    DEFB    01CH                        ;5a62  1c           14851  14870 
    DEFB    000H                        ;5a63  00           14852  14871 
    DEFB    000H                        ;5a64  00           14853  14872 
    DEFB    000H                        ;5a65  00           14854  14873 
                                        ;                   14855  14874 ;
                                        ;                   14856  14875 ;CHR$(&HED)
    DEFB    000H                        ;5a66  00           14857  14876 
    DEFB    000H                        ;5a67  00           14858  14877 
    DEFB    000H                        ;5a68  00           14859  14878 
    DEFB    000H                        ;5a69  00           14860  14879 
    DEFB    076H                        ;5a6a  76           14861  14880 
    DEFB    049H                        ;5a6b  49           14862  14881 
    DEFB    049H                        ;5a6c  49           14863  14882 
    DEFB    049H                        ;5a6d  49           14864  14883 
    DEFB    049H                        ;5a6e  49           14865  14884 
    DEFB    000H                        ;5a6f  00           14866  14885 
    DEFB    000H                        ;5a70  00           14867  14886 
    DEFB    000H                        ;5a71  00           14868  14887 
                                        ;                   14869  14888 ;
                                        ;                   14870  14889 ;CHR$(&HEE)
    DEFB    000H                        ;5a72  00           14871  14890 
    DEFB    000H                        ;5a73  00           14872  14891 
    DEFB    000H                        ;5a74  00           14873  14892 
    DEFB    000H                        ;5a75  00           14874  14893 
    DEFB    02CH                        ;5a76  2c           14875  14894 
    DEFB    032H                        ;5a77  32           14876  14895 
    DEFB    022H                        ;5a78  22           14877  14896 
    DEFB    022H                        ;5a79  22           14878  14897 
    DEFB    022H                        ;5a7a  22           14879  14898 
    DEFB    000H                        ;5a7b  00           14880  14899 
    DEFB    000H                        ;5a7c  00           14881  14900 
    DEFB    000H                        ;5a7d  00           14882  14901 
                                        ;                   14883  14902 ;
                                        ;                   14884  14903 ;CHR$(&HEF)
    DEFB    000H                        ;5a7e  00           14885  14904 
    DEFB    000H                        ;5a7f  00           14886  14905 
    DEFB    000H                        ;5a80  00           14887  14906 
    DEFB    000H                        ;5a81  00           14888  14907 
    DEFB    01CH                        ;5a82  1c           14889  14908 
    DEFB    022H                        ;5a83  22           14890  14909 
    DEFB    022H                        ;5a84  22           14891  14910 
    DEFB    022H                        ;5a85  22           14892  14911 
    DEFB    01CH                        ;5a86  1c           14893  14912 
    DEFB    000H                        ;5a87  00           14894  14913 
    DEFB    000H                        ;5a88  00           14895  14914 
    DEFB    000H                        ;5a89  00           14896  14915 
                                        ;                   14897  14916 ;
                                        ;                   14898  14917 ;CHR$(&HF0)
    DEFB    000H                        ;5a8a  00           14899  14918 
    DEFB    000H                        ;5a8b  00           14900  14919 
    DEFB    000H                        ;5a8c  00           14901  14920 
    DEFB    000H                        ;5a8d  00           14902  14921 
    DEFB    02CH                        ;5a8e  2c           14903  14922 
    DEFB    032H                        ;5a8f  32           14904  14923 
    DEFB    022H                        ;5a90  22           14905  14924 
    DEFB    032H                        ;5a91  32           14906  14925 
    DEFB    02CH                        ;5a92  2c           14907  14926 
    DEFB    020H                        ;5a93  20           14908  14927 
    DEFB    020H                        ;5a94  20           14909  14928 
    DEFB    000H                        ;5a95  00           14910  14929 
                                        ;                   14911  14930 ;
                                        ;                   14912  14931 ;CHR$(&HF1)
    DEFB    000H                        ;5a96  00           14913  14932 
    DEFB    000H                        ;5a97  00           14914  14933 
    DEFB    000H                        ;5a98  00           14915  14934 
    DEFB    000H                        ;5a99  00           14916  14935 
    DEFB    01AH                        ;5a9a  1a           14917  14936 
    DEFB    026H                        ;5a9b  26           14918  14937 
    DEFB    022H                        ;5a9c  22           14919  14938 
    DEFB    026H                        ;5a9d  26           14920  14939 
    DEFB    01AH                        ;5a9e  1a           14921  14940 
    DEFB    002H                        ;5a9f  02           14922  14941 
    DEFB    002H                        ;5aa0  02           14923  14942 
    DEFB    000H                        ;5aa1  00           14924  14943 
                                        ;                   14925  14944 ;
                                        ;                   14926  14945 ;CHR$(&HF2)
    DEFB    000H                        ;5aa2  00           14927  14946 
    DEFB    000H                        ;5aa3  00           14928  14947 
    DEFB    000H                        ;5aa4  00           14929  14948 
    DEFB    000H                        ;5aa5  00           14930  14949 
    DEFB    02EH                        ;5aa6  2e           14931  14950 
    DEFB    030H                        ;5aa7  30           14932  14951 
    DEFB    020H                        ;5aa8  20           14933  14952 
    DEFB    020H                        ;5aa9  20           14934  14953 
    DEFB    020H                        ;5aaa  20           14935  14954 
    DEFB    000H                        ;5aab  00           14936  14955 
    DEFB    000H                        ;5aac  00           14937  14956 
    DEFB    000H                        ;5aad  00           14938  14957 
                                        ;                   14939  14958 ;
                                        ;                   14940  14959 ;CHR$(&HF3)
    DEFB    000H                        ;5aae  00           14941  14960 
    DEFB    000H                        ;5aaf  00           14942  14961 
    DEFB    000H                        ;5ab0  00           14943  14962 
    DEFB    000H                        ;5ab1  00           14944  14963 
    DEFB    01EH                        ;5ab2  1e           14945  14964 
    DEFB    020H                        ;5ab3  20           14946  14965 
    DEFB    01CH                        ;5ab4  1c           14947  14966 
    DEFB    002H                        ;5ab5  02           14948  14967 
    DEFB    03CH                        ;5ab6  3c           14949  14968 
    DEFB    000H                        ;5ab7  00           14950  14969 
    DEFB    000H                        ;5ab8  00           14951  14970 
    DEFB    000H                        ;5ab9  00           14952  14971 
                                        ;                   14953  14972 ;
                                        ;                   14954  14973 ;CHR$(&HF4)
    DEFB    000H                        ;5aba  00           14955  14974 
    DEFB    000H                        ;5abb  00           14956  14975 
    DEFB    010H                        ;5abc  10           14957  14976 
    DEFB    010H                        ;5abd  10           14958  14977 
    DEFB    038H                        ;5abe  38           14959  14978 
    DEFB    010H                        ;5abf  10           14960  14979 
    DEFB    010H                        ;5ac0  10           14961  14980 
    DEFB    012H                        ;5ac1  12           14962  14981 
    DEFB    00CH                        ;5ac2  0c           14963  14982 
    DEFB    000H                        ;5ac3  00           14964  14983 
    DEFB    000H                        ;5ac4  00           14965  14984 
    DEFB    000H                        ;5ac5  00           14966  14985 
                                        ;                   14967  14986 ;
                                        ;                   14968  14987 ;CHR$(&HF5)
    DEFB    000H                        ;5ac6  00           14969  14988 
    DEFB    000H                        ;5ac7  00           14970  14989 
    DEFB    000H                        ;5ac8  00           14971  14990 
    DEFB    000H                        ;5ac9  00           14972  14991 
    DEFB    022H                        ;5aca  22           14973  14992 
    DEFB    022H                        ;5acb  22           14974  14993 
    DEFB    022H                        ;5acc  22           14975  14994 
    DEFB    026H                        ;5acd  26           14976  14995 
    DEFB    01AH                        ;5ace  1a           14977  14996 
    DEFB    000H                        ;5acf  00           14978  14997 
    DEFB    000H                        ;5ad0  00           14979  14998 
    DEFB    000H                        ;5ad1  00           14980  14999 
                                        ;                   14981  15000 ;
                                        ;                   14982  15001 ;CHR$(&HF6)
    DEFB    000H                        ;5ad2  00           14983  15002 
    DEFB    000H                        ;5ad3  00           14984  15003 
    DEFB    000H                        ;5ad4  00           14985  15004 
    DEFB    000H                        ;5ad5  00           14986  15005 
    DEFB    022H                        ;5ad6  22           14987  15006 
    DEFB    022H                        ;5ad7  22           14988  15007 
    DEFB    022H                        ;5ad8  22           14989  15008 
    DEFB    014H                        ;5ad9  14           14990  15009 
    DEFB    008H                        ;5ada  08           14991  15010 
    DEFB    000H                        ;5adb  00           14992  15011 
    DEFB    000H                        ;5adc  00           14993  15012 
    DEFB    000H                        ;5add  00           14994  15013 
                                        ;                   14995  15014 ;
                                        ;                   14996  15015 ;CHR$(&HF7)
    DEFB    000H                        ;5ade  00           14997  15016 
    DEFB    000H                        ;5adf  00           14998  15017 
    DEFB    000H                        ;5ae0  00           14999  15018 
    DEFB    000H                        ;5ae1  00           15000  15019 
    DEFB    049H                        ;5ae2  49           15001  15020 
    DEFB    049H                        ;5ae3  49           15002  15021 
    DEFB    049H                        ;5ae4  49           15003  15022 
    DEFB    049H                        ;5ae5  49           15004  15023 
    DEFB    036H                        ;5ae6  36           15005  15024 
    DEFB    000H                        ;5ae7  00           15006  15025 
    DEFB    000H                        ;5ae8  00           15007  15026 
    DEFB    000H                        ;5ae9  00           15008  15027 
                                        ;                   15009  15028 ;
                                        ;                   15010  15029 ;CHR$(&HF8)
    DEFB    000H                        ;5aea  00           15011  15030 
    DEFB    000H                        ;5aeb  00           15012  15031 
    DEFB    000H                        ;5aec  00           15013  15032 
    DEFB    000H                        ;5aed  00           15014  15033 
    DEFB    022H                        ;5aee  22           15015  15034 
    DEFB    014H                        ;5aef  14           15016  15035 
    DEFB    008H                        ;5af0  08           15017  15036 
    DEFB    014H                        ;5af1  14           15018  15037 
    DEFB    022H                        ;5af2  22           15019  15038 
    DEFB    000H                        ;5af3  00           15020  15039 
    DEFB    000H                        ;5af4  00           15021  15040 
    DEFB    000H                        ;5af5  00           15022  15041 
                                        ;                   15023  15042 ;
                                        ;                   15024  15043 ;CHR$(&HF9)
    DEFB    000H                        ;5af6  00           15025  15044 
    DEFB    000H                        ;5af7  00           15026  15045 
    DEFB    000H                        ;5af8  00           15027  15046 
    DEFB    000H                        ;5af9  00           15028  15047 
    DEFB    022H                        ;5afa  22           15029  15048 
    DEFB    022H                        ;5afb  22           15030  15049 
    DEFB    022H                        ;5afc  22           15031  15050 
    DEFB    026H                        ;5afd  26           15032  15051 
    DEFB    01AH                        ;5afe  1a           15033  15052 
    DEFB    002H                        ;5aff  02           15034  15053 
    DEFB    01CH                        ;5b00  1c           15035  15054 
    DEFB    000H                        ;5b01  00           15036  15055 
                                        ;                   15037  15056 ;
                                        ;                   15038  15057 ;CHR$(&HFA)
    DEFB    000H                        ;5b02  00           15039  15058 
    DEFB    000H                        ;5b03  00           15040  15059 
    DEFB    000H                        ;5b04  00           15041  15060 
    DEFB    000H                        ;5b05  00           15042  15061 
    DEFB    03EH                        ;5b06  3e           15043  15062 
    DEFB    004H                        ;5b07  04           15044  15063 
    DEFB    008H                        ;5b08  08           15045  15064 
    DEFB    010H                        ;5b09  10           15046  15065 
    DEFB    03EH                        ;5b0a  3e           15047  15066 
    DEFB    000H                        ;5b0b  00           15048  15067 
    DEFB    000H                        ;5b0c  00           15049  15068 
    DEFB    000H                        ;5b0d  00           15050  15069 
                                        ;                   15051  15070 ;
                                        ;                   15052  15071 ;CHR$(&HFB)
    DEFB    000H                        ;5b0e  00           15053  15072 
    DEFB    000H                        ;5b0f  00           15054  15073 
    DEFB    008H                        ;5b10  08           15055  15074 
    DEFB    010H                        ;5b11  10           15056  15075 
    DEFB    010H                        ;5b12  10           15057  15076 
    DEFB    020H                        ;5b13  20           15058  15077 
    DEFB    010H                        ;5b14  10           15059  15078 
    DEFB    010H                        ;5b15  10           15060  15079 
    DEFB    008H                        ;5b16  08           15061  15080 
    DEFB    000H                        ;5b17  00           15062  15081 
    DEFB    000H                        ;5b18  00           15063  15082 
    DEFB    000H                        ;5b19  00           15064  15083 
                                        ;                   15065  15084 ;
                                        ;                   15066  15085 ;CHR$(&HFC)
    DEFB    000H                        ;5b1a  00           15067  15086 
    DEFB    000H                        ;5b1b  00           15068  15087 
    DEFB    000H                        ;5b1c  00           15069  15088 
    DEFB    054H                        ;5b1d  54           15070  15089 
    DEFB    0FEH                        ;5b1e  fe           15071  15090 
    DEFB    054H                        ;5b1f  54           15072  15091 
    DEFB    0FEH                        ;5b20  fe           15073  15092 
    DEFB    054H                        ;5b21  54           15074  15093 
    DEFB    028H                        ;5b22  28           15075  15094 
    DEFB    000H                        ;5b23  00           15076  15095 
    DEFB    000H                        ;5b24  00           15077  15096 
    DEFB    000H                        ;5b25  00           15078  15097 
                                        ;                   15079  15098 ;
                                        ;                   15080  15099 ;CHR$(&HFD)
    DEFB    000H                        ;5b26  00           15081  15100 
    DEFB    000H                        ;5b27  00           15082  15101 
    DEFB    010H                        ;5b28  10           15083  15102 
    DEFB    008H                        ;5b29  08           15084  15103 
    DEFB    008H                        ;5b2a  08           15085  15104 
    DEFB    004H                        ;5b2b  04           15086  15105 
    DEFB    008H                        ;5b2c  08           15087  15106 
    DEFB    008H                        ;5b2d  08           15088  15107 
    DEFB    010H                        ;5b2e  10           15089  15108 
    DEFB    000H                        ;5b2f  00           15090  15109 
    DEFB    000H                        ;5b30  00           15091  15110 
    DEFB    000H                        ;5b31  00           15092  15111 
                                        ;                   15093  15112 ;
                                        ;                   15094  15113 ;CHR$(&HFE)
    DEFB    000H                        ;5b32  00           15095  15114 
    DEFB    000H                        ;5b33  00           15096  15115 
    DEFB    000H                        ;5b34  00           15097  15116 
    DEFB    000H                        ;5b35  00           15098  15117 
    DEFB    000H                        ;5b36  00           15099  15118 
    DEFB    032H                        ;5b37  32           15100  15119 
    DEFB    04CH                        ;5b38  4c           15101  15120 
    DEFB    000H                        ;5b39  00           15102  15121 
    DEFB    000H                        ;5b3a  00           15103  15122 
    DEFB    000H                        ;5b3b  00           15104  15123 
    DEFB    000H                        ;5b3c  00           15105  15124 
    DEFB    000H                        ;5b3d  00           15106  15125 
                                        ;                   15107  15126 ;
                                        ;                   15108  15127 ;CHR$(&HFF)
    DEFB    000H                        ;5b3e  00           15109  15128 
    DEFB    000H                        ;5b3f  00           15110  15129 
    DEFB    000H                        ;5b40  00           15111  15130 
    DEFB    000H                        ;5b41  00           15112  15131 
    DEFB    001H                        ;5b42  01           15113  15132 
    DEFB    03EH                        ;5b43  3e           15114  15133 
    DEFB    054H                        ;5b44  54           15115  15134 
    DEFB    014H                        ;5b45  14           15116  15135 
    DEFB    014H                        ;5b46  14           15117  15136 
    DEFB    000H                        ;5b47  00           15118  15137 
    DEFB    000H                        ;5b48  00           15119  15138 
    DEFB    000H                        ;5b49  00           15120  15139 
                                        ;                   15121  15140 
                                        ;                   15122  15141 ;	ORG	05B4Ah
ADDDEG: PUSH    HL                      ;5b4a  e5           15123  15142 
    LD  HL,8                            ;5b4b  21 08 00     15124  15143 
    ADD HL,DE                           ;5b4e  19           15125  15144 
    EX  DE,HL                           ;5b4f  eb           15126  15145 
    POP HL                              ;5b50  e1           15127  15146 
    RET                                 ;5b51  c9           15128  15147 
                                        ;                   15129  15148 ;
OCTLER: PUSH    HL                      ;5b52  e5           15130  15149 
    LD  HL,CHCKOC                       ;5b53  21 a1 5b     15131  15150 
    LD  (CHKVEC),HL                     ;5b56  22 7b 5b     15132  15151 
    LD  HL,00000h                       ;5b59  21 00 00     15133  15152 
    XOR A                               ;5b5c  af           15134  15153 
    JR  MID&OP                          ;5b5d  18 0c        15135  15154 
                                        ;                   15136  15155 ;
HEXPZM: PUSH    HL                      ;5b5f  e5           15137  15156 
    LD  HL,CHCKHX                       ;5b60  21 a8 5b     15138  15157 
    LD  (CHKVEC),HL                     ;5b63  22 7b 5b     15139  15158 
    LD  HL,ADHLCK                       ;5b66  21 38 5d     15140  15159 
    LD  A,0CDh                          ;5b69  3e cd        15141  15160 
MID&OP: LD  (MULVEC),HL                 ;5b6b  22 89 5b     15142  15161 
    LD  (VECSWT),A                      ;5b6e  32 88 5b     15143  15162 
    LD  HL,00000h                       ;5b71  21 00 00     15144  15163 
LOP&OP: CALL    DEFTCH                  ;5b74  cd 51 5d     15145  15164 
    CALL    SMALL'                      ;5b77  cd 1c 63     15146  15165 
    DEFB    0CDH                        ;5b7a  cd           15147  15166 ;CALL
CHKVEC: DEFW    CHCKHX                  ;5b7b  a8 5b        15148  15167 
    JR  C,RET&OP                        ;5b7d  38 17        15149  15168 
    CALL    ADHLCK                      ;5b7f  cd 38 5d     15150  15169 
    CALL    ADHLCK                      ;5b82  cd 38 5d     15151  15170 
    CALL    ADHLCK                      ;5b85  cd 38 5d     15152  15171 
VECSWT: DEFB    0CDH                    ;5b88  cd           15153  15172 
MULVEC: DEFW    ADHLCK                  ;5b89  38 5d        15154  15173 
    ADD A,L                             ;5b8b  85           15155  15174 
    LD  L,A                             ;5b8c  6f           15156  15175 
    LD  A,0                             ;5b8d  3e 00        15157  15176 
    ADC A,H                             ;5b8f  8c           15158  15177 
    JP  C,OVERFL1                       ;5b90  da e4 6e     15159  15178 
    LD  H,A                             ;5b93  67           15160  15179 
    JR  LOP&OP                          ;5b94  18 de        15161  15180 
                                        ;                   15162  15181 ;
RET&OP: DEC DE                          ;5b96  1b           15163  15182 
    LD  C,E                             ;5b97  4b           15164  15183 
    LD  B,D                             ;5b98  42           15165  15184 
    EX  DE,HL                           ;5b99  eb           15166  15185 
    POP HL                              ;5b9a  e1           15167  15186 
    CALL    FLTHEX                      ;5b9b  cd 02 29     15168  15187 
    LD  E,C                             ;5b9e  59           15169  15188 
    LD  D,B                             ;5b9f  50           15170  15189 
    RET                                 ;5ba0  c9           15171  15190 
                                        ;                   15172  15191 ;
CHCKOC: SUB 030h                        ;5ba1  d6 30        15173  15192 
    RET C                               ;5ba3  d8           15174  15193 
    CP  008h                            ;5ba4  fe 08        15175  15194 
    CCF                                 ;5ba6  3f           15176  15195 
    RET                                 ;5ba7  c9           15177  15196 
                                        ;                   15178  15197 ;
CHCKHX: SUB 030h                        ;5ba8  d6 30        15179  15198 
    RET C                               ;5baa  d8           15180  15199 
    CP  00Ah                            ;5bab  fe 0a        15181  15200 
    CCF                                 ;5bad  3f           15182  15201 
    RET NC                              ;5bae  d0           15183  15202 
    CP  011h                            ;5baf  fe 11        15184  15203 
    RET C                               ;5bb1  d8           15185  15204 
    SUB 007h                            ;5bb2  d6 07        15186  15205 
    CP  010h                            ;5bb4  fe 10        15187  15206 
    CCF                                 ;5bb6  3f           15188  15207 
    RET                                 ;5bb7  c9           15189  15208 
                                        ;                   15190  15209 ;
OVFLAG: LD  (IY+0),8                    ;5bb8  fd 36 00 08  15191  15210 
    XOR A                               ;5bbc  af           15192  15211 
    LD  (IY-1),A                        ;5bbd  fd 77 ff     15193  15212 
    LD  C,A                             ;5bc0  4f           15194  15213 
    INC C                               ;5bc1  0c           15195  15214 
    EX  DE,HL                           ;5bc2  eb           15196  15215 
    LD  B,8                             ;5bc3  06 08        15197  15216 
    CALL    ZFILL                       ;5bc5  cd 10 62     15198  15217 
    EX  DE,HL                           ;5bc8  eb           15199  15218 
    CALL    DEFTCH                      ;5bc9  cd 51 5d     15200  15219 
    CP  02Bh                            ;5bcc  fe 2b        15201  15220 
    JR  Z,OVFLAG                        ;5bce  28 e8        15202  15221 
    CP  02Dh                            ;5bd0  fe 2d        15203  15222 
    JR  Z,SKIP2D                        ;5bd2  28 0b        15204  15223 
    JR  L008F                           ;5bd4  18 03        15205  15224 
ZRSKIP: CALL    DEFTCH                  ;5bd6  cd 51 5d     15206  15225 
L008F:  CP  030h                        ;5bd9  fe 30        15207  15226 
    JR  Z,ZRSKIP                        ;5bdb  28 f9        15208  15227 
    JR  CHCK26                          ;5bdd  18 06        15209  15228 
SKIP2D: CALL    OVFLAG                  ;5bdf  cd b8 5b     15210  15229 
    JP  TOGLE                           ;5be2  c3 eb 6b     15211  15230 
                                        ;                   15212  15231 ;
CHCK26: CP  026h                        ;5be5  fe 26        15213  15232 
    JR  NZ,MDLAG                        ;5be7  20 17        15214  15233 
    CALL    DEFTCH                      ;5be9  cd 51 5d     15215  15234 
    CALL    SMALL'                      ;5bec  cd 1c 63     15216  15235 
    CP  048h                            ;5bef  fe 48        15217  15236 
    JP  Z,HEXPZM                        ;5bf1  ca 5f 5b     15218  15237 
    CP  04Fh                            ;5bf4  fe 4f        15219  15238 
    CALL    Z,DEFTCH                    ;5bf6  cc 51 5d     15220  15239 
    DEC DE                              ;5bf9  1b           15221  15240 
    JP  OCTLER                          ;5bfa  c3 52 5b     15222  15241 
                                        ;                   15223  15242 ;
FTCHL:  CALL    DEFTCH                  ;5bfd  cd 51 5d     15224  15243 
MDLAG:  CP  02Eh                        ;5c00  fe 2e        15225  15244 
    JR  Z,POINTS                        ;5c02  28 23        15226  15245 
    CP  045h                            ;5c04  fe 45        15227  15246 
    JP  Z,EXPON?                        ;5c06  ca a8 5c     15228  15247 
    CP  044h                            ;5c09  fe 44        15229  15248 
    JP  Z,DEXPON                        ;5c0b  ca b6 5c     15230  15249 
    CP  030h                            ;5c0e  fe 30        15231  15250 
    JR  C,TST23H                        ;5c10  38 47        15232  15251 
    CP  03Ah                            ;5c12  fe 3a        15233  15252 
    JR  NC,TST23H                       ;5c14  30 43        15234  15253 
    SUB 030h                            ;5c16  d6 30        15235  15254 
    CALL    MULTEN                      ;5c18  cd 42 61     15236  15255 
    INC (IY-1)                          ;5c1b  fd 34 ff     15237  15256 
    SET 6,(IY-1)                        ;5c1e  fd cb ff f6  15238  15257 
    CALL    MULDEC                      ;5c22  cd 3d 5d     15239  15258 
    JR  FTCHL                           ;5c25  18 d6        15240  15259 
                                        ;                   15241  15260 ;
POINTS: SET 7,(IY-1)                    ;5c27  fd cb ff fe  15242  15261 
POINT:  CALL    DEFTCH                  ;5c2b  cd 51 5d     15243  15262 
    CP  030h                            ;5c2e  fe 30        15244  15263 
    JR  C,PESC                          ;5c30  38 1f        15245  15264 
    CP  03Ah                            ;5c32  fe 3a        15246  15265 
    JR  NC,PESC                         ;5c34  30 1b        15247  15266 
    SUB 030h                            ;5c36  d6 30        15248  15267 
    INC C                               ;5c38  0c           15249  15268 
    CALL    MULTEN                      ;5c39  cd 42 61     15250  15269 
    BIT 6,(IY-1)                        ;5c3c  fd cb ff 76  15251  15270 
    JR  NZ,KMYSET                       ;5c40  20 07        15252  15271 
    OR  A                               ;5c42  b7           15253  15272 
    JR  Z,POINT                         ;5c43  28 e6        15254  15273 
    SET 6,(IY-1)                        ;5c45  fd cb ff f6  15255  15274 
KMYSET: CALL    MULDEC                  ;5c49  cd 3d 5d     15256  15275 
    INC (IY-1)                          ;5c4c  fd 34 ff     15257  15276 
    JR  POINT                           ;5c4f  18 da        15258  15277 
                                        ;                   15259  15278 ;
PESC:   DEC C                           ;5c51  0d           15260  15279 
    JR  Z,TST23H                        ;5c52  28 05        15261  15280 
    CALL    DIVTEN                      ;5c54  cd 27 5d     15262  15281 
    JR  PESC                            ;5c57  18 f8        15263  15282 
                                        ;                   15264  15283 ;
TST23H: CP  045h                        ;5c59  fe 45        15265  15284 
    JP  Z,EXPON!                        ;5c5b  ca af 5c     15266  15285 
    CP  044h                            ;5c5e  fe 44        15267  15286 
    JP  Z,DEXPON                        ;5c60  ca b6 5c     15268  15287 
    CP  023h                            ;5c63  fe 23        15269  15288 
    JR  NZ,TST21H                       ;5c65  20 09        15270  15289 
    LD  (IY+0),8                        ;5c67  fd 36 00 08  15271  15290 
    SET 7,(IY-1)                        ;5c6b  fd cb ff fe  15272  15291 
    RET                                 ;5c6f  c9           15273  15292 
                                        ;                   15274  15293 ;
TST21H: CP  021h                        ;5c70  fe 21        15275  15294 
    JR  NZ,TST25H                       ;5c72  20 1d        15276  15295 
    SET 7,(IY-1)                        ;5c74  fd cb ff fe  15277  15296 
DGTUPQ: PUSH    DE                      ;5c78  d5           15278  15297 
    PUSH    BC                          ;5c79  c5           15279  15298 
    CALL    CSNG                        ;5c7a  cd 26 2b     15280  15299 
    PUSH    HL                          ;5c7d  e5           15281  15300 
    INC HL                              ;5c7e  23           15282  15301 
    INC HL                              ;5c7f  23           15283  15302 
    INC HL                              ;5c80  23           15284  15303 
    INC HL                              ;5c81  23           15285  15304 
    LD  B,4                             ;5c82  06 04        15286  15305 
SNGCL1: LD  (HL),0                      ;5c84  36 00        15287  15306 
    INC HL                              ;5c86  23           15288  15307 
    DJNZ    SNGCL1                      ;5c87  10 fb        15289  15308 
    POP HL                              ;5c89  e1           15290  15309 
    POP BC                              ;5c8a  c1           15291  15310 
    POP DE                              ;5c8b  d1           15292  15311 
    LD  (IY+0),4                        ;5c8c  fd 36 00 04  15293  15312 
    RET                                 ;5c90  c9           15294  15313 
                                        ;                   15295  15314 ;
TST25H: CP  025h                        ;5c91  fe 25        15296  15315 
    JR  NZ,TSTPRC                       ;5c93  20 08        15297  15316 
    CALL    INT                         ;5c95  cd 10 60     15298  15317 
    RES 7,(IY-1)                        ;5c98  fd cb ff be  15299  15318 
    RET                                 ;5c9c  c9           15300  15319 
                                        ;                   15301  15320 ;
TSTPRC: DEC DE                          ;5c9d  1b           15302  15321 
    LD  A,(IY-1)                        ;5c9e  fd 7e ff     15303  15322 
    AND 03Fh                            ;5ca1  e6 3f        15304  15323 
    CP  008h                            ;5ca3  fe 08        15305  15324 
    RET NC                              ;5ca5  d0           15306  15325 
    JR  DGTUPQ                          ;5ca6  18 d0        15307  15326 
                                        ;                   15308  15327 ;
EXPON?: LD  A,(DE)                      ;5ca8  1a           15309  15328 
    CP  04Ch                            ;5ca9  fe 4c        15310  15329 
    JR  NZ,EXPON                        ;5cab  20 0f        15311  15330 
    JR  TSTPRC                          ;5cad  18 ee        15312  15331 
                                        ;                   15313  15332 ;
EXPON!: LD  A,(DE)                      ;5caf  1a           15314  15333 
    CP  04Ch                            ;5cb0  fe 4c        15315  15334 
    JR  NZ,EXPON                        ;5cb2  20 08        15316  15335 
    JR  TSTPRC                          ;5cb4  18 e7        15317  15336 
                                        ;                   15318  15337 ;
DEXPON: LD  (IY+0),8                    ;5cb6  fd 36 00 08  15319  15338 
    JR  EXPCLM                          ;5cba  18 04        15320  15339 
EXPON:  LD  (IY+0),4                    ;5cbc  fd 36 00 04  15321  15340 
EXPCLM: SET 7,(IY-1)                    ;5cc0  fd cb ff fe  15322  15341 
    PUSH    HL                          ;5cc4  e5           15323  15342 
    LD  HL,MUL                          ;5cc5  21 e0 6f     15324  15343 
    LD  (EXJPVC),HL                     ;5cc8  22 22 5d     15325  15344 
    LD  HL,00000h                       ;5ccb  21 00 00     15326  15345 
FTREPT: CALL    DEFTCH                  ;5cce  cd 51 5d     15327  15346 
    CP  02Bh                            ;5cd1  fe 2b        15328  15347 
    JR  Z,CBEGIN                        ;5cd3  28 0c        15329  15348 
    CP  02Dh                            ;5cd5  fe 2d        15330  15349 
    JR  NZ,CLMIDL                       ;5cd7  20 0b        15331  15350 
    PUSH    HL                          ;5cd9  e5           15332  15351 
    LD  HL,DIV                          ;5cda  21 bd 70     15333  15352 
    LD  (EXJPVC),HL                     ;5cdd  22 22 5d     15334  15353 
    POP HL                              ;5ce0  e1           15335  15354 
CBEGIN: CALL    DEFTCH                  ;5ce1  cd 51 5d     15336  15355 
CLMIDL: SUB 030h                        ;5ce4  d6 30        15337  15356 
    JR  C,ESCPER                        ;5ce6  38 1c        15338  15357 
    CP  00Ah                            ;5ce8  fe 0a        15339  15358 
    JR  NC,ESCPER                       ;5cea  30 18        15340  15359 
    PUSH    DE                          ;5cec  d5           15341  15360 
    CALL    ADHLCK                      ;5ced  cd 38 5d     15342  15361 
    LD  E,L                             ;5cf0  5d           15343  15362 
    LD  D,H                             ;5cf1  54           15344  15363 
    CALL    ADHLCK                      ;5cf2  cd 38 5d     15345  15364 
    CALL    ADHLCK                      ;5cf5  cd 38 5d     15346  15365 
    CALL    ADDECK                      ;5cf8  cd 34 5d     15347  15366 
    LD  E,A                             ;5cfb  5f           15348  15367 
    LD  D,000h                          ;5cfc  16 00        15349  15368 
    CALL    ADDECK                      ;5cfe  cd 34 5d     15350  15369 
    POP DE                              ;5d01  d1           15351  15370 
    JR  CBEGIN                          ;5d02  18 dd        15352  15371 
ESCPER: DEC DE                          ;5d04  1b           15353  15372 
    LD  A,H                             ;5d05  7c           15354  15373 
    OR  A                               ;5d06  b7           15355  15374 
    JR  NZ,OVERF'                       ;5d07  20 31        15356  15375 
    LD  A,L                             ;5d09  7d           15357  15376 
    POP HL                              ;5d0a  e1           15358  15377 
    PUSH    DE                          ;5d0b  d5           15359  15378 
    PUSH    BC                          ;5d0c  c5           15360  15379 
    PUSH    HL                          ;5d0d  e5           15361  15380 
    LD  DE,ZFAC1                        ;5d0e  11 fa 62     15362  15381 
    PUSH    DE                          ;5d11  d5           15363  15382 
    CALL    LDIR1                       ;5d12  cd a3 73     15364  15383 
    POP HL                              ;5d15  e1           15365  15384 
    LD  B,A                             ;5d16  47           15366  15385 
    INC B                               ;5d17  04           15367  15386 
    JR  MULLKM                          ;5d18  18 03        15368  15387 
EMLLPO: CALL    MULTEN                  ;5d1a  cd 42 61     15369  15388 
MULLKM: DJNZ    EMLLPO                  ;5d1d  10 fb        15370  15389 
    EX  DE,HL                           ;5d1f  eb           15371  15390 
    POP HL                              ;5d20  e1           15372  15391 
    DEFB    0CDH                        ;5d21  cd           15373  15392 ;CALL
EXJPVC: DEFS    2                       ;5d22               15374  15393 
    POP BC                              ;5d24  c1           15375  15394 
    POP DE                              ;5d25  d1           15376  15395 
    RET                                 ;5d26  c9           15377  15396 
                                        ;                   15378  15397 ;
DIVTEN: PUSH    AF                      ;5d27  f5           15379  15398 
    PUSH    BC                          ;5d28  c5           15380  15399 
    PUSH    DE                          ;5d29  d5           15381  15400 
    LD  DE,FLTEN                        ;5d2a  11 90 62     15382  15401 
    CALL    DIV                         ;5d2d  cd bd 70     15383  15402 
    POP DE                              ;5d30  d1           15384  15403 
    POP BC                              ;5d31  c1           15385  15404 
    POP AF                              ;5d32  f1           15386  15405 
    RET                                 ;5d33  c9           15387  15406 
                                        ;                   15388  15407 ;
ADDECK: ADD HL,DE                       ;5d34  19           15389  15408 
    RET NC                              ;5d35  d0           15390  15409 
    JR  OVERF'                          ;5d36  18 02        15391  15410 
                                        ;                   15392  15411 ;
ADHLCK: ADD HL,HL                       ;5d38  29           15393  15412 
    RET NC                              ;5d39  d0           15394  15413 
OVERF': JP  OVERFL1                     ;5d3a  c3 e4 6e     15395  15414 
                                        ;                   15396  15415 ;
MULDEC: PUSH    DE                      ;5d3d  d5           15397  15416 
    PUSH    HL                          ;5d3e  e5           15398  15417 
    LD  HL,ZFAC1                        ;5d3f  21 fa 62     15399  15418 
    LD  E,A                             ;5d42  5f           15400  15419 
    LD  D,0                             ;5d43  16 00        15401  15420 
    CALL    FLTHEX                      ;5d45  cd 02 29     15402  15421 
    EX  DE,HL                           ;5d48  eb           15403  15422 
    POP HL                              ;5d49  e1           15404  15423 
    PUSH    BC                          ;5d4a  c5           15405  15424 
    CALL    ADD                         ;5d4b  cd a6 6c     15406  15425 
    POP BC                              ;5d4e  c1           15407  15426 
    POP DE                              ;5d4f  d1           15408  15427 
    RET                                 ;5d50  c9           15409  15428 
                                        ;                   15410  15429 ;
DEFTCH: LD  A,(DE)                      ;5d51  1a           15411  15430 
    CP  020h                            ;5d52  fe 20        15412  15431 
    INC DE                              ;5d54  13           15413  15432 
    JR  Z,DEFTCH                        ;5d55  28 fa        15414  15433 
    RET                                 ;5d57  c9           15415  15434 
                                        ;                   15416  15435 ;
CVNMFL: LD  A,(HL)                      ;5d58  7e           15417  15436 
    OR  A                               ;5d59  b7           15418  15437 
    JR  Z,ONLYZ#                        ;5d5a  28 06        15419  15438 
    INC HL                              ;5d5c  23           15420  15439 
    LD  A,(HL)                          ;5d5d  7e           15421  15440 
    RES 7,(HL)                          ;5d5e  cb be        15422  15441 
    DEC HL                              ;5d60  2b           15423  15442 
    RLCA                                ;5d61  07           15424  15443 
ONLYZ#: LD  A,020h                      ;5d62  3e 20        15425  15444 
    JR  NC,PLUS                         ;5d64  30 02        15426  15445 
    LD  A,02Dh                          ;5d66  3e 2d        15427  15446 
PLUS:   PUSH    AF                      ;5d68  f5           15428  15447 
    CALL    CVASFL                      ;5d69  cd 1a 5e     15429  15448 
    POP AF                              ;5d6c  f1           15430  15449 
    INC B                               ;5d6d  04           15431  15450 
    DEC DE                              ;5d6e  1b           15432  15451 
    LD  (DE),A                          ;5d6f  12           15433  15452 
    RET                                 ;5d70  c9           15434  15453 
                                        ;                   15435  15454 ;
ENORLP: LD  BC,0                        ;5d71  01 00 00     15436  15455 
ENORL': CALL    CMP                     ;5d74  cd d6 61     15437  15456 
    JR  NC,NORRES                       ;5d77  30 06        15438  15457 
    CALL    MULTEN                      ;5d79  cd 42 61     15439  15458 
    DEC BC                              ;5d7c  0b           15440  15459 
    JR  ENORL'                          ;5d7d  18 f5        15441  15460 
NORRES: PUSH    HL                      ;5d7f  e5           15442  15461 
    LD  HL,0FFF8h                       ;5d80  21 f8 ff     15443  15462 
    ADD HL,DE                           ;5d83  19           15444  15463 
    EX  DE,HL                           ;5d84  eb           15445  15464 
    POP HL                              ;5d85  e1           15446  15465 
NORRE': CALL    CMP                     ;5d86  cd d6 61     15447  15466 
    RET C                               ;5d89  d8           15448  15467 
    CALL    DIVTEN                      ;5d8a  cd 27 5d     15449  15468 
    INC BC                              ;5d8d  03           15450  15469 
    JR  NORRE'                          ;5d8e  18 f6        15451  15470 
                                        ;                   15452  15471 ;
OKOMTR: LD  A,044h                      ;5d90  3e 44        15453  15472 
    BIT 3,(IY+0)                        ;5d92  fd cb 00 5e  15454  15473 
    JR  NZ,PUTEMK                       ;5d96  20 01        15455  15474 
    INC A                               ;5d98  3c           15456  15475 
PUTEMK: LD  (DE),A                      ;5d99  12           15457  15476 
    INC DE                              ;5d9a  13           15458  15477 
    LD  A,H                             ;5d9b  7c           15459  15478 
    OR  A                               ;5d9c  b7           15460  15479 
    LD  A,02Bh                          ;5d9d  3e 2b        15461  15480 
    JR  Z,EXPPLS                        ;5d9f  28 09        15462  15481 
    LD  A,L                             ;5da1  7d           15463  15482 
    CPL                                 ;5da2  2f           15464  15483 
    LD  L,A                             ;5da3  6f           15465  15484 
    LD  A,H                             ;5da4  7c           15466  15485 
    CPL                                 ;5da5  2f           15467  15486 
    LD  H,A                             ;5da6  67           15468  15487 
    INC HL                              ;5da7  23           15469  15488 
    LD  A,02Dh                          ;5da8  3e 2d        15470  15489 
EXPPLS: LD  (DE),A                      ;5daa  12           15471  15490 
    INC DE                              ;5dab  13           15472  15491 
    PUSH    DE                          ;5dac  d5           15473  15492 
    LD  DE,ZFAC                         ;5dad  11 f2 62     15474  15493 
    CALL    ASCHL                       ;5db0  cd a8 62     15475  15494 
    POP DE                              ;5db3  d1           15476  15495 
    LD  A,(ZFAC+3)                      ;5db4  3a f5 62     15477  15496 
    LD  (DE),A                          ;5db7  12           15478  15497 
    INC DE                              ;5db8  13           15479  15498 
    LD  A,(ZFAC+4)                      ;5db9  3a f6 62     15480  15499 
    LD  (DE),A                          ;5dbc  12           15481  15500 
    RET                                 ;5dbd  c9           15482  15501 
                                        ;                   15483  15502 ;
EXPASC: PUSH    HL                      ;5dbe  e5           15484  15503 
    LD  DE,ZFAC                         ;5dbf  11 f2 62     15485  15504 
    PUSH    DE                          ;5dc2  d5           15486  15505 
    CALL    LDIR8                       ;5dc3  cd a6 73     15487  15506 
    POP HL                              ;5dc6  e1           15488  15507 
    LD  DE,FLONE                        ;5dc7  11 98 62     15489  15508 
    CALL    ENORLP                      ;5dca  cd 71 5d     15490  15509 
    PUSH    BC                          ;5dcd  c5           15491  15510 
    CALL    CVASFL                      ;5dce  cd 1a 5e     15492  15511 
    POP HL                              ;5dd1  e1           15493  15512 
    PUSH    DE                          ;5dd2  d5           15494  15513 
    PUSH    BC                          ;5dd3  c5           15495  15514 
    LD  A,E                             ;5dd4  7b           15496  15515 
    ADD A,B                             ;5dd5  80           15497  15516 
    LD  E,A                             ;5dd6  5f           15498  15517 
    LD  A,000h                          ;5dd7  3e 00        15499  15518 
    ADC A,D                             ;5dd9  8a           15500  15519 
    LD  D,A                             ;5dda  57           15501  15520 
    DEC DE                              ;5ddb  1b           15502  15521 
    LD  A,(DE)                          ;5ddc  1a           15503  15522 
    CP  030h                            ;5ddd  fe 30        15504  15523 
    INC DE                              ;5ddf  13           15505  15524 
    JR  NZ,PUTEXP                       ;5de0  20 05        15506  15525 
    DEC DE                              ;5de2  1b           15507  15526 
    POP BC                              ;5de3  c1           15508  15527 
    DEC B                               ;5de4  05           15509  15528 
    PUSH    BC                          ;5de5  c5           15510  15529 
    INC HL                              ;5de6  23           15511  15530 
PUTEXP: CALL    OKOMTR                  ;5de7  cd 90 5d     15512  15531 
    POP BC                              ;5dea  c1           15513  15532 
    POP DE                              ;5deb  d1           15514  15533 
    INC B                               ;5dec  04           15515  15534 
    INC B                               ;5ded  04           15516  15535 
    INC B                               ;5dee  04           15517  15536 
    INC B                               ;5def  04           15518  15537 
    POP HL                              ;5df0  e1           15519  15538 
    RET                                 ;5df1  c9           15520  15539 
                                        ;                   15521  15540 ;
INTPAR: PUSH    HL                      ;5df2  e5           15522  15541 
    CALL    DLTEN                       ;5df3  cd 67 61     15523  15542 
    LD  DE,DGBUF+3                      ;5df6  11 07 63     15524  15543 
    CALL    ASCHL                       ;5df9  cd a8 62     15525  15544 
    EX  DE,HL                           ;5dfc  eb           15526  15545 
    LD  B,5                             ;5dfd  06 05        15527  15546 
FRSTCH: LD  A,(HL)                      ;5dff  7e           15528  15547 
    CP  030h                            ;5e00  fe 30        15529  15548 
    JR  NZ,BEGTRS                       ;5e02  20 03        15530  15549 
    INC HL                              ;5e04  23           15531  15550 
    DJNZ    FRSTCH                      ;5e05  10 f8        15532  15551 
BEGTRS: LD  C,B                         ;5e07  48           15533  15552 
MIDTRS: LD  A,(HL)                      ;5e08  7e           15534  15553 
    INC IX                              ;5e09  dd 23        15535  15554 
    LD  (IX+0),A                        ;5e0b  dd 77 00     15536  15555 
    INC HL                              ;5e0e  23           15537  15556 
    DJNZ    MIDTRS                      ;5e0f  10 f7        15538  15557 
    POP HL                              ;5e11  e1           15539  15558 
    CALL    FRAC                        ;5e12  cd 95 60     15540  15559 
    LD  DE,FLLAST                       ;5e15  11 a0 62     15541  15560 
    JR  ESTST'                          ;5e18  18 57        15542  15561 
                                        ;                   15543  15562 ;
CVASFL: XOR A                           ;5e1a  af           15544  15563 
    CP  (HL)                            ;5e1b  be           15545  15564 
    JP  Z,ASZERO                        ;5e1c  ca b4 5e     15546  15565 
    LD  A,(IY+0)                        ;5e1f  fd 7e 00     15547  15566 
    CP  008h                            ;5e22  fe 08        15548  15567 
    JR  Z,DBLLCH                        ;5e24  28 0b        15549  15568 
    LD  DE,SHLMT                        ;5e26  11 ee 62     15550  15569 
    CALL    CMP                         ;5e29  cd d6 61     15551  15570 
    JP  NC,EXPASC                       ;5e2c  d2 be 5d     15552  15571 
    JR  NOEXP                           ;5e2f  18 09        15553  15572 
DBLLCH: LD  DE,DHLMT                    ;5e31  11 e6 62     15554  15573 
    CALL    CMP                         ;5e34  cd d6 61     15555  15574 
    JP  NC,EXPASC                       ;5e37  d2 be 5d     15556  15575 
NOEXP:  LD  DE,FLLAST                   ;5e3a  11 a0 62     15557  15576 
    CALL    CMP                         ;5e3d  cd d6 61     15558  15577 
    JP  C,EXPASC                        ;5e40  da be 5d     15559  15578 
    PUSH    HL                          ;5e43  e5           15560  15579 
    LD  DE,ZFAC1                        ;5e44  11 fa 62     15561  15580 
    PUSH    DE                          ;5e47  d5           15562  15581 
    CALL    LDIR8                       ;5e48  cd a6 73     15563  15582 
    POP HL                              ;5e4b  e1           15564  15583 
    CALL    CONDDG                      ;5e4c  cd fa 5f     15565  15584 
    LD  IX,DGBUF                        ;5e4f  dd 21 04 63  15566  15585 
    LD  (IX+0),030h                     ;5e53  dd 36 00 30  15567  15586 
    LD  A,(HL)                          ;5e57  7e           15568  15587 
    CP  081h                            ;5e58  fe 81        15569  15588 
    JR  C,FRACDG                        ;5e5a  38 1e        15570  15589 
    CP  091h                            ;5e5c  fe 91        15571  15590 
    JP  C,INTPAR                        ;5e5e  da f2 5d     15572  15591 
    LD  DE,CONTBL                       ;5e61  11 20 62     15573  15592 
    CALL    CONDSF                      ;5e64  cd ec 5f     15574  15593 
CVCONT: CALL    CMP                     ;5e67  cd d6 61     15575  15594 
    JR  NC,DWNERC                       ;5e6a  30 0b        15576  15595 
    CALL    ADDDEG                      ;5e6c  cd 4a 5b     15577  15596 
    JR  CVCONT                          ;5e6f  18 f6        15578  15597 
                                        ;                   15579  15598 ;
ESTST': CALL    CONDDG                  ;5e71  cd fa 5f     15580  15599 
    LD  A,B                             ;5e74  78           15581  15600 
    SUB C                               ;5e75  91           15582  15601 
    LD  B,A                             ;5e76  47           15583  15602 
DWNERC: CALL    MIDSGN                  ;5e77  cd c0 5f     15584  15603 
FRACDG: INC IX                          ;5e7a  dd 23        15585  15604 
    LD  (IX+0),02Eh                     ;5e7c  dd 36 00 2e  15586  15605 
FRCAGN: LD  DE,FLMAX                    ;5e80  11 18 62     15587  15606 
    CALL    CONDSF                      ;5e83  cd ec 5f     15588  15607 
    PUSH    BC                          ;5e86  c5           15589  15608 
    PUSH    IX                          ;5e87  dd e5        15590  15609 
    CALL    MUL                         ;5e89  cd e0 6f     15591  15610 
    POP IX                              ;5e8c  dd e1        15592  15611 
    POP BC                              ;5e8e  c1           15593  15612 
    CALL    GNXDGT                      ;5e8f  cd bd 5f     15594  15613 
    LD  A,B                             ;5e92  78           15595  15614 
    OR  A                               ;5e93  b7           15596  15615 
    JR  NZ,FRCAGN                       ;5e94  20 ea        15597  15616 
    CALL    FRCADM                      ;5e96  cd bd 5e     15598  15617 
BCKSER: DEC HL                          ;5e99  2b           15599  15618 
    LD  A,(HL)                          ;5e9a  7e           15600  15619 
    CP  02Eh                            ;5e9b  fe 2e        15601  15620 
    DEC HL                              ;5e9d  2b           15602  15621 
    JR  Z,INTDIS                        ;5e9e  28 05        15603  15622 
    INC HL                              ;5ea0  23           15604  15623 
    CP  030h                            ;5ea1  fe 30        15605  15624 
    JR  Z,BCKSER                        ;5ea3  28 f4        15606  15625 
INTDIS: LD  DE,DGBUF                    ;5ea5  11 04 63     15607  15626 
    LD  A,(DE)                          ;5ea8  1a           15608  15627 
    CP  030h                            ;5ea9  fe 30        15609  15628 
    JR  NZ,LSTASA                       ;5eab  20 01        15610  15629 
    INC DE                              ;5ead  13           15611  15630 
LSTASA: SBC HL,DE                       ;5eae  ed 52        15612  15631 
    LD  B,L                             ;5eb0  45           15613  15632 
    INC B                               ;5eb1  04           15614  15633 
    POP HL                              ;5eb2  e1           15615  15634 
    RET                                 ;5eb3  c9           15616  15635 
                                        ;                   15617  15636 ;
ASZERO: LD  DE,DGBUF                    ;5eb4  11 04 63     15618  15637 
    LD  A,030h                          ;5eb7  3e 30        15619  15638 
    LD  (DE),A                          ;5eb9  12           15620  15639 
ASCONE: LD  B,1                         ;5eba  06 01        15621  15640 
    RET                                 ;5ebc  c9           15622  15641 
                                        ;                   15623  15642 ;
FRCADM: PUSH    IX                      ;5ebd  dd e5        15624  15643 
    POP HL                              ;5ebf  e1           15625  15644 
    LD  A,(HL)                          ;5ec0  7e           15626  15645 
    PUSH    HL                          ;5ec1  e5           15627  15646 
FRCASL: LD  (HL),030h                   ;5ec2  36 30        15628  15647 
    CP  035h                            ;5ec4  fe 35        15629  15648 
    JR  C,ESCADD                        ;5ec6  38 0c        15630  15649 
ADDLOP: DEC HL                          ;5ec8  2b           15631  15650 
    LD  A,(HL)                          ;5ec9  7e           15632  15651 
    CP  02Eh                            ;5eca  fe 2e        15633  15652 
    JR  Z,ADDLOP                        ;5ecc  28 fa        15634  15653 
    INC A                               ;5ece  3c           15635  15654 
    LD  (HL),A                          ;5ecf  77           15636  15655 
    CP  03Ah                            ;5ed0  fe 3a        15637  15656 
    JR  Z,FRCASL                        ;5ed2  28 ee        15638  15657 
ESCADD: POP HL                          ;5ed4  e1           15639  15658 
    RET                                 ;5ed5  c9           15640  15659 
                                        ;                   15641  15660 ;
USGNCV:                                 ;                   15642  15661 
                                        ;                   15643  15662 ;
                                        ;                   15644  15663 ; ACC <- 1 EXP ON
                                        ;                   15645  15664 ; ACC <- 0 EXP OFF
                                        ;                   15646  15665 ; B <- INT PAR
                                        ;                   15647  15666 ; C <- FRAC PAR
                                        ;                   15648  15667 ;
                                        ;                   15649  15668 ; OUT:HL <- LASTPO
                                        ;                   15650  15669 ; KEYBUF+1 <- RESULT
                                        ;                   15651  15670 ;
    PUSH    BC                          ;5ed6  c5           15652  15671 
    CALL    USGCV'                      ;5ed7  cd 4a 5f     15653  15672 
    POP BC                              ;5eda  c1           15654  15673 
    LD  A,B                             ;5edb  78           15655  15674 
    CP  2                               ;5edc  fe 02        15656  15675 
    RET C                               ;5ede  d8           15657  15676 
    DEC B                               ;5edf  05           15658  15677 
    LD  DE,KEYBUF                       ;5ee0  11 4f 7a     15659  15678 
RPSPAC: INC DE                          ;5ee3  13           15660  15679 
    LD  A,(DE)                          ;5ee4  1a           15661  15680 
    CP  030h                            ;5ee5  fe 30        15662  15681 
    RET NZ                              ;5ee7  c0           15663  15682 
    LD  A,020h                          ;5ee8  3e 20        15664  15683 
    LD  (DE),A                          ;5eea  12           15665  15684 
    DJNZ    RPSPAC                      ;5eeb  10 f6        15666  15685 
    RET                                 ;5eed  c9           15667  15686 
                                        ;                   15668  15687 ;
EXPUSG: PUSH    BC                      ;5eee  c5           15669  15688 
    LD  A,B                             ;5eef  78           15670  15689 
    CP  011h                            ;5ef0  fe 11        15671  15690 
    JP  NC,FOVER                        ;5ef2  d2 a6 5f     15672  15691 
    OR  A                               ;5ef5  b7           15673  15692 
    JR  Z,USNRIW                        ;5ef6  28 01        15674  15693 
    DEC A                               ;5ef8  3d           15675  15694 
USNRIW: CALL    CPSHIF                  ;5ef9  cd dd 5f     15676  15695 
    LD  A,(HL)                          ;5efc  7e           15677  15696 
    OR  A                               ;5efd  b7           15678  15697 
    LD  BC,0                            ;5efe  01 00 00     15679  15698 
    CALL    NZ,ENORLP                   ;5f01  c4 71 5d     15680  15699 
    LD  E,C                             ;5f04  59           15681  15700 
    LD  D,B                             ;5f05  50           15682  15701 
    POP BC                              ;5f06  c1           15683  15702 
    LD  (EXPUBC),BC                     ;5f07  ed 43 2d 5f  15684  15703 
    LD  (EXPUHL),HL                     ;5f0b  22 30 5f     15685  15704 
AGNEXP: PUSH    DE                      ;5f0e  d5           15686  15705 
    PUSH    BC                          ;5f0f  c5           15687  15706 
    LD  DE,ZFAC                         ;5f10  11 f2 62     15688  15707 
    PUSH    DE                          ;5f13  d5           15689  15708 
    CALL    LDIR8                       ;5f14  cd a6 73     15690  15709 
    POP HL                              ;5f17  e1           15691  15710 
    POP BC                              ;5f18  c1           15692  15711 
    CALL    USGC''                      ;5f19  cd 46 5f     15693  15712 
    LD  DE,KEYBUF                       ;5f1c  11 4f 7a     15694  15713 
    LD  A,(DE)                          ;5f1f  1a           15695  15714 
    CP  02Fh                            ;5f20  fe 2f        15696  15715 
    JR  NZ,NGPUDS                       ;5f22  20 06        15697  15716 
    INC DE                              ;5f24  13           15698  15717 
    LD  A,(DE)                          ;5f25  1a           15699  15718 
    CP  031h                            ;5f26  fe 31        15700  15719 
    JR  NZ,WRITEL1                      ;5f28  20 0d        15701  15720 
NGPUDS: POP DE                          ;5f2a  d1           15702  15721 
    INC DE                              ;5f2b  13           15703  15722 
    DEFB    001H                        ;5f2c  01           15704  15723 ; LD BC,?
EXPUBC: DEFS    2                       ;5f2d               15705  15724 
    DEFB    021H                        ;5f2f  21           15706  15725 ; LD HL,?
EXPUHL: DEFS    2                       ;5f30               15707  15726 
    CALL    DIVTEN                      ;5f32  cd 27 5d     15708  15727 
    JR  AGNEXP                          ;5f35  18 d7        15709  15728 
                                        ;                   15710  15729 ;
WRITEL1: CP 02Eh                        ;5f37  fe 2e        15711  15730 
    JR  Z,NTPT2E                        ;5f39  28 03        15712  15731 
    LD  A,020h                          ;5f3b  3e 20        15713  15732 
    LD  (DE),A                          ;5f3d  12           15714  15733 
NTPT2E: POP DE                          ;5f3e  d1           15715  15734 
    EX  DE,HL                           ;5f3f  eb           15716  15735 
    CALL    OKOMTR                      ;5f40  cd 90 5d     15717  15736 
    INC DE                              ;5f43  13           15718  15737 
    EX  DE,HL                           ;5f44  eb           15719  15738 
    RET                                 ;5f45  c9           15720  15739 
                                        ;                   15721  15740 ;
USGC'': LD  A,02Fh                      ;5f46  3e 2f        15722  15741 
    JR  USG'''                          ;5f48  18 05        15723  15742 
                                        ;                   15724  15743 ;
USGCV': OR  A                           ;5f4a  b7           15725  15744 
    JR  NZ,EXPUSG                       ;5f4b  20 a1        15726  15745 
    LD  A,030h                          ;5f4d  3e 30        15727  15746 
USG''': LD  IX,KEYBUF                   ;5f4f  dd 21 4f 7a  15728  15747 
    LD  (IX+0),A                        ;5f53  dd 77 00     15729  15748 
    LD  A,B                             ;5f56  78           15730  15749 
    OR  A                               ;5f57  b7           15731  15750 
    JR  Z,FRACUS                        ;5f58  28 1d        15732  15751 
    CP  17                              ;5f5a  fe 11        15733  15752 
    JR  C,STDGUS                        ;5f5c  38 0b        15734  15753 
STFLBL: INC IX                          ;5f5e  dd 23        15735  15754 
    LD  (IX+0),030h                     ;5f60  dd 36 00 30  15736  15755 
    DEC A                               ;5f64  3d           15737  15756 
    CP  16                              ;5f65  fe 10        15738  15757 
    JR  NZ,STFLBL                       ;5f67  20 f5        15739  15758 
STDGUS: INC A                           ;5f69  3c           15740  15759 
    CALL    CPSHIF                      ;5f6a  cd dd 5f     15741  15760 
    CALL    CMP                         ;5f6d  cd d6 61     15742  15761 
    JR  NC,FOVER                        ;5f70  30 34        15743  15762 
    LD  B,0                             ;5f72  06 00        15744  15763 
    CALL    GTESTB                      ;5f74  cd bb 5f     15745  15764 
FRACUS: CALL    ONECMP                  ;5f77  cd d3 61     15746  15765 
    JR  NC,FOVER                        ;5f7a  30 2a        15747  15766 
    LD  A,C                             ;5f7c  79           15748  15767 
    OR  A                               ;5f7d  b7           15749  15768 
    JR  Z,NOFRAC                        ;5f7e  28 2b        15750  15769 
    INC IX                              ;5f80  dd 23        15751  15770 
    LD  (IX+0),02Eh                     ;5f82  dd 36 00 2e  15752  15771 
    LD  B,C                             ;5f86  41           15753  15772 
AGINFR: PUSH    BC                      ;5f87  c5           15754  15773 
    PUSH    IX                          ;5f88  dd e5        15755  15774 
    LD  DE,FLMAX                        ;5f8a  11 18 62     15756  15775 
    CALL    CONDSF                      ;5f8d  cd ec 5f     15757  15776 
    CALL    MUL                         ;5f90  cd e0 6f     15758  15777 
    POP IX                              ;5f93  dd e1        15759  15778 
    POP BC                              ;5f95  c1           15760  15779 
    CALL    GNXDGT                      ;5f96  cd bd 5f     15761  15780 
    LD  A,B                             ;5f99  78           15762  15781 
    OR  A                               ;5f9a  b7           15763  15782 
    JR  NZ,AGINFR                       ;5f9b  20 ea        15764  15783 
OVERRD: CALL    FRCADM                  ;5f9d  cd bd 5e     15765  15784 
    LD  A,(KEYBUF)                      ;5fa0  3a 4f 7a     15766  15785 
    CP  031h                            ;5fa3  fe 31        15767  15786 
    RET C                               ;5fa5  d8           15768  15787 
FOVER:  LD  A,21                        ;5fa6  3e 15        15769  15788 
    JP  ERROR                           ;5fa8  c3 96 21     15770  15789 
                                        ;                   15771  15790 ;
NOFRAC: INC (HL)                        ;5fab  34           15772  15791 
    CALL    ONECMP                      ;5fac  cd d3 61     15773  15792 
    INC IX                              ;5faf  dd 23        15774  15793 
    PUSH    IX                          ;5fb1  dd e5        15775  15794 
    POP HL                              ;5fb3  e1           15776  15795 
    RET C                               ;5fb4  d8           15777  15796 
    LD  (IX+0),039h                     ;5fb5  dd 36 00 39  15778  15797 
    JR  OVERRD                          ;5fb9  18 e2        15779  15798 
                                        ;                   15780  15799 ;
GTESTB: DEC B                           ;5fbb  05           15781  15800 
    RET Z                               ;5fbc  c8           15782  15801 
GNXDGT: CALL    ADDDEG                  ;5fbd  cd 4a 5b     15783  15802 
MIDSGN: LD  A,(DE)                      ;5fc0  1a           15784  15803 
    CP  07Dh                            ;5fc1  fe 7d        15785  15804 
    RET Z                               ;5fc3  c8           15786  15805 
    INC IX                              ;5fc4  dd 23        15787  15806 
    LD  (IX+0),030h                     ;5fc6  dd 36 00 30  15788  15807 
INTGDL: CALL    CMP                     ;5fca  cd d6 61     15789  15808 
    JR  C,GTESTB                        ;5fcd  38 ec        15790  15809 
    INC (IX+0)                          ;5fcf  dd 34 00     15791  15810 
    PUSH    IX                          ;5fd2  dd e5        15792  15811 
    PUSH    BC                          ;5fd4  c5           15793  15812 
    CALL    SUB                         ;5fd5  cd d1 6b     15794  15813 
    POP BC                              ;5fd8  c1           15795  15814 
    POP IX                              ;5fd9  dd e1        15796  15815 
    JR  INTGDL                          ;5fdb  18 ed        15797  15816 
                                        ;                   15798  15817 ;
CPSHIF: ADD A,A                         ;5fdd  87           15799  15818 
    ADD A,A                             ;5fde  87           15800  15819 
    ADD A,A                             ;5fdf  87           15801  15820 
    LD  B,A                             ;5fe0  47           15802  15821 
    LD  DE,FLLAST                       ;5fe1  11 a0 62     15803  15822 
    LD  A,E                             ;5fe4  7b           15804  15823 
    SUB B                               ;5fe5  90           15805  15824 
    LD  E,A                             ;5fe6  5f           15806  15825 
    LD  A,D                             ;5fe7  7a           15807  15826 
    SBC A,0                             ;5fe8  de 00        15808  15827 
    LD  D,A                             ;5fea  57           15809  15828 
    RET                                 ;5feb  c9           15810  15829 
                                        ;                   15811  15830 ;
CONDSF: LD  A,(IY+0)                    ;5fec  fd 7e 00     15812  15831 
    CP  008h                            ;5fef  fe 08        15813  15832 
    RET Z                               ;5ff1  c8           15814  15833 
    PUSH    HL                          ;5ff2  e5           15815  15834 
    LD  HL,72                           ;5ff3  21 48 00     15816  15835 
    ADD HL,DE                           ;5ff6  19           15817  15836 
    EX  DE,HL                           ;5ff7  eb           15818  15837 
    POP HL                              ;5ff8  e1           15819  15838 
    RET                                 ;5ff9  c9           15820  15839 
                                        ;                   15821  15840 ;
CONDDG: LD  A,(IY+0)                    ;5ffa  fd 7e 00     15822  15841 
    LD  B,17                            ;5ffd  06 11        15823  15842 
    CP  008h                            ;5fff  fe 08        15824  15843 
    RET Z                               ;6001  c8           15825  15844 
    LD  B,7                             ;6002  06 07        15826  15845 
    RET                                 ;6004  c9           15827  15846 
                                        ;                   15828  15847 ;
INTZRR: LD  B,(IY+0)                    ;6005  fd 46 00     15829  15848 
    EX  DE,HL                           ;6008  eb           15830  15849 
    CALL    ZFILL                       ;6009  cd 10 62     15831  15850 
INTBCK: POP DE                          ;600c  d1           15832  15851 
    POP HL                              ;600d  e1           15833  15852 
    POP BC                              ;600e  c1           15834  15853 
    RET                                 ;600f  c9           15835  15854 
                                        ;                   15836  15855 ;
B_FIX:                                  ;                   15837  15856 
INT:    PUSH    BC                      ;6010  c5           15838  15857 
    PUSH    HL                          ;6011  e5           15839  15858 
    PUSH    DE                          ;6012  d5           15840  15859 
    LD  A,(HL)                          ;6013  7e           15841  15860 
    CP  081h                            ;6014  fe 81        15842  15861 
    JR  C,INTZRR                        ;6016  38 ed        15843  15862 
    BIT 3,(IY+0)                        ;6018  fd cb 00 5e  15844  15863 
    JR  NZ,INTDBL                       ;601c  20 24        15845  15864 
    CP  098h                            ;601e  fe 98        15846  15865 
    JR  NC,INTBCK                       ;6020  30 ea        15847  15866 
    INC HL                              ;6022  23           15848  15867 
    CALL    RCHLBC                      ;6023  cd 8e 60     15849  15868 
    DEC HL                              ;6026  2b           15850  15869 
    LD  B,0                             ;6027  06 00        15851  15870 
INTSFL: SRL E                           ;6029  cb 3b        15852  15871 
    RR  D                               ;602b  cb 1a        15853  15872 
    RR  C                               ;602d  cb 19        15854  15873 
    INC A                               ;602f  3c           15855  15874 
    INC B                               ;6030  04           15856  15875 
    CP  098h                            ;6031  fe 98        15857  15876 
    JR  NZ,INTSFL                       ;6033  20 f4        15858  15877 
INTSBL: SLA C                           ;6035  cb 21        15859  15878 
    RL  D                               ;6037  cb 12        15860  15879 
    RL  E                               ;6039  cb 13        15861  15880 
    DJNZ    INTSBL                      ;603b  10 f8        15862  15881 
INTBC': CALL    STHLBC                  ;603d  cd 88 60     15863  15882 
    JR  INTBCK                          ;6040  18 ca        15864  15883 
                                        ;                   15865  15884 ;
INTDBL: CP  0B8h                        ;6042  fe b8        15866  15885 
    JR  NC,INTBCK                       ;6044  30 c6        15867  15886 
    INC HL                              ;6046  23           15868  15887 
    CALL    RCHLBC                      ;6047  cd 8e 60     15869  15888 
    PUSH    HL                          ;604a  e5           15870  15889 
    EXX                                 ;604b  d9           15871  15890 
    POP HL                              ;604c  e1           15872  15891 
    CALL    RCHLBC                      ;604d  cd 8e 60     15873  15892 
    LD  B,(HL)                          ;6050  46           15874  15893 
    EXX                                 ;6051  d9           15875  15894 
    LD  B,000h                          ;6052  06 00        15876  15895 
INDSFL: SRL E                           ;6054  cb 3b        15877  15896 
    RR  D                               ;6056  cb 1a        15878  15897 
    RR  C                               ;6058  cb 19        15879  15898 
    EXX                                 ;605a  d9           15880  15899 
    RR  E                               ;605b  cb 1b        15881  15900 
    RR  D                               ;605d  cb 1a        15882  15901 
    RR  C                               ;605f  cb 19        15883  15902 
    RR  B                               ;6061  cb 18        15884  15903 
    EXX                                 ;6063  d9           15885  15904 
    INC B                               ;6064  04           15886  15905 
    INC A                               ;6065  3c           15887  15906 
    CP  0B8h                            ;6066  fe b8        15888  15907 
    JR  NZ,INDSFL                       ;6068  20 ea        15889  15908 
IDSFBL: EXX                             ;606a  d9           15890  15909 
    SLA B                               ;606b  cb 20        15891  15910 
    RL  C                               ;606d  cb 11        15892  15911 
    RL  D                               ;606f  cb 12        15893  15912 
    RL  E                               ;6071  cb 13        15894  15913 
    EXX                                 ;6073  d9           15895  15914 
    RL  C                               ;6074  cb 11        15896  15915 
    RL  D                               ;6076  cb 12        15897  15916 
    RL  E                               ;6078  cb 13        15898  15917 
    DJNZ    IDSFBL                      ;607a  10 ee        15899  15918 
    EXX                                 ;607c  d9           15900  15919 
    LD  (HL),B                          ;607d  70           15901  15920 
    DEC HL                              ;607e  2b           15902  15921 
MIDERF: CALL    STHLBC                  ;607f  cd 88 60     15903  15922 
    DEC HL                              ;6082  2b           15904  15923 
    PUSH    HL                          ;6083  e5           15905  15924 
    EXX                                 ;6084  d9           15906  15925 
    POP HL                              ;6085  e1           15907  15926 
    JR  INTBC'                          ;6086  18 b5        15908  15927 
                                        ;                   15909  15928 ;
STHLBC: LD  (HL),C                      ;6088  71           15910  15929 
    DEC HL                              ;6089  2b           15911  15930 
    LD  (HL),D                          ;608a  72           15912  15931 
    DEC HL                              ;608b  2b           15913  15932 
    LD  (HL),E                          ;608c  73           15914  15933 
    RET                                 ;608d  c9           15915  15934 
                                        ;                   15916  15935 ;
RCHLBC: LD  E,(HL)                      ;608e  5e           15917  15936 
    INC HL                              ;608f  23           15918  15937 
    LD  D,(HL)                          ;6090  56           15919  15938 
    INC HL                              ;6091  23           15920  15939 
    LD  C,(HL)                          ;6092  4e           15921  15940 
    INC HL                              ;6093  23           15922  15941 
    RET                                 ;6094  c9           15923  15942 
                                        ;                   15924  15943 ;
FRAC:   LD  A,(HL)                      ;6095  7e           15925  15944 
    OR  A                               ;6096  b7           15926  15945 
    RET Z                               ;6097  c8           15927  15946 
    INC HL                              ;6098  23           15928  15947 
    LD  A,(HL)                          ;6099  7e           15929  15948 
    SET 7,(HL)                          ;609a  cb fe        15930  15949 
    DEC HL                              ;609c  2b           15931  15950 
    PUSH    AF                          ;609d  f5           15932  15951 
    CALL    FRAC'                       ;609e  cd a7 60     15933  15952 
    POP AF                              ;60a1  f1           15934  15953 
    RLCA                                ;60a2  07           15935  15954 
    RET C                               ;60a3  d8           15936  15955 
    JP  RESNHL                          ;60a4  c3 c0 6b     15937  15956 
                                        ;                   15938  15957 ;
FRAC':  PUSH    BC                      ;60a7  c5           15939  15958 
    PUSH    HL                          ;60a8  e5           15940  15959 
    PUSH    DE                          ;60a9  d5           15941  15960 
    LD  A,(HL)                          ;60aa  7e           15942  15961 
    CP  081h                            ;60ab  fe 81        15943  15962 
    JP  C,INTBCK                        ;60ad  da 0c 60     15944  15963 
    BIT 3,(IY+0)                        ;60b0  fd cb 00 5e  15945  15964 
    JR  NZ,FRCDBL                       ;60b4  20 31        15946  15965 
    CP  098h                            ;60b6  fe 98        15947  15966 
    JP  NC,INTZRR                       ;60b8  d2 05 60     15948  15967 
    INC HL                              ;60bb  23           15949  15968 
    CALL    RCHLBC                      ;60bc  cd 8e 60     15950  15969 
    DEC HL                              ;60bf  2b           15951  15970 
FRCSBL: SLA C                           ;60c0  cb 21        15952  15971 
    RL  D                               ;60c2  cb 12        15953  15972 
    RL  E                               ;60c4  cb 13        15954  15973 
    DEC A                               ;60c6  3d           15955  15974 
    CP  080h                            ;60c7  fe 80        15956  15975 
    JR  NZ,FRCSBL                       ;60c9  20 f5        15957  15976 
    EX  AF,AF'                          ;60cb  08           15958  15977 
    LD  A,E                             ;60cc  7b           15959  15978 
    OR  D                               ;60cd  b2           15960  15979 
    OR  C                               ;60ce  b1           15961  15980 
    JR  Z,ENDSFR                        ;60cf  28 0e        15962  15981 
    EX  AF,AF'                          ;60d1  08           15963  15982 
FRCSB': BIT 7,E                         ;60d2  cb 7b        15964  15983 
    JR  NZ,ENDSFR                       ;60d4  20 09        15965  15984 
    SLA C                               ;60d6  cb 21        15966  15985 
    RL  D                               ;60d8  cb 12        15967  15986 
    RL  E                               ;60da  cb 13        15968  15987 
    DEC A                               ;60dc  3d           15969  15988 
    JR  FRCSB'                          ;60dd  18 f3        15970  15989 
                                        ;                   15971  15990 ;
ENDSFR: CALL    STHLBC                  ;60df  cd 88 60     15972  15991 
    DEC HL                              ;60e2  2b           15973  15992 
    LD  (HL),A                          ;60e3  77           15974  15993 
    JP  INTBCK                          ;60e4  c3 0c 60     15975  15994 
                                        ;                   15976  15995 ;
FRCDBL: CP  0B8h                        ;60e7  fe b8        15977  15996 
    JP  NC,INTZRR                       ;60e9  d2 05 60     15978  15997 
    INC HL                              ;60ec  23           15979  15998 
    CALL    RCHLBC                      ;60ed  cd 8e 60     15980  15999 
    PUSH    HL                          ;60f0  e5           15981  16000 
    EXX                                 ;60f1  d9           15982  16001 
    POP HL                              ;60f2  e1           15983  16002 
    CALL    RCHLBC                      ;60f3  cd 8e 60     15984  16003 
    LD  B,(HL)                          ;60f6  46           15985  16004 
IDFRBL: SLA B                           ;60f7  cb 20        15986  16005 
    RL  C                               ;60f9  cb 11        15987  16006 
    RL  D                               ;60fb  cb 12        15988  16007 
    RL  E                               ;60fd  cb 13        15989  16008 
    EXX                                 ;60ff  d9           15990  16009 
    RL  C                               ;6100  cb 11        15991  16010 
    RL  D                               ;6102  cb 12        15992  16011 
    RL  E                               ;6104  cb 13        15993  16012 
    EXX                                 ;6106  d9           15994  16013 
    DEC A                               ;6107  3d           15995  16014 
    CP  080h                            ;6108  fe 80        15996  16015 
    JR  NZ,IDFRBL                       ;610a  20 eb        15997  16016 
    EX  AF,AF'                          ;610c  08           15998  16017 
    LD  A,B                             ;610d  78           15999  16018 
    OR  C                               ;610e  b1           16000  16019 
    OR  D                               ;610f  b2           16001  16020 
    OR  E                               ;6110  b3           16002  16021 
    EXX                                 ;6111  d9           16003  16022 
    OR  C                               ;6112  b1           16004  16023 
    OR  D                               ;6113  b2           16005  16024 
    OR  E                               ;6114  b3           16006  16025 
    EXX                                 ;6115  d9           16007  16026 
    JR  Z,ESCDFS                        ;6116  28 19        16008  16027 
    EX  AF,AF'                          ;6118  08           16009  16028 
    EXX                                 ;6119  d9           16010  16029 
DSFL1': BIT 7,E                         ;611a  cb 7b        16011  16030 
    EXX                                 ;611c  d9           16012  16031 
    JR  NZ,ESCDFS                       ;611d  20 12        16013  16032 
    SLA B                               ;611f  cb 20        16014  16033 
    RL  C                               ;6121  cb 11        16015  16034 
    RL  D                               ;6123  cb 12        16016  16035 
    RL  E                               ;6125  cb 13        16017  16036 
    EXX                                 ;6127  d9           16018  16037 
    RL  C                               ;6128  cb 11        16019  16038 
    RL  D                               ;612a  cb 12        16020  16039 
    RL  E                               ;612c  cb 13        16021  16040 
    DEC A                               ;612e  3d           16022  16041 
    JR  DSFL1'                          ;612f  18 e9        16023  16042 
ESCDFS: LD  (HL),B                      ;6131  70           16024  16043 
    DEC HL                              ;6132  2b           16025  16044 
    CALL    STHLBC                      ;6133  cd 88 60     16026  16045 
    DEC HL                              ;6136  2b           16027  16046 
    PUSH    HL                          ;6137  e5           16028  16047 
    EXX                                 ;6138  d9           16029  16048 
    POP HL                              ;6139  e1           16030  16049 
    CALL    STHLBC                      ;613a  cd 88 60     16031  16050 
    DEC HL                              ;613d  2b           16032  16051 
    LD  (HL),A                          ;613e  77           16033  16052 
    JP  INTBCK                          ;613f  c3 0c 60     16034  16053 
                                        ;                   16035  16054 ;
MULTEN: PUSH    AF                      ;6142  f5           16036  16055 
    PUSH    BC                          ;6143  c5           16037  16056 
    PUSH    DE                          ;6144  d5           16038  16057 
    LD  DE,FLTEN                        ;6145  11 90 62     16039  16058 
    CALL    MUL                         ;6148  cd e0 6f     16040  16059 
    POP DE                              ;614b  d1           16041  16060 
    POP BC                              ;614c  c1           16042  16061 
    POP AF                              ;614d  f1           16043  16062 
    RET                                 ;614e  c9           16044  16063 
                                        ;                   16045  16064 ;
MOD_:   PUSH    HL                      ;614f  e5           16046  16065 
    PUSH    DE                          ;6150  d5           16047  16066 
    CALL    DIV                         ;6151  cd bd 70     16048  16067 
    CALL    FRAC                        ;6154  cd 95 60     16049  16068 
    CALL    MUL                         ;6157  cd e0 6f     16050  16069 
    POP DE                              ;615a  d1           16051  16070 
    POP HL                              ;615b  e1           16052  16071 
    RET                                 ;615c  c9           16053  16072 
                                        ;                   16054  16073 
HEXFLT: LD  A,(HL)                      ;615d  7e           16055  16074 
    CP  091h                            ;615e  fe 91        16056  16075 
    JR  C,HLFLT                         ;6160  38 05        16057  16076 
HXZRRT: CCF                             ;6162  3f           16058  16077 
    LD  HL,00000h                       ;6163  21 00 00     16059  16078 
    RET                                 ;6166  c9           16060  16079 
                                        ;                   16061  16080 ;
DLTEN:                                  ;                   16062  16081 
HLFLT:  INC HL                          ;6167  23           16063  16082 
    BIT 7,(HL)                          ;6168  cb 7e        16064  16083 
    JR  Z,NORHLC                        ;616a  28 0b        16065  16084 
    CALL    NORHLC                      ;616c  cd 77 61     16066  16085 
    LD  A,H                             ;616f  7c           16067  16086 
    CPL                                 ;6170  2f           16068  16087 
    LD  H,A                             ;6171  67           16069  16088 
    LD  A,L                             ;6172  7d           16070  16089 
    CPL                                 ;6173  2f           16071  16090 
    LD  L,A                             ;6174  6f           16072  16091 
    INC HL                              ;6175  23           16073  16092 
    RET                                 ;6176  c9           16074  16093 
                                        ;                   16075  16094 ;
NORHLC: DEC HL                          ;6177  2b           16076  16095 
    LD  A,(HL)                          ;6178  7e           16077  16096 
    CP  091h                            ;6179  fe 91        16078  16097 
    JP  NC,OVERFL1                      ;617b  d2 e4 6e     16079  16098 
TSTRNG: CP  081h                        ;617e  fe 81        16080  16099 
    JR  C,HXZRRT                        ;6180  38 e0        16081  16100 
    PUSH    AF                          ;6182  f5           16082  16101 
    INC HL                              ;6183  23           16083  16102 
    LD  A,(HL)                          ;6184  7e           16084  16103 
    INC HL                              ;6185  23           16085  16104 
    LD  L,(HL)                          ;6186  6e           16086  16105 
    LD  H,A                             ;6187  67           16087  16106 
    POP AF                              ;6188  f1           16088  16107 
    SET 7,H                             ;6189  cb fc        16089  16108 
HXFLSL: CP  090h                        ;618b  fe 90        16090  16109 
    RET Z                               ;618d  c8           16091  16110 
    INC A                               ;618e  3c           16092  16111 
    SRL H                               ;618f  cb 3c        16093  16112 
    RR  L                               ;6191  cb 1d        16094  16113 
    JR  HXFLSL                          ;6193  18 f6        16095  16114 
                                        ;                   16096  16115 ;
STRCMP: LD  (IY+0),4                    ;6195  fd 36 00 04  16097  16116 
    CALL    CONDMZ                      ;6199  cd f6 6b     16098  16117 
    EX  DE,HL                           ;619c  eb           16099  16118 
    CALL    CONDMZ                      ;619d  cd f6 6b     16100  16119 
    EX  DE,HL                           ;61a0  eb           16101  16120 
    LD  E,(HL)                          ;61a1  5e           16102  16121 
    INC HL                              ;61a2  23           16103  16122 
    LD  D,(HL)                          ;61a3  56           16104  16123 
    POP HL                              ;61a4  e1           16105  16124 
    PUSH    HL                          ;61a5  e5           16106  16125 
    LD  A,(HL)                          ;61a6  7e           16107  16126 
    INC HL                              ;61a7  23           16108  16127 
    LD  H,(HL)                          ;61a8  66           16109  16128 
    LD  L,A                             ;61a9  6f           16110  16129 
    EX  DE,HL                           ;61aa  eb           16111  16130 
    PUSH    HL                          ;61ab  e5           16112  16131 
    PUSH    DE                          ;61ac  d5           16113  16132 
    LD  A,(DE)                          ;61ad  1a           16114  16133 
    CP  (HL)                            ;61ae  be           16115  16134 
    JR  C,NOIV0                         ;61af  38 01        16116  16135 
    LD  A,(HL)                          ;61b1  7e           16117  16136 
NOIV0:  LD  B,A                         ;61b2  47           16118  16137 
    OR  A                               ;61b3  b7           16119  16138 
    JR  Z,SCMPLN                        ;61b4  28 13        16120  16139 
    INC HL                              ;61b6  23           16121  16140 
    INC DE                              ;61b7  13           16122  16141 
    PUSH    DE                          ;61b8  d5           16123  16142 
    LD  E,(HL)                          ;61b9  5e           16124  16143 
    INC HL                              ;61ba  23           16125  16144 
    LD  D,(HL)                          ;61bb  56           16126  16145 
    POP HL                              ;61bc  e1           16127  16146 
    LD  A,(HL)                          ;61bd  7e           16128  16147 
    INC HL                              ;61be  23           16129  16148 
    LD  H,(HL)                          ;61bf  66           16130  16149 
    LD  L,A                             ;61c0  6f           16131  16150 
SCMPLP: LD  A,(DE)                      ;61c1  1a           16132  16151 
    CP  (HL)                            ;61c2  be           16133  16152 
    INC HL                              ;61c3  23           16134  16153 
    INC DE                              ;61c4  13           16135  16154 
    JR  NZ,PCMPRT                       ;61c5  20 08        16136  16155 
    DJNZ    SCMPLP                      ;61c7  10 f8        16137  16156 
SCMPLN: POP HL                          ;61c9  e1           16138  16157 
    POP DE                              ;61ca  d1           16139  16158 
    LD  A,(DE)                          ;61cb  1a           16140  16159 
    CP  (HL)                            ;61cc  be           16141  16160 
    JR  CMPRET                          ;61cd  18 2b        16142  16161 
                                        ;                   16143  16162 ;
PCMPRT: POP HL                          ;61cf  e1           16144  16163 
    POP DE                              ;61d0  d1           16145  16164 
    JR  CMPRET                          ;61d1  18 27        16146  16165 
                                        ;                   16147  16166 ;
ONECMP: LD  DE,FLONE                    ;61d3  11 98 62     16148  16167 
CMP:    PUSH    BC                      ;61d6  c5           16149  16168 
    PUSH    HL                          ;61d7  e5           16150  16169 
    PUSH    DE                          ;61d8  d5           16151  16170 
    LD  A,(IY+0)                        ;61d9  fd 7e 00     16152  16171 
    CP  003h                            ;61dc  fe 03        16153  16172 
    JR  Z,STRCMP                        ;61de  28 b5        16154  16173 
    INC HL                              ;61e0  23           16155  16174 
    INC DE                              ;61e1  13           16156  16175 
    BIT 7,(HL)                          ;61e2  cb 7e        16157  16176 
    JR  NZ,HMISN                        ;61e4  20 18        16158  16177 
TSTCMP2:                                ;                   16159  16178 
    LD  A,(DE)                          ;61e6  1a           16160  16179 
    RLCA                                ;61e7  07           16161  16180 
    JR  C,CMPR''                        ;61e8  38 22        16162  16181 
    DEC HL                              ;61ea  2b           16163  16182 
    DEC DE                              ;61eb  1b           16164  16183 
TSTCMP: LD  C,0                         ;61ec  0e 00        16165  16184 
    LD  B,(IY+0)                        ;61ee  fd 46 00     16166  16185 
    EX  DE,HL                           ;61f1  eb           16167  16186 
DCMPLO: LD  A,(DE)                      ;61f2  1a           16168  16187 
    CP  (HL)                            ;61f3  be           16169  16188 
    JR  NZ,CMPRET                       ;61f4  20 04        16170  16189 
    INC HL                              ;61f6  23           16171  16190 
    INC DE                              ;61f7  13           16172  16191 
    DJNZ    DCMPLO                      ;61f8  10 f8        16173  16192 
CMPRET: POP DE                          ;61fa  d1           16174  16193 
    POP HL                              ;61fb  e1           16175  16194 
    POP BC                              ;61fc  c1           16176  16195 
    RET                                 ;61fd  c9           16177  16196 
                                        ;                   16178  16197 ;
HMISN:  LD  A,(DE)                      ;61fe  1a           16179  16198 
    RLCA                                ;61ff  07           16180  16199 
    JR  NC,CMPRE'                       ;6200  30 05        16181  16200 
    DEC HL                              ;6202  2b           16182  16201 
    DEC DE                              ;6203  1b           16183  16202 
    EX  DE,HL                           ;6204  eb           16184  16203 
    JR  TSTCMP                          ;6205  18 e5        16185  16204 
                                        ;                   16186  16205 ;
CMPRE': XOR A                           ;6207  af           16187  16206 
    INC A                               ;6208  3c           16188  16207 
    SCF                                 ;6209  37           16189  16208 
    JR  CMPRET                          ;620a  18 ee        16190  16209 
                                        ;                   16191  16210 ;
CMPR'': XOR A                           ;620c  af           16192  16211 
    INC A                               ;620d  3c           16193  16212 
    JR  CMPRET                          ;620e  18 ea        16194  16213 
                                        ;                   16195  16214 ;
ZFILL:  XOR A                           ;6210  af           16196  16215 
FILL:   PUSH    DE                      ;6211  d5           16197  16216 
FILLOP: LD  (DE),A                      ;6212  12           16198  16217 
    INC DE                              ;6213  13           16199  16218 
    DJNZ    FILLOP                      ;6214  10 fc        16200  16219 
    POP DE                              ;6216  d1           16201  16220 
    RET                                 ;6217  c9           16202  16221 
                                        ;                   16203  16222 ;
FLMAX:  DEFB    0B6H                    ;6218  b6           16204  16223 
    DEFB    00EH                        ;6219  0e           16205  16224 
    DEFB    01BH                        ;621a  1b           16206  16225 
    DEFB    0C9H                        ;621b  c9           16207  16226 
    DEFB    0BFH                        ;621c  bf           16208  16227 
    DEFB    004H                        ;621d  04           16209  16228 
    DEFB    000H                        ;621e  00           16210  16229 
    DEFB    000H                        ;621f  00           16211  16230 
                                        ;                   16212  16231 ;
CONTBL: DEFB    0B2H                    ;6220  b2           16213  16232 
    DEFB    063H                        ;6221  63           16214  16233 
    DEFB    05FH                        ;6222  5f           16215  16234 
    DEFB    0A9H                        ;6223  a9           16216  16235 
    DEFB    031H                        ;6224  31           16217  16236 
    DEFB    0A0H                        ;6225  a0           16218  16237 
    DEFB    000H                        ;6226  00           16219  16238 
    DEFB    000H                        ;6227  00           16220  16239 
                                        ;                   16221  16240 ;
    DEFB    0AFH                        ;6228  af           16222  16241 
    DEFB    035H                        ;6229  35           16223  16242 
    DEFB    0E6H                        ;622a  e6           16224  16243 
    DEFB    020H                        ;622b  20           16225  16244 
    DEFB    0F4H                        ;622c  f4           16226  16245 
    DEFB    080H                        ;622d  80           16227  16246 
    DEFB    000H                        ;622e  00           16228  16247 
    DEFB    000H                        ;622f  00           16229  16248 
                                        ;                   16230  16249 ;
    DEFB    0ACH                        ;6230  ac           16231  16250 
    DEFB    011H                        ;6231  11           16232  16251 
    DEFB    084H                        ;6232  84           16233  16252 
    DEFB    0E7H                        ;6233  e7           16234  16253 
    DEFB    02AH                        ;6234  2a           16235  16254 
    DEFB    000H                        ;6235  00           16236  16255 
    DEFB    000H                        ;6236  00           16237  16256 
    DEFB    000H                        ;6237  00           16238  16257 
                                        ;                   16239  16258 ;
    DEFB    0A8H                        ;6238  a8           16240  16259 
    DEFB    068H                        ;6239  68           16241  16260 
    DEFB    0D4H                        ;623a  d4           16242  16261 
    DEFB    0A5H                        ;623b  a5           16243  16262 
    DEFB    010H                        ;623c  10           16244  16263 
    DEFB    000H                        ;623d  00           16245  16264 
    DEFB    000H                        ;623e  00           16246  16265 
    DEFB    000H                        ;623f  00           16247  16266 
                                        ;                   16248  16267 ;
    DEFB    0A5H                        ;6240  a5           16249  16268 
    DEFB    03AH                        ;6241  3a           16250  16269 
    DEFB    043H                        ;6242  43           16251  16270 
    DEFB    0B7H                        ;6243  b7           16252  16271 
    DEFB    040H                        ;6244  40           16253  16272 
    DEFB    000H                        ;6245  00           16254  16273 
    DEFB    000H                        ;6246  00           16255  16274 
    DEFB    000H                        ;6247  00           16256  16275 
                                        ;                   16257  16276 ;
    DEFB    0A2H                        ;6248  a2           16258  16277 
    DEFB    015H                        ;6249  15           16259  16278 
    DEFB    002H                        ;624a  02           16260  16279 
    DEFB    0F9H                        ;624b  f9           16261  16280 
    DEFB    000H                        ;624c  00           16262  16281 
    DEFB    000H                        ;624d  00           16263  16282 
    DEFB    000H                        ;624e  00           16264  16283 
    DEFB    000H                        ;624f  00           16265  16284 
                                        ;                   16266  16285 ;
    DEFB    09EH                        ;6250  9e           16267  16286 
    DEFB    06EH                        ;6251  6e           16268  16287 
    DEFB    06BH                        ;6252  6b           16269  16288 
    DEFB    028H                        ;6253  28           16270  16289 
    DEFB    000H                        ;6254  00           16271  16290 
    DEFB    000H                        ;6255  00           16272  16291 
    DEFB    000H                        ;6256  00           16273  16292 
    DEFB    000H                        ;6257  00           16274  16293 
                                        ;                   16275  16294 ;
    DEFB    09BH                        ;6258  9b           16276  16295 
    DEFB    03EH                        ;6259  3e           16277  16296 
    DEFB    0BCH                        ;625a  bc           16278  16297 
    DEFB    020H                        ;625b  20           16279  16298 
    DEFB    000H                        ;625c  00           16280  16299 
    DEFB    000H                        ;625d  00           16281  16300 
    DEFB    000H                        ;625e  00           16282  16301 
    DEFB    000H                        ;625f  00           16283  16302 
                                        ;                   16284  16303 ;
    DEFB    098H                        ;6260  98           16285  16304 
    DEFB    018H                        ;6261  18           16286  16305 
    DEFB    096H                        ;6262  96           16287  16306 
    DEFB    080H                        ;6263  80           16288  16307 
    DEFB    000H                        ;6264  00           16289  16308 
    DEFB    000H                        ;6265  00           16290  16309 
    DEFB    000H                        ;6266  00           16291  16310 
    DEFB    000H                        ;6267  00           16292  16311 
                                        ;                   16293  16312 ;
SNGMXO: DEFB    094H                    ;6268  94           16294  16313 
    DEFB    074H                        ;6269  74           16295  16314 
    DEFB    024H                        ;626a  24           16296  16315 
    DEFB    000H                        ;626b  00           16297  16316 
    DEFB    000H                        ;626c  00           16298  16317 
    DEFB    000H                        ;626d  00           16299  16318 
    DEFB    000H                        ;626e  00           16300  16319 
    DEFB    000H                        ;626f  00           16301  16320 
                                        ;                   16302  16321 ;
    DEFB    091H                        ;6270  91           16303  16322 
    DEFB    043H                        ;6271  43           16304  16323 
    DEFB    050H                        ;6272  50           16305  16324 
    DEFB    000H                        ;6273  00           16306  16325 
    DEFB    000H                        ;6274  00           16307  16326 
    DEFB    000H                        ;6275  00           16308  16327 
    DEFB    000H                        ;6276  00           16309  16328 
    DEFB    000H                        ;6277  00           16310  16329 
                                        ;                   16311  16330 ;
    DEFB    08EH                        ;6278  8e           16312  16331 
    DEFB    01CH                        ;6279  1c           16313  16332 
    DEFB    040H                        ;627a  40           16314  16333 
    DEFB    000H                        ;627b  00           16315  16334 
    DEFB    000H                        ;627c  00           16316  16335 
    DEFB    000H                        ;627d  00           16317  16336 
    DEFB    000H                        ;627e  00           16318  16337 
    DEFB    000H                        ;627f  00           16319  16338 
                                        ;                   16320  16339 ;
    DEFB    08AH                        ;6280  8a           16321  16340 
    DEFB    07AH                        ;6281  7a           16322  16341 
    DEFB    000H                        ;6282  00           16323  16342 
    DEFB    000H                        ;6283  00           16324  16343 
    DEFB    000H                        ;6284  00           16325  16344 
    DEFB    000H                        ;6285  00           16326  16345 
    DEFB    000H                        ;6286  00           16327  16346 
    DEFB    000H                        ;6287  00           16328  16347 
                                        ;                   16329  16348 ;
    DEFB    087H                        ;6288  87           16330  16349 
    DEFB    048H                        ;6289  48           16331  16350 
    DEFB    000H                        ;628a  00           16332  16351 
    DEFB    000H                        ;628b  00           16333  16352 
    DEFB    000H                        ;628c  00           16334  16353 
    DEFB    000H                        ;628d  00           16335  16354 
    DEFB    000H                        ;628e  00           16336  16355 
    DEFB    000H                        ;628f  00           16337  16356 
                                        ;                   16338  16357 ;
FLTEN:                                  ;                   16339  16358 
    DEFB    084H                        ;6290  84           16340  16359 
    DEFB    020H                        ;6291  20           16341  16360 
    DEFB    000H                        ;6292  00           16342  16361 
    DEFB    000H                        ;6293  00           16343  16362 
    DEFB    000H                        ;6294  00           16344  16363 
    DEFB    000H                        ;6295  00           16345  16364 
    DEFB    000H                        ;6296  00           16346  16365 
    DEFB    000H                        ;6297  00           16347  16366 
FLONE:                                  ;                   16348  16367 
    DEFB    081H                        ;6298  81           16349  16368 
    DEFB    000H                        ;6299  00           16350  16369 
    DEFB    000H                        ;629a  00           16351  16370 
    DEFB    000H                        ;629b  00           16352  16371 
    DEFB    000H                        ;629c  00           16353  16372 
    DEFB    000H                        ;629d  00           16354  16373 
    DEFB    000H                        ;629e  00           16355  16374 
    DEFB    000H                        ;629f  00           16356  16375 
FLLAST:                                 ;                   16357  16376 
    DEFB    07DH                        ;62a0  7d           16358  16377 
    DEFB    04CH                        ;62a1  4c           16359  16378 
    DEFB    0CCH                        ;62a2  cc           16360  16379 
    DEFB    0CCH                        ;62a3  cc           16361  16380 
    DEFB    0CCH                        ;62a4  cc           16362  16381 
    DEFB    0CCH                        ;62a5  cc           16363  16382 
    DEFB    0CCH                        ;62a6  cc           16364  16383 
    DEFB    0CDH                        ;62a7  cd           16365  16384 
ASCHL:                                  ;                   16366  16385 
    PUSH    HL                          ;62a8  e5           16367  16386 
    PUSH    DE                          ;62a9  d5           16368  16387 
    PUSH    BC                          ;62aa  c5           16369  16388 
    LD  C,0H                            ;62ab  0e 00        16370  16389 
    PUSH    DE                          ;62ad  d5           16371  16390 
    LD  B,0                             ;62ae  06 00        16372  16391 
    LD  DE,02710H                       ;62b0  11 10 27     16373  16392 
    CALL    CONV1                       ;62b3  cd d1 62     16374  16393 
    LD  DE,003E8H                       ;62b6  11 e8 03     16375  16394 
    CALL    CONV1                       ;62b9  cd d1 62     16376  16395 
    LD  DE,00064H                       ;62bc  11 64 00     16377  16396 
    CALL    CONV1                       ;62bf  cd d1 62     16378  16397 
    LD  DE,0000AH                       ;62c2  11 0a 00     16379  16398 
    CALL    CONV1                       ;62c5  cd d1 62     16380  16399 
    LD  A,L                             ;62c8  7d           16381  16400 
    POP DE                              ;62c9  d1           16382  16401 
    OR  030H                            ;62ca  f6 30        16383  16402 
    LD  (DE),A                          ;62cc  12           16384  16403 
    POP BC                              ;62cd  c1           16385  16404 
    POP DE                              ;62ce  d1           16386  16405 
    POP HL                              ;62cf  e1           16387  16406 
    RET                                 ;62d0  c9           16388  16407 
                                        ;                   16389  16408 ;
CONV1:  LD  A,0FFH                      ;62d1  3e ff        16390  16409 
CONV2:  INC A                           ;62d3  3c           16391  16410 
    OR  A                               ;62d4  b7           16392  16411 
    SBC HL,DE                           ;62d5  ed 52        16393  16412 
    JR  NC,CONV2                        ;62d7  30 fa        16394  16413 
    ADD HL,DE                           ;62d9  19           16395  16414 
    OR  A                               ;62da  b7           16396  16415 
    INC B                               ;62db  04           16397  16416 
    DEFB    0F6H                        ;62dc  f6           16398  16417 ;OR ?
    DEFB    030H                        ;62dd  30           16399  16418 
    POP DE                              ;62de  d1           16400  16419 
    EX  (SP),HL                         ;62df  e3           16401  16420 
    LD  (HL),A                          ;62e0  77           16402  16421 
    INC HL                              ;62e1  23           16403  16422 
    EX  (SP),HL                         ;62e2  e3           16404  16423 
    PUSH    DE                          ;62e3  d5           16405  16424 
    INC C                               ;62e4  0c           16406  16425 
    RET                                 ;62e5  c9           16407  16426 
                                        ;                   16408  16427 ;
DHLMT:                                  ;                   16409  16428 
    DEFB    0B6H                        ;62e6  b6           16410  16429 
    DEFB    00EH                        ;62e7  0e           16411  16430 
    DEFB    01BH                        ;62e8  1b           16412  16431 
    DEFB    0C9H                        ;62e9  c9           16413  16432 
    DEFB    0BFH                        ;62ea  bf           16414  16433 
    DEFB    003H                        ;62eb  03           16415  16434 
    DEFB    0FFH                        ;62ec  ff           16416  16435 
    DEFB    0FEH                        ;62ed  fe           16417  16436 
                                        ;                   16418  16437 ;
SHLMT:                                  ;                   16419  16438 
    DEFB    094H                        ;62ee  94           16420  16439 
    DEFB    074H                        ;62ef  74           16421  16440 
    DEFB    023H                        ;62f0  23           16422  16441 
    DEFB    0F8H                        ;62f1  f8           16423  16442 
ZFAC:                                   ;                   16424  16443 
    DEFS    8                           ;62f2               16425  16444 
ZFAC1:  DEFS    8                       ;62fa               16426  16445 
    DEFS    2                           ;6302               16427  16446 
DGBUF:  DEFS    18                      ;6304               16428  16447 
    DEFS    5                           ;6316               16429  16448 
                                        ;                   16430  16449 
                                        ;                   16431  16450 ;	ORG	0631Bh
                                        ;                   16432  16451 
$EDIT:                                  ;                   16433  16452 
SMALL:  LD  A,(DE)                      ;631b  1a           16434  16453 
SMALL': CP  061h                        ;631c  fe 61        16435  16454 
    RET C                               ;631e  d8           16436  16455 
    CP  07Bh                            ;631f  fe 7b        16437  16456 
    RET NC                              ;6321  d0           16438  16457 
    SUB 020h                            ;6322  d6 20        16439  16458 
    RET                                 ;6324  c9           16440  16459 
                                        ;                   16441  16460 ;
CVIMTX:                                 ;                   16442  16461 
    PUSH    BC                          ;6325  c5           16443  16462 
    PUSH    DE                          ;6326  d5           16444  16463 
CPILLP: CALL    SPSTRE                  ;6327  cd ad 64     16445  16464 
    OR  A                               ;632a  b7           16446  16465 
    JR  Z,TREND                         ;632b  28 2f        16447  16466 
    INC DE                              ;632d  13           16448  16467 
    CP  080h                            ;632e  fe 80        16449  16468 ;80H 이상은 BASIC에 무시
    JR  NC,CPILLP                       ;6330  30 f5        16450  16469 
    CP  020h                            ;6332  fe 20        16451  16470 ;20H 이하도 무시
    JR  C,CPILLP                        ;6334  38 f1        16452  16471 
    DEC DE                              ;6336  1b           16453  16472 
    CP  03Fh                            ;6337  fe 3f        16454  16473 
    JR  Z,PRTCDE                        ;6339  28 1a        16455  16474 
    CP  022h                            ;633b  fe 22        16456  16475 
    JR  Z,STRING1                       ;633d  28 21        16457  16476 
    CP  027h                            ;633f  fe 27        16458  16477 
    JR  Z,REMOPR                        ;6341  28 24        16459  16478 
    CP  02Eh                            ;6343  fe 2e        16460  16479 
    JR  Z,NUMJMP                        ;6345  28 09        16461  16480 
    CP  026h                            ;6347  fe 26        16462  16481 
    JR  Z,NUMJMP                        ;6349  28 05        16463  16482 
    CALL    TSTNAC                      ;634b  cd 2e 65     16464  16483 
    JR  C,STATE                         ;634e  38 45        16465  16484 
NUMJMP: CALL    NUMBER                  ;6350  cd b6 64     16466  16485 
    JR  CPILLP                          ;6353  18 d2        16467  16486 
PRTCDE: LD  (HL),08Ch                   ;6355  36 8c        16468  16487 
BACKLP: INC HL                          ;6357  23           16469  16488 
    INC DE                              ;6358  13           16470  16489 
    JR  CPILLP                          ;6359  18 cc        16471  16490 
TREND': EX  DE,HL                       ;635b  eb           16472  16491 
TREND:  LD  (HL),A                      ;635c  77           16473  16492 
    POP DE                              ;635d  d1           16474  16493 
    POP BC                              ;635e  c1           16475  16494 
    RET                                 ;635f  c9           16476  16495 
                                        ;                   16477  16496 ;
STRING1: CALL   DQTSTR                  ;6360  cd 9d 64     16478  16497 
    JR  Z,TREND                         ;6363  28 f7        16479  16498 
    JR  CPILLP                          ;6365  18 c0        16480  16499 
                                        ;                   16481  16500 ;
REMOPR: LD  (HL),03Ah                   ;6367  36 3a        16482  16501 
    INC HL                              ;6369  23           16483  16502 
RMTRLP: LD  (HL),A                      ;636a  77           16484  16503 
    INC DE                              ;636b  13           16485  16504 
    INC HL                              ;636c  23           16486  16505 
RMTRMD: LD  A,(DE)                      ;636d  1a           16487  16506 
    OR  A                               ;636e  b7           16488  16507 
    JR  NZ,RMTRLP                       ;636f  20 f9        16489  16508 
BACK:   JP  CPILLP                      ;6371  c3 27 63     16490  16509 
STORE': INC HL                          ;6374  23           16491  16510 
STORE:  CALL    SMALL                   ;6375  cd 1b 63     16492  16511 
    LD  (HL),A                          ;6378  77           16493  16512 
    INC DE                              ;6379  13           16494  16513 
    CP  041h                            ;637a  fe 41        16495  16514 ;대문자 체크
    JR  C,BACK1                         ;637c  38 14        16496  16515 
    CP  05Bh                            ;637e  fe 5b        16497  16516 
    JR  NC,BACK1                        ;6380  30 10        16498  16517 
NOSLOP: CALL    SMALL                   ;6382  cd 1b 63     16499  16518 
    CP  030h                            ;6385  fe 30        16500  16519 ;숫자 체크
    JR  C,BACK1                         ;6387  38 09        16501  16520 
    CP  03Ah                            ;6389  fe 3a        16502  16521 
    JR  NC,BACK1                        ;638b  30 05        16503  16522 
    INC HL                              ;638d  23           16504  16523 
    LD  (HL),A                          ;638e  77           16505  16524 
    INC DE                              ;638f  13           16506  16525 
    JR  NOSLOP                          ;6390  18 f0        16507  16526 
BACK1:  INC HL                          ;6392  23           16508  16527 
    JR  BACK                            ;6393  18 dc        16509  16528 
                                        ;                   16510  16529 ;
STATE:  LD  BC,CTBL1                    ;6395  01 37 67     16511  16530 ;예약어가 저장된 곳
    CALL    MATCH                       ;6398  cd 61 64     16512  16531 
    JR  NC,GETHX                        ;639b  30 21        16513  16532 
    LD  BC,CTBL2                        ;639d  01 d3 68     16514  16533 
    CALL    MATCH                       ;63a0  cd 61 64     16515  16534 
    JR  C,STORE                         ;63a3  38 d0        16516  16535 
    DEC HL                              ;63a5  2b           16517  16536 
    LD  A,(HL)                          ;63a6  7e           16518  16537 
    LD  (HL),0FFh                       ;63a7  36 ff        16519  16538 
    INC HL                              ;63a9  23           16520  16539 
    LD  (HL),A                          ;63aa  77           16521  16540 
    CP  0C0h                            ;63ab  fe c0        16522  16541 
    JR  NZ,BACK1                        ;63ad  20 e3        16523  16542 
    INC HL                              ;63af  23           16524  16543 
    CALL    SPSTRE                      ;63b0  cd ad 64     16525  16544 
    CP  03Dh                            ;63b3  fe 3d        16526  16545 
    JP  NZ,BACK                         ;63b5  c2 71 63     16527  16546 
    LD  (HL),0F5h                       ;63b8  36 f5        16528  16547 
    INC HL                              ;63ba  23           16529  16548 
    INC DE                              ;63bb  13           16530  16549 
    JR  LNOSLP1                         ;63bc  18 25        16531  16550 
                                        ;                   16532  16551 ;
GETHX:  LD  A,B                         ;63be  78           16533  16552 
    CP  092h                            ;63bf  fe 92        16534  16553 
    JR  Z,RMTRMD                        ;63c1  28 aa        16535  16554 
    CP  08Fh                            ;63c3  fe 8f        16536  16555 
    JP  Z,DATAST1                       ;63c5  ca 3c 64     16537  16556 
    CP  0B8h                            ;63c8  fe b8        16538  16557 
    JR  Z,ELSEST                        ;63ca  28 68        16539  16558 
    CP  0E1h                            ;63cc  fe e1        16540  16559 
    JR  Z,LNOSLP1                       ;63ce  28 13        16541  16560 
    CP  0B6h                            ;63d0  fe b6        16542  16561 
    JR  Z,LNOSLP1                       ;63d2  28 0f        16543  16562 
    CP  093h                            ;63d4  fe 93        16544  16563 
    JR  Z,LISTER                        ;63d6  28 3a        16545  16564 
    CP  08Ah                            ;63d8  fe 8a        16546  16565 
    JP  NC,BACK                         ;63da  d2 71 63     16547  16566 
    CP  086h                            ;63dd  fe 86        16548  16567 
    JR  Z,LSIT#?                        ;63df  28 74        16549  16568 
    JR  NC,LISTER                       ;63e1  30 2f        16550  16569 
LNOSLP1: CALL   SPSTRE                  ;63e3  cd ad 64     16551  16570 
    CP  02Ch                            ;63e6  fe 2c        16552  16571 
    JR  Z,COMSTR                        ;63e8  28 0d        16553  16572 
    CALL    TSTNAC                      ;63ea  cd 2e 65     16554  16573 
    JR  C,LBLGOT1                       ;63ed  38 0d        16555  16574 
    CALL    CVBCAS                      ;63ef  cd bd 30     16556  16575 
    CALL    HEX2                        ;63f2  cd 0c 65     16557  16576 
    JR  LNOSLP1                         ;63f5  18 ec        16558  16577 
COMSTR: LD  (HL),A                      ;63f7  77           16559  16578 
    INC HL                              ;63f8  23           16560  16579 
    INC DE                              ;63f9  13           16561  16580 
    JR  LNOSLP1                         ;63fa  18 e7        16562  16581 
                                        ;                   16563  16582 ;
LBLGOT1: CP 03Ah                        ;63fc  fe 3a        16564  16583 
    JP  Z,BACK                          ;63fe  ca 71 63     16565  16584 
    OR  A                               ;6401  b7           16566  16585 
    JP  Z,BACK                          ;6402  ca 71 63     16567  16586 
    CP  022h                            ;6405  fe 22        16568  16587 
    JP  NZ,BACK                         ;6407  c2 71 63     16569  16588 
    CALL    DQTSTR                      ;640a  cd 9d 64     16570  16589 
    JP  Z,TREND                         ;640d  ca 5c 63     16571  16590 
    JR  LNOSLP1                         ;6410  18 d1        16572  16591 
                                        ;                   16573  16592 ;
LISTER: CALL    SPSTRE                  ;6412  cd ad 64     16574  16593 
LISTRM: CP  02Eh                        ;6415  fe 2e        16575  16594 
    JR  Z,AFNUM                         ;6417  28 16        16576  16595 
    CP  02Dh                            ;6419  fe 2d        16577  16596 
    JR  Z,AFNUM                         ;641b  28 12        16578  16597 
    CP  02Ch                            ;641d  fe 2c        16579  16598 
    JR  Z,AFNUM                         ;641f  28 0e        16580  16599 
    CALL    TSTNAC                      ;6421  cd 2e 65     16581  16600 
    JP  C,BACK                          ;6424  da 71 63     16582  16601 
    CALL    CVBCAS                      ;6427  cd bd 30     16583  16602 
    CALL    HEX2                        ;642a  cd 0c 65     16584  16603 
    JR  LISTER                          ;642d  18 e3        16585  16604 
                                        ;                   16586  16605 ;
AFNUM:  LD  (HL),A                      ;642f  77           16587  16606 
    INC HL                              ;6430  23           16588  16607 
    INC DE                              ;6431  13           16589  16608 
    JR  LISTER                          ;6432  18 de        16590  16609 
                                        ;                   16591  16610 ;
ELSEST: DEC HL                          ;6434  2b           16592  16611 
    LD  (HL),03Ah                       ;6435  36 3a        16593  16612 
    INC HL                              ;6437  23           16594  16613 
    LD  (HL),A                          ;6438  77           16595  16614 
    INC HL                              ;6439  23           16596  16615 
    JR  LNOSLP1                         ;643a  18 a7        16597  16616 
                                        ;                   16598  16617 ;
DATAST1: LD A,(DE)                      ;643c  1a           16599  16618 
    OR  A                               ;643d  b7           16600  16619 
    JP  Z,TREND                         ;643e  ca 5c 63     16601  16620 
    LD  (HL),A                          ;6441  77           16602  16621 
    INC HL                              ;6442  23           16603  16622 
    INC DE                              ;6443  13           16604  16623 
DATAS: CP   03Ah                        ;6444  fe 3a        16605  16624 
    JP  Z,CPILLP                        ;6446  ca 27 63     16606  16625 
    CP  022h                            ;6449  fe 22        16607  16626 
    JR  NZ,DATAST1                      ;644b  20 ef        16608  16627 
DQSTL:  CALL    DQTST'                  ;644d  cd a0 64     16609  16628 
    JP  Z,TREND                         ;6450  ca 5c 63     16610  16629 
    JR  DATAST1                         ;6453  18 e7        16611  16630 ;DATAS'?
                                        ;                   16612  16631 ;
LSIT#?: LD  A,(DE)                      ;6455  1a           16613  16632 
    CP  023h                            ;6456  fe 23        16614  16633 
    JR  NZ,LISTER                       ;6458  20 b8        16615  16634 
    DEC HL                              ;645a  2b           16616  16635 
    INC (HL)                            ;645b  34           16617  16636 
    INC HL                              ;645c  23           16618  16637 
    INC DE                              ;645d  13           16619  16638 
    INC DE                              ;645e  13           16620  16639 
    JR  LISTER                          ;645f  18 b1        16621  16640 
                                        ;                   16622  16641 ;
MATCH:  PUSH    HL                      ;6461  e5           16623  16642 
    PUSH    DE                          ;6462  d5           16624  16643 
    LD  L,C                             ;6463  69           16625  16644 
    LD  H,B                             ;6464  60           16626  16645 
    LD  B,080h                          ;6465  06 80        16627  16646 
MSTART: POP DE                          ;6467  d1           16628  16647 
    PUSH    DE                          ;6468  d5           16629  16648 
    INC B                               ;6469  04           16630  16649 
    LD  A,(HL)                          ;646a  7e           16631  16650 
    INC A                               ;646b  3c           16632  16651 
    JR  Z,NOMTCH1                       ;646c  28 1e        16633  16652 
                                        ;                   16634  16653 ;
TESTMT: CALL    SMALL                   ;646e  cd 1b 63     16635  16654 
    LD  C,(HL)                          ;6471  4e           16636  16655 
    INC HL                              ;6472  23           16637  16656 
    INC DE                              ;6473  13           16638  16657 
    CP  02Eh                            ;6474  fe 2e        16639  16658 ;생략형 명령 처리
    JR  Z,SHORTN1                       ;6476  28 18        16640  16659 
    SUB C                               ;6478  91           16641  16660 
    JR  Z,TESTMT                        ;6479  28 f3        16642  16661 
    CP  080h                            ;647b  fe 80        16643  16662 
    JR  Z,MTCHOK                        ;647d  28 08        16644  16663 
    DEC HL                              ;647f  2b           16645  16664 
SKIPTB: LD  A,(HL)                      ;6480  7e           16646  16665 
    RLCA                                ;6481  07           16647  16666 
    INC HL                              ;6482  23           16648  16667 
    JR  NC,SKIPTB                       ;6483  30 fb        16649  16668 
    JR  MSTART                          ;6485  18 e0        16650  16669 
MTCHOK: POP HL                          ;6487  e1           16651  16670 
    POP HL                              ;6488  e1           16652  16671 
    LD  (HL),B                          ;6489  70           16653  16672 
    INC HL                              ;648a  23           16654  16673 
    RET                                 ;648b  c9           16655  16674 
                                        ;                   16656  16675 ;
NOMTCH1: POP    DE                      ;648c  d1           16657  16676 
    POP HL                              ;648d  e1           16658  16677 
    SCF                                 ;648e  37           16659  16678 
    RET                                 ;648f  c9           16660  16679 
                                        ;                   16661  16680 ;
SHORTN1: EX AF,AF'                      ;6490  08           16662  16681 
    LD  A,B                             ;6491  78           16663  16682 
    CP  0EEh                            ;6492  fe ee        16664  16683 
    JR  NC,NO2EH                        ;6494  30 03        16665  16684 
    EX  AF,AF'                          ;6496  08           16666  16685 
    JR  MTCHOK                          ;6497  18 ee        16667  16686 
                                        ;                   16668  16687 ;
NO2EH:  EX  AF,AF'                      ;6499  08           16669  16688 
    DEC HL                              ;649a  2b           16670  16689 
    JR  SKIPTB                          ;649b  18 e3        16671  16690 
                                        ;                   16672  16691 ;
DQTSTR: LD  (HL),A                      ;649d  77           16673  16692 
    INC DE                              ;649e  13           16674  16693 
    INC HL                              ;649f  23           16675  16694 
DQTST': LD  A,(DE)                      ;64a0  1a           16676  16695 
    OR  A                               ;64a1  b7           16677  16696 
    RET Z                               ;64a2  c8           16678  16697 
    CP  022h                            ;64a3  fe 22        16679  16698 
    JR  NZ,DQTSTR                       ;64a5  20 f6        16680  16699 
    LD  (HL),A                          ;64a7  77           16681  16700 
    INC DE                              ;64a8  13           16682  16701 
    INC HL                              ;64a9  23           16683  16702 
    INC A                               ;64aa  3c           16684  16703 
    DEC A                               ;64ab  3d           16685  16704 
    RET                                 ;64ac  c9           16686  16705 
                                        ;                   16687  16706 ;
SPSTRE: LD  A,(DE)                      ;64ad  1a           16688  16707 
    CP  020h                            ;64ae  fe 20        16689  16708 
    RET NZ                              ;64b0  c0           16690  16709 
    LD  (HL),A                          ;64b1  77           16691  16710 
    INC DE                              ;64b2  13           16692  16711 
    INC HL                              ;64b3  23           16693  16712 
    JR  SPSTRE                          ;64b4  18 f7        16694  16713 
                                        ;                   16695  16714 ;
NUMBER: LD  A,(DE)                      ;64b6  1a           16696  16715 
    CP  026h                            ;64b7  fe 26        16697  16716 
    PUSH    HL                          ;64b9  e5           16698  16717 
    INC HL                              ;64ba  23           16699  16718 
    JR  NZ,NOT26H                       ;64bb  20 23        16700  16719 
    PUSH    DE                          ;64bd  d5           16701  16720 
    INC DE                              ;64be  13           16702  16721 
    CALL    DEFTCH                      ;64bf  cd 51 5d     16703  16722 
    CALL    SMALL'                      ;64c2  cd 1c 63     16704  16723 
    POP DE                              ;64c5  d1           16705  16724 ;이 줄은 책에서 빠져있네요.
    PUSH    AF                          ;64c6  f5           16706  16725 
    CALL    OVFLAG                      ;64c7  cd b8 5b     16707  16726 
    CALL    HEXFLT                      ;64ca  cd 5d 61     16708  16727 
    POP AF                              ;64cd  f1           16709  16728 
    CP  048h                            ;64ce  fe 48        16710  16729 
    LD  A,011h                          ;64d0  3e 11        16711  16730 
    JR  Z,SKIPHX                        ;64d2  28 01        16712  16731 
    DEC A                               ;64d4  3d           16713  16732 
SKIPHX: LD  C,L                         ;64d5  4d           16714  16733 
    LD  B,H                             ;64d6  44           16715  16734 
    POP HL                              ;64d7  e1           16716  16735 
    LD  (HL),A                          ;64d8  77           16717  16736 
    INC HL                              ;64d9  23           16718  16737 
    LD  (HL),C                          ;64da  71           16719  16738 
    INC HL                              ;64db  23           16720  16739 
    LD  (HL),B                          ;64dc  70           16721  16740 
    INC HL                              ;64dd  23           16722  16741 
    JR  BCKSPS                          ;64de  18 24        16723  16742 
                                        ;                   16724  16743 ;
NOT26H: CALL    OVFLAG                  ;64e0  cd b8 5b     16725  16744 
    BIT 7,(IY-1)                        ;64e3  fd cb ff 7e  16726  16745 
    JR  NZ,FLOAT                        ;64e7  20 32        16727  16746 
    LD  A,(HL)                          ;64e9  7e           16728  16747 
    CP  090h                            ;64ea  fe 90        16729  16748 
    JR  NC,FLOAT                        ;64ec  30 2d        16730  16749 
    CALL    HEXFLT                      ;64ee  cd 5d 61     16731  16750 
    PUSH    DE                          ;64f1  d5           16732  16751 
    EX  DE,HL                           ;64f2  eb           16733  16752 
    LD  HL,00009H                       ;64f3  21 09 00     16734  16753 
    OR  A                               ;64f6  b7           16735  16754 
    SBC HL,DE                           ;64f7  ed 52        16736  16755 
    EX  DE,HL                           ;64f9  eb           16737  16756 
    POP DE                              ;64fa  d1           16738  16757 
    LD  A,012h                          ;64fb  3e 12        16739  16758 
    JR  C,HEX1                          ;64fd  38 11        16740  16759 
    LD  A,L                             ;64ff  7d           16741  16760 
    INC A                               ;6500  3c           16742  16761 
    POP HL                              ;6501  e1           16743  16762 
    LD  (HL),A                          ;6502  77           16744  16763 
    INC HL                              ;6503  23           16745  16764 
BCKSPS: DEC DE                          ;6504  1b           16746  16765 
    LD  A,(DE)                          ;6505  1a           16747  16766 
    CP  020h                            ;6506  fe 20        16748  16767 
    JR  Z,BCKSPS                        ;6508  28 fa        16749  16768 
    INC DE                              ;650a  13           16750  16769 
    RET                                 ;650b  c9           16751  16770 
                                        ;                   16752  16771 ;
HEX2:   LD  A,00Bh                      ;650c  3e 0b        16753  16772 
    JR  PPOLNO                          ;650e  18 03        16754  16773 
                                        ;                   16755  16774 ;
HEX1:   LD  C,L                         ;6510  4d           16756  16775 
    LD  B,H                             ;6511  44           16757  16776 
    POP HL                              ;6512  e1           16758  16777 
PPOLNO: LD  (HL),A                      ;6513  77           16759  16778 
    INC HL                              ;6514  23           16760  16779 
    LD  (HL),C                          ;6515  71           16761  16780 
    INC HL                              ;6516  23           16762  16781 
    LD  (HL),B                          ;6517  70           16763  16782 
    INC HL                              ;6518  23           16764  16783 
    JR  BCKSPS                          ;6519  18 e9        16765  16784 
                                        ;                   16766  16785 ;
FLOAT:  LD  A,(IY+0)                    ;651b  fd 7e 00     16767  16786 
    AND 00Fh                            ;651e  e6 0f        16768  16787 
    OR  010h                            ;6520  f6 10        16769  16788 
    POP HL                              ;6522  e1           16770  16789 
    LD  (HL),A                          ;6523  77           16771  16790 
    INC HL                              ;6524  23           16772  16791 
    LD  C,(IY+0)                        ;6525  fd 4e 00     16773  16792 
    LD  B,0                             ;6528  06 00        16774  16793 
    ADD HL,BC                           ;652a  09           16775  16794 
    JR  BCKSPS                          ;652b  18 d7        16776  16795 
                                        ;                   16777  16796 ;
TSTNDE: LD  A,(DE)                      ;652d  1a           16778  16797 
TSTNAC: CP  030h                        ;652e  fe 30        16779  16798 
    RET C                               ;6530  d8           16780  16799 
    CP  03Ah                            ;6531  fe 3a        16781  16800 
    CCF                                 ;6533  3f           16782  16801 
    RET                                 ;6534  c9           16783  16802 
                                        ;                   16784  16803 ;
TREN':  LD  (DE),A                      ;6535  12           16785  16804 
    POP BC                              ;6536  c1           16786  16805 
    POP DE                              ;6537  d1           16787  16806 
    POP HL                              ;6538  e1           16788  16807 
    RET                                 ;6539  c9           16789  16808 
                                        ;                   16790  16809 ;
CVTXIM: PUSH    HL                      ;653a  e5           16791  16810 
    PUSH    DE                          ;653b  d5           16792  16811 
    PUSH    BC                          ;653c  c5           16793  16812 
    LD  (CVCPPT),DE                     ;653d  ed 53 4a 65  16794  16813 
CVTMLP: PUSH    HL                      ;6541  e5           16795  16814 
    PUSH    DE                          ;6542  d5           16796  16815 
    EX  DE,HL                           ;6543  eb           16797  16816 
    DEC H                               ;6544  25           16798  16817 
    LD  DE,26                           ;6545  11 1a 00     16799  16818 
    ADD HL,DE                           ;6548  19           16800  16819 
    DEFB    011H                        ;6549  11           16801  16820 ; LD DE,?
CVCPPT: DEFS    2                       ;654a               16802  16821 
    XOR A                               ;654c  af           16803  16822 
    SBC HL,DE                           ;654d  ed 52        16804  16823 
    POP DE                              ;654f  d1           16805  16824 
    POP HL                              ;6550  e1           16806  16825 
    JP  NC,TREN'                        ;6551  d2 35 65     16807  16826 
    LD  A,(HL)                          ;6554  7e           16808  16827 
    OR  A                               ;6555  b7           16809  16828 
    JP  Z,TREN'                         ;6556  ca 35 65     16810  16829 
    CP  081h                            ;6559  fe 81        16811  16830 ;FUNCTION의 TOKEN
    JR  NC,TRASIM                       ;655b  30 13        16812  16831 
    CP  020h                            ;655d  fe 20        16813  16832 
    JR  C,TRNUMB                        ;655f  38 32        16814  16833 
    CP  022h                            ;6561  fe 22        16815  16834 
    JP  Z,DQUAT                         ;6563  ca 5d 66     16816  16835 
    CP  03Ah                            ;6566  fe 3a        16817  16836 
    JP  Z,CORON                         ;6568  ca 74 66     16818  16837 
BCEG:   LD  (DE),A                      ;656b  12           16819  16838 
    INC DE                              ;656c  13           16820  16839 
MDLBK:  INC HL                          ;656d  23           16821  16840 
    JR  CVTMLP                          ;656e  18 d1        16822  16841 
TRASIM: CP  0FFh                        ;6570  fe ff        16823  16842 ;함수 앞에 FF가 붙으므로
    JR  Z,FUNCTR                        ;6572  28 15        16824  16843 
    LD  BC,CTBL1                        ;6574  01 37 67     16825  16844 
    PUSH    AF                          ;6577  f5           16826  16845 
    CALL    INVS                        ;6578  cd 84 66     16827  16846 
    POP AF                              ;657b  f1           16828  16847 
    INC HL                              ;657c  23           16829  16848 
    CP  092h                            ;657d  fe 92        16830  16849 
    JP  Z,REM1                          ;657f  ca 70 66     16831  16850 
    CP  08Fh                            ;6582  fe 8f        16832  16851 
    JP  Z,DTARCL                        ;6584  ca 3d 66     16833  16852 
    JR  CVTMLP                          ;6587  18 b8        16834  16853 
                                        ;                   16835  16854 ;
FUNCTR: INC HL                          ;6589  23           16836  16855 
    LD  A,(HL)                          ;658a  7e           16837  16856 
    LD  BC,CTBL2                        ;658b  01 d3 68     16838  16857 
    CALL    INVS                        ;658e  cd 84 66     16839  16858 
    JR  MDLBK                           ;6591  18 da        16840  16859 
                                        ;                   16841  16860 ;
TRNUMB: CP  010h                        ;6593  fe 10        16842  16861 
    JR  NC,RFLOAT                       ;6595  30 41        16843  16862 
    CP  00Bh                            ;6597  fe 0b        16844  16863 
    JR  NC,IMHORN                       ;6599  30 05        16845  16864 
    DEC A                               ;659b  3d           16846  16865 
    OR  030h                            ;659c  f6 30        16847  16866 
    JR  BCEG                            ;659e  18 cb        16848  16867 
                                        ;                   16849  16868 ;
IMHORN: CP  00Ch                        ;65a0  fe 0c        16850  16869 
    JP  Z,IMLNO                         ;65a2  ca 2d 66     16851  16870 
IMHEX:  PUSH    DE                      ;65a5  d5           16852  16871 
    INC HL                              ;65a6  23           16853  16872 
    LD  E,(HL)                          ;65a7  5e           16854  16873 
    INC HL                              ;65a8  23           16855  16874 
    LD  D,(HL)                          ;65a9  56           16856  16875 
    INC HL                              ;65aa  23           16857  16876 
    PUSH    HL                          ;65ab  e5           16858  16877 
    CP  010h                            ;65ac  fe 10        16859  16878 
    JR  C,IMMID                         ;65ae  38 05        16860  16879 
    CP  012h                            ;65b0  fe 12        16861  16880 
    JP  C,HEXOCT                        ;65b2  da ae 66     16862  16881 
IMMID:  EX  DE,HL                       ;65b5  eb           16863  16882 
    LD  DE,FIVEBF                       ;65b6  11 ab 69     16864  16883 
    CALL    ASCHL                       ;65b9  cd a8 62     16865  16884 
    XOR A                               ;65bc  af           16866  16885 
    LD  (FIVEBF+5),A                    ;65bd  32 b0 69     16867  16886 
    LD  B,4                             ;65c0  06 04        16868  16887 
SKZRLP: LD  A,(DE)                      ;65c2  1a           16869  16888 
    CP  030h                            ;65c3  fe 30        16870  16889 
    JR  NZ,ESSKZR                       ;65c5  20 03        16871  16890 
    INC DE                              ;65c7  13           16872  16891 
    DJNZ    SKZRLP                      ;65c8  10 f8        16873  16892 
ESSKZR: LD  C,E                         ;65ca  4b           16874  16893 
    LD  B,D                             ;65cb  42           16875  16894 
    POP HL                              ;65cc  e1           16876  16895 
    POP DE                              ;65cd  d1           16877  16896 
ZTRLW:  LD  A,(BC)                      ;65ce  0a           16878  16897 
    OR  A                               ;65cf  b7           16879  16898 
    JP  Z,CVTMLP                        ;65d0  ca 41 65     16880  16899 
    LD  (DE),A                          ;65d3  12           16881  16900 
    INC DE                              ;65d4  13           16882  16901 
    INC BC                              ;65d5  03           16883  16902 
    JR  ZTRLW                           ;65d6  18 f6        16884  16903 
RFLOAT: CP  013h                        ;65d8  fe 13        16885  16904 
    JR  C,IMHEX                         ;65da  38 c9        16886  16905 
    AND 00Fh                            ;65dc  e6 0f        16887  16906 
    LD  (IY+0),A                        ;65de  fd 77 00     16888  16907 
    INC HL                              ;65e1  23           16889  16908 
    PUSH    HL                          ;65e2  e5           16890  16909 
    PUSH    DE                          ;65e3  d5           16891  16910 
    CALL    CVASFL                      ;65e4  cd 1a 5e     16892  16911 
    EX  DE,HL                           ;65e7  eb           16893  16912 
    POP DE                              ;65e8  d1           16894  16913 
FLTRDL: LD  A,(HL)                      ;65e9  7e           16895  16914 
    LD  (DE),A                          ;65ea  12           16896  16915 
    CP  02Eh                            ;65eb  fe 2e        16897  16916 
    JR  Z,NTPT21                        ;65ed  28 29        16898  16917 
    CP  045h                            ;65ef  fe 45        16899  16918 
    JR  Z,NTPT21                        ;65f1  28 25        16900  16919 
    CP  044h                            ;65f3  fe 44        16901  16920 
    JR  Z,NTPT23                        ;65f5  28 30        16902  16921 
    INC HL                              ;65f7  23           16903  16922 
    INC DE                              ;65f8  13           16904  16923 
    DJNZ    FLTRDL                      ;65f9  10 ee        16905  16924 
    LD  A,(IY+0)                        ;65fb  fd 7e 00     16906  16925 
    CP  008h                            ;65fe  fe 08        16907  16926 
    LD  A,021h                          ;6600  3e 21        16908  16927 
    JR  NZ,PUT21H                       ;6602  20 02        16909  16928 
PUT23H: LD  A,023h                      ;6604  3e 23        16910  16929 
PUT21H: LD  (DE),A                      ;6606  12           16911  16930 
    INC DE                              ;6607  13           16912  16931 
TSTED:  LD  C,(IY+0)                    ;6608  fd 4e 00     16913  16932 
    LD  B,0                             ;660b  06 00        16914  16933 
    POP HL                              ;660d  e1           16915  16934 
    ADD HL,BC                           ;660e  09           16916  16935 
    JP  CVTMLP                          ;660f  c3 41 65     16917  16936 
                                        ;                   16918  16937 ;
FLTRP': LD  A,(HL)                      ;6612  7e           16919  16938 
    LD  (DE),A                          ;6613  12           16920  16939 
    CP  044h                            ;6614  fe 44        16921  16940 
    JR  Z,NTPT23                        ;6616  28 0f        16922  16941 
NTPT21: INC HL                          ;6618  23           16923  16942 
    INC DE                              ;6619  13           16924  16943 
    DJNZ    FLTRP'                      ;661a  10 f6        16925  16944 
    LD  A,(IY+0)                        ;661c  fd 7e 00     16926  16945 
    CP  008h                            ;661f  fe 08        16927  16946 
    JR  Z,PUT23H                        ;6621  28 e1        16928  16947 
    JR  TSTED                           ;6623  18 e3        16929  16948 
                                        ;                   16930  16949 ;
FLTR'': LD  A,(HL)                      ;6625  7e           16931  16950 
    LD  (DE),A                          ;6626  12           16932  16951 
NTPT23: INC HL                          ;6627  23           16933  16952 
    INC DE                              ;6628  13           16934  16953 
    DJNZ    FLTR''                      ;6629  10 fa        16935  16954 
    JR  TSTED                           ;662b  18 db        16936  16955 
                                        ;                   16937  16956 ;
IMLNO:  PUSH    DE                      ;662d  d5           16938  16957 
    INC HL                              ;662e  23           16939  16958 
    LD  E,(HL)                          ;662f  5e           16940  16959 
    INC HL                              ;6630  23           16941  16960 
    LD  D,(HL)                          ;6631  56           16942  16961 
    INC HL                              ;6632  23           16943  16962 
    PUSH    HL                          ;6633  e5           16944  16963 
    EX  DE,HL                           ;6634  eb           16945  16964 
    INC HL                              ;6635  23           16946  16965 
    INC HL                              ;6636  23           16947  16966 
    LD  E,(HL)                          ;6637  5e           16948  16967 
    INC HL                              ;6638  23           16949  16968 
    LD  D,(HL)                          ;6639  56           16950  16969 
    JP  IMMID                           ;663a  c3 b5 65     16951  16970 
                                        ;                   16952  16971 ;
DTARCL: LD  A,(HL)                      ;663d  7e           16953  16972 
    CP  022h                            ;663e  fe 22        16954  16973 
    JR  Z,DTA22S                        ;6640  28 0e        16955  16974 
MIDDST: LD  (DE),A                      ;6642  12           16956  16975 
    CP  03Ah                            ;6643  fe 3a        16957  16976 
    INC HL                              ;6645  23           16958  16977 
    INC DE                              ;6646  13           16959  16978 
    JP  Z,CVTMLP                        ;6647  ca 41 65     16960  16979 
    OR  A                               ;664a  b7           16961  16980 
    JP  Z,TREN'                         ;664b  ca 35 65     16962  16981 
    JR  DTARCL                          ;664e  18 ed        16963  16982 
                                        ;                   16964  16983 ;
DTA22S: LD  (DE),A                      ;6650  12           16965  16984 
    INC HL                              ;6651  23           16966  16985 
    INC DE                              ;6652  13           16967  16986 
    LD  A,(HL)                          ;6653  7e           16968  16987 
    CP  022h                            ;6654  fe 22        16969  16988 
    JR  Z,MIDDST                        ;6656  28 ea        16970  16989 
    OR  A                               ;6658  b7           16971  16990 
    JR  Z,MIDDST                        ;6659  28 e7        16972  16991 
    JR  DTA22S                          ;665b  18 f3        16973  16992 
                                        ;                   16974  16993 ;
DQUAT:  LD  B,022h                      ;665d  06 22        16975  16994 
    LD  (DE),A                          ;665f  12           16976  16995 
    INC HL                              ;6660  23           16977  16996 
    INC DE                              ;6661  13           16978  16997 
DQUATL: LD  A,(HL)                      ;6662  7e           16979  16998 
    LD  (DE),A                          ;6663  12           16980  16999 
    OR  A                               ;6664  b7           16981  17000 
    JP  Z,TREN'                         ;6665  ca 35 65     16982  17001 
    CP  B                               ;6668  b8           16983  17002 
    INC HL                              ;6669  23           16984  17003 
    INC DE                              ;666a  13           16985  17004 
    JP  Z,CVTMLP                        ;666b  ca 41 65     16986  17005 
    JR  DQUATL                          ;666e  18 f2        16987  17006 
                                        ;                   16988  17007 ;
REM1:   LD  B,0                         ;6670  06 00        16989  17008 
    JR  DQUATL                          ;6672  18 ee        16990  17009 
                                        ;                   16991  17010 ;
CORON:  LD  (DE),A                      ;6674  12           16992  17011 
    INC HL                              ;6675  23           16993  17012 
    LD  A,(HL)                          ;6676  7e           16994  17013 
    CP  027h                            ;6677  fe 27        16995  17014 
    JR  Z,REM1                          ;6679  28 f5        16996  17015 
    CP  0B8h                            ;667b  fe b8        16997  17016 
    JP  Z,CVTMLP                        ;667d  ca 41 65     16998  17017 
    INC DE                              ;6680  13           16999  17018 
    JP  CVTMLP                          ;6681  c3 41 65     17000  17019 
                                        ;                   17001  17020 ;
INVS:   DEC A                           ;6684  3d           17002  17021 
    CP  080h                            ;6685  fe 80        17003  17022 
    JR  Z,ASSTR#                        ;6687  28 0b        17004  17023 
    EX  AF,AF'                          ;6689  08           17005  17024 
SKIPTR: LD  A,(BC)                      ;668a  0a           17006  17025 
    RLCA                                ;668b  07           17007  17026 
    INC BC                              ;668c  03           17008  17027 
    JP  NC,SKIPTR                       ;668d  d2 8a 66     17009  17028 
    EX  AF,AF'                          ;6690  08           17010  17029 
    JP  INVS                            ;6691  c3 84 66     17011  17030 
ASSTR#: LD  A,(BC)                      ;6694  0a           17012  17031 
    PUSH    AF                          ;6695  f5           17013  17032 
    AND 07Fh                            ;6696  e6 7f        17014  17033 
    LD  (DE),A                          ;6698  12           17015  17034 
    POP AF                              ;6699  f1           17016  17035 
    INC DE                              ;669a  13           17017  17036 
    INC BC                              ;669b  03           17018  17037 
    RLCA                                ;669c  07           17019  17038 
    JR  NC,ASSTR#                       ;669d  30 f5        17020  17039 
    RET                                 ;669f  c9           17021  17040 
                                        ;                   17022  17041 ;
OCTALD: LD  A,04Fh                      ;66a0  3e 4f        17023  17042 
    EX  AF,AF'                          ;66a2  08           17024  17043 
    EX  DE,HL                           ;66a3  eb           17025  17044 
    LD  DE,FIVEBF                       ;66a4  11 ab 69     17026  17045 
    CALL    OCTHL                       ;66a7  cd db 66     17027  17046 
    LD  B,005h                          ;66aa  06 05        17028  17047 
    JR  SKHEXP                          ;66ac  18 10        17029  17048 
                                        ;                   17030  17049 ;
HEXOCT: CP  011h                        ;66ae  fe 11        17031  17050 
    JR  NZ,OCTALD                       ;66b0  20 ee        17032  17051 
    LD  A,048h                          ;66b2  3e 48        17033  17052 
    EX  AF,AF'                          ;66b4  08           17034  17053 
    EX  DE,HL                           ;66b5  eb           17035  17054 
    LD  DE,FIVEBF                       ;66b6  11 ab 69     17036  17055 
    CALL    HEXHL                       ;66b9  cd 12 67     17037  17056 
    LD  B,3                             ;66bc  06 03        17038  17057 
SKHEXP: LD  A,(DE)                      ;66be  1a           17039  17058 
    CP  030h                            ;66bf  fe 30        17040  17059 
    JR  NZ,ESHEXR                       ;66c1  20 03        17041  17060 
    INC DE                              ;66c3  13           17042  17061 
    DJNZ    SKHEXP                      ;66c4  10 f8        17043  17062 
ESHEXR: LD  C,E                         ;66c6  4b           17044  17063 
    LD  B,D                             ;66c7  42           17045  17064 
    POP HL                              ;66c8  e1           17046  17065 
    POP DE                              ;66c9  d1           17047  17066 
    LD  A,026h                          ;66ca  3e 26        17048  17067 
    LD  (DE),A                          ;66cc  12           17049  17068 
    INC DE                              ;66cd  13           17050  17069 
    EX  AF,AF'                          ;66ce  08           17051  17070 
    LD  (DE),A                          ;66cf  12           17052  17071 
    INC DE                              ;66d0  13           17053  17072 
ZTRLWH: LD  A,(BC)                      ;66d1  0a           17054  17073 
    OR  A                               ;66d2  b7           17055  17074 
    JP  Z,CVTMLP                        ;66d3  ca 41 65     17056  17075 
    LD  (DE),A                          ;66d6  12           17057  17076 
    INC DE                              ;66d7  13           17058  17077 
    INC BC                              ;66d8  03           17059  17078 
    JR  ZTRLWH                          ;66d9  18 f6        17060  17079 
                                        ;                   17061  17080 ;
OCTHL:  PUSH    DE                      ;66db  d5           17062  17081 
    CALL    OCTCOV                      ;66dc  cd e1 66     17063  17082 
    POP DE                              ;66df  d1           17064  17083 
    RET                                 ;66e0  c9           17065  17084 
                                        ;                   17066  17085 ;
OCTCOV: LD  A,H                         ;66e1  7c           17067  17086 
    RLA                                 ;66e2  17           17068  17087 
    LD  A,0                             ;66e3  3e 00        17069  17088 
    ADC A,030h                          ;66e5  ce 30        17070  17089 
    LD  (DE),A                          ;66e7  12           17071  17090 
    INC DE                              ;66e8  13           17072  17091 
    LD  A,H                             ;66e9  7c           17073  17092 
    RRCA                                ;66ea  0f           17074  17093 
    RRCA                                ;66eb  0f           17075  17094 
    RRCA                                ;66ec  0f           17076  17095 
    RRCA                                ;66ed  0f           17077  17096 
    CALL    OCTSTO                      ;66ee  cd 0b 67     17078  17097 
    LD  A,H                             ;66f1  7c           17079  17098 
    RRCA                                ;66f2  0f           17080  17099 
    CALL    OCTSTO                      ;66f3  cd 0b 67     17081  17100 
    LD  A,H                             ;66f6  7c           17082  17101 
    AND 001h                            ;66f7  e6 01        17083  17102 
    LD  H,L                             ;66f9  65           17084  17103 
    RL  H                               ;66fa  cb 14        17085  17104 
    RLA                                 ;66fc  17           17086  17105 
    RL  H                               ;66fd  cb 14        17087  17106 
    RLA                                 ;66ff  17           17088  17107 
    CALL    OCTSTO                      ;6700  cd 0b 67     17089  17108 
    LD  A,L                             ;6703  7d           17090  17109 
    RRCA                                ;6704  0f           17091  17110 
    RRCA                                ;6705  0f           17092  17111 
    RRCA                                ;6706  0f           17093  17112 
    CALL    OCTSTO                      ;6707  cd 0b 67     17094  17113 
    LD  A,L                             ;670a  7d           17095  17114 
OCTSTO: AND 007h                        ;670b  e6 07        17096  17115 
    ADD A,030h                          ;670d  c6 30        17097  17116 
    LD  (DE),A                          ;670f  12           17098  17117 
    INC DE                              ;6710  13           17099  17118 
    RET                                 ;6711  c9           17100  17119 
                                        ;                   17101  17120 ;
HEXHL:  PUSH    DE                      ;6712  d5           17102  17121 
    CALL    HEXCOV                      ;6713  cd 1a 67     17103  17122 
    XOR A                               ;6716  af           17104  17123 
    LD  (DE),A                          ;6717  12           17105  17124 
    POP DE                              ;6718  d1           17106  17125 
    RET                                 ;6719  c9           17107  17126 
                                        ;                   17108  17127 ;
HEXCOV: LD  A,H                         ;671a  7c           17109  17128 
    CALL    HEXACC                      ;671b  cd 1f 67     17110  17129 
    LD  A,L                             ;671e  7d           17111  17130 
HEXACC: PUSH    AF                      ;671f  f5           17112  17131 
    RRCA                                ;6720  0f           17113  17132 
    RRCA                                ;6721  0f           17114  17133 
    RRCA                                ;6722  0f           17115  17134 
    RRCA                                ;6723  0f           17116  17135 
    AND 00Fh                            ;6724  e6 0f        17117  17136 
    CALL    HEXHLF                      ;6726  cd 2c 67     17118  17137 
    POP AF                              ;6729  f1           17119  17138 
    AND 00Fh                            ;672a  e6 0f        17120  17139 
HEXHLF: ADD A,030h                      ;672c  c6 30        17121  17140 
    CP  03Ah                            ;672e  fe 3a        17122  17141 
    JR  C,SKIUTO                        ;6730  38 02        17123  17142 
    ADD A,007h                          ;6732  c6 07        17124  17143 
SKIUTO: LD  (DE),A                      ;6734  12           17125  17144 
    INC DE                              ;6735  13           17126  17145 
    RET                                 ;6736  c9           17127  17146 
                                        ;                   17128  17147 ;
CTBL1:  DEFM    'GOT'                   ;6737  47 4f 54     17129  17148 ;GOTO		81H
    DEFB    'O'+080H                    ;673a  cf           17130  17149 
    DEFM    'GOSU'                      ;673b  47 4f 53 55  17131  17150 ;GOSUB
    DEFB    'B'+080H                    ;673f  c2           17132  17151 
    DEFM    'RU'                        ;6740  52 55        17133  17152 ;RUN
    DEFB    'N'+080H                    ;6742  ce           17134  17153 
    DEFM    'RETUR'                     ;6743  52 45 54 55  17135  17154 ;RETURN
                                        ;6747  52           17135  17155
    DEFB    'N'+080H                    ;6748  ce           17136  17156 
    DEFM    'RESTOR'                    ;6749  52 45 53 54  17137  17157 ;RESTORE
                                        ;674d  4f 52        17137  17158
    DEFB    'E'+080H                    ;674f  c5           17138  17159 
    DEFM    'LIS'                       ;6750  4c 49 53     17139  17160 ;LIST
    DEFB    'T'+080H                    ;6753  d4           17140  17161 
    DEFM    'LIST#'                     ;6754  4c 49 53 54  17141  17162 ;LIST#1
                                        ;6758  23           17141  17163
    DEFB    '1'+080H                    ;6759  b1           17142  17164 
    DEFM    'AUT'                       ;675a  41 55 54     17143  17165 ;AUTO
    DEFB    'O'+080H                    ;675d  cf           17144  17166 
    DEFM    'DELET'                     ;675e  44 45 4c 45  17145  17167 ;DELETE
                                        ;6762  54           17145  17168
    DEFB    'E'+080H                    ;6763  c5           17146  17169 
    DEFM    'FO'                        ;6764  46 4f        17147  17170 ;FOR
    DEFB    'R'+080H                    ;6766  d2           17148  17171 
    DEFM    'NEX'                       ;6767  4e 45 58     17149  17172 ;NEXT
    DEFB    'T'+080H                    ;676a  d4           17150  17173 
    DEFM    'PRIN'                      ;676b  50 52 49 4e  17151  17174 ;PRINT
    DEFB    'T'+080H                    ;676f  d4           17152  17175 
    DEFM    'INPU'                      ;6770  49 4e 50 55  17153  17176 ;INPUT
    DEFB    'T'+080H                    ;6774  d4           17154  17177 
    DEFM    'I'                         ;6775  49           17155  17178 ;IF
    DEFB    'F'+080H                    ;6776  c6           17156  17179 
    DEFM    'DAT'                       ;6777  44 41 54     17157  17180 ;DATA
    DEFB    'A'+080H                    ;677a  c1           17158  17181 
    DEFM    'REA'                       ;677b  52 45 41     17159  17182 ;READ		90H
    DEFB    'D'+080H                    ;677e  c4           17160  17183 
    DEFM    'DI'                        ;677f  44 49        17161  17184 ;DIM
    DEFB    'M'+080H                    ;6781  cd           17162  17185 
    DEFM    'RE'                        ;6782  52 45        17163  17186 ;REM
    DEFB    'M'+080H                    ;6784  cd           17164  17187 
    DEFM    'EDI'                       ;6785  45 44 49     17165  17188 ;EDIT
    DEFB    'T'+080H                    ;6788  d4           17166  17189 
    DEFM    'STO'                       ;6789  53 54 4f     17167  17190 ;STOP
    DEFB    'P'+080H                    ;678c  d0           17168  17191 
    DEFM    'CON'                       ;678d  43 4f 4e     17169  17192 ;CONT
    DEFB    'T'+080H                    ;6790  d4           17170  17193 
    DEFM    'CL'                        ;6791  43 4c        17171  17194 ;CLS
    DEFB    'S'+080H                    ;6793  d3           17172  17195 
    DEFM    'CLEA'                      ;6794  43 4c 45 41  17173  17196 ;CLEAR
    DEFB    'R'+080H                    ;6798  d2           17174  17197 
    DEFM    'O'                         ;6799  4f           17175  17198 ;ON
    DEFB    'N'+080H                    ;679a  ce           17176  17199 
    DEFM    'LE'                        ;679b  4c 45        17177  17200 ;LET
    DEFB    'T'+080H                    ;679d  d4           17178  17201 
    DEFM    'NE'                        ;679e  4e 45        17179  17202 ;NEW
    DEFB    'W'+080H                    ;67a0  d7           17180  17203 
    DEFM    'POK'                       ;67a1  50 4f 4b     17181  17204 ;POKE
    DEFB    'E'+080H                    ;67a4  c5           17182  17205 
    DEFM    'OF'                        ;67a5  4f 46        17183  17206 ;OFF
    DEFB    'F'+080H                    ;67a7  c6           17184  17207 
    DEFM    'WHIL'                      ;67a8  57 48 49 4c  17185  17208 ;WHILE
    DEFB    'E'+080H                    ;67ac  c5           17186  17209 
    DEFM    'WEN'                       ;67ad  57 45 4e     17187  17210 ;WEND
    DEFB    'D'+080H                    ;67b0  c4           17188  17211 
    DEFM    'REPEA'                     ;67b1  52 45 50 45  17189  17212 ;REPEAT
                                        ;67b5  41           17189  17213
    DEFB    'T'+080H                    ;67b6  d4           17190  17214 
    DEFM    'UNTI'                      ;67b7  55 4e 54 49  17191  17215 ;UNTIL		A0
    DEFB    'L'+080H                    ;67bb  cc           17192  17216 
    DEFM    'TRAC'                      ;67bc  54 52 41 43  17193  17217 ;TRACE
    DEFB    'E'+080H                    ;67c0  c5           17194  17218 
    DEFM    'EN'                        ;67c1  45 4e        17195  17219 ;END
    DEFB    'D'+080H                    ;67c3  c4           17196  17220 
    DEFM    'PLA'                       ;67c4  50 4c 41     17197  17221 ;PLAY
    DEFB    'Y'+080H                    ;67c7  d9           17198  17222 
    DEFM    'BEE'                       ;67c8  42 45 45     17199  17223 ;BEEP
    DEFB    'P'+080H                    ;67cb  d0           17200  17224 
    DEFM    'DEFIN'                     ;67cc  44 45 46 49  17201  17225 ;DEFINT
                                        ;67d0  4e           17201  17226
    DEFB    'T'+080H                    ;67d1  d4           17202  17227 
    DEFM    'DEFSN'                     ;67d2  44 45 46 53  17203  17228 ;DEFSNG
                                        ;67d6  4e           17203  17229
    DEFB    'G'+080H                    ;67d7  c7           17204  17230 
    DEFM    'DEFDB'                     ;67d8  44 45 46 44  17205  17231 ;DEFDBL
                                        ;67dc  42           17205  17232
    DEFB    'L'+080H                    ;67dd  cc           17206  17233 
    DEFM    'DEFST'                     ;67de  44 45 46 53  17207  17234 ;DEFST
                                        ;67e2  54           17207  17235
    DEFB    'R'+080H                    ;67e3  d2           17208  17236 
    DEFM    'DE'                        ;67e4  44 45        17209  17237 ;DEF
    DEFB    'F'+080H                    ;67e6  c6           17210  17238 
    DEFM    'DUM'                       ;67e7  44 55 4d     17211  17239 ;DUMP
    DEFB    'P'+080H                    ;67ea  d0           17212  17240 
    DEFM    'LOA'                       ;67eb  4c 4f 41     17213  17241 ;LOAD
    DEFB    'D'+080H                    ;67ee  c4           17214  17242 
    DEFM    'SAV'                       ;67ef  53 41 56     17215  17243 ;SAVE
    DEFB    'E'+080H                    ;67f2  c5           17216  17244 
    DEFM    'MERG'                      ;67f3  4d 45 52 47  17217  17245 ;MERGE
    DEFB    'E'+080H                    ;67f7  c5           17218  17246 
    DEFB    080H                        ;67f8  80           17219  17247 ;DEFM 'CONSO'
                                        ;                   17220  17248 ;DEFB	'L'+080H
    DEFM    'OU'                        ;67f9  4f 55        17221  17249 ;OUT
    DEFB    'T'+080H                    ;67fb  d4           17222  17250 
    DEFM    'SEARC'                     ;67fc  53 45 41 52  17223  17251 ;SEARCH 	B0
                                        ;6800  43           17223  17252
    DEFB    'H'+080H                    ;6801  c8           17224  17253 
    DEFM    'SOUN'                      ;6802  53 4f 55 4e  17225  17254 ;SOUND
    DEFB    'D'+080H                    ;6806  c4           17226  17255 
    DEFB    080H                        ;6807  80           17227  17256 
    DEFM    'SWA'                       ;6808  53 57 41     17228  17257 ;SWAP
    DEFB    'P'+080H                    ;680b  d0           17229  17258 
    DEFB    080H                        ;680c  80           17230  17259 ;DEFM 'ERAS'
    DEFM    'ERRO'                      ;680d  45 52 52 4f  17231  17260 ;ERROR
    DEFB    'R'+080H                    ;6811  d2           17232  17261 
    DEFM    'RESUM'                     ;6812  52 45 53 55  17233  17262 ;RESUME
                                        ;6816  4d           17233  17263
    DEFB    'E'+080H                    ;6817  c5           17234  17264 
    DEFM    'RENU'                      ;6818  52 45 4e 55  17235  17265 ;RENUM
    DEFB    'M'+080H                    ;681c  cd           17236  17266 
    DEFM    'ELS'                       ;681d  45 4c 53     17237  17267 ;ELSE
    DEFB    'E'+080H                    ;6820  c5           17238  17268 
    DEFM    'CAL'                       ;6821  43 41 4c     17239  17269 ;CALL
    DEFB    'L'+080H                    ;6824  cc           17240  17270 
    DEFM    'LOCAT'                     ;6825  4c 4f 43 41  17241  17271 ;LOCATE
                                        ;6829  54           17241  17272
    DEFB    'E'+080H                    ;682a  c5           17242  17273 
    DEFB    080H                        ;682b  80           17243  17274 ;DEFM 'MA'	;MAT
                                        ;                   17244  17275 ;DEFB	'T'+080H
    DEFM    'MO'                        ;682c  4d 4f        17245  17276 ;MON
    DEFB    'N'+080H                    ;682e  ce           17246  17277 
    DEFM    'HCOP'                      ;682f  48 43 4f 50  17247  17278 ;HCOPY
    DEFB    'Y'+080H                    ;6833  d9           17248  17279 
    DEFM    'KE'                        ;6834  4b 45        17249  17280 ;KEY
    DEFB    'Y'+080H                    ;6836  d9           17250  17281 
    DEFM    'PUS'                       ;6837  50 55 53     17251  17282 ;PUSH
    DEFB    'H'+080H                    ;683a  c8           17252  17283 
    DEFM    'PO'                        ;683b  50 4f        17253  17284 ;POP		C0
    DEFB    'P'+080H                    ;683d  d0           17254  17285 
    DEFB    080H                        ;683e  80           17255  17286 ;DEFM	'BAS'
    DEFM    'LABE'                      ;683f  4c 41 42 45  17256  17287 ;LABEL
    DEFB    'L'+080H                    ;6843  cc           17257  17288 
    DEFB    080H                        ;6844  80           17258  17289 ;DEFM	'RANDOMIZ'
    DEFM    'SCREE'                     ;6845  53 43 52 45  17259  17290 ;SCREEN
                                        ;6849  45           17259  17291
    DEFB    'N'+080H                    ;684a  ce           17260  17292 
    DEFM    'LIN'                       ;684b  4c 49 4e     17261  17293 ;LINE
    DEFB    'E'+080H                    ;684e  c5           17262  17294 
    DEFM    'COLO'                      ;684f  43 4f 4c 4f  17263  17295 ;COLOR
    DEFB    'R'+080H                    ;6853  d2           17264  17296 
    DEFM    'PSE'                       ;6854  50 53 45     17265  17297 ;PSET
    DEFB    'T'+080H                    ;6857  d4           17266  17298 
    DEFM    'PRESE'                     ;6858  50 52 45 53  17267  17299 ;PRESET
                                        ;685c  45           17267  17300
    DEFB    'T'+080H                    ;685d  d4           17268  17301 
    DEFM    'CGINI'                     ;685e  43 47 49 4e  17269  17302 ;CGINIT
                                        ;6862  49           17269  17303
    DEFB    'T'+080H                    ;6863  d4           17270  17304 
    DEFM    'PATTER'                    ;6864  50 41 54 54  17271  17305 ;PATTERN
                                        ;6868  45 52        17271  17306
    DEFB    'N'+080H                    ;686a  ce           17272  17307 
    DEFM    'CIRCL'                     ;686b  43 49 52 43  17273  17308 ;CIRCLE
                                        ;686f  4c           17273  17309
    DEFB    'E'+080H                    ;6870  c5           17274  17310 
    DEFM    'PAIN'                      ;6871  50 41 49 4e  17275  17311 ;PAINT
    DEFB    'T'+080H                    ;6875  d4           17276  17312 
    DEFM    'ROPE'                      ;6876  52 4f 50 45  17277  17313 ;ROPEN
    DEFB    'N'+080H                    ;687a  ce           17278  17314 
    DEFM    'WOPE'                      ;687b  57 4f 50 45  17279  17315 ;WOPEN
    DEFB    'N'+080H                    ;687f  ce           17280  17316 
    DEFM    'CLOS'                      ;6880  43 4c 4f 53  17281  17317 ;CLOSE
    DEFB    'E'+080H                    ;6884  c5           17282  17318 
    DEFB    080H                        ;6885  80           17283  17319 ;DEFM	'FILED'
    DEFB    080H                        ;6886  80           17284  17320 ;DEFM	'GET'
    DEFB    080H                        ;6887  80           17285  17321 ;DEFM	'PUT'
    DEFB    080H                        ;6888  80           17286  17322 ;DEFM	'SET'
    DEFB    080H                        ;6889  80           17287  17323 ;DEFM	'FILES'
    DEFB    080H                        ;688a  80           17288  17324 ;DEFM	'RENAME'
    DEFB    080H                        ;688b  80           17289  17325 ;DEFM	'KILL'
    DEFB    080H                        ;688c  80           17290  17326 ;DEFM	'LSET'
    DEFB    080H                        ;688d  80           17291  17327 ;DEFM	'RSET'
    DEFB    080H                        ;688e  80           17292  17328 ;DEFM	'FORMAT
    DEFB    080H                        ;688f  80           17293  17329 ;DEFM	'INIT'
    DEFB    080H                        ;6890  80           17294  17330 ;EDFM	'CHAIN
    DEFB    080H                        ;6891  80           17295  17331 ;DEFM	'PEN'
    DEFB    080H                        ;6892  80           17296  17332 ;DEFM	'COM'
    DEFB    080H                        ;6893  80           17297  17333 ;DEFM	'PAUSE'
    DEFM    'T'                         ;6894  54           17298  17334 ;TO
    DEFB    'O'+080H                    ;6895  cf           17299  17335 
    DEFM    'STE'                       ;6896  53 54 45     17300  17336 ;STEP
    DEFB    'P'+080H                    ;6899  d0           17301  17337 
    DEFM    'THE'                       ;689a  54 48 45     17302  17338 ;THEN
    DEFB    'N'+080H                    ;689d  ce           17303  17339 
    DEFM    'USIN'                      ;689e  55 53 49 4e  17304  17340 ;USING
    DEFB    'G'+080H                    ;68a2  c7           17305  17341 
    DEFB    080H                        ;68a3  80           17306  17342 
    DEFB    080H                        ;68a4  80           17307  17343 
    DEFB    080H                        ;68a5  80           17308  17344 
    DEFB    080H                        ;68a6  80           17309  17345 
    DEFM    'TA'                        ;68a7  54 41        17310  17346 ;TAB
    DEFB    'B'+080H                    ;68a9  c2           17311  17347 
    DEFM    'SP'                        ;68aa  53 50        17312  17348 ;SPC
    DEFB    'C'+080H                    ;68ac  c3           17313  17349 
    DEFB    080H                        ;68ad  80           17314  17350 
    DEFB    080H                        ;68ae  80           17315  17351 
    DEFM    'XO'                        ;68af  58 4f        17316  17352 ;XOR
    DEFB    'R'+080H                    ;68b1  d2           17317  17353 
    DEFM    'O'                         ;68b2  4f           17318  17354 ;OR
    DEFB    'R'+080H                    ;68b3  d2           17319  17355 
    DEFM    'AN'                        ;68b4  41 4e        17320  17356 ;AND
    DEFB    'D'+080H                    ;68b6  c4           17321  17357 
    DEFM    'NO'                        ;68b7  4e 4f        17322  17358 ;NOT
    DEFB    'T'+080H                    ;68b9  d4           17323  17359 
    DEFB    '>'                         ;68ba  3e           17324  17360 ;><
    DEFB    '<'+080H                    ;68bb  bc           17325  17361 
    DEFB    '<'                         ;68bc  3c           17326  17362 ;<>
    DEFB    '>'+080H                    ;68bd  be           17327  17363 
    DEFM    '='                         ;68be  3d           17328  17364 ;=<
    DEFB    '<'+080H                    ;68bf  bc           17329  17365 
    DEFM    '='                         ;68c0  3d           17330  17366 ;=>
    DEFB    '>'+080H                    ;68c1  be           17331  17367 
    DEFB    '<'                         ;68c2  3c           17332  17368 ;<=
    DEFB    '='+080H                    ;68c3  bd           17333  17369 
    DEFB    '>'                         ;68c4  3e           17334  17370 ;><
    DEFB    '='+080H                    ;68c5  bd           17335  17371 ;=    
    DEFB    '='+080H                    ;68c6  bd           17336  17372 ;=
    DEFB    '>'+080H                    ;68c7  be           17337  17373 ;>
    DEFB    '<'+080H                    ;68c8  bc           17338  17374 ;<
    DEFB    '+'+080H                    ;68c9  ab           17339  17375 ;+
    DEFB    '-'+080H                    ;68ca  ad           17340  17376 ;-
    DEFM    'MO'                        ;68cb  4d 4f        17341  17377 ;MOD
    DEFB    'D'+080H                    ;68cd  c4           17342  17378 
    DEFB    0FCH                        ;68ce  fc           17343  17379 ;\
    DEFB    '/'+080H                    ;68cf  af           17344  17380 ;/
    DEFB    '*'+080H                    ;68d0  aa           17345  17381 ;*
    DEFB    '^'+080H                    ;68d1  de           17346  17382 ;^
    DEFB    0FFH                        ;68d2  ff           17347  17383 ;예약어 끝을 의미하는 DELIMETER
                                        ;                   17348  17384 
CTBL2:                                  ;                   17349  17385 
    DEFM    'IN'                        ;68d3  49 4e        17350  17386 ;81H INT
    DEFB    'T'+080H                    ;68d5  d4           17351  17387 
    DEFM    'AB'                        ;68d6  41 42        17352  17388 ;ABS
    DEFB    'S'+080H                    ;68d8  d3           17353  17389 
    DEFM    'SI'                        ;68d9  53 49        17354  17390 ;SIN
    DEFB    'N'+080H                    ;68db  ce           17355  17391 
    DEFM    'CO'                        ;68dc  43 4f        17356  17392 ;COS
    DEFB    'S'+080H                    ;68de  d3           17357  17393 
    DEFM    'TA'                        ;68df  54 41        17358  17394 ;TAN
    DEFB    'N'+080H                    ;68e1  ce           17359  17395 
    DEFM    'LO'                        ;68e2  4c 4f        17360  17396 ;LOG
    DEFB    'G'+080H                    ;68e4  c7           17361  17397 
    DEFM    'EX'                        ;68e5  45 58        17362  17398 ;EXP
    DEFB    'P'+080H                    ;68e7  d0           17363  17399 
    DEFM    'SQ'                        ;68e8  53 51        17364  17400 ;SQR
    DEFB    'R'+080H                    ;68ea  d2           17365  17401 
    DEFM    'RN'                        ;68eb  52 4e        17366  17402 ;RND
    DEFB    'D'+080H                    ;68ed  c4           17367  17403 
    DEFM    'PEE'                       ;68ee  50 45 45     17368  17404 ;PEEK
    DEFB    'K'+080H                    ;68f1  cb           17369  17405 
    DEFM    'AT'                        ;68f2  41 54        17370  17406 ;ATN
    DEFB    'N'+080H                    ;68f4  ce           17371  17407 
    DEFM    'SG'                        ;68f5  53 47        17372  17408 ;SGN
    DEFB    'N'+080H                    ;68f7  ce           17373  17409 
    DEFM    'FRA'                       ;68f8  46 52 41     17374  17410 ;FRAC
    DEFB    'C'+080H                    ;68fb  c3           17375  17411 
    DEFM    'FI'                        ;68fc  46 49        17376  17412 ;FIX
    DEFB    'X'+080H                    ;68fe  d8           17377  17413 
    DEFM    'PA'                        ;68ff  50 41        17378  17414 ;PAI
    DEFB    'I'+080H                    ;6901  c9           17379  17415 
    DEFM    'RA'                        ;6902  52 41        17380  17416 ;RAD	90H
    DEFB    'D'+080H                    ;6904  c4           17381  17417 
    DEFM    'IN'                        ;6905  49 4e        17382  17418 ;INP
    DEFB    'P'+080H                    ;6907  d0           17383  17419 
    DEFM    'CDB'                       ;6908  43 44 42     17384  17420 ;CDBL
    DEFB    'L'+080H                    ;690b  cc           17385  17421 
    DEFM    'CSN'                       ;690c  43 53 4e     17386  17422 ;CSNG
    DEFB    'G'+080H                    ;690f  c7           17387  17423 
    DEFM    'CIN'                       ;6910  43 49 4e     17388  17424 ;CINT
    DEFB    'T'+080H                    ;6913  d4           17389  17425 
    DEFB    080H                        ;6914  80           17390  17426 ;DEFM	'DSK'	;DSKF
    DEFB    080H                        ;6915  80           17391  17427 ;DEFM	'EO'	;EOF
    DEFB    080H                        ;6916  80           17392  17428 ;DEFM	'FPO'	;FPOS
    DEFB    080H                        ;6917  80           17393  17429 ;DEFM	'LO'	;LOC
    DEFB    080H                        ;6918  80           17394  17430 ;DEFM	'LO'	;LOF
    DEFM    'PO'                        ;6919  50 4f        17395  17431 ;POS
    DEFB    'S'+080H                    ;691b  d3           17396  17432 
    DEFM    'LPO'                       ;691c  4c 50 4f     17397  17433 ;LPOS
    DEFB    'S'+080H                    ;691f  d3           17398  17434 
    DEFM    'FA'                        ;6920  46 41        17399  17435 ;FAC
    DEFB    'C'+080H                    ;6922  c3           17400  17436 
    DEFM    'SU'                        ;6923  53 55        17401  17437 ;SUM
    DEFB    'M'+080H                    ;6925  cd           17402  17438 
    DEFB    080H                        ;6926  80           17403  17439 ;DEFM	'RE'	;REV
    DEFB    080H                        ;6927  80           17404  17440 ;DUMMY
    DEFM    'CHR'                       ;6928  43 48 52     17405  17441 ;CHR$	A0
    DEFB    '$'+080H                    ;692b  a4           17406  17442 
    DEFM    'STR'                       ;692c  53 54 52     17407  17443 ;STR$
    DEFB    '$'+080H                    ;692f  a4           17408  17444 
    DEFM    'HEX'                       ;6930  48 45 58     17409  17445 ;HEX$
    DEFB    '$'+080H                    ;6933  a4           17410  17446 
    DEFM    'OCT'                       ;6934  4f 43 54     17411  17447 ;OCT$
    DEFB    '$'+080H                    ;6937  a4           17412  17448 
    DEFM    'MKI'                       ;6938  4d 4b 49     17413  17449 ;MKI$
    DEFB    '$'+080H                    ;693b  a4           17414  17450 
    DEFM    'MKS'                       ;693c  4d 4b 53     17415  17451 ;MKS$
    DEFB    '$'+080H                    ;693f  a4           17416  17452 
    DEFM    'MKD'                       ;6940  4d 4b 44     17417  17453 ;MKD$
    DEFB    '$'+080H                    ;6943  a4           17418  17454 
    DEFM    'SPACE'                     ;6944  53 50 41 43  17419  17455 ;SPACE$
                                        ;6948  45           17419  17456
    DEFB    '$'+080H                    ;6949  a4           17420  17457 
    DEFB    080H                        ;694a  80           17421  17458 ;DUMMY
    DEFM    'AS'                        ;694b  41 53        17422  17459 ;ASC	A9
    DEFB    'C'+080H                    ;694d  c3           17423  17460 
    DEFM    'LE'                        ;694e  4c 45        17424  17461 ;LEN
    DEFB    'N'+080H                    ;6950  ce           17425  17462 
    DEFM    'VA'                        ;6951  56 41        17426  17463 ;VAL
    DEFB    'L'+080H                    ;6953  cc           17427  17464 
    DEFM    'CV'                        ;6954  43 56        17428  17465 ;CVS
    DEFB    'S'+080H                    ;6956  d3           17429  17466 
    DEFM    'CV'                        ;6957  43 56        17430  17467 ;CVD
    DEFB    'D'+080H                    ;6959  c4           17431  17468 
    DEFM    'CV'                        ;695a  43 56        17432  17469 ;CVI
    DEFB    'I'+080H                    ;695c  c9           17433  17470 
    DEFM    'STA'                       ;695d  53 54 41     17434  17471 ;STAT
    DEFB    'T'+080H                    ;6960  d4           17435  17472 
    DEFM    'PA'                        ;6961  50 41        17436  17473 ;PAR(ITY)	B0H
    DEFB    'R'+080H                    ;6963  d2           17437  17474 
    DEFB    080H                        ;6964  80           17438  17475 ;DUMMY B1H
    DEFM    'LEFT'                      ;6965  4c 45 46 54  17439  17476 ;LEFT$
    DEFB    '$'+080H                    ;6969  a4           17440  17477 
    DEFM    'RIGHT'                     ;696a  52 49 47 48  17441  17478 ;RIGHT$
                                        ;696e  54           17441  17479
    DEFB    '$'+080H                    ;696f  a4           17442  17480 
    DEFM    'MID'                       ;6970  4d 49 44     17443  17481 ;MID$
    DEFB    '$'+080H                    ;6973  a4           17444  17482 
    DEFM    'INKEY'                     ;6974  49 4e 4b 45  17445  17483 ;INKEY$
                                        ;6978  59           17445  17484
    DEFB    '$'+080H                    ;6979  a4           17446  17485 
    DEFM    'INST'                      ;697a  49 4e 53 54  17447  17486 ;INSTR
    DEFB    'R'+080H                    ;697e  d2           17448  17487 
    DEFM    'FR'                        ;697f  46 52        17449  17488 ;FRE
    DEFB    'E'+080H                    ;6981  c5           17450  17489 
    DEFM    'MEM'                       ;6982  4d 45 4d     17451  17490 ;MEM$
    DEFB    '$'+080H                    ;6985  a4           17452  17491 
    DEFM    'SCRN'                      ;6986  53 43 52 4e  17453  17492 ;SCRN$
    DEFB    '$'+080H                    ;698a  a4           17454  17493 
    DEFM    'VARPT'                     ;698b  56 41 52 50  17455  17494 ;VARPTR
                                        ;698f  54           17455  17495
    DEFB    'R'+080H                    ;6990  d2           17456  17496 
    DEFM    'STRING'                    ;6991  53 54 52 49  17457  17497 ;STRING$
                                        ;6995  4e 47        17457  17498
    DEFB    '$'+080H                    ;6997  a4           17458  17499 
    DEFB    080H                        ;6998  80           17459  17500 ;DEFM	'TIME'
    DEFM    'F'                         ;6999  46           17460  17501 ;FN
    DEFB    'N'+080H                    ;699a  ce           17461  17502 
    DEFM    'US'                        ;699b  55 53        17462  17503 ;USR
    DEFB    'R'+080H                    ;699d  d2           17463  17504 
    DEFM    'ER'                        ;699e  45 52        17464  17505 ;ERR
    DEFB    'R'+080H                    ;69a0  d2           17465  17506 
    DEFM    'ER'                        ;69a1  45 52        17466  17507 ;ERL
    DEFB    'L'+080H                    ;69a3  cc           17467  17508 
    DEFM    'CSRLI'                     ;69a4  43 53 52 4c  17468  17509 ;CSRLIN
                                        ;69a8  49           17468  17510
    DEFB    'N'+080H                    ;69a9  ce           17469  17511 
    DEFB    0FFH                        ;69aa  ff           17470  17512 
                                        ;                   17471  17513 ;
FIVEBF: DEFS    6                       ;69ab               17472  17514 
    DEFB    000H                        ;69b1  00           17473  17515 
                                        ;                   17474  17516 ;
                                        ;                   17475  17517 ;	ORG	069B2H
$ERTXT:                                 ;                   17476  17518 
ERRTXT:                                 ;                   17477  17519 
    DEFB    000H                        ;69b2  00           17478  17520 
    DEFM    'NEXT WITHOUT FOR'          ;69b3  4e 45 58 54  17479  17521 
                                        ;69b7  20 57 49 54  17479  17522
                                        ;69bb  48 4f 55 54  17479  17523
                                        ;69bf  20 46 4f 52  17479  17524
                                        ;                   17480  17525 
    DEFB    000H                        ;69c3  00           17481  17526 
    DEFM    'SYNTAX ERROR'              ;69c4  53 59 4e 54  17482  17527 
                                        ;69c8  41 58 20 45  17482  17528
                                        ;69cc  52 52 4f 52  17482  17529
                                        ;                   17483  17530 
    DEFB    000H                        ;69d0  00           17484  17531 
    DEFM    'RETURN WITHOUT GOSUB'      ;69d1  52 45 54 55  17485  17532 
                                        ;69d5  52 4e 20 57  17485  17533
                                        ;69d9  49 54 48 4f  17485  17534
                                        ;69dd  55 54 20 47  17485  17535
                                        ;69e1  4f 53 55 42  17485  17536
                                        ;                   17486  17537 
    DEFB    000H                        ;69e5  00           17487  17538 
    DEFM    'OUT OF DATA'               ;69e6  4f 55 54 20  17488  17539 
                                        ;69ea  4f 46 20 44  17488  17540
                                        ;69ee  41 54 41     17488  17541
                                        ;                   17489  17542 
    DEFB    000H                        ;69f1  00           17490  17543 
    DEFM    'ILLEGAL FUNCTION CALL'     ;69f2  49 4c 4c 45  17491  17544 
                                        ;69f6  47 41 4c 20  17491  17545
                                        ;69fa  46 55 4e 43  17491  17546
                                        ;69fe  54 49 4f 4e  17491  17547
                                        ;6a02  20 43 41 4c  17491  17548
                                        ;6a06  4c           17491  17549
                                        ;                   17492  17550 
    DEFB    000H                        ;6a07  00           17493  17551 
    DEFM    'OVERFLOW'                  ;6a08  4f 56 45 52  17494  17552 
                                        ;6a0c  46 4c 4f 57  17494  17553
                                        ;                   17495  17554 
    DEFB    000H                        ;6a10  00           17496  17555 
    DEFM    'OUT OF MEMORY'             ;6a11  4f 55 54 20  17497  17556 
                                        ;6a15  4f 46 20 4d  17497  17557
                                        ;6a19  45 4d 4f 52  17497  17558
                                        ;6a1d  59           17497  17559
                                        ;                   17498  17560 
    DEFB    000H                        ;6a1e  00           17499  17561 
UDLMES:                                 ;                   17500  17562 
    DEFM    'UNDEFINED LINE NUMBER'     ;6a1f  55 4e 44 45  17501  17563 
                                        ;6a23  46 49 4e 45  17501  17564
                                        ;6a27  44 20 4c 49  17501  17565
                                        ;6a2b  4e 45 20 4e  17501  17566
                                        ;6a2f  55 4d 42 45  17501  17567
                                        ;6a33  52           17501  17568
                                        ;                   17502  17569 
    DEFB    000H                        ;6a34  00           17503  17570 
    DEFM    'SUBSCRIPT OUT OF RANGE'    ;6a35  53 55 42 53  17504  17571 
                                        ;6a39  43 52 49 50  17504  17572
                                        ;6a3d  54 20 4f 55  17504  17573
                                        ;6a41  54 20 4f 46  17504  17574
                                        ;6a45  20 52 41 4e  17504  17575
                                        ;6a49  47 45        17504  17576
                                        ;                   17505  17577 
    DEFB    000H                        ;6a4b  00           17506  17578 
    DEFM    'DUPLICATE DEFINITION'      ;6a4c  44 55 50 4c  17507  17579 
                                        ;6a50  49 43 41 54  17507  17580
                                        ;6a54  45 20 44 45  17507  17581
                                        ;6a58  46 49 4e 49  17507  17582
                                        ;6a5c  54 49 4f 4e  17507  17583
                                        ;                   17508  17584 
    DEFB    000H                        ;6a60  00           17509  17585 
    DEFM    'DIVISION BY ZERO'          ;6a61  44 49 56 49  17510  17586 
                                        ;6a65  53 49 4f 4e  17510  17587
                                        ;6a69  20 42 59 20  17510  17588
                                        ;6a6d  5a 45 52 4f  17510  17589
                                        ;                   17511  17590 
    DEFB    000H                        ;6a71  00           17512  17591 
    DEFM    'ILLEGAL DIRECT'            ;6a72  49 4c 4c 45  17513  17592 
                                        ;6a76  47 41 4c 20  17513  17593
                                        ;6a7a  44 49 52 45  17513  17594
                                        ;6a7e  43 54        17513  17595
                                        ;                   17514  17596 
    DEFB    000H                        ;6a80  00           17515  17597 
    DEFM    'TYPE MISMATCH'             ;6a81  54 59 50 45  17516  17598 
                                        ;6a85  20 4d 49 53  17516  17599
                                        ;6a89  4d 41 54 43  17516  17600
                                        ;6a8d  48           17516  17601
                                        ;                   17517  17602 
    DEFB    000H                        ;6a8e  00           17518  17603 
    DEFM    'HUBASIC'                   ;6a8f  48 55 42 41  17519  17604 
                                        ;6a93  53 49 43     17519  17605
                                        ;                   17520  17606 
    DEFB    000H                        ;6a96  00           17521  17607 
    DEFM    'STRING TOO LONG'           ;6a97  53 54 52 49  17522  17608 
                                        ;6a9b  4e 47 20 54  17522  17609
                                        ;6a9f  4f 4f 20 4c  17522  17610
                                        ;6aa3  4f 4e 47     17522  17611
                                        ;                   17523  17612 
    DEFB    000H                        ;6aa6  00           17524  17613 
    DEFM    'EXPRESSION TOO COMPLEX'    ;6aa7  45 58 50 52  17525  17614 
                                        ;6aab  45 53 53 49  17525  17615
                                        ;6aaf  4f 4e 20 54  17525  17616
                                        ;6ab3  4f 4f 20 43  17525  17617
                                        ;6ab7  4f 4d 50 4c  17525  17618
                                        ;6abb  45 58        17525  17619
                                        ;                   17526  17620 
    DEFB    000H                        ;6abd  00           17527  17621 
    DEFM    "CAN'T CONTINUE"            ;6abe  43 41 4e 27  17528  17622 
                                        ;6ac2  54 20 43 4f  17528  17623
                                        ;6ac6  4e 54 49 4e  17528  17624
                                        ;6aca  55 45        17528  17625
                                        ;                   17529  17626 
    DEFB    000H                        ;6acc  00           17530  17627 
    DEFM    'UNDEFINED USER FUNCTION'   ;6acd  55 4e 44 45  17531  17628 
                                        ;6ad1  46 49 4e 45  17531  17629
                                        ;6ad5  44 20 55 53  17531  17630
                                        ;6ad9  45 52 20 46  17531  17631
                                        ;6add  55 4e 43 54  17531  17632
                                        ;6ae1  49 4f 4e     17531  17633
                                        ;                   17532  17634 
    DEFB    000H                        ;6ae4  00           17533  17635 
    DEFM    'NO RESUME'                 ;6ae5  4e 4f 20 52  17534  17636 
                                        ;6ae9  45 53 55 4d  17534  17637
                                        ;6aed  45           17534  17638
                                        ;                   17535  17639 
    DEFB    000H                        ;6aee  00           17536  17640 
    DEFM    'RESUME WITHOUT ERROR'      ;6aef  52 45 53 55  17537  17641 
                                        ;6af3  4d 45 20 57  17537  17642
                                        ;6af7  49 54 48 4f  17537  17643
                                        ;6afb  55 54 20 45  17537  17644
                                        ;6aff  52 52 4f 52  17537  17645
                                        ;                   17538  17646 
    DEFB    000H                        ;6b03  00           17539  17647 
    DEFM    'FORMAT OVER'               ;6b04  46 4f 52 4d  17540  17648 
                                        ;6b08  41 54 20 4f  17540  17649
                                        ;6b0c  56 45 52     17540  17650
                                        ;                   17541  17651 
    DEFB    000H                        ;6b0f  00           17542  17652 
    DEFM    'MISSING OPERAND'           ;6b10  4d 49 53 53  17543  17653 
                                        ;6b14  49 4e 47 20  17543  17654
                                        ;6b18  4f 50 45 52  17543  17655
                                        ;6b1c  41 4e 44     17543  17656
                                        ;                   17544  17657 
    DEFB    000H                        ;6b1f  00           17545  17658 
    DEFM    'REPEAT WITHOUT UNTIL'      ;6b20  52 45 50 45  17546  17659 
                                        ;6b24  41 54 20 57  17546  17660
                                        ;6b28  49 54 48 4f  17546  17661
                                        ;6b2c  55 54 20 55  17546  17662
                                        ;6b30  4e 54 49 4c  17546  17663
                                        ;                   17547  17664 
    DEFB    000H                        ;6b34  00           17548  17665 
    DEFM    'UNTIL WITHOUT REPEAT'      ;6b35  55 4e 54 49  17549  17666 
                                        ;6b39  4c 20 57 49  17549  17667
                                        ;6b3d  54 48 4f 55  17549  17668
                                        ;6b41  54 20 52 45  17549  17669
                                        ;6b45  50 45 41 54  17549  17670
                                        ;                   17550  17671 
    DEFB    000H                        ;6b49  00           17551  17672 
    DEFM    'WHILE WITHOUT WEND'        ;6b4a  57 48 49 4c  17552  17673 
                                        ;6b4e  45 20 57 49  17552  17674
                                        ;6b52  54 48 4f 55  17552  17675
                                        ;6b56  54 20 57 45  17552  17676
                                        ;6b5a  4e 44        17552  17677
                                        ;                   17553  17678 
    DEFB    000H                        ;6b5c  00           17554  17679 
    DEFM    'WEND WITHOUT WHILE'        ;6b5d  57 45 4e 44  17555  17680 
                                        ;6b61  20 57 49 54  17555  17681
                                        ;6b65  48 4f 55 54  17555  17682
                                        ;6b69  20 57 48 49  17555  17683
                                        ;6b6d  4c 45        17555  17684
                                        ;                   17556  17685 
    DEFB    000H                        ;6b6f  00           17557  17686 
    DEFM    'TAPE READ ERROR'           ;6b70  54 41 50 45  17558  17687 
                                        ;6b74  20 52 45 41  17558  17688
                                        ;6b78  44 20 45 52  17558  17689
                                        ;6b7c  52 4f 52     17558  17690
                                        ;                   17559  17691 
    DEFB    000H                        ;6b7f  00           17560  17692 
    DEFM    'DEVICE UNAVAILABLE'        ;6b80  44 45 56 49  17561  17693 
                                        ;6b84  43 45 20 55  17561  17694
                                        ;6b88  4e 41 56 41  17561  17695
                                        ;6b8c  49 4c 41 42  17561  17696
                                        ;6b90  4c 45        17561  17697
                                        ;                   17562  17698 
    DEFB    000H                        ;6b92  00           17563  17699 
    DEFM    'STATEMENT NOT INSTALL'     ;6b93  53 54 41 54  17564  17700 
                                        ;6b97  45 4d 45 4e  17564  17701
                                        ;6b9b  54 20 4e 4f  17564  17702
                                        ;6b9f  54 20 49 4e  17564  17703
                                        ;6ba3  53 54 41 4c  17564  17704
                                        ;6ba7  4c           17564  17705
                                        ;                   17565  17706 
    DEFB    000H                        ;6ba8  00           17566  17707 
    DEFM    'STACK EMPTY'               ;6ba9  53 54 41 43  17567  17708 
                                        ;6bad  4b 20 45 4d  17567  17709
                                        ;6bb1  50 54 59     17567  17710
                                        ;                   17568  17711 
    DEFB    000H                        ;6bb4  00           17569  17712 
    DEFM    'FILE ERROR'                ;6bb5  46 49 4c 45  17570  17713 
                                        ;6bb9  20 45 52 52  17570  17714
                                        ;6bbd  4f 52        17570  17715
                                        ;                   17571  17716 
    DEFB    000H                        ;6bbf  00           17572  17717 
                                        ;                   17573  17718 
                                        ;                   17574  17719 ;	ORG	06BC0h
$FLOAT:                                 ;                   17575  17720 
B_ABS:                                  ;                   17576  17721 
RESNHL: INC HL                          ;6bc0  23           17577  17722 
    RES 7,(HL)                          ;6bc1  cb be        17578  17723 
    DEC HL                              ;6bc3  2b           17579  17724 
    RET                                 ;6bc4  c9           17580  17725 
                                        ;                   17581  17726 ;
STROMT: LD  A,(IY+0)                    ;6bc5  fd 7e 00     17582  17727 
    CP  003h                            ;6bc8  fe 03        17583  17728 
    JP  Z,TYPEMS                        ;6bca  ca 32 17     17584  17729 
    RET                                 ;6bcd  c9           17585  17730 
                                        ;                   17586  17731 ;
ONESUB: LD  DE,FLONE                    ;6bce  11 98 62     17587  17732 
SUB:    CALL    STROMT                  ;6bd1  cd c5 6b     17588  17733 
    CALL    TOGLE                       ;6bd4  cd eb 6b     17589  17734 
    CALL    ADD                         ;6bd7  cd a6 6c     17590  17735 
    PUSH    AF                          ;6bda  f5           17591  17736 
    CALL    TOGLE                       ;6bdb  cd eb 6b     17592  17737 
    XOR A                               ;6bde  af           17593  17738 
    CP  (HL)                            ;6bdf  be           17594  17739 
    JR  Z,ZERO3                         ;6be0  28 03        17595  17740 
    POP AF                              ;6be2  f1           17596  17741 
    CCF                                 ;6be3  3f           17597  17742 
    RET                                 ;6be4  c9           17598  17743 
                                        ;                   17599  17744 ;
ZERO3:  POP AF                          ;6be5  f1           17600  17745 
    XOR A                               ;6be6  af           17601  17746 
    INC HL                              ;6be7  23           17602  17747 
    LD  (HL),A                          ;6be8  77           17603  17748 
    DEC HL                              ;6be9  2b           17604  17749 
    RET                                 ;6bea  c9           17605  17750 
                                        ;                   17606  17751 
TOGLE:  INC HL                          ;6beb  23           17607  17752 
    LD  A,(HL)                          ;6bec  7e           17608  17753 
    XOR 080h                            ;6bed  ee 80        17609  17754 
    LD  (HL),A                          ;6bef  77           17610  17755 
    DEC HL                              ;6bf0  2b           17611  17756 
    RET                                 ;6bf1  c9           17612  17757 
                                        ;                   17613  17758 ;
CONDM': PUSH    HL                      ;6bf2  e5           17614  17759 
    PUSH    DE                          ;6bf3  d5           17615  17760 
    JR  MIDCMZ                          ;6bf4  18 0f        17616  17761 
                                        ;                   17617  17762 ;
CONDMZ: PUSH    HL                      ;6bf6  e5           17618  17763 
    PUSH    DE                          ;6bf7  d5           17619  17764 
    LD  E,(HL)                          ;6bf8  5e           17620  17765 
    INC HL                              ;6bf9  23           17621  17766 
    LD  D,(HL)                          ;6bfa  56           17622  17767 
    INC HL                              ;6bfb  23           17623  17768 
    OR  A                               ;6bfc  b7           17624  17769 
    SBC HL,DE                           ;6bfd  ed 52        17625  17770 
    JR  Z,MTCHPO                        ;6bff  28 03        17626  17771 
RTCDMZ: POP DE                          ;6c01  d1           17627  17772 
    POP HL                              ;6c02  e1           17628  17773 
    RET                                 ;6c03  c9           17629  17774 
                                        ;                   17630  17775 ;
MTCHPO: EX  DE,HL                       ;6c04  eb           17631  17776 
MIDCMZ: LD  A,(HL)                      ;6c05  7e           17632  17777 
    OR  A                               ;6c06  b7           17633  17778 
    JR  Z,RTCDMZ                        ;6c07  28 f8        17634  17779 
    INC HL                              ;6c09  23           17635  17780 
    LD  E,(HL)                          ;6c0a  5e           17636  17781 
    INC HL                              ;6c0b  23           17637  17782 
    LD  D,(HL)                          ;6c0c  56           17638  17783 
    LD  HL,(STRTOP)                     ;6c0d  2a 41 7a     17639  17784 
    SBC HL,DE                           ;6c10  ed 52        17640  17785 
    JR  NC,RTCDMZ                       ;6c12  30 ed        17641  17786 
    EX  DE,HL                           ;6c14  eb           17642  17787 
    DEC HL                              ;6c15  2b           17643  17788 
    LD  (HL),0                          ;6c16  36 00        17644  17789 
    DEC HL                              ;6c18  2b           17645  17790 
    LD  (HL),A                          ;6c19  77           17646  17791 
    POP DE                              ;6c1a  d1           17647  17792 
    POP HL                              ;6c1b  e1           17648  17793 
    RET                                 ;6c1c  c9           17649  17794 
                                        ;                   17650  17795 ;
STROVF: LD  A,15                        ;6c1d  3e 0f        17651  17796 
    JP  ERROR                           ;6c1f  c3 96 21     17652  17797 
                                        ;                   17653  17798 ;
STRADE: POP DE                          ;6c22  d1           17654  17799 
    POP HL                              ;6c23  e1           17655  17800 
    CALL    CONDMZ                      ;6c24  cd f6 6b     17656  17801 
    PUSH    HL                          ;6c27  e5           17657  17802 
    PUSH    DE                          ;6c28  d5           17658  17803 
    LD  HL,ZFAC                         ;6c29  21 f2 62     17659  17804 
    CALL    LDIR8                       ;6c2c  cd a6 73     17660  17805 
    POP HL                              ;6c2f  e1           17661  17806 
    PUSH    HL                          ;6c30  e5           17662  17807 
    LD  E,L                             ;6c31  5d           17663  17808 
    LD  D,H                             ;6c32  54           17664  17809 
    INC DE                              ;6c33  13           17665  17810 
    INC DE                              ;6c34  13           17666  17811 
    LD  (HL),E                          ;6c35  73           17667  17812 
    INC HL                              ;6c36  23           17668  17813 
    LD  (HL),D                          ;6c37  72           17669  17814 
    EX  DE,HL                           ;6c38  eb           17670  17815 
    INC HL                              ;6c39  23           17671  17816 
    LD  E,(HL)                          ;6c3a  5e           17672  17817 
    INC HL                              ;6c3b  23           17673  17818 
    LD  D,(HL)                          ;6c3c  56           17674  17819 
    DEC HL                              ;6c3d  2b           17675  17820 
    DEC HL                              ;6c3e  2b           17676  17821 
    EX  DE,HL                           ;6c3f  eb           17677  17822 
    DEC HL                              ;6c40  2b           17678  17823 
    LD  (HL),D                          ;6c41  72           17679  17824 
    DEC HL                              ;6c42  2b           17680  17825 
    LD  (HL),E                          ;6c43  73           17681  17826 
SRADE': POP HL                          ;6c44  e1           17682  17827 
    POP DE                              ;6c45  d1           17683  17828 
    RET                                 ;6c46  c9           17684  17829 
                                        ;                   17685  17830 ;
STRADD: PUSH    DE                      ;6c47  d5           17686  17831 
    PUSH    HL                          ;6c48  e5           17687  17832 
    LD  C,(HL)                          ;6c49  4e           17688  17833 
    INC HL                              ;6c4a  23           17689  17834 
    LD  B,(HL)                          ;6c4b  46           17690  17835 
    EX  DE,HL                           ;6c4c  eb           17691  17836 
    LD  E,(HL)                          ;6c4d  5e           17692  17837 
    INC HL                              ;6c4e  23           17693  17838 
    LD  D,(HL)                          ;6c4f  56           17694  17839 
    LD  L,C                             ;6c50  69           17695  17840 
    LD  H,B                             ;6c51  60           17696  17841 
    LD  A,(HL)                          ;6c52  7e           17697  17842 
    EX  AF,AF'                          ;6c53  08           17698  17843 
    LD  A,(DE)                          ;6c54  1a           17699  17844 
    ADD A,(HL)                          ;6c55  86           17700  17845 
    JR  C,STROVF                        ;6c56  38 c5        17701  17846 
    JR  Z,SRADE'                        ;6c58  28 ea        17702  17847 
    LD  HL,ZFAC                         ;6c5a  21 f2 62     17703  17848 
    CALL    CLRFAC                      ;6c5d  cd a9 28     17704  17849 
    PUSH    HL                          ;6c60  e5           17705  17850 
    PUSH    DE                          ;6c61  d5           17706  17851 
    LD  E,L                             ;6c62  5d           17707  17852 
    LD  D,H                             ;6c63  54           17708  17853 
    INC HL                              ;6c64  23           17709  17854 
    INC HL                              ;6c65  23           17710  17855 
    EX  DE,HL                           ;6c66  eb           17711  17856 
    LD  (HL),E                          ;6c67  73           17712  17857 
    INC HL                              ;6c68  23           17713  17858 
    LD  (HL),D                          ;6c69  72           17714  17859 
    EX  DE,HL                           ;6c6a  eb           17715  17860 
    LD  (HL),A                          ;6c6b  77           17716  17861 
    LD  E,L                             ;6c6c  5d           17717  17862 
    LD  D,H                             ;6c6d  54           17718  17863 
    EX  AF,AF'                          ;6c6e  08           17719  17864 
    PUSH    AF                          ;6c6f  f5           17720  17865 
    CALL    GETSTR                      ;6c70  cd 9e 2d     17721  17866 
    INC HL                              ;6c73  23           17722  17867 
    LD  A,(HL)                          ;6c74  7e           17723  17868 
    INC HL                              ;6c75  23           17724  17869 
    LD  H,(HL)                          ;6c76  66           17725  17870 
    LD  L,A                             ;6c77  6f           17726  17871 
    INC BC                              ;6c78  03           17727  17872 
    LD  A,(BC)                          ;6c79  0a           17728  17873 
    LD  E,A                             ;6c7a  5f           17729  17874 
    INC BC                              ;6c7b  03           17730  17875 
    LD  A,(BC)                          ;6c7c  0a           17731  17876 
    LD  D,A                             ;6c7d  57           17732  17877 
    POP AF                              ;6c7e  f1           17733  17878 
    OR  A                               ;6c7f  b7           17734  17879 
    JR  Z,NXTADS                        ;6c80  28 07        17735  17880 
    LD  B,A                             ;6c82  47           17736  17881 
FSTTRL: LD  A,(DE)                      ;6c83  1a           17737  17882 
    LD  (HL),A                          ;6c84  77           17738  17883 
    INC HL                              ;6c85  23           17739  17884 
    INC DE                              ;6c86  13           17740  17885 
    DJNZ    FSTTRL                      ;6c87  10 fa        17741  17886 
NXTADS: POP BC                          ;6c89  c1           17742  17887 
    LD  A,(BC)                          ;6c8a  0a           17743  17888 
    EX  AF,AF'                          ;6c8b  08           17744  17889 
    INC BC                              ;6c8c  03           17745  17890 
    LD  A,(BC)                          ;6c8d  0a           17746  17891 
    LD  E,A                             ;6c8e  5f           17747  17892 
    INC BC                              ;6c8f  03           17748  17893 
    LD  A,(BC)                          ;6c90  0a           17749  17894 
    LD  D,A                             ;6c91  57           17750  17895 
    EX  AF,AF'                          ;6c92  08           17751  17896 
    OR  A                               ;6c93  b7           17752  17897 
    JR  Z,STRADS                        ;6c94  28 07        17753  17898 
    LD  B,A                             ;6c96  47           17754  17899 
SNDTRL: LD  A,(DE)                      ;6c97  1a           17755  17900 
    LD  (HL),A                          ;6c98  77           17756  17901 
    INC HL                              ;6c99  23           17757  17902 
    INC DE                              ;6c9a  13           17758  17903 
    DJNZ    SNDTRL                      ;6c9b  10 fa        17759  17904 
STRADS: POP DE                          ;6c9d  d1           17760  17905 
    POP HL                              ;6c9e  e1           17761  17906 
    PUSH    HL                          ;6c9f  e5           17762  17907 
    CALL    CONDMZ                      ;6ca0  cd f6 6b     17763  17908 
    JP  STRADE                          ;6ca3  c3 22 6c     17764  17909 
                                        ;                   17765  17910 ;
ADD:    LD  A,(IY+0)                    ;6ca6  fd 7e 00     17766  17911 
    CP  003h                            ;6ca9  fe 03        17767  17912 
    JR  Z,STRADD                        ;6cab  28 9a        17768  17913 
    PUSH    DE                          ;6cad  d5           17769  17914 
    PUSH    HL                          ;6cae  e5           17770  17915 
    INC HL                              ;6caf  23           17771  17916 
    LD  A,(HL)                          ;6cb0  7e           17772  17917 
    RLCA                                ;6cb1  07           17773  17918 
    JR  C,HMINS                         ;6cb2  38 0f        17774  17919 
    INC DE                              ;6cb4  13           17775  17920 
    LD  A,(DE)                          ;6cb5  1a           17776  17921 
    RLCA                                ;6cb6  07           17777  17922 
    JR  C,DMINS                         ;6cb7  38 2e        17778  17923 
    DEC DE                              ;6cb9  1b           17779  17924 
    DEC HL                              ;6cba  2b           17780  17925 
    CALL    FADD                        ;6cbb  cd fc 6c     17781  17926 
    POP HL                              ;6cbe  e1           17782  17927 
    POP DE                              ;6cbf  d1           17783  17928 
    JP  RESNHL                          ;6cc0  c3 c0 6b     17784  17929 
                                        ;                   17785  17930 ;
HMINS:  LD  A,(DE)                      ;6cc3  1a           17786  17931 
    OR  A                               ;6cc4  b7           17787  17932 
    JR  Z,MINCR                         ;6cc5  28 0a        17788  17933 
    INC DE                              ;6cc7  13           17789  17934 
    LD  A,(DE)                          ;6cc8  1a           17790  17935 
    RLCA                                ;6cc9  07           17791  17936 
    JR  NC,HMDP                         ;6cca  30 0f        17792  17937 
    DEC DE                              ;6ccc  1b           17793  17938 
    DEC HL                              ;6ccd  2b           17794  17939 
    CALL    FADD                        ;6cce  cd fc 6c     17795  17940 
MINCR:  POP HL                          ;6cd1  e1           17796  17941 
    INC HL                              ;6cd2  23           17797  17942 
    LD  A,(HL)                          ;6cd3  7e           17798  17943 
    DEC HL                              ;6cd4  2b           17799  17944 
    OR  A                               ;6cd5  b7           17800  17945 
    JR  Z,MZRT                          ;6cd6  28 01        17801  17946 
    SCF                                 ;6cd8  37           17802  17947 
MZRT:   POP DE                          ;6cd9  d1           17803  17948 
    RET                                 ;6cda  c9           17804  17949 
                                        ;                   17805  17950 ;
HMDP:   DEC DE                          ;6cdb  1b           17806  17951 
    DEC HL                              ;6cdc  2b           17807  17952 
    CALL    FSUB                        ;6cdd  cd 04 6e     17808  17953 
    POP HL                              ;6ce0  e1           17809  17954 
    JR  C,MZRT                          ;6ce1  38 f6        17810  17955 
    POP DE                              ;6ce3  d1           17811  17956 
    JP  RESNHL                          ;6ce4  c3 c0 6b     17812  17957 
                                        ;                   17813  17958 ;
DMINS:  DEC DE                          ;6ce7  1b           17814  17959 
    DEC HL                              ;6ce8  2b           17815  17960 
    CALL    FSUB                        ;6ce9  cd 04 6e     17816  17961 
    POP HL                              ;6cec  e1           17817  17962 
    JR  NC,OKM                          ;6ced  30 06        17818  17963 
    CALL    RESNHL                      ;6cef  cd c0 6b     17819  17964 
ZRO:    POP DE                          ;6cf2  d1           17820  17965 
    OR  A                               ;6cf3  b7           17821  17966 
    RET                                 ;6cf4  c9           17822  17967 
                                        ;                   17823  17968 
OKM:    XOR A                           ;6cf5  af           17824  17969 
    CP  (HL)                            ;6cf6  be           17825  17970 
    JR  Z,ZRO                           ;6cf7  28 f9        17826  17971 
    POP DE                              ;6cf9  d1           17827  17972 
    SCF                                 ;6cfa  37           17828  17973 
    RET                                 ;6cfb  c9           17829  17974 
                                        ;                   17830  17975 ;
FADD:   LD  A,0B7h                      ;6cfc  3e b7        17831  17976 
    LD  (INST1),A                       ;6cfe  32 7c 6d     17832  17977 
    BIT 2,(IY+0)                        ;6d01  fd cb 00 56  17833  17978 
    JP  NZ,SFADD                        ;6d05  c2 ea 6e     17834  17979 
    XOR A                               ;6d08  af           17835  17980 
    CP  (HL)                            ;6d09  be           17836  17981 
    JP  Z,TRANS                         ;6d0a  ca cf 6e     17837  17982 
    LD  A,(DE)                          ;6d0d  1a           17838  17983 
    OR  A                               ;6d0e  b7           17839  17984 
    RET Z                               ;6d0f  c8           17840  17985 
    SUB (HL)                            ;6d10  96           17841  17986 
    JR  NC,ANSHIF                       ;6d11  30 0b        17842  17987 
    NEG                                 ;6d13  ed 44        17843  17988 
    CP  56                              ;6d15  fe 38        17844  17989 
    RET NC                              ;6d17  d0           17845  17990 
    LD  (HLBUF),HL                      ;6d18  22 6a 6d     17846  17991 
    EX  DE,HL                           ;6d1b  eb           17847  17992 
    JR  FADDS                           ;6d1c  18 08        17848  17993 
ANSHIF: CP  56                          ;6d1e  fe 38        17849  17994 
    JP  NC,TRANS                        ;6d20  d2 cf 6e     17850  17995 
    LD  (HLBUF),HL                      ;6d23  22 6a 6d     17851  17996 
FADDS:  CALL    FADD1                   ;6d26  cd 7f 6d     17852  17997 
    PUSH    IX                          ;6d29  dd e5        17853  17998 
    EX  (SP),HL                         ;6d2b  e3           17854  17999 
    LD  A,D                             ;6d2c  7a           17855  18000 
    ADD A,H                             ;6d2d  84           17856  18001 
    LD  D,A                             ;6d2e  57           17857  18002 
    LD  A,L                             ;6d2f  7d           17858  18003 
    ADC A,E                             ;6d30  8b           17859  18004 
    LD  E,A                             ;6d31  5f           17860  18005 
    POP HL                              ;6d32  e1           17861  18006 
    LD  A,B                             ;6d33  78           17862  18007 
    EXX                                 ;6d34  d9           17863  18008 
    ADC A,B                             ;6d35  88           17864  18009 
    EXX                                 ;6d36  d9           17865  18010 
    LD  B,A                             ;6d37  47           17866  18011 
    LD  A,C                             ;6d38  79           17867  18012 
    EXX                                 ;6d39  d9           17868  18013 
    ADC A,C                             ;6d3a  89           17869  18014 
    EXX                                 ;6d3b  d9           17870  18015 
    LD  C,A                             ;6d3c  4f           17871  18016 
    LD  A,H                             ;6d3d  7c           17872  18017 
    EXX                                 ;6d3e  d9           17873  18018 
    ADC A,H                             ;6d3f  8c           17874  18019 
    EXX                                 ;6d40  d9           17875  18020 
    LD  H,A                             ;6d41  67           17876  18021 
    LD  A,L                             ;6d42  7d           17877  18022 
    EXX                                 ;6d43  d9           17878  18023 
    ADC A,L                             ;6d44  8d           17879  18024 
    EXX                                 ;6d45  d9           17880  18025 
    LD  L,A                             ;6d46  6f           17881  18026 
    EXX                                 ;6d47  d9           17882  18027 
    EX  AF,AF'                          ;6d48  08           17883  18028 
    LD  B,A                             ;6d49  47           17884  18029 
    EX  AF,AF'                          ;6d4a  08           17885  18030 
    LD  A,B                             ;6d4b  78           17886  18031 
    ADC A,D                             ;6d4c  8a           17887  18032 
    LD  D,A                             ;6d4d  57           17888  18033 
    JP  NC,STORE1                       ;6d4e  d2 66 6d     17889  18034 
    INC E                               ;6d51  1c           17890  18035 
    JP  Z,OVERFL1                       ;6d52  ca e4 6e     17891  18036 
    EXX                                 ;6d55  d9           17892  18037 
    SCF                                 ;6d56  37           17893  18038 
    RRA                                 ;6d57  1f           17894  18039 
    RR  L                               ;6d58  cb 1d        17895  18040 
    RR  H                               ;6d5a  cb 1c        17896  18041 
    RR  C                               ;6d5c  cb 19        17897  18042 
    RR  B                               ;6d5e  cb 18        17898  18043 
    RR  E                               ;6d60  cb 1b        17899  18044 
    RR  D                               ;6d62  cb 1a        17900  18045 
    EXX                                 ;6d64  d9           17901  18046 
    LD  D,A                             ;6d65  57           17902  18047 
STORE1: LD  BC,00008h                   ;6d66  01 08 00     17903  18048 
    DEFB    021H                        ;6d69  21           17904  18049 ;LD HL,?
HLBUF:  DEFS    2                       ;6d6a               17905  18050 
    ADD HL,BC                           ;6d6c  09           17906  18051 
    LD  (SPBF),SP                       ;6d6d  ed 73 5b 70  17907  18052 
    LD  SP,HL                           ;6d71  f9           17908  18053 
    EXX                                 ;6d72  d9           17909  18054 
    PUSH    DE                          ;6d73  d5           17910  18055 
    PUSH    BC                          ;6d74  c5           17911  18056 
    PUSH    HL                          ;6d75  e5           17912  18057 
    EXX                                 ;6d76  d9           17913  18058 
    PUSH    DE                          ;6d77  d5           17914  18059 
FLEXIT: LD  SP,(SPBF)                   ;6d78  ed 7b 5b 70  17915  18060 
INST1:  DEFS    1                       ;6d7c               17916  18061 
    EI                                  ;6d7d  fb           17917  18062 
    RET                                 ;6d7e  c9           17918  18063 
                                        ;                   17919  18064 ;
FADD1:  DI                              ;6d7f  f3           17920  18065 
    LD  (SPBF),SP                       ;6d80  ed 73 5b 70  17921  18066 
    LD  C,A                             ;6d84  4f           17922  18067 
    AND 007h                            ;6d85  e6 07        17923  18068 
    INC A                               ;6d87  3c           17924  18069 
    LD  B,A                             ;6d88  47           17925  18070 
    LD  A,C                             ;6d89  79           17926  18071 
    AND 038h                            ;6d8a  e6 38        17927  18072 
    LD  (JPVEC),A                       ;6d8c  32 99 6d     17928  18073 
    LD  SP,HL                           ;6d8f  f9           17929  18074 
    EX  AF,AF'                          ;6d90  08           17930  18075 
    EXX                                 ;6d91  d9           17931  18076 
    POP AF                              ;6d92  f1           17932  18077 
    SET 7,A                             ;6d93  cb ff        17933  18078 
    POP HL                              ;6d95  e1           17934  18079 
    POP BC                              ;6d96  c1           17935  18080 
    POP DE                              ;6d97  d1           17936  18081 
    DEFB    018H                        ;6d98  18           17937  18082 ;JR ?
JPVEC:  DEFS    1                       ;6d99               17938  18083 
    JP  CLR1                            ;6d9a  c3 d1 6d     17939  18084 
FADDL1: XOR A                           ;6d9d  af           17940  18085 
    JP  CLR1                            ;6d9e  c3 d1 6d     17941  18086 
    DEFB    000H                        ;6da1  00           17942  18087 
    LD  D,E                             ;6da2  53           17943  18088 
    LD  E,B                             ;6da3  58           17944  18089 
    LD  B,C                             ;6da4  41           17945  18090 
    LD  C,H                             ;6da5  4c           17946  18091 
    LD  H,L                             ;6da6  65           17947  18092 
    LD  L,A                             ;6da7  6f           17948  18093 
    JR  FADDL1                          ;6da8  18 f3        17949  18094 
    LD  D,B                             ;6daa  50           17950  18095 
    LD  E,C                             ;6dab  59           17951  18096 
    LD  B,H                             ;6dac  44           17952  18097 
    LD  C,L                             ;6dad  4d           17953  18098 
    LD  H,A                             ;6dae  67           17954  18099 
    XOR A                               ;6daf  af           17955  18100 
    JR  CLR2$                           ;6db0  18 1e        17956  18101 
    LD  D,C                             ;6db2  51           17957  18102 
    LD  E,H                             ;6db3  5c           17958  18103 
    LD  B,L                             ;6db4  45           17959  18104 
    LD  C,A                             ;6db5  4f           17960  18105 
    XOR A                               ;6db6  af           17961  18106 
    JP  CLR3                            ;6db7  c3 cf 6d     17962  18107 
    LD  D,H                             ;6dba  54           17963  18108 
    LD  E,L                             ;6dbb  5d           17964  18109 
    LD  B,A                             ;6dbc  47           17965  18110 
    XOR A                               ;6dbd  af           17966  18111 
    JP  CLR4                            ;6dbe  c3 ce 6d     17967  18112 
    DEFB    000H                        ;6dc1  00           17968  18113 
    LD  D,L                             ;6dc2  55           17969  18114 
    LD  E,A                             ;6dc3  5f           17970  18115 
    XOR A                               ;6dc4  af           17971  18116 
    JP  CLR5                            ;6dc5  c3 cd 6d     17972  18117 
    DEFW    0                           ;6dc8  00 00        17973  18118 
    LD  D,A                             ;6dca  57           17974  18119 
    XOR A                               ;6dcb  af           17975  18120 
    LD  E,A                             ;6dcc  5f           17976  18121 
CLR5:   LD  B,A                         ;6dcd  47           17977  18122 
CLR4:   LD  C,A                         ;6dce  4f           17978  18123 
CLR3:   LD  H,A                         ;6dcf  67           17979  18124 
CLR2$:  LD  L,A                         ;6dd0  6f           17980  18125 
CLR1:   EX  AF,AF'                      ;6dd1  08           17981  18126 
    RRCA                                ;6dd2  0f           17982  18127 
    RRCA                                ;6dd3  0f           17983  18128 
    ADD A,0EBh                          ;6dd4  c6 eb        17984  18129 
    LD  (JPVEC2),A                      ;6dd6  32 f1 6d     17985  18130 
    EX  AF,AF'                          ;6dd9  08           17986  18131 
    JP  SHIFST                          ;6dda  c3 eb 6d     17987  18132 
    OR  A                               ;6ddd  b7           17988  18133 
    RRA                                 ;6dde  1f           17989  18134 
    RR  L                               ;6ddf  cb 1d        17990  18135 
    RR  H                               ;6de1  cb 1c        17991  18136 
    RR  C                               ;6de3  cb 19        17992  18137 
    RR  B                               ;6de5  cb 18        17993  18138 
    RR  E                               ;6de7  cb 1b        17994  18139 
    RR  D                               ;6de9  cb 1a        17995  18140 
SHIFST: EXX                             ;6deb  d9           17996  18141 
    SCF                                 ;6dec  37           17997  18142 
    CCF                                 ;6ded  3f           17998  18143 
    DEC B                               ;6dee  05           17999  18144 
    EXX                                 ;6def  d9           18000  18145 
    DEFB    020H                        ;6df0  20           18001  18146 ;JR NZ,?
JPVEC2: DEFS    1                       ;6df1               18002  18147 
    EXX                                 ;6df2  d9           18003  18148 
    EX  DE,HL                           ;6df3  eb           18004  18149 
    LD  SP,HL                           ;6df4  f9           18005  18150 
    POP DE                              ;6df5  d1           18006  18151 
    SET 7,D                             ;6df6  cb fa        18007  18152 
    POP HL                              ;6df8  e1           18008  18153 
    POP BC                              ;6df9  c1           18009  18154 
    POP IX                              ;6dfa  dd e1        18010  18155 
    LD  SP,(SPBF)                       ;6dfc  ed 7b 5b 70  18011  18156 
    EXX                                 ;6e00  d9           18012  18157 
    SCF                                 ;6e01  37           18013  18158 
    EX  AF,AF'                          ;6e02  08           18014  18159 
    RET                                 ;6e03  c9           18015  18160 
                                        ;                   18016  18161 ;
FSUB:   BIT 3,(IY+0)                    ;6e04  fd cb 00 5e  18017  18162 
    JP  Z,SSUB                          ;6e08  ca 83 6f     18018  18163 
FSUB1:  XOR A                           ;6e0b  af           18019  18164 
    CP  (HL)                            ;6e0c  be           18020  18165 
    JP  Z,NEGTIV                        ;6e0d  ca ce 6e     18021  18166 
    LD  A,(DE)                          ;6e10  1a           18022  18167 
    OR  A                               ;6e11  b7           18023  18168 
    RET Z                               ;6e12  c8           18024  18169 
    SUB (HL)                            ;6e13  96           18025  18170 
    JR  NC,SNSHIF                       ;6e14  30 0f        18026  18171 
    NEG                                 ;6e16  ed 44        18027  18172 
    CP  56                              ;6e18  fe 38        18028  18173 
    CCF                                 ;6e1a  3f           18029  18174 
    RET C                               ;6e1b  d8           18030  18175 
    LD  (HLBUF),HL                      ;6e1c  22 6a 6d     18031  18176 
    EX  DE,HL                           ;6e1f  eb           18032  18177 
    CALL    DSUB1                       ;6e20  cd 2d 6e     18033  18178 
    CCF                                 ;6e23  3f           18034  18179 
    RET                                 ;6e24  c9           18035  18180 
                                        ;                   18036  18181 ;
SNSHIF: CP  56                          ;6e25  fe 38        18037  18182 
    JP  NC,NEGTIV                       ;6e27  d2 ce 6e     18038  18183 
    LD  (HLBUF),HL                      ;6e2a  22 6a 6d     18039  18184 
DSUB1:  PUSH    AF                      ;6e2d  f5           18040  18185 
    PUSH    HL                          ;6e2e  e5           18041  18186 
    PUSH    DE                          ;6e2f  d5           18042  18187 
    LD  A,(DE)                          ;6e30  1a           18043  18188 
    CP  (HL)                            ;6e31  be           18044  18189 
    JR  NZ,NE_                          ;6e32  20 1d        18045  18190 
    INC DE                              ;6e34  13           18046  18191 
    INC HL                              ;6e35  23           18047  18192 
    LD  A,(DE)                          ;6e36  1a           18048  18193 
    SET 7,A                             ;6e37  cb ff        18049  18194 
    CP  (HL)                            ;6e39  be           18050  18195 
    JR  Z,CMPCON                        ;6e3a  28 05        18051  18196 
    RES 7,A                             ;6e3c  cb bf        18052  18197 
    CP  (HL)                            ;6e3e  be           18053  18198 
    JR  NZ,NE_                          ;6e3f  20 10        18054  18199 
CMPCON: INC HL                          ;6e41  23           18055  18200 
    INC DE                              ;6e42  13           18056  18201 
    LD  B,6                             ;6e43  06 06        18057  18202 
CMPL:   LD  A,(DE)                      ;6e45  1a           18058  18203 
    CP  (HL)                            ;6e46  be           18059  18204 
    JP  NZ,NE_                          ;6e47  c2 51 6e     18060  18205 
    INC HL                              ;6e4a  23           18061  18206 
    INC DE                              ;6e4b  13           18062  18207 
    DJNZ    CMPL                        ;6e4c  10 f7        18063  18208 
    JP  ZERO                            ;6e4e  c3 d8 6e     18064  18209 
NE_:    POP DE                          ;6e51  d1           18065  18210 
    POP HL                              ;6e52  e1           18066  18211 
    POP AF                              ;6e53  f1           18067  18212 
    CALL    FADD1                       ;6e54  cd 7f 6d     18068  18213 
    PUSH    IX                          ;6e57  dd e5        18069  18214 
    EX  (SP),HL                         ;6e59  e3           18070  18215 
    LD  A,H                             ;6e5a  7c           18071  18216 
    SUB D                               ;6e5b  92           18072  18217 
    LD  D,A                             ;6e5c  57           18073  18218 
    LD  A,L                             ;6e5d  7d           18074  18219 
    SBC A,E                             ;6e5e  9b           18075  18220 
    LD  E,A                             ;6e5f  5f           18076  18221 
    POP HL                              ;6e60  e1           18077  18222 
    EXX                                 ;6e61  d9           18078  18223 
    LD  A,B                             ;6e62  78           18079  18224 
    EXX                                 ;6e63  d9           18080  18225 
    SBC A,B                             ;6e64  98           18081  18226 
    LD  B,A                             ;6e65  47           18082  18227 
    EXX                                 ;6e66  d9           18083  18228 
    LD  A,C                             ;6e67  79           18084  18229 
    EXX                                 ;6e68  d9           18085  18230 
    SBC A,C                             ;6e69  99           18086  18231 
    LD  C,A                             ;6e6a  4f           18087  18232 
    EXX                                 ;6e6b  d9           18088  18233 
    LD  A,H                             ;6e6c  7c           18089  18234 
    EXX                                 ;6e6d  d9           18090  18235 
    SBC A,H                             ;6e6e  9c           18091  18236 
    LD  H,A                             ;6e6f  67           18092  18237 
    EXX                                 ;6e70  d9           18093  18238 
    LD  A,L                             ;6e71  7d           18094  18239 
    EXX                                 ;6e72  d9           18095  18240 
    SBC A,L                             ;6e73  9d           18096  18241 
    LD  L,A                             ;6e74  6f           18097  18242 
    EXX                                 ;6e75  d9           18098  18243 
    EX  AF,AF'                          ;6e76  08           18099  18244 
    LD  B,A                             ;6e77  47           18100  18245 
    EX  AF,AF'                          ;6e78  08           18101  18246 
    LD  A,D                             ;6e79  7a           18102  18247 
    SBC A,B                             ;6e7a  98           18103  18248 
    LD  D,A                             ;6e7b  57           18104  18249 
    LD  A,0B7h                          ;6e7c  3e b7        18105  18250 
    LD  (INST1),A                       ;6e7e  32 7c 6d     18106  18251 
    EXX                                 ;6e81  d9           18107  18252 
    CALL    C,MINUS                     ;6e82  dc a2 6e     18108  18253 
    EXX                                 ;6e85  d9           18109  18254 
DSSFL2: BIT 7,D                         ;6e86  cb 7a        18110  18255 
    JP  NZ,STORE1                       ;6e88  c2 66 6d     18111  18256 
    EXX                                 ;6e8b  d9           18112  18257 
    OR  A                               ;6e8c  b7           18113  18258 
    RL  D                               ;6e8d  cb 12        18114  18259 
    RL  E                               ;6e8f  cb 13        18115  18260 
    RL  B                               ;6e91  cb 10        18116  18261 
    RL  C                               ;6e93  cb 11        18117  18262 
    RL  H                               ;6e95  cb 14        18118  18263 
    RL  L                               ;6e97  cb 15        18119  18264 
    EXX                                 ;6e99  d9           18120  18265 
    RL  D                               ;6e9a  cb 12        18121  18266 
    DEC E                               ;6e9c  1d           18122  18267 
    JR  NZ,DSSFL2                       ;6e9d  20 e7        18123  18268 
    JP  STORE1                          ;6e9f  c3 66 6d     18124  18269 
                                        ;                   18125  18270 ;
MINUS:  EXX                             ;6ea2  d9           18126  18271 
    LD  A,03Fh                          ;6ea3  3e 3f        18127  18272 
    LD  (INST1),A                       ;6ea5  32 7c 6d     18128  18273 
    LD  A,D                             ;6ea8  7a           18129  18274 
    CPL                                 ;6ea9  2f           18130  18275 
    LD  D,A                             ;6eaa  57           18131  18276 
    EXX                                 ;6eab  d9           18132  18277 
    LD  A,D                             ;6eac  7a           18133  18278 
    CPL                                 ;6ead  2f           18134  18279 
    LD  D,A                             ;6eae  57           18135  18280 
    LD  A,E                             ;6eaf  7b           18136  18281 
    CPL                                 ;6eb0  2f           18137  18282 
    LD  E,A                             ;6eb1  5f           18138  18283 
    LD  A,B                             ;6eb2  78           18139  18284 
    CPL                                 ;6eb3  2f           18140  18285 
    LD  B,A                             ;6eb4  47           18141  18286 
    LD  A,C                             ;6eb5  79           18142  18287 
    CPL                                 ;6eb6  2f           18143  18288 
    LD  C,A                             ;6eb7  4f           18144  18289 
    LD  A,H                             ;6eb8  7c           18145  18290 
    CPL                                 ;6eb9  2f           18146  18291 
    LD  H,A                             ;6eba  67           18147  18292 
    LD  A,L                             ;6ebb  7d           18148  18293 
    CPL                                 ;6ebc  2f           18149  18294 
    LD  L,A                             ;6ebd  6f           18150  18295 
    INC D                               ;6ebe  14           18151  18296 
    RET NZ                              ;6ebf  c0           18152  18297 
    INC E                               ;6ec0  1c           18153  18298 
    RET NZ                              ;6ec1  c0           18154  18299 
    INC B                               ;6ec2  04           18155  18300 
    RET NZ                              ;6ec3  c0           18156  18301 
    INC C                               ;6ec4  0c           18157  18302 
    RET NZ                              ;6ec5  c0           18158  18303 
    INC H                               ;6ec6  24           18159  18304 
    RET NZ                              ;6ec7  c0           18160  18305 
    INC L                               ;6ec8  2c           18161  18306 
    RET NZ                              ;6ec9  c0           18162  18307 
    EXX                                 ;6eca  d9           18163  18308 
    INC D                               ;6ecb  14           18164  18309 
    EXX                                 ;6ecc  d9           18165  18310 
    RET                                 ;6ecd  c9           18166  18311 
                                        ;                   18167  18312 ;
NEGTIV: OR  A                           ;6ece  b7           18168  18313 
TRANS:  LD  C,(IY+0)                    ;6ecf  fd 4e 00     18169  18314 
    LD  B,0                             ;6ed2  06 00        18170  18315 
    EX  DE,HL                           ;6ed4  eb           18171  18316 
    LDIR                                ;6ed5  ed b0        18172  18317 
    RET                                 ;6ed7  c9           18173  18318 
                                        ;                   18174  18319 ;
ZERO:   POP DE                          ;6ed8  d1           18175  18320 
    POP HL                              ;6ed9  e1           18176  18321 
    POP AF                              ;6eda  f1           18177  18322 
ZERO':  LD  B,(IY+0)                    ;6edb  fd 46 00     18178  18323 
    XOR A                               ;6ede  af           18179  18324 
ZFILL0: LD  (HL),A                      ;6edf  77           18180  18325 
    INC HL                              ;6ee0  23           18181  18326 
    DJNZ    ZFILL0                      ;6ee1  10 fc        18182  18327 
    RET                                 ;6ee3  c9           18183  18328 
                                        ;                   18184  18329 ;
OVERFL1: LD A,6                         ;6ee4  3e 06        18185  18330 
    EI                                  ;6ee6  fb           18186  18331 
    JP  ERROR                           ;6ee7  c3 96 21     18187  18332 
                                        ;                   18188  18333 ;
SFADD:  XOR A                           ;6eea  af           18189  18334 
    CP  (HL)                            ;6eeb  be           18190  18335 
    JP  Z,TRANS                         ;6eec  ca cf 6e     18191  18336 
    LD  A,(DE)                          ;6eef  1a           18192  18337 
    OR  A                               ;6ef0  b7           18193  18338 
    RET Z                               ;6ef1  c8           18194  18339 
    SUB (HL)                            ;6ef2  96           18195  18340 
    JR  NC,SNSH                         ;6ef3  30 0c        18196  18341 
    NEG                                 ;6ef5  ed 44        18197  18342 
    CP  24                              ;6ef7  fe 18        18198  18343 
    RET NC                              ;6ef9  d0           18199  18344 
    LD  (SHLBUF),HL                     ;6efa  22 79 6f     18200  18345 
    EX  DE,HL                           ;6efd  eb           18201  18346 
    JP  SADD1                           ;6efe  c3 09 6f     18202  18347 
SNSH:   CP  24                          ;6f01  fe 18        18203  18348 
    JP  NC,TRANS                        ;6f03  d2 cf 6e     18204  18349 
    LD  (SHLBUF),HL                     ;6f06  22 79 6f     18205  18350 
SADD1:  LD  (SPBF),SP                   ;6f09  ed 73 5b 70  18206  18351 
    DI                                  ;6f0d  f3           18207  18352 
    LD  C,A                             ;6f0e  4f           18208  18353 
    AND 007h                            ;6f0f  e6 07        18209  18354 
    INC A                               ;6f11  3c           18210  18355 
    LD  B,A                             ;6f12  47           18211  18356 
    LD  A,C                             ;6f13  79           18212  18357 
    AND 038h                            ;6f14  e6 38        18213  18358 
    LD  C,A                             ;6f16  4f           18214  18359 
    LD  (SJVEC),A                       ;6f17  32 21 6f     18215  18360 
    LD  SP,HL                           ;6f1a  f9           18216  18361 
    EXX                                 ;6f1b  d9           18217  18362 
    POP DE                              ;6f1c  d1           18218  18363 
    SET 7,D                             ;6f1d  cb fa        18219  18364 
    POP HL                              ;6f1f  e1           18220  18365 
    DEFB    018H                        ;6f20  18           18221  18366 ;JR ?
SJVEC:  DEFS    1                       ;6f21               18222  18367 
    LD  C,0                             ;6f22  0e 00        18223  18368 
    JP  SCL0                            ;6f24  c3 37 6f     18224  18369 
    DEFS    3                           ;6f27               18225  18370 
    LD  C,H                             ;6f2a  4c           18226  18371 
    LD  H,L                             ;6f2b  65           18227  18372 
    LD  L,D                             ;6f2c  6a           18228  18373 
    XOR A                               ;6f2d  af           18229  18374 
    JP  SCL1                            ;6f2e  c3 36 6f     18230  18375 
    DEFS    1                           ;6f31               18231  18376 
    LD  C,L                             ;6f32  4d           18232  18377 
    LD  H,D                             ;6f33  62           18233  18378 
    XOR A                               ;6f34  af           18234  18379 
    LD  L,A                             ;6f35  6f           18235  18380 
SCL1:   LD  D,A                         ;6f36  57           18236  18381 
SCL0:   EXX                             ;6f37  d9           18237  18382 
    LD  A,C                             ;6f38  79           18238  18383 
    RRCA                                ;6f39  0f           18239  18384 
    RRCA                                ;6f3a  0f           18240  18385 
    ADD A,0F5h                          ;6f3b  c6 f5        18241  18386 
    LD  (SJVEC2),A                      ;6f3d  32 50 6f     18242  18387 
    LD  A,B                             ;6f40  78           18243  18388 
    EXX                                 ;6f41  d9           18244  18389 
    LD  B,A                             ;6f42  47           18245  18390 
    JP  SSIFST                          ;6f43  c3 4e 6f     18246  18391 
    RR  D                               ;6f46  cb 1a        18247  18392 
    RR  L                               ;6f48  cb 1d        18248  18393 
    RR  H                               ;6f4a  cb 1c        18249  18394 
    RR  C                               ;6f4c  cb 19        18250  18395 
SSIFST: OR  A                           ;6f4e  b7           18251  18396 
    DEFB    010H                        ;6f4f  10           18252  18397 ;DJNZ ?
SJVEC2: DEFS    1                       ;6f50               18253  18398 
    RL  C                               ;6f51  cb 11        18254  18399 
    EXX                                 ;6f53  d9           18255  18400 
    EX  DE,HL                           ;6f54  eb           18256  18401 
    LD  SP,HL                           ;6f55  f9           18257  18402 
    POP DE                              ;6f56  d1           18258  18403 
    SET 7,D                             ;6f57  cb fa        18259  18404 
    EXX                                 ;6f59  d9           18260  18405 
    POP BC                              ;6f5a  c1           18261  18406 
    LD  A,H                             ;6f5b  7c           18262  18407 
    ADC A,B                             ;6f5c  88           18263  18408 
    LD  H,A                             ;6f5d  67           18264  18409 
    LD  A,C                             ;6f5e  79           18265  18410 
    ADC A,L                             ;6f5f  8d           18266  18411 
    LD  L,A                             ;6f60  6f           18267  18412 
    EXX                                 ;6f61  d9           18268  18413 
    LD  A,D                             ;6f62  7a           18269  18414 
    EXX                                 ;6f63  d9           18270  18415 
    ADC A,D                             ;6f64  8a           18271  18416 
    LD  D,A                             ;6f65  57           18272  18417 
    EXX                                 ;6f66  d9           18273  18418 
    LD  A,E                             ;6f67  7b           18274  18419 
    EXX                                 ;6f68  d9           18275  18420 
    LD  E,A                             ;6f69  5f           18276  18421 
    JP  NC,SSTRE                        ;6f6a  d2 74 6f     18277  18422 
    RR  D                               ;6f6d  cb 1a        18278  18423 
    RR  L                               ;6f6f  cb 1d        18279  18424 
    RR  H                               ;6f71  cb 1c        18280  18425 
    INC E                               ;6f73  1c           18281  18426 
SSTRE:  EXX                             ;6f74  d9           18282  18427 
    LD  BC,00004h                       ;6f75  01 04 00     18283  18428 
    DEFB    021H                        ;6f78  21           18284  18429 ;LD HL,?
SHLBUF: DEFS    2                       ;6f79               18285  18430 
    ADD HL,BC                           ;6f7b  09           18286  18431 
    LD  SP,HL                           ;6f7c  f9           18287  18432 
    EXX                                 ;6f7d  d9           18288  18433 
    PUSH    HL                          ;6f7e  e5           18289  18434 
    PUSH    DE                          ;6f7f  d5           18290  18435 
    JP  FLEXIT                          ;6f80  c3 78 6d     18291  18436 
                                        ;                   18292  18437 ;
SSUB:   PUSH    HL                      ;6f83  e5           18293  18438 
    PUSH    DE                          ;6f84  d5           18294  18439 
    LD  A,(DE)                          ;6f85  1a           18295  18440 
    CP  (HL)                            ;6f86  be           18296  18441 
    JR  C,NSSUB0                        ;6f87  38 01        18297  18442 
    LD  A,(HL)                          ;6f89  7e           18298  18443 
NSSUB0: CP  080h                        ;6f8a  fe 80        18299  18444 
    LD  A,000h                          ;6f8c  3e 00        18300  18445 
    JR  NC,OSETER                       ;6f8e  30 10        18301  18446 
    PUSH    HL                          ;6f90  e5           18302  18447 
    INC HL                              ;6f91  23           18303  18448 
    INC HL                              ;6f92  23           18304  18449 
    INC HL                              ;6f93  23           18305  18450 
    LD  C,(HL)                          ;6f94  4e           18306  18451 
    POP HL                              ;6f95  e1           18307  18452 
    EX  DE,HL                           ;6f96  eb           18308  18453 
    INC HL                              ;6f97  23           18309  18454 
    INC HL                              ;6f98  23           18310  18455 
    INC HL                              ;6f99  23           18311  18456 
    LD  A,(HL)                          ;6f9a  7e           18312  18457 
    EX  DE,HL                           ;6f9b  eb           18313  18458 
    CP  C                               ;6f9c  b9           18314  18459 
    JR  C,OSETER                        ;6f9d  38 01        18315  18460 
    LD  A,C                             ;6f9f  79           18316  18461 
OSETER: LD  DE,WRKFC                    ;6fa0  11 93 73     18317  18462 
    LD  BC,00004h                       ;6fa3  01 04 00     18318  18463 
    LDIR                                ;6fa6  ed b0        18319  18464 
    LD  B,4                             ;6fa8  06 04        18320  18465 
ZFSSUB: LD  (DE),A                      ;6faa  12           18321  18466 
    INC DE                              ;6fab  13           18322  18467 
    DJNZ    ZFSSUB                      ;6fac  10 fc        18323  18468 
    POP DE                              ;6fae  d1           18324  18469 
    PUSH    DE                          ;6faf  d5           18325  18470 
    EX  DE,HL                           ;6fb0  eb           18326  18471 
    LD  DE,WRKFC1                       ;6fb1  11 9b 73     18327  18472 
    LD  BC,00004h                       ;6fb4  01 04 00     18328  18473 
    LDIR                                ;6fb7  ed b0        18329  18474 
    LD  B,4                             ;6fb9  06 04        18330  18475 
ZFSSU1: LD  (DE),A                      ;6fbb  12           18331  18476 
    INC DE                              ;6fbc  13           18332  18477 
    DJNZ    ZFSSU1                      ;6fbd  10 fc        18333  18478 
    LD  HL,WRKFC                        ;6fbf  21 93 73     18334  18479 
    LD  DE,WRKFC1                       ;6fc2  11 9b 73     18335  18480 
    DEC IY                              ;6fc5  fd 2b        18336  18481 
    LD  (IY+0),008h                     ;6fc7  fd 36 00 08  18337  18482 
    CALL    FSUB1                       ;6fcb  cd 0b 6e     18338  18483 
    INC IY                              ;6fce  fd 23        18339  18484 
    POP DE                              ;6fd0  d1           18340  18485 
    POP HL                              ;6fd1  e1           18341  18486 
    PUSH    HL                          ;6fd2  e5           18342  18487 
    PUSH    DE                          ;6fd3  d5           18343  18488 
    EX  DE,HL                           ;6fd4  eb           18344  18489 
    LD  HL,WRKFC                        ;6fd5  21 93 73     18345  18490 
    LD  BC,00004h                       ;6fd8  01 04 00     18346  18491 
    LDIR                                ;6fdb  ed b0        18347  18492 
    POP DE                              ;6fdd  d1           18348  18493 
    POP HL                              ;6fde  e1           18349  18494 
    RET                                 ;6fdf  c9           18350  18495 
                                        ;                   18351  18496 ;
MUL:    CALL    STROMT                  ;6fe0  cd c5 6b     18352  18497 
    DI                                  ;6fe3  f3           18353  18498 
    PUSH    DE                          ;6fe4  d5           18354  18499 
    PUSH    HL                          ;6fe5  e5           18355  18500 
    LD  (SPBF),SP                       ;6fe6  ed 73 5b 70  18356  18501 
    BIT 3,(IY+0)                        ;6fea  fd cb 00 5e  18357  18502 
    JP  NZ,DMUL                         ;6fee  c2 8e 71     18358  18503 
    LD  SP,HL                           ;6ff1  f9           18359  18504 
    LD  A,(DE)                          ;6ff2  1a           18360  18505 
    OR  A                               ;6ff3  b7           18361  18506 
    JP  Z,UNDRFL                        ;6ff4  ca ab 70     18362  18507 
    XOR A                               ;6ff7  af           18363  18508 
    EXX                                 ;6ff8  d9           18364  18509 
    POP DE                              ;6ff9  d1           18365  18510 
    SET 7,D                             ;6ffa  cb fa        18366  18511 
    CP  E                               ;6ffc  bb           18367  18512 
    JP  Z,UNDRFL                        ;6ffd  ca ab 70     18368  18513 
    POP HL                              ;7000  e1           18369  18514 
    EXX                                 ;7001  d9           18370  18515 
    EX  DE,HL                           ;7002  eb           18371  18516 
    LD  SP,HL                           ;7003  f9           18372  18517 
    POP DE                              ;7004  d1           18373  18518 
    SET 7,D                             ;7005  cb fa        18374  18519 
    CP  E                               ;7007  bb           18375  18520 
    JP  Z,UNDRFL                        ;7008  ca ab 70     18376  18521 
    POP HL                              ;700b  e1           18377  18522 
    LD  BC,05F00h                       ;700c  01 00 5f     18378  18523 
    LD  SP,WRKFC+6                      ;700f  31 99 73     18379  18524 
    PUSH    BC                          ;7012  c5           18380  18525 
    PUSH    BC                          ;7013  c5           18381  18526 
    LD  C,A                             ;7014  4f           18382  18527 
    LD  B,A                             ;7015  47           18383  18528 
    PUSH    BC                          ;7016  c5           18384  18529 
    EXX                                 ;7017  d9           18385  18530 
    PUSH    DE                          ;7018  d5           18386  18531 
    LD  E,A                             ;7019  5f           18387  18532 
    EXX                                 ;701a  d9           18388  18533 
    CP  H                               ;701b  bc           18389  18534 
    LD  IX,WRKFC+4                      ;701c  dd 21 97 73  18390  18535 
    JR  Z,SML1                          ;7020  28 04        18391  18536 
    LD  C,H                             ;7022  4c           18392  18537 
    CALL    SMULTS                      ;7023  cd 77 70     18393  18538 
SML1:   DEC IX                          ;7026  dd 2b        18394  18539 
    CP  L                               ;7028  bd           18395  18540 
    JR  Z,SML2                          ;7029  28 04        18396  18541 
    LD  C,L                             ;702b  4d           18397  18542 
    CALL    SMULTS                      ;702c  cd 77 70     18398  18543 
SML2:   DEC IX                          ;702f  dd 2b        18399  18544 
    LD  C,D                             ;7031  4a           18400  18545 
    CALL    SMULTS                      ;7032  cd 77 70     18401  18546 
    POP HL                              ;7035  e1           18402  18547 
    LD  A,E                             ;7036  7b           18403  18548 
    ADD A,L                             ;7037  85           18404  18549 
    LD  L,A                             ;7038  6f           18405  18550 
    LD  A,000h                          ;7039  3e 00        18406  18551 
    ADC A,A                             ;703b  8f           18407  18552 
    LD  H,A                             ;703c  67           18408  18553 
    POP BC                              ;703d  c1           18409  18554 
    POP DE                              ;703e  d1           18410  18555 
SMSF:   BIT 7,C                         ;703f  cb 79        18411  18556 
    JR  NZ,EXPCUL                       ;7041  20 09        18412  18557 
    RL  D                               ;7043  cb 12        18413  18558 
    RL  E                               ;7045  cb 13        18414  18559 
    RL  B                               ;7047  cb 10        18415  18560 
    RL  C                               ;7049  cb 11        18416  18561 
    DEC HL                              ;704b  2b           18417  18562 
EXPCUL: LD  A,L                         ;704c  7d           18418  18563 
    SUB 080h                            ;704d  d6 80        18419  18564 
    LD  L,A                             ;704f  6f           18420  18565 
    LD  A,H                             ;7050  7c           18421  18566 
    SBC A,000h                          ;7051  de 00        18422  18567 
    JP  C,UNDRFL                        ;7053  da ab 70     18423  18568 
    JP  NZ,OVERFL1                      ;7056  c2 e4 6e     18424  18569 
    LD  A,L                             ;7059  7d           18425  18570 
    DEFB    031H                        ;705a  31           18426  18571 ;LD SP,?
SPBF:   DEFS    2                       ;705b               18427  18572 
    POP HL                              ;705d  e1           18428  18573 
    LD  (HL),A                          ;705e  77           18429  18574 
    INC HL                              ;705f  23           18430  18575 
    LD  A,(HL)                          ;7060  7e           18431  18576 
    EX  (SP),HL                         ;7061  e3           18432  18577 
    INC HL                              ;7062  23           18433  18578 
    XOR (HL)                            ;7063  ae           18434  18579 
    DEC HL                              ;7064  2b           18435  18580 
    EX  (SP),HL                         ;7065  e3           18436  18581 
    DEC HL                              ;7066  2b           18437  18582 
    PUSH    HL                          ;7067  e5           18438  18583 
    INC HL                              ;7068  23           18439  18584 
    RLCA                                ;7069  07           18440  18585 
    JR  C,SMSTS                         ;706a  38 02        18441  18586 
    RES 7,C                             ;706c  cb b9        18442  18587 
SMSTS:  LD  (HL),C                      ;706e  71           18443  18588 
    INC HL                              ;706f  23           18444  18589 
    LD  (HL),B                          ;7070  70           18445  18590 
    INC HL                              ;7071  23           18446  18591 
    LD  (HL),E                          ;7072  73           18447  18592 
    POP HL                              ;7073  e1           18448  18593 
    POP DE                              ;7074  d1           18449  18594 
    EI                                  ;7075  fb           18450  18595 
    RET                                 ;7076  c9           18451  18596 
                                        ;                   18452  18597 ;
SMULTS: LD  B,8                         ;7077  06 08        18453  18598 
SMULTP: RR  C                           ;7079  cb 19        18454  18599 
    EXX                                 ;707b  d9           18455  18600 
    JP  NC,SMLP1                        ;707c  d2 94 70     18456  18601 
    LD  SP,IX                           ;707f  dd f9        18457  18602 
    POP BC                              ;7081  c1           18458  18603 
    PUSH    HL                          ;7082  e5           18459  18604 
    LD  A,H                             ;7083  7c           18460  18605 
    ADD A,B                             ;7084  80           18461  18606 
    LD  H,A                             ;7085  67           18462  18607 
    LD  A,L                             ;7086  7d           18463  18608 
    ADC A,C                             ;7087  89           18464  18609 
    LD  L,A                             ;7088  6f           18465  18610 
    EX  (SP),HL                         ;7089  e3           18466  18611 
    DEC SP                              ;708a  3b           18467  18612 
    DEC SP                              ;708b  3b           18468  18613 
    EX  (SP),HL                         ;708c  e3           18469  18614 
    LD  A,H                             ;708d  7c           18470  18615 
    ADC A,D                             ;708e  8a           18471  18616 
    LD  H,A                             ;708f  67           18472  18617 
    LD  A,L                             ;7090  7d           18473  18618 
    ADC A,E                             ;7091  8b           18474  18619 
    LD  L,A                             ;7092  6f           18475  18620 
    EX  (SP),HL                         ;7093  e3           18476  18621 
SMLP1:  OR  A                           ;7094  b7           18477  18622 
    RL  H                               ;7095  cb 14        18478  18623 
    RL  L                               ;7097  cb 15        18479  18624 
    RL  D                               ;7099  cb 12        18480  18625 
    RL  E                               ;709b  cb 13        18481  18626 
    EXX                                 ;709d  d9           18482  18627 
    DJNZ    SMULTP                      ;709e  10 d9        18483  18628 
    EXX                                 ;70a0  d9           18484  18629 
    LD  H,L                             ;70a1  65           18485  18630 
    LD  L,D                             ;70a2  6a           18486  18631 
    LD  D,E                             ;70a3  53           18487  18632 
    XOR A                               ;70a4  af           18488  18633 
    LD  E,A                             ;70a5  5f           18489  18634 
    EXX                                 ;70a6  d9           18490  18635 
    LD  SP,WRKFC-4                      ;70a7  31 8f 73     18491  18636 
    RET                                 ;70aa  c9           18492  18637 
                                        ;                   18493  18638 ;
UNDRFL: LD  SP,(SPBF)                   ;70ab  ed 7b 5b 70  18494  18639 
    POP HL                              ;70af  e1           18495  18640 
    PUSH    HL                          ;70b0  e5           18496  18641 
    CALL    ZERO'                       ;70b1  cd db 6e     18497  18642 
    POP HL                              ;70b4  e1           18498  18643 
    POP DE                              ;70b5  d1           18499  18644 
    EI                                  ;70b6  fb           18500  18645 
    RET                                 ;70b7  c9           18501  18646 
                                        ;                   18502  18647 ;
DVBYZR: LD  A,11                        ;70b8  3e 0b        18503  18648 
    JP  ERROR                           ;70ba  c3 96 21     18504  18649 
                                        ;                   18505  18650 ;
DIV:    CALL    STROMT                  ;70bd  cd c5 6b     18506  18651 
    DI                                  ;70c0  f3           18507  18652 
    XOR A                               ;70c1  af           18508  18653 
    PUSH    DE                          ;70c2  d5           18509  18654 
    PUSH    HL                          ;70c3  e5           18510  18655 
    LD  (SPBF),SP                       ;70c4  ed 73 5b 70  18511  18656 
    BIT 3,(IY+0)                        ;70c8  fd cb 00 5e  18512  18657 
    JP  NZ,DDIV                         ;70cc  c2 89 72     18513  18658 
    LD  SP,HL                           ;70cf  f9           18514  18659 
    EXX                                 ;70d0  d9           18515  18660 
    POP DE                              ;70d1  d1           18516  18661 
    SET 7,D                             ;70d2  cb fa        18517  18662 
    CP  E                               ;70d4  bb           18518  18663 
    JR  Z,UNDRFL                        ;70d5  28 d4        18519  18664 
    LD  E,A                             ;70d7  5f           18520  18665 
    POP HL                              ;70d8  e1           18521  18666 
    EXX                                 ;70d9  d9           18522  18667 
    EX  DE,HL                           ;70da  eb           18523  18668 
    LD  SP,HL                           ;70db  f9           18524  18669 
    POP DE                              ;70dc  d1           18525  18670 
    SET 7,D                             ;70dd  cb fa        18526  18671 
    CP  E                               ;70df  bb           18527  18672 
    JR  Z,DVBYZR                        ;70e0  28 d6        18528  18673 
    LD  E,A                             ;70e2  5f           18529  18674 
    POP HL                              ;70e3  e1           18530  18675 
    LD  SP,(SPBF)                       ;70e4  ed 7b 5b 70  18531  18676 
    LD  IX,WRKFC-1                      ;70e8  dd 21 92 73  18532  18677 
    LD  C,4                             ;70ec  0e 04        18533  18678 
SDLOP2: INC IX                          ;70ee  dd 23        18534  18679 
    LD  B,8                             ;70f0  06 08        18535  18680 
SDLOP1: EXX                             ;70f2  d9           18536  18681 
    RL  (IX+0)                          ;70f3  dd cb 00 16  18537  18682 
    LD  A,H                             ;70f7  7c           18538  18683 
    EXX                                 ;70f8  d9           18539  18684 
    SUB H                               ;70f9  94           18540  18685 
    EXX                                 ;70fa  d9           18541  18686 
    LD  H,A                             ;70fb  67           18542  18687 
    LD  A,L                             ;70fc  7d           18543  18688 
    EXX                                 ;70fd  d9           18544  18689 
    SBC A,L                             ;70fe  9d           18545  18690 
    EXX                                 ;70ff  d9           18546  18691 
    LD  L,A                             ;7100  6f           18547  18692 
    LD  A,D                             ;7101  7a           18548  18693 
    EXX                                 ;7102  d9           18549  18694 
    SBC A,D                             ;7103  9a           18550  18695 
    EXX                                 ;7104  d9           18551  18696 
    LD  D,A                             ;7105  57           18552  18697 
    LD  A,E                             ;7106  7b           18553  18698 
    EXX                                 ;7107  d9           18554  18699 
    SBC A,E                             ;7108  9b           18555  18700 
    EXX                                 ;7109  d9           18556  18701 
    LD  E,A                             ;710a  5f           18557  18702 
    SET 0,(IX+0)                        ;710b  dd cb 00 c6  18558  18703 
    JR  NC,SDCNT                        ;710f  30 18        18559  18704 
    RES 0,(IX+0)                        ;7111  dd cb 00 86  18560  18705 
    EXX                                 ;7115  d9           18561  18706 
    LD  A,H                             ;7116  7c           18562  18707 
    EXX                                 ;7117  d9           18563  18708 
    ADD A,H                             ;7118  84           18564  18709 
    LD  H,A                             ;7119  67           18565  18710 
    EXX                                 ;711a  d9           18566  18711 
    LD  A,L                             ;711b  7d           18567  18712 
    EXX                                 ;711c  d9           18568  18713 
    ADC A,L                             ;711d  8d           18569  18714 
    LD  L,A                             ;711e  6f           18570  18715 
    EXX                                 ;711f  d9           18571  18716 
    LD  A,D                             ;7120  7a           18572  18717 
    EXX                                 ;7121  d9           18573  18718 
    ADC A,D                             ;7122  8a           18574  18719 
    LD  D,A                             ;7123  57           18575  18720 
    EXX                                 ;7124  d9           18576  18721 
    LD  A,E                             ;7125  7b           18577  18722 
    EXX                                 ;7126  d9           18578  18723 
    ADC A,E                             ;7127  8b           18579  18724 
    LD  E,A                             ;7128  5f           18580  18725 
SDCNT:  SLA H                           ;7129  cb 24        18581  18726 
    RL  L                               ;712b  cb 15        18582  18727 
    RL  D                               ;712d  cb 12        18583  18728 
    RL  E                               ;712f  cb 13        18584  18729 
    EXX                                 ;7131  d9           18585  18730 
    DJNZ    SDLOP1                      ;7132  10 be        18586  18731 
    DEC C                               ;7134  0d           18587  18732 
    JR  NZ,SDLOP2                       ;7135  20 b7        18588  18733 
    LD  HL,WRKFC+3                      ;7137  21 96 73     18589  18734 
    LD  A,067h                          ;713a  3e 67        18590  18735 
    ADD A,(HL)                          ;713c  86           18591  18736 
    LD  (HL),A                          ;713d  77           18592  18737 
    LD  B,3                             ;713e  06 03        18593  18738 
ADLP:   DEC HL                          ;7140  2b           18594  18739 
    LD  A,0                             ;7141  3e 00        18595  18740 
    ADC A,(HL)                          ;7143  8e           18596  18741 
    LD  (HL),A                          ;7144  77           18597  18742 
    DJNZ    ADLP                        ;7145  10 f9        18598  18743 
    XOR A                               ;7147  af           18599  18744 
    BIT 7,(HL)                          ;7148  cb 7e        18600  18745 
    JR  NZ,SDEXPC                       ;714a  20 0d        18601  18746 
    LD  HL,WRKFC+3                      ;714c  21 96 73     18602  18747 
    RL  (HL)                            ;714f  cb 16        18603  18748 
    LD  B,003h                          ;7151  06 03        18604  18749 
NOSDLP: DEC HL                          ;7153  2b           18605  18750 
    RL  (HL)                            ;7154  cb 16        18606  18751 
    DJNZ    NOSDLP                      ;7156  10 fb        18607  18752 
    SCF                                 ;7158  37           18608  18753 
SDEXPC: POP HL                          ;7159  e1           18609  18754 
    POP DE                              ;715a  d1           18610  18755 
    PUSH    DE                          ;715b  d5           18611  18756 
    PUSH    HL                          ;715c  e5           18612  18757 
    LD  A,(HL)                          ;715d  7e           18613  18758 
    CCF                                 ;715e  3f           18614  18759 
    ADC A,080h                          ;715f  ce 80        18615  18760 
    LD  C,A                             ;7161  4f           18616  18761 
    LD  A,0                             ;7162  3e 00        18617  18762 
    ADC A,A                             ;7164  8f           18618  18763 
    LD  B,A                             ;7165  47           18619  18764 
    EX  DE,HL                           ;7166  eb           18620  18765 
    LD  A,C                             ;7167  79           18621  18766 
    SUB (HL)                            ;7168  96           18622  18767 
    EX  DE,HL                           ;7169  eb           18623  18768 
    LD  C,A                             ;716a  4f           18624  18769 
    LD  A,B                             ;716b  78           18625  18770 
    SBC A,0                             ;716c  de 00        18626  18771 
    JP  C,UNDRFL                        ;716e  da ab 70     18627  18772 
    JP  NZ,OVERFL1                      ;7171  c2 e4 6e     18628  18773 
    LD  (HL),C                          ;7174  71           18629  18774 
    INC HL                              ;7175  23           18630  18775 
    INC DE                              ;7176  13           18631  18776 
    LD  A,(DE)                          ;7177  1a           18632  18777 
    XOR (HL)                            ;7178  ae           18633  18778 
    RLCA                                ;7179  07           18634  18779 
    LD  B,3                             ;717a  06 03        18635  18780 
DDTRL:  LD  DE,WRKFC                    ;717c  11 93 73     18636  18781 
SDTRL:  LD  A,(DE)                      ;717f  1a           18637  18782 
    LD  (HL),A                          ;7180  77           18638  18783 
    INC HL                              ;7181  23           18639  18784 
    INC DE                              ;7182  13           18640  18785 
    DJNZ    SDTRL                       ;7183  10 fa        18641  18786 
    POP HL                              ;7185  e1           18642  18787 
    JR  C,SDMIN                         ;7186  38 03        18643  18788 
    CALL    RESNHL                      ;7188  cd c0 6b     18644  18789 
SDMIN:  POP DE                          ;718b  d1           18645  18790 
    EI                                  ;718c  fb           18646  18791 
    RET                                 ;718d  c9           18647  18792 
                                        ;                   18648  18793 ;
DMUL:   LD  SP,HL                       ;718e  f9           18649  18794 
    LD  A,(DE)                          ;718f  1a           18650  18795 
    OR  A                               ;7190  b7           18651  18796 
    JP  Z,UNDRFL                        ;7191  ca ab 70     18652  18797 
    XOR A                               ;7194  af           18653  18798 
    EXX                                 ;7195  d9           18654  18799 
    POP DE                              ;7196  d1           18655  18800 
    SET 7,D                             ;7197  cb fa        18656  18801 
    CP  E                               ;7199  bb           18657  18802 
    JP  Z,UNDRFL                        ;719a  ca ab 70     18658  18803 
    LD  E,A                             ;719d  5f           18659  18804 
    POP BC                              ;719e  c1           18660  18805 
    POP HL                              ;719f  e1           18661  18806 
    POP IX                              ;71a0  dd e1        18662  18807 
    EXX                                 ;71a2  d9           18663  18808 
    LD  SP,WRKFC+14                     ;71a3  31 a1 73     18664  18809 
    LD  BC,05F00h                       ;71a6  01 00 5f     18665  18810 
    PUSH    BC                          ;71a9  c5           18666  18811 
    PUSH    BC                          ;71aa  c5           18667  18812 
    PUSH    BC                          ;71ab  c5           18668  18813 
    PUSH    BC                          ;71ac  c5           18669  18814 
    LD  B,A                             ;71ad  47           18670  18815 
    PUSH    BC                          ;71ae  c5           18671  18816 
    PUSH    BC                          ;71af  c5           18672  18817 
    PUSH    BC                          ;71b0  c5           18673  18818 
    LD  SP,(SPBF)                       ;71b1  ed 7b 5b 70  18674  18819 
    EX  DE,HL                           ;71b5  eb           18675  18820 
    LD  B,6                             ;71b6  06 06        18676  18821 
    LD  DE,00007h                       ;71b8  11 07 00     18677  18822 
    ADD HL,DE                           ;71bb  19           18678  18823 
    LD  DE,WRKFC+13                     ;71bc  11 a0 73     18679  18824 
DMULLP: CALL    BLCKAD                  ;71bf  cd 13 72     18680  18825 
    DEC DE                              ;71c2  1b           18681  18826 
    DEC HL                              ;71c3  2b           18682  18827 
    DJNZ    DMULLP                      ;71c4  10 f9        18683  18828 
    LD  A,(HL)                          ;71c6  7e           18684  18829 
    SET 7,A                             ;71c7  cb ff        18685  18830 
    CALL    BLCKA1                      ;71c9  cd 16 72     18686  18831 
    LD  HL,WRKFC                        ;71cc  21 93 73     18687  18832 
    BIT 7,(HL)                          ;71cf  cb 7e        18688  18833 
    SCF                                 ;71d1  37           18689  18834 
    JR  NZ,DMNOSH                       ;71d2  20 0b        18690  18835 
    LD  HL,WRKFC+7                      ;71d4  21 9a 73     18691  18836 
    LD  B,008h                          ;71d7  06 08        18692  18837 
DMSFL:  RL  (HL)                        ;71d9  cb 16        18693  18838 
    DEC HL                              ;71db  2b           18694  18839 
    DJNZ    DMSFL                       ;71dc  10 fb        18695  18840 
    OR  A                               ;71de  b7           18696  18841 
DMNOSH: POP HL                          ;71df  e1           18697  18842 
    POP DE                              ;71e0  d1           18698  18843 
    PUSH    DE                          ;71e1  d5           18699  18844 
    PUSH    HL                          ;71e2  e5           18700  18845 
    LD  A,(DE)                          ;71e3  1a           18701  18846 
    LD  C,A                             ;71e4  4f           18702  18847 
    ADC A,(HL)                          ;71e5  8e           18703  18848 
    LD  C,A                             ;71e6  4f           18704  18849 
    LD  A,0                             ;71e7  3e 00        18705  18850 
    ADC A,A                             ;71e9  8f           18706  18851 
    LD  B,A                             ;71ea  47           18707  18852 
    LD  A,C                             ;71eb  79           18708  18853 
    SUB 081h                            ;71ec  d6 81        18709  18854 
    LD  C,A                             ;71ee  4f           18710  18855 
    LD  A,B                             ;71ef  78           18711  18856 
    SBC A,0                             ;71f0  de 00        18712  18857 
    JP  M,UNDRFL                        ;71f2  fa ab 70     18713  18858 
    JP  NZ,OVERFL1                      ;71f5  c2 e4 6e     18714  18859 
    LD  (HL),C                          ;71f8  71           18715  18860 
    INC DE                              ;71f9  13           18716  18861 
    INC HL                              ;71fa  23           18717  18862 
    LD  A,(DE)                          ;71fb  1a           18718  18863 
    XOR (HL)                            ;71fc  ae           18719  18864 
    RLCA                                ;71fd  07           18720  18865 
    LD  DE,WRKFC                        ;71fe  11 93 73     18721  18866 
    JR  C,SMSKP1                        ;7201  38 04        18722  18867 
    EX  DE,HL                           ;7203  eb           18723  18868 
    RES 7,(HL)                          ;7204  cb be        18724  18869 
    EX  DE,HL                           ;7206  eb           18725  18870 
SMSKP1: LD  B,007h                      ;7207  06 07        18726  18871 
DMTRL:  LD  A,(DE)                      ;7209  1a           18727  18872 
    LD  (HL),A                          ;720a  77           18728  18873 
    INC DE                              ;720b  13           18729  18874 
    INC HL                              ;720c  23           18730  18875 
    DJNZ    DMTRL                       ;720d  10 fa        18731  18876 
    POP HL                              ;720f  e1           18732  18877 
    POP DE                              ;7210  d1           18733  18878 
    EI                                  ;7211  fb           18734  18879 
    RET                                 ;7212  c9           18735  18880 
                                        ;                   18736  18881 ;
BLCKAD: LD  A,(HL)                      ;7213  7e           18737  18882 
    OR  A                               ;7214  b7           18738  18883 
    RET Z                               ;7215  c8           18739  18884 
BLCKA1: PUSH    HL                      ;7216  e5           18740  18885 
    PUSH    BC                          ;7217  c5           18741  18886 
    PUSH    DE                          ;7218  d5           18742  18887 
    LD  B,8                             ;7219  06 08        18743  18888 
BLADLP: RRCA                            ;721b  0f           18744  18889 
    PUSH    AF                          ;721c  f5           18745  18890 
    JP  NC,DMSKIP                       ;721d  d2 54 72     18746  18891 
    LD  A,(DE)                          ;7220  1a           18747  18892 
    PUSH    IX                          ;7221  dd e5        18748  18893 
    EX  (SP),HL                         ;7223  e3           18749  18894 
    ADD A,H                             ;7224  84           18750  18895 
    LD  (DE),A                          ;7225  12           18751  18896 
    DEC DE                              ;7226  1b           18752  18897 
    LD  A,(DE)                          ;7227  1a           18753  18898 
    ADC A,L                             ;7228  8d           18754  18899 
    LD  (DE),A                          ;7229  12           18755  18900 
    POP HL                              ;722a  e1           18756  18901 
    DEC DE                              ;722b  1b           18757  18902 
    LD  A,(DE)                          ;722c  1a           18758  18903 
    EXX                                 ;722d  d9           18759  18904 
    ADC A,H                             ;722e  8c           18760  18905 
    EXX                                 ;722f  d9           18761  18906 
    LD  (DE),A                          ;7230  12           18762  18907 
    DEC DE                              ;7231  1b           18763  18908 
    LD  A,(DE)                          ;7232  1a           18764  18909 
    EXX                                 ;7233  d9           18765  18910 
    ADC A,L                             ;7234  8d           18766  18911 
    EXX                                 ;7235  d9           18767  18912 
    LD  (DE),A                          ;7236  12           18768  18913 
    DEC DE                              ;7237  1b           18769  18914 
    LD  A,(DE)                          ;7238  1a           18770  18915 
    EXX                                 ;7239  d9           18771  18916 
    ADC A,B                             ;723a  88           18772  18917 
    EXX                                 ;723b  d9           18773  18918 
    LD  (DE),A                          ;723c  12           18774  18919 
    DEC DE                              ;723d  1b           18775  18920 
    LD  A,(DE)                          ;723e  1a           18776  18921 
    EXX                                 ;723f  d9           18777  18922 
    ADC A,C                             ;7240  89           18778  18923 
    EXX                                 ;7241  d9           18779  18924 
    LD  (DE),A                          ;7242  12           18780  18925 
    DEC DE                              ;7243  1b           18781  18926 
    LD  A,(DE)                          ;7244  1a           18782  18927 
    EXX                                 ;7245  d9           18783  18928 
    ADC A,D                             ;7246  8a           18784  18929 
    EXX                                 ;7247  d9           18785  18930 
    LD  (DE),A                          ;7248  12           18786  18931 
    DEC DE                              ;7249  1b           18787  18932 
    LD  A,(DE)                          ;724a  1a           18788  18933 
    EXX                                 ;724b  d9           18789  18934 
    ADC A,E                             ;724c  8b           18790  18935 
    EXX                                 ;724d  d9           18791  18936 
    LD  (DE),A                          ;724e  12           18792  18937 
    DEC DE                              ;724f  1b           18793  18938 
    LD  A,(DE)                          ;7250  1a           18794  18939 
    ADC A,0                             ;7251  ce 00        18795  18940 
    LD  (DE),A                          ;7253  12           18796  18941 
                                        ;                   18797  18942 ;
DMSKIP: EXX                             ;7254  d9           18798  18943 
    PUSH    IX                          ;7255  dd e5        18799  18944 
    EX  (SP),HL                         ;7257  e3           18800  18945 
    LD  A,H                             ;7258  7c           18801  18946 
    ADD A,A                             ;7259  87           18802  18947 
    LD  H,A                             ;725a  67           18803  18948 
    LD  A,L                             ;725b  7d           18804  18949 
    RLA                                 ;725c  17           18805  18950 
    LD  L,A                             ;725d  6f           18806  18951 
    EX  (SP),HL                         ;725e  e3           18807  18952 
    POP IX                              ;725f  dd e1        18808  18953 
    RL  H                               ;7261  cb 14        18809  18954 
    RL  L                               ;7263  cb 15        18810  18955 
    RL  B                               ;7265  cb 10        18811  18956 
    RL  C                               ;7267  cb 11        18812  18957 
    RL  D                               ;7269  cb 12        18813  18958 
    RL  E                               ;726b  cb 13        18814  18959 
    EXX                                 ;726d  d9           18815  18960 
    POP AF                              ;726e  f1           18816  18961 
    POP DE                              ;726f  d1           18817  18962 
    PUSH    DE                          ;7270  d5           18818  18963 
    DJNZ    BLADLP                      ;7271  10 a8        18819  18964 
    EXX                                 ;7273  d9           18820  18965 
    LD  A,H                             ;7274  7c           18821  18966 
    PUSH    IX                          ;7275  dd e5        18822  18967 
    EX  (SP),HL                         ;7277  e3           18823  18968 
    LD  H,L                             ;7278  65           18824  18969 
    LD  L,A                             ;7279  6f           18825  18970 
    EX  (SP),HL                         ;727a  e3           18826  18971 
    POP IX                              ;727b  dd e1        18827  18972 
    LD  H,L                             ;727d  65           18828  18973 
    LD  L,B                             ;727e  68           18829  18974 
    LD  B,C                             ;727f  41           18830  18975 
    LD  C,D                             ;7280  4a           18831  18976 
    LD  D,E                             ;7281  53           18832  18977 
    LD  E,0                             ;7282  1e 00        18833  18978 
    EXX                                 ;7284  d9           18834  18979 
    POP DE                              ;7285  d1           18835  18980 
    POP BC                              ;7286  c1           18836  18981 
    POP HL                              ;7287  e1           18837  18982 
    RET                                 ;7288  c9           18838  18983 
                                        ;                   18839  18984 ;
DDIV:   LD  SP,HL                       ;7289  f9           18840  18985 
    EXX                                 ;728a  d9           18841  18986 
    POP DE                              ;728b  d1           18842  18987 
    SET 7,D                             ;728c  cb fa        18843  18988 
    CP  E                               ;728e  bb           18844  18989 
    JP  Z,UNDRFL                        ;728f  ca ab 70     18845  18990 
    LD  E,A                             ;7292  5f           18846  18991 
    POP BC                              ;7293  c1           18847  18992 
    POP HL                              ;7294  e1           18848  18993 
    POP IX                              ;7295  dd e1        18849  18994 
    EXX                                 ;7297  d9           18850  18995 
    EX  DE,HL                           ;7298  eb           18851  18996 
    LD  SP,(SPBF)                       ;7299  ed 7b 5b 70  18852  18997 
    CP  (HL)                            ;729d  be           18853  18998 
    JP  Z,DVBYZR                        ;729e  ca b8 70     18854  18999 
    LD  DE,00007h                       ;72a1  11 07 00     18855  19000 
    ADD HL,DE                           ;72a4  19           18856  19001 
    EX  DE,HL                           ;72a5  eb           18857  19002 
    LD  HL,WRKFC-1                      ;72a6  21 92 73     18858  19003 
    LD  C,8                             ;72a9  0e 08        18859  19004 
DDLOP2: INC HL                          ;72ab  23           18860  19005 
    LD  B,8                             ;72ac  06 08        18861  19006 
DDLOP1: RL  (HL)                        ;72ae  cb 16        18862  19007 
    PUSH    DE                          ;72b0  d5           18863  19008 
    EX  DE,HL                           ;72b1  eb           18864  19009 
    PUSH    BC                          ;72b2  c5           18865  19010 
    PUSH    IX                          ;72b3  dd e5        18866  19011 
    POP BC                              ;72b5  c1           18867  19012 
    LD  A,B                             ;72b6  78           18868  19013 
    SUB (HL)                            ;72b7  96           18869  19014 
    LD  B,A                             ;72b8  47           18870  19015 
    DEC HL                              ;72b9  2b           18871  19016 
    LD  A,C                             ;72ba  79           18872  19017 
    SBC A,(HL)                          ;72bb  9e           18873  19018 
    LD  C,A                             ;72bc  4f           18874  19019 
    PUSH    BC                          ;72bd  c5           18875  19020 
    POP IX                              ;72be  dd e1        18876  19021 
    POP BC                              ;72c0  c1           18877  19022 
    DEC HL                              ;72c1  2b           18878  19023 
    EXX                                 ;72c2  d9           18879  19024 
    LD  A,H                             ;72c3  7c           18880  19025 
    EXX                                 ;72c4  d9           18881  19026 
    SBC A,(HL)                          ;72c5  9e           18882  19027 
    EXX                                 ;72c6  d9           18883  19028 
    LD  H,A                             ;72c7  67           18884  19029 
    LD  A,L                             ;72c8  7d           18885  19030 
    EXX                                 ;72c9  d9           18886  19031 
    DEC HL                              ;72ca  2b           18887  19032 
    SBC A,(HL)                          ;72cb  9e           18888  19033 
    EXX                                 ;72cc  d9           18889  19034 
    LD  L,A                             ;72cd  6f           18890  19035 
    LD  A,B                             ;72ce  78           18891  19036 
    EXX                                 ;72cf  d9           18892  19037 
    DEC HL                              ;72d0  2b           18893  19038 
    SBC A,(HL)                          ;72d1  9e           18894  19039 
    EXX                                 ;72d2  d9           18895  19040 
    LD  B,A                             ;72d3  47           18896  19041 
    LD  A,C                             ;72d4  79           18897  19042 
    EXX                                 ;72d5  d9           18898  19043 
    DEC HL                              ;72d6  2b           18899  19044 
    SBC A,(HL)                          ;72d7  9e           18900  19045 
    EXX                                 ;72d8  d9           18901  19046 
    LD  C,A                             ;72d9  4f           18902  19047 
    LD  A,D                             ;72da  7a           18903  19048 
    EXX                                 ;72db  d9           18904  19049 
    DEC HL                              ;72dc  2b           18905  19050 
    PUSH    BC                          ;72dd  c5           18906  19051 
    LD  C,(HL)                          ;72de  4e           18907  19052 
    SET 7,C                             ;72df  cb f9        18908  19053 
    SBC A,C                             ;72e1  99           18909  19054 
    POP BC                              ;72e2  c1           18910  19055 
    EXX                                 ;72e3  d9           18911  19056 
    LD  D,A                             ;72e4  57           18912  19057 
    LD  A,E                             ;72e5  7b           18913  19058 
    SBC A,0                             ;72e6  de 00        18914  19059 
    LD  E,A                             ;72e8  5f           18915  19060 
    EXX                                 ;72e9  d9           18916  19061 
    EX  DE,HL                           ;72ea  eb           18917  19062 
    POP DE                              ;72eb  d1           18918  19063 
    PUSH    DE                          ;72ec  d5           18919  19064 
    SET 0,(HL)                          ;72ed  cb c6        18920  19065 
    JR  NC,DDCNT                        ;72ef  30 37        18921  19066 
    RES 0,(HL)                          ;72f1  cb 86        18922  19067 
    EX  DE,HL                           ;72f3  eb           18923  19068 
    PUSH    BC                          ;72f4  c5           18924  19069 
    PUSH    IX                          ;72f5  dd e5        18925  19070 
    POP BC                              ;72f7  c1           18926  19071 
    LD  A,B                             ;72f8  78           18927  19072 
    ADD A,(HL)                          ;72f9  86           18928  19073 
    LD  B,A                             ;72fa  47           18929  19074 
    DEC HL                              ;72fb  2b           18930  19075 
    LD  A,C                             ;72fc  79           18931  19076 
    ADC A,(HL)                          ;72fd  8e           18932  19077 
    LD  C,A                             ;72fe  4f           18933  19078 
    PUSH    BC                          ;72ff  c5           18934  19079 
    POP IX                              ;7300  dd e1        18935  19080 
    POP BC                              ;7302  c1           18936  19081 
    DEC HL                              ;7303  2b           18937  19082 
    LD  A,(HL)                          ;7304  7e           18938  19083 
    EXX                                 ;7305  d9           18939  19084 
    ADC A,H                             ;7306  8c           18940  19085 
    LD  H,A                             ;7307  67           18941  19086 
    EXX                                 ;7308  d9           18942  19087 
    DEC HL                              ;7309  2b           18943  19088 
    LD  A,(HL)                          ;730a  7e           18944  19089 
    EXX                                 ;730b  d9           18945  19090 
    ADC A,L                             ;730c  8d           18946  19091 
    LD  L,A                             ;730d  6f           18947  19092 
    EXX                                 ;730e  d9           18948  19093 
    DEC HL                              ;730f  2b           18949  19094 
    LD  A,(HL)                          ;7310  7e           18950  19095 
    EXX                                 ;7311  d9           18951  19096 
    ADC A,B                             ;7312  88           18952  19097 
    LD  B,A                             ;7313  47           18953  19098 
    EXX                                 ;7314  d9           18954  19099 
    DEC HL                              ;7315  2b           18955  19100 
    LD  A,(HL)                          ;7316  7e           18956  19101 
    EXX                                 ;7317  d9           18957  19102 
    ADC A,C                             ;7318  89           18958  19103 
    LD  C,A                             ;7319  4f           18959  19104 
    EXX                                 ;731a  d9           18960  19105 
    DEC HL                              ;731b  2b           18961  19106 
    LD  A,(HL)                          ;731c  7e           18962  19107 
    EXX                                 ;731d  d9           18963  19108 
    SET 7,A                             ;731e  cb ff        18964  19109 
    ADC A,D                             ;7320  8a           18965  19110 
    LD  D,A                             ;7321  57           18966  19111 
    LD  A,E                             ;7322  7b           18967  19112 
    ADC A,0                             ;7323  ce 00        18968  19113 
    LD  E,A                             ;7325  5f           18969  19114 
    EXX                                 ;7326  d9           18970  19115 
    EX  DE,HL                           ;7327  eb           18971  19116 
DDCNT:  POP DE                          ;7328  d1           18972  19117 
    PUSH    IX                          ;7329  dd e5        18973  19118 
    EX  (SP),HL                         ;732b  e3           18974  19119 
    SLA H                               ;732c  cb 24        18975  19120 
    RL  L                               ;732e  cb 15        18976  19121 
    EX  (SP),HL                         ;7330  e3           18977  19122 
    POP IX                              ;7331  dd e1        18978  19123 
    EXX                                 ;7333  d9           18979  19124 
    RL  H                               ;7334  cb 14        18980  19125 
    RL  L                               ;7336  cb 15        18981  19126 
    RL  B                               ;7338  cb 10        18982  19127 
    RL  C                               ;733a  cb 11        18983  19128 
    RL  D                               ;733c  cb 12        18984  19129 
    RL  E                               ;733e  cb 13        18985  19130 
    EXX                                 ;7340  d9           18986  19131 
    DEC B                               ;7341  05           18987  19132 
    JP  NZ,DDLOP1                       ;7342  c2 ae 72     18988  19133 
    DEC C                               ;7345  0d           18989  19134 
    JP  NZ,DDLOP2                       ;7346  c2 ab 72     18990  19135 
    LD  HL,WRKFC+7                      ;7349  21 9a 73     18991  19136 
    LD  A,067h                          ;734c  3e 67        18992  19137 
    ADD A,(HL)                          ;734e  86           18993  19138 
    LD  (HL),A                          ;734f  77           18994  19139 
    LD  B,007h                          ;7350  06 07        18995  19140 
DDADLP: DEC HL                          ;7352  2b           18996  19141 
    LD  A,000h                          ;7353  3e 00        18997  19142 
    ADC A,(HL)                          ;7355  8e           18998  19143 
    LD  (HL),A                          ;7356  77           18999  19144 
    DJNZ    DDADLP                      ;7357  10 f9        19000  19145 
    XOR A                               ;7359  af           19001  19146 
    BIT 7,(HL)                          ;735a  cb 7e        19002  19147 
    JR  NZ,DDEXPC                       ;735c  20 0b        19003  19148 
    LD  HL,WRKFC+8                      ;735e  21 9b 73     19004  19149 
    LD  B,8                             ;7361  06 08        19005  19150 
DDNSLP: DEC HL                          ;7363  2b           19006  19151 
    RL  (HL)                            ;7364  cb 16        19007  19152 
    DJNZ    DDNSLP                      ;7366  10 fb        19008  19153 
    SCF                                 ;7368  37           19009  19154 
DDEXPC: POP HL                          ;7369  e1           19010  19155 
    POP DE                              ;736a  d1           19011  19156 
    PUSH    DE                          ;736b  d5           19012  19157 
    PUSH    HL                          ;736c  e5           19013  19158 
    LD  A,(HL)                          ;736d  7e           19014  19159 
    CCF                                 ;736e  3f           19015  19160 
    ADC A,080h                          ;736f  ce 80        19016  19161 
    LD  C,A                             ;7371  4f           19017  19162 
    LD  A,0                             ;7372  3e 00        19018  19163 
    ADC A,A                             ;7374  8f           19019  19164 
    LD  B,A                             ;7375  47           19020  19165 
    EX  DE,HL                           ;7376  eb           19021  19166 
    LD  A,C                             ;7377  79           19022  19167 
    SUB (HL)                            ;7378  96           19023  19168 
    EX  DE,HL                           ;7379  eb           19024  19169 
    LD  C,A                             ;737a  4f           19025  19170 
    LD  A,B                             ;737b  78           19026  19171 
    SBC A,0                             ;737c  de 00        19027  19172 
    JP  C,UNDRFL                        ;737e  da ab 70     19028  19173 
    JP  NZ,OVERFL1                      ;7381  c2 e4 6e     19029  19174 
    LD  (HL),C                          ;7384  71           19030  19175 
    INC HL                              ;7385  23           19031  19176 
    INC DE                              ;7386  13           19032  19177 
    LD  A,(DE)                          ;7387  1a           19033  19178 
    XOR (HL)                            ;7388  ae           19034  19179 
    RLCA                                ;7389  07           19035  19180 
    LD  B,7                             ;738a  06 07        19036  19181 
    JP  DDTRL                           ;738c  c3 7c 71     19037  19182 
                                        ;                   19038  19183 ;
    DEFS    4                           ;738f               19039  19184 
WRKFC:  DEFS    8                       ;7393               19040  19185 
WRKFC1: DEFS    8                       ;739b               19041  19186 
                                        ;                   19042  19187 ;    ORG 073A3H
LDIR1:      LD  HL,FLONE                ;73a3  21 98 62     19043  19188 ;!b
LDIR8:      LD  BC,00008h               ;73a6  01 08 00     19044  19189 ;
            LDIR                        ;73a9  ed b0        19045  19190 ;
            RET                         ;73ab  c9           19046  19191 ;
                                        ;                   19047  19192 
ONEADD:     LD  DE,FLONE                ;73ac  11 98 62     19048  19193 ;b
            JP  ADD                     ;73af  c3 a6 6c     19049  19194 ;l
L073B2h:    EX  DE,HL                   ;73b2  eb           19050  19195 ;
            LD  HL,00008h               ;73b3  21 08 00     19051  19196 ;!
            ADD HL,DE                   ;73b6  19           19052  19197 ;
            EX  DE,HL                   ;73b7  eb           19053  19198 ;
            RET                         ;73b8  c9           19054  19199 ;
                                        ;                   19055  19200 
B_SQR:      XOR A                       ;73b9  af           19056  19201 ;
            CP  (HL)                    ;73ba  be           19057  19202 ;
            RET Z                       ;73bb  c8           19058  19203 ;
            INC HL                      ;73bc  23           19059  19204 ;#
            BIT 7,(HL)                  ;73bd  cb 7e        19060  19205 ;~
            DEC HL                      ;73bf  2b           19061  19206 ;+
            JP  NZ,IFCALL               ;73c0  c2 36 17     19062  19207 ;6
            PUSH    BC                  ;73c3  c5           19063  19208 ;
            LD  DE,00008h               ;73c4  11 08 00     19064  19209 ;
            PUSH    HL                  ;73c7  e5           19065  19210 ;
            ADD HL,DE                   ;73c8  19           19066  19211 ;
            LD  (L073D1h+1),HL          ;73c9  22 d2 73     19067  19212 ;"s
            ADD HL,DE                   ;73cc  19           19068  19213 ;
            LD  (L073E4h+1),HL          ;73cd  22 e5 73     19069  19214 ;"s
            POP HL                      ;73d0  e1           19070  19215 ;
L073D1h:    LD  DE,00000h               ;73d1  11 00 00     19071  19216 ;
            PUSH    HL                  ;73d4  e5           19072  19217 ;
            PUSH    DE                  ;73d5  d5           19073  19218 ;
            CALL    LDIR8               ;73d6  cd a6 73     19074  19219 ;s
            POP HL                      ;73d9  e1           19075  19220 ;
            LD  A,(HL)                  ;73da  7e           19076  19221 ;~
            CP  082h                    ;73db  fe 82        19077  19222 ;
            ADC A,081h                  ;73dd  ce 81        19078  19223 ;
            DEC A                       ;73df  3d           19079  19224 ;=
            RRA                         ;73e0  1f           19080  19225 ;
            LD  (HL),A                  ;73e1  77           19081  19226 ;w
L073E2h:    POP HL                      ;73e2  e1           19082  19227 ;
            PUSH    HL                  ;73e3  e5           19083  19228 ;
L073E4h:    LD  DE,00000h               ;73e4  11 00 00     19084  19229 ;
            PUSH    DE                  ;73e7  d5           19085  19230 ;
            CALL    LDIR8               ;73e8  cd a6 73     19086  19231 ;s
            POP HL                      ;73eb  e1           19087  19232 ;
            LD  DE,(L073D1h+1)          ;73ec  ed 5b d2 73  19088  19233 ;[s
            CALL    DIV                 ;73f0  cd bd 70     19089  19234 ;p
            CALL    ADD                 ;73f3  cd a6 6c     19090  19235 ;l
            DEC (HL)                    ;73f6  35           19091  19236 ;5
            CALL    CMP                 ;73f7  cd d6 61     19092  19237 ;a
            JR  Z,L07401h               ;73fa  28 05        19093  19238 ;(
            CALL    LDIR8               ;73fc  cd a6 73     19094  19239 ;s
            JR  L073E2h                 ;73ff  18 e1        19095  19240 ;
L07401h:    POP DE                      ;7401  d1           19096  19241 ;
            PUSH    DE                  ;7402  d5           19097  19242 ;
            CALL    LDIR8               ;7403  cd a6 73     19098  19243 ;s
            POP HL                      ;7406  e1           19099  19244 ;
            POP BC                      ;7407  c1           19100  19245 ;
            RET                         ;7408  c9           19101  19246 ;
                                        ;                   19102  19247 
B_SUM:      CALL    B_FIX               ;7409  cd 10 60     19103  19248 ;` 7409
            LD  A,(HL)                  ;740c  7e           19104  19249 ;~
            OR  A                       ;740d  b7           19105  19250 ;
            RET Z                       ;740e  c8           19106  19251 ;
            INC HL                      ;740f  23           19107  19252 ;#
            BIT 7,(HL)                  ;7410  cb 7e        19108  19253 ;~
            DEC HL                      ;7412  2b           19109  19254 ;+
            JP  NZ,IFCALL               ;7413  c2 36 17     19110  19255 ;6
            PUSH    BC                  ;7416  c5           19111  19256 ;
            CALL    L073B2h             ;7417  cd b2 73     19112  19257 ;s
            PUSH    HL                  ;741a  e5           19113  19258 ;
            PUSH    DE                  ;741b  d5           19114  19259 ;
            CALL    LDIR8               ;741c  cd a6 73     19115  19260 ;s
            POP HL                      ;741f  e1           19116  19261 ;
            CALL    ONEADD              ;7420  cd ac 73     19117  19262 ;s
            EX  DE,HL                   ;7423  eb           19118  19263 ;
            POP HL                      ;7424  e1           19119  19264 ;
            CALL    MUL                 ;7425  cd e0 6f     19120  19265 ;o
            DEC (HL)                    ;7428  35           19121  19266 ;5
            POP BC                      ;7429  c1           19122  19267 ;
            RET                         ;742a  c9           19123  19268 ;
                                        ;                   19124  19269 
B_FACG:     PUSH    BC                  ;742b  c5           19125  19270 ;
            CALL    B_FIX               ;742c  cd 10 60     19126  19271 ;`
            LD  A,(HL)                  ;742f  7e           19127  19272 ;~
            OR  A                       ;7430  b7           19128  19273 ;
            JR  Z,L07437h               ;7431  28 04        19129  19274 ;(
            CP  082h                    ;7433  fe 82        19130  19275 ;
            JR  NC,L0743Fh              ;7435  30 08        19131  19276 ;0
L07437h:    PUSH    HL                  ;7437  e5           19132  19277 ;
            EX  DE,HL                   ;7438  eb           19133  19278 ;
            CALL    LDIR1               ;7439  cd a3 73     19134  19279 ;s
            POP HL                      ;743c  e1           19135  19280 ;
            POP BC                      ;743d  c1           19136  19281 ;
            RET                         ;743e  c9           19137  19282 ;
                                        ;                   19138  19283 
L0743Fh:    PUSH    HL                  ;743f  e5           19139  19284 ;
            CALL    HEXFLT              ;7440  cd 5d 61     19140  19285 ;]a
            XOR A                       ;7443  af           19141  19286 ;
            CP  H                       ;7444  bc           19142  19287 ;
            JP  NZ,OVERFL1              ;7445  c2 e4 6e     19143  19288 ;n
            LD  A,L                     ;7448  7d           19144  19289 ;}
            CP  022h                    ;7449  fe 22        19145  19290 ;"
            JP  NC,OVERFL1              ;744b  d2 e4 6e     19146  19291 ;n
            LD  B,L                     ;744e  45           19147  19292 ;E
            POP DE                      ;744f  d1           19148  19293 ;
            LD  HL,00008h               ;7450  21 08 00     19149  19294 ;!
            ADD HL,DE                   ;7453  19           19150  19295 ;
            PUSH    HL                  ;7454  e5           19151  19296 ;
            PUSH    DE                  ;7455  d5           19152  19297 ;
            PUSH    BC                  ;7456  c5           19153  19298 ;
            EX  DE,HL                   ;7457  eb           19154  19299 ;
            CALL    LDIR1               ;7458  cd a3 73     19155  19300 ;s
            POP BC                      ;745b  c1           19156  19301 ;
            POP DE                      ;745c  d1           19157  19302 ;
            POP HL                      ;745d  e1           19158  19303 ;
L0745Eh:    PUSH    BC                  ;745e  c5           19159  19304 ;
            CALL    MUL                 ;745f  cd e0 6f     19160  19305 ;o
            PUSH    HL                  ;7462  e5           19161  19306 ;
            EX  DE,HL                   ;7463  eb           19162  19307 ;
            CALL    ONESUB              ;7464  cd ce 6b     19163  19308 ;k
            EX  DE,HL                   ;7467  eb           19164  19309 ;
            POP HL                      ;7468  e1           19165  19310 ;
            POP BC                      ;7469  c1           19166  19311 ;
            DJNZ    L0745Eh             ;746a  10 f2        19167  19312 ;
            PUSH    DE                  ;746c  d5           19168  19313 ;
            CALL    LDIR8               ;746d  cd a6 73     19169  19314 ;s
            POP HL                      ;7470  e1           19170  19315 ;
            POP BC                      ;7471  c1           19171  19316 ;
            RET                         ;7472  c9           19172  19317 ;
                                        ;                   19173  19318 
L07473h:    LD  A,(HL)                  ;7473  7e           19174  19319 ;~
            LD  C,H                     ;7474  4c           19175  19320 ;L
L07475h:    ADD A,B                     ;7475  80           19176  19321 ;
            DEC HL                      ;7476  2b           19177  19322 ;+
B_ATN:      PUSH    BC                  ;7477  c5           19178  19323 ;
            INC HL                      ;7478  23           19179  19324 ;#
            LD  A,(HL)                  ;7479  7e           19180  19325 ;~
            RES 7,(HL)                  ;747a  cb be        19181  19326 ;
            DEC HL                      ;747c  2b           19182  19327 ;+
            PUSH    AF                  ;747d  f5           19183  19328 ;
            CALL    L07488h             ;747e  cd 88 74     19184  19329 ;t
            POP AF                      ;7481  f1           19185  19330 ;
            POP BC                      ;7482  c1           19186  19331 ;
            RLCA                        ;7483  07           19187  19332 ;
            RET NC                      ;7484  d0           19188  19333 ;
            JP  TOGLE                   ;7485  c3 eb 6b     19189  19334 ;k
L07488h:    CALL    ONECMP              ;7488  cd d3 61     19190  19335 ;a
            JR  C,L074ADh               ;748b  38 20        19191  19336 ;8 
            CALL    L073B2h             ;748d  cd b2 73     19192  19337 ;s
            PUSH    DE                  ;7490  d5           19193  19338 ;
            PUSH    HL                  ;7491  e5           19194  19339 ;
            CALL    LDIR8               ;7492  cd a6 73     19195  19340 ;s
            POP DE                      ;7495  d1           19196  19341 ;
            PUSH    DE                  ;7496  d5           19197  19342 ;
            CALL    LDIR1               ;7497  cd a3 73     19198  19343 ;s
            POP HL                      ;749a  e1           19199  19344 ;
            POP DE                      ;749b  d1           19200  19345 ;
            CALL    DIV                 ;749c  cd bd 70     19201  19346 ;p
            CALL    L074ADh             ;749f  cd ad 74     19202  19347 ;t
            LD  DE,PAITBL               ;74a2  11 78 77     19203  19348 ;xw
            INC (HL)                    ;74a5  34           19204  19349 ;4
            CALL    SUB                 ;74a6  cd d1 6b     19205  19350 ;k
            DEC (HL)                    ;74a9  35           19206  19351 ;5
            JP  B_ABS                   ;74aa  c3 c0 6b     19207  19352 ;k
L074ADh:    LD  A,0FFh                  ;74ad  3e ff        19208  19353 ;>
            LD  (L07602h+1),A           ;74af  32 03 76     19209  19354 ;2v
            LD  DE,L07473h              ;74b2  11 73 74     19210  19355 ;st
            CALL    CMP                 ;74b5  cd d6 61     19211  19356 ;a
            JR  C,L07509h               ;74b8  38 4f        19212  19357 ;8O
            LD  DE,L07475h              ;74ba  11 75 74     19213  19358 ;ut
            CALL    CMP                 ;74bd  cd d6 61     19214  19359 ;a
            PUSH    AF                  ;74c0  f5           19215  19360 ;
            CALL    L073B2h             ;74c1  cd b2 73     19216  19361 ;s
            POP AF                      ;74c4  f1           19217  19362 ;
            PUSH    HL                  ;74c5  e5           19218  19363 ;
            PUSH    DE                  ;74c6  d5           19219  19364 ;
            CALL    LDIR8               ;74c7  cd a6 73     19220  19365 ;s
            POP HL                      ;74ca  e1           19221  19366 ;
            JR  C,L074E1h               ;74cb  38 14        19222  19367 ;8
            CALL    ONEADD              ;74cd  cd ac 73     19223  19368 ;s
            EX  (SP),HL                 ;74d0  e3           19224  19369 ;
            CALL    SUB                 ;74d1  cd d1 6b     19225  19370 ;k
            POP DE                      ;74d4  d1           19226  19371 ;
            CALL    DIV                 ;74d5  cd bd 70     19227  19372 ;p
            CALL    L07509h             ;74d8  cd 09 75     19228  19373 ;u
            LD  DE,SINTBL3              ;74db  11 4a 77     19229  19374 ;Jw
            JP  ADD                     ;74de  c3 a6 6c     19230  19375 ;l
L074E1h:    LD  DE,L07501h              ;74e1  11 01 75     19231  19376 ;u
            CALL    MUL                 ;74e4  cd e0 6f     19232  19377 ;o
            CALL    ONEADD              ;74e7  cd ac 73     19233  19378 ;s
            EX  (SP),HL                 ;74ea  e3           19234  19379 ;
            LD  DE,L07501h              ;74eb  11 01 75     19235  19380 ;u
            CALL    SUB                 ;74ee  cd d1 6b     19236  19381 ;k
            POP DE                      ;74f1  d1           19237  19382 ;
            CALL    DIV                 ;74f2  cd bd 70     19238  19383 ;p
            CALL    L07509h             ;74f5  cd 09 75     19239  19384 ;u
            INC (HL)                    ;74f8  34           19240  19385 ;4
            LD  DE,SINTBL3              ;74f9  11 4a 77     19241  19386 ;Jw
            CALL    ADD                 ;74fc  cd a6 6c     19242  19387 ;l
            DEC (HL)                    ;74ff  35           19243  19388 ;5
            RET                         ;7500  c9           19244  19389 ;
                                        ;                   19245  19390 
L07501h:    LD  A,A                     ;7501  7f           19246  19391 ;
            LD  D,H                     ;7502  54           19247  19392 ;T
            INC DE                      ;7503  13           19248  19393 ;
L0E7CFh     EQU    0E7CFh               ;e7cf               19249  19394 
            CALL    Z,L0E7CFh           ;7504  cc cf e7     19250  19395 ;
            LD  A,C                     ;7507  79           19251  19396 ;y
            SUB B                       ;7508  90           19252  19397 ;
L07509h:    PUSH    BC                  ;7509  c5           19253  19398 ;
            PUSH    HL                  ;750a  e5           19254  19399 ;
            LD  (L075F2h+1),HL          ;750b  22 f3 75     19255  19400 ;"u
            LD  DE,00008h               ;750e  11 08 00     19256  19401 ;
            ADD HL,DE                   ;7511  19           19257  19402 ;
            LD  (L075E2h+1),HL          ;7512  22 e3 75     19258  19403 ;"u
            ADD HL,DE                   ;7515  19           19259  19404 ;
            LD  (L075C8h),HL            ;7516  22 c8 75     19260  19405 ;"u
            ADD HL,DE                   ;7519  19           19261  19406 ;
            LD  (L075DAh+1),HL          ;751a  22 db 75     19262  19407 ;"u
            EX  DE,HL                   ;751d  eb           19263  19408 ;
            POP HL                      ;751e  e1           19264  19409 ;
            PUSH    HL                  ;751f  e5           19265  19410 ;
            PUSH    DE                  ;7520  d5           19266  19411 ;
            CALL    LDIR8               ;7521  cd a6 73     19267  19412 ;s
            POP HL                      ;7524  e1           19268  19413 ;
            LD  E,L                     ;7525  5d           19269  19414 ;]
            LD  D,H                     ;7526  54           19270  19415 ;T
            CALL    MUL                 ;7527  cd e0 6f     19271  19416 ;o
            LD  DE,(L075C8h)            ;752a  ed 5b c8 75  19272  19417 ;[u
            POP HL                      ;752e  e1           19273  19418 ;
            PUSH    HL                  ;752f  e5           19274  19419 ;
            CALL    LDIR8               ;7530  cd a6 73     19275  19420 ;s
            LD  A,(IY+0)                ;7533  fd 7e 00     19276  19421 ;~
            DEC A                       ;7536  3d           19277  19422 ;=
            CP  003h                    ;7537  fe 03        19278  19423 ;
            LD  B,A                     ;7539  47           19279  19424 ;G
            LD  HL,L076FAh              ;753a  21 fa 76     19280  19425 ;!v
            JP  Z,L075D5h               ;753d  ca d5 75     19281  19426 ;u
            LD  B,00Ah                  ;7540  06 0a        19282  19427 ;
            JP  L075D5h                 ;7542  c3 d5 75     19283  19428 ;u
B_COS:      PUSH    BC                  ;7545  c5           19284  19429 ;
            LD  A,(HL)                  ;7546  7e           19285  19430 ;~
            OR  A                       ;7547  b7           19286  19431 ;
            JP  Z,L07437h               ;7548  ca 37 74     19287  19432 ;7t
            LD  DE,SINTBL3              ;754b  11 4a 77     19288  19433 ;Jw
            DEC (HL)                    ;754e  35           19289  19434 ;5
            CALL    SUB                 ;754f  cd d1 6b     19290  19435 ;k
            INC (HL)                    ;7552  34           19291  19436 ;4
            CALL    TOGLE               ;7553  cd eb 6b     19292  19437 ;k
            POP BC                      ;7556  c1           19293  19438 ;
B_SIN:      PUSH    BC                  ;7557  c5           19294  19439 ;
            PUSH    HL                  ;7558  e5           19295  19440 ;
            INC HL                      ;7559  23           19296  19441 ;#
            LD  A,(HL)                  ;755a  7e           19297  19442 ;~
            RES 7,(HL)                  ;755b  cb be        19298  19443 ;
            AND 080h                    ;755d  e6 80        19299  19444 ;
            CPL                         ;755f  2f           19300  19445 ;/
            LD  (L07602h+1),A           ;7560  32 03 76     19301  19446 ;2v
            DEC HL                      ;7563  2b           19302  19447 ;+
            CALL    L073B2h             ;7564  cd b2 73     19303  19448 ;s
            LD  HL,SINTBL3              ;7567  21 4a 77     19304  19449 ;!Jw
            PUSH    DE                  ;756a  d5           19305  19450 ;
            CALL    LDIR8               ;756b  cd a6 73     19306  19451 ;s
            POP HL                      ;756e  e1           19307  19452 ;
            INC (HL)                    ;756f  34           19308  19453 ;4
            INC (HL)                    ;7570  34           19309  19454 ;4
            INC (HL)                    ;7571  34           19310  19455 ;4
            EX  DE,HL                   ;7572  eb           19311  19456 ;
            POP HL                      ;7573  e1           19312  19457 ;
            PUSH    HL                  ;7574  e5           19313  19458 ;
            CALL    CMP                 ;7575  cd d6 61     19314  19459 ;a
            CALL    NC,MOD_             ;7578  d4 4f 61     19315  19460 ;Oa
            EX  DE,HL                   ;757b  eb           19316  19461 ;
            DEC (HL)                    ;757c  35           19317  19462 ;5
            EX  DE,HL                   ;757d  eb           19318  19463 ;
            CALL    CMP                 ;757e  cd d6 61     19319  19464 ;a
            JR  C,L0758Eh               ;7581  38 0b        19320  19465 ;8
            CALL    SUB                 ;7583  cd d1 6b     19321  19466 ;k
            LD  A,(L07602h+1)           ;7586  3a 03 76     19322  19467 ;:v
            XOR 080h                    ;7589  ee 80        19323  19468 ;
            LD  (L07602h+1),A           ;758b  32 03 76     19324  19469 ;2v
L0758Eh:    EX  DE,HL                   ;758e  eb           19325  19470 ;
            DEC (HL)                    ;758f  35           19326  19471 ;5
            EX  DE,HL                   ;7590  eb           19327  19472 ;
            CALL    CMP                 ;7591  cd d6 61     19328  19473 ;a
            JR  C,L0759Eh               ;7594  38 08        19329  19474 ;8
            DEC (HL)                    ;7596  35           19330  19475 ;5
            CALL    SUB                 ;7597  cd d1 6b     19331  19476 ;k
            INC (HL)                    ;759a  34           19332  19477 ;4
            CALL    B_ABS               ;759b  cd c0 6b     19333  19478 ;k
L0759Eh:    LD  (L075F2h+1),HL          ;759e  22 f3 75     19334  19479 ;"u
            LD  DE,00008h               ;75a1  11 08 00     19335  19480 ;
            ADD HL,DE                   ;75a4  19           19336  19481 ;
            LD  (L075E2h+1),HL          ;75a5  22 e3 75     19337  19482 ;"u
            ADD HL,DE                   ;75a8  19           19338  19483 ;
            LD  (L075C8h),HL            ;75a9  22 c8 75     19339  19484 ;"u
            ADD HL,DE                   ;75ac  19           19340  19485 ;
            LD  (L075DAh+1),HL          ;75ad  22 db 75     19341  19486 ;"u
            EX  DE,HL                   ;75b0  eb           19342  19487 ;
            POP HL                      ;75b1  e1           19343  19488 ;
            PUSH    DE                  ;75b2  d5           19344  19489 ;
            LD  DE,SINTBL3              ;75b3  11 4a 77     19345  19490 ;Jw
            CALL    CMP                 ;75b6  cd d6 61     19346  19491 ;a
            JR  NC,L0761Bh              ;75b9  30 60        19347  19492 ;0`
            POP DE                      ;75bb  d1           19348  19493 ;
            PUSH    HL                  ;75bc  e5           19349  19494 ;
            PUSH    DE                  ;75bd  d5           19350  19495 ;
            CALL    LDIR8               ;75be  cd a6 73     19351  19496 ;s
            POP HL                      ;75c1  e1           19352  19497 ;
            LD  E,L                     ;75c2  5d           19353  19498 ;]
            LD  D,H                     ;75c3  54           19354  19499 ;T
            CALL    MUL                 ;75c4  cd e0 6f     19355  19500 ;o
            DEFB 011h                   ;75c7  11           19356  19501 ; LD DE, xxxx
L075C8h:                                ;                   19357  19502 
            DEFW 0                      ;75c8  00 00        19358  19503 ;
            POP HL                      ;75ca  e1           19359  19504 ;
            PUSH    HL                  ;75cb  e5           19360  19505 ;
            CALL    LDIR8               ;75cc  cd a6 73     19361  19506 ;s
            LD  B,(IY+0)                ;75cf  fd 46 00     19362  19507 ;F
            LD  HL,SINTBL1              ;75d2  21 7a 76     19363  19508 ;!zv
L075D5h:    PUSH    BC                  ;75d5  c5           19364  19509 ;
            PUSH    HL                  ;75d6  e5           19365  19510 ;
            LD  HL,(L075C8h)            ;75d7  2a c8 75     19366  19511 ;*u
L075DAh:    LD  DE,00000h               ;75da  11 00 00     19367  19512 ;
            CALL    MUL                 ;75dd  cd e0 6f     19368  19513 ;o
            POP HL                      ;75e0  e1           19369  19514 ;
            PUSH    HL                  ;75e1  e5           19370  19515 ;
L075E2h:    LD  DE,00000h               ;75e2  11 00 00     19371  19516 ;
            PUSH    DE                  ;75e5  d5           19372  19517 ;
            CALL    LDIR8               ;75e6  cd a6 73     19373  19518 ;s
            POP HL                      ;75e9  e1           19374  19519 ;
            LD  DE,(L075C8h)            ;75ea  ed 5b c8 75  19375  19520 ;[u
            CALL    MUL                 ;75ee  cd e0 6f     19376  19521 ;o
            EX  DE,HL                   ;75f1  eb           19377  19522 ;
L075F2h:    LD  HL,00000h               ;75f2  21 00 00     19378  19523 ;!
            CALL    ADD                 ;75f5  cd a6 6c     19379  19524 ;l
            POP HL                      ;75f8  e1           19380  19525 ;
            LD  DE,00008h               ;75f9  11 08 00     19381  19526 ;
            ADD HL,DE                   ;75fc  19           19382  19527 ;
            POP BC                      ;75fd  c1           19383  19528 ;
            DJNZ    L075D5h             ;75fe  10 d5        19384  19529 ;
            POP HL                      ;7600  e1           19385  19530 ;
            POP BC                      ;7601  c1           19386  19531 ;
L07602h:    LD  A,000h                  ;7602  3e 00        19387  19532 ;>
            INC HL                      ;7604  23           19388  19533 ;#
            XOR (HL)                    ;7605  ae           19389  19534 ;
            CPL                         ;7606  2f           19390  19535 ;/
            LD  (HL),A                  ;7607  77           19391  19536 ;w
            DEC HL                      ;7608  2b           19392  19537 ;+
            LD  A,(IY+0)                ;7609  fd 7e 00     19393  19538 ;~
            CP  008h                    ;760c  fe 08        19394  19539 ;
            LD  A,(HL)                  ;760e  7e           19395  19540 ;~
            JR  Z,L07617h               ;760f  28 06        19396  19541 ;(
            CP  06Ch                    ;7611  fe 6c        19397  19542 ;l
L07613h:    RET NC                      ;7613  d0           19398  19543 ;
            JP  CLRFAC                  ;7614  c3 a9 28     19399  19544 ;(
L07617h:    CP  04Dh                    ;7617  fe 4d        19400  19545 ;M
            JR  L07613h                 ;7619  18 f8        19401  19546 ;
L0761Bh:    DEC (HL)                    ;761b  35           19402  19547 ;5
            LD  DE,SINTBL3              ;761c  11 4a 77     19403  19548 ;Jw
            CALL    SUB                 ;761f  cd d1 6b     19404  19549 ;k
            INC (HL)                    ;7622  34           19405  19550 ;4
            CALL    B_ABS               ;7623  cd c0 6b     19406  19551 ;k
            POP DE                      ;7626  d1           19407  19552 ;
            PUSH    HL                  ;7627  e5           19408  19553 ;
            PUSH    DE                  ;7628  d5           19409  19554 ;
            CALL    LDIR8               ;7629  cd a6 73     19410  19555 ;s
            POP HL                      ;762c  e1           19411  19556 ;
            LD  E,L                     ;762d  5d           19412  19557 ;]
            LD  D,H                     ;762e  54           19413  19558 ;T
            CALL    MUL                 ;762f  cd e0 6f     19414  19559 ;o
            LD  DE,(L075C8h)            ;7632  ed 5b c8 75  19415  19560 ;[u
            CALL    LDIR1               ;7636  cd a3 73     19416  19561 ;s
            POP DE                      ;7639  d1           19417  19562 ;
            PUSH    DE                  ;763a  d5           19418  19563 ;
            CALL    LDIR1               ;763b  cd a3 73     19419  19564 ;s
            LD  B,(IY+0)                ;763e  fd 46 00     19420  19565 ;F
            LD  HL,SINTBL2              ;7641  21 ba 76     19421  19566 ;!v
L07644h:    JR  L075D5h                 ;7644  18 8f        19422  19567 ;
B_TAN:                                  ;                   19423  19568 
            PUSH    BC                  ;7646  c5           19424  19569 ;
            PUSH    HL                  ;7647  e5           19425  19570 ;
            LD  DE,00008h               ;7648  11 08 00     19426  19571 ;
            ADD HL,DE                   ;764b  19           19427  19572 ;
            LD  (L0766Dh+1),HL          ;764c  22 6e 76     19428  19573 ;"nv
            ADD HL,DE                   ;764f  19           19429  19574 ;
            LD  (L07662h+1),HL          ;7650  22 63 76     19430  19575 ;"cv
            EX  DE,HL                   ;7653  eb           19431  19576 ;
            POP HL                      ;7654  e1           19432  19577 ;
            PUSH    HL                  ;7655  e5           19433  19578 ;
            CALL    LDIR8               ;7656  cd a6 73     19434  19579 ;s
            LD  HL,(L0766Dh+1)          ;7659  2a 6e 76     19435  19580 ;*nv
            EX  DE,HL                   ;765c  eb           19436  19581 ;
            POP HL                      ;765d  e1           19437  19582 ;
            PUSH    HL                  ;765e  e5           19438  19583 ;
            CALL    LDIR8               ;765f  cd a6 73     19439  19584 ;s
L07662h:    LD  HL,00000h               ;7662  21 00 00     19440  19585 ;!
            CALL    B_SIN               ;7665  cd 57 75     19441  19586 ;Wu
            POP DE                      ;7668  d1           19442  19587 ;
            PUSH    DE                  ;7669  d5           19443  19588 ;
            CALL    LDIR8               ;766a  cd a6 73     19444  19589 ;s
L0766Dh:    LD  HL,00000h               ;766d  21 00 00     19445  19590 ;!
            CALL    B_COS               ;7670  cd 45 75     19446  19591 ;Eu
            EX  DE,HL                   ;7673  eb           19447  19592 ;
            POP HL                      ;7674  e1           19448  19593 ;
            CALL    DIV                 ;7675  cd bd 70     19449  19594 ;p
            POP BC                      ;7678  c1           19450  19595 ;
            RET                         ;7679  c9           19451  19596 ;
SINTBL1:                                ;                   19452  19597 
            DEFB 07Eh, 0AAh, 0AAh, 0AAh, 0AAh, 0AAh, 0AAh, 0ABh;767a  7e aa aa aa  19453  19598 
                                        ;767e  aa aa aa ab  19453  19599
            DEFB 07Ah, 008h, 088h, 088h, 088h, 088h, 088h, 089h;7682  7a 08 88 88  19454  19600 
                                        ;7686  88 88 88 89  19454  19601
            DEFB 074h, 0D0h, 00Dh, 000h, 0D0h, 00Dh, 000h, 0D0h;768a  74 d0 0d 00  19455  19602 
                                        ;768e  d0 0d 00 d0  19455  19603
            DEFB 06Eh, 038h, 0EFh, 01Dh, 02Ah, 0B6h, 039h, 09Ch;7692  6e 38 ef 1d  19456  19604 
                                        ;7696  2a b6 39 9c  19456  19605
            DEFB 067h, 0D7h, 032h, 02Bh, 03Fh, 0AAh, 027h, 01Ch;769a  67 d7 32 2b  19457  19606 
                                        ;769e  3f aa 27 1c  19457  19607
            DEFB 060h, 030h, 092h, 030h, 09Dh, 043h, 068h, 04Ch;76a2  60 30 92 30  19458  19608 
                                        ;76a6  9d 43 68 4c  19458  19609
            DEFB 058h, 0D7h, 03Fh, 09Fh, 039h, 09Dh, 0C0h, 0F9h;76aa  58 d7 3f 9f  19459  19610 
                                        ;76ae  39 9d c0 f9  19459  19611
            DEFB 050h, 04Ah, 096h, 03Bh, 081h, 085h, 06Ah, 053h;76b2  50 4a 96 3b  19460  19612 
                                        ;76b6  81 85 6a 53  19460  19613
SINTBL2:                                ;                   19461  19614 
            DEFB 080h, 080h, 000h, 000h, 000h, 000h, 000h, 000h;76ba  80 80 00 00  19462  19615 
                                        ;76be  00 00 00 00  19462  19616
            DEFB 07Ch, 02Ah, 0AAh, 0AAh, 0AAh, 0AAh, 0AAh, 0ABh;76c2  7c 2a aa aa  19463  19617 
                                        ;76c6  aa aa aa ab  19463  19618
            DEFB 077h, 0B6h, 00Bh, 060h, 0B6h, 00Bh, 060h, 0B7h;76ca  77 b6 0b 60  19464  19619 
                                        ;76ce  b6 0b 60 b7  19464  19620
            DEFB 071h, 050h, 00Dh, 000h, 0D0h, 00Dh, 000h, 0D1h;76d2  71 50 0d 00  19465  19621 
                                        ;76d6  d0 0d 00 d1  19465  19622
            DEFB 06Bh, 093h, 0F2h, 07Dh, 0BBh, 0C4h, 0FAh, 0E4h;76da  6b 93 f2 7d  19466  19623 
                                        ;76de  bb c4 fa e4  19466  19624
            DEFB 064h, 00Fh, 076h, 0C7h, 07Fh, 0C6h, 0C4h, 0BEh;76e2  64 0f 76 c7  19467  19625 
                                        ;76e6  7f c6 c4 be  19467  19626
            DEFB 05Ch, 0C9h, 0CBh, 0A5h, 046h, 003h, 0E4h, 0EAh;76ea  5c c9 cb a5  19468  19627 
                                        ;76ee  46 03 e4 ea  19468  19628
            DEFB 054h, 057h, 03Fh, 09Fh, 039h, 09Dh, 0C0h, 0F9h;76f2  54 57 3f 9f  19469  19629 
                                        ;76f6  39 9d c0 f9  19469  19630
L076FAh:    DEFB 07Fh, 0AAh, 0AAh, 0AAh, 0AAh, 0AAh, 0AAh, 0ABh;76fa  7f aa aa aa  19470  19631 
                                        ;76fe  aa aa aa ab  19470  19632
            DEFB 07Eh, 04Ch, 0CCh, 0CCh, 0CCh, 0CCh, 0CCh, 0CDh;7702  7e 4c cc cc  19471  19633 
                                        ;7706  cc cc cc cd  19471  19634
            DEFB 07Eh, 092h, 049h, 024h, 092h, 049h, 024h, 093h;770a  7e 92 49 24  19472  19635 
                                        ;770e  92 49 24 93  19472  19636
            DEFB 07Dh, 063h, 08Eh, 038h, 0E3h, 08Eh, 038h, 0E4h;7712  7d 63 8e 38  19473  19637 
                                        ;7716  e3 8e 38 e4  19473  19638
            DEFB 07Dh, 0BAh, 02Eh, 08Bh, 0A2h, 0E8h, 0BAh, 02Fh;771a  7d ba 2e 8b  19474  19639 
                                        ;771e  a2 e8 ba 2f  19474  19640
            DEFB 07Dh, 01Dh, 089h, 0D8h, 09Dh, 089h, 0D8h, 09Eh;7722  7d 1d 89 d8  19475  19641 
                                        ;7726  9d 89 d8 9e  19475  19642
            DEFB 07Dh, 088h, 088h, 088h, 088h, 088h, 088h, 089h;772a  7d 88 88 88  19476  19643 
                                        ;772e  88 88 88 89  19476  19644
            DEFB 07Ch, 070h, 0F0h, 0F0h, 0F0h, 0F0h, 0F0h, 0F1h;7732  7c 70 f0 f0  19477  19645 
                                        ;7736  f0 f0 f0 f1  19477  19646
            DEFB 07Ch, 0D7h, 094h, 035h, 0E5h, 00Dh, 079h, 044h;773a  7c d7 94 35  19478  19647 
                                        ;773e  e5 0d 79 44  19478  19648
            DEFB 07Ch, 043h, 00Ch, 030h, 0C3h, 00Ch, 030h, 0C4h;7742  7c 43 0c 30  19479  19649 
                                        ;7746  c3 0c 30 c4  19479  19650
SINTBL3:    DEFB 080h, 049h, 00Fh, 0DAh, 0A2h, 021h, 068h, 0C2h;774a  80 49 0f da  19480  19651 
                                        ;774e  a2 21 68 c2  19480  19652
                                        ;                   19481  19653 ;    ORG 07752h
B_SGN:      LD A,(HL)                   ;7752  7e           19482  19654 
            OR A                        ;7753  b7           19483  19655 
            RET Z                       ;7754  c8           19484  19656 
            INC HL                      ;7755  23           19485  19657 ;#
            BIT 7,(HL)                  ;7756  cb 7e        19486  19658 ;~
            DEC HL                      ;7758  2b           19487  19659 ;+
            JR  NZ,L07764h              ;7759  20 09        19488  19660 ;     
L0775Bh:    PUSH    HL                  ;775b  e5           19489  19661 ;
            EX  DE,HL                   ;775c  eb           19490  19662 ;
            PUSH    BC                  ;775d  c5           19491  19663 ;
            CALL    LDIR1               ;775e  cd a3 73     19492  19664 ;s
            POP BC                      ;7761  c1           19493  19665 ;
            POP HL                      ;7762  e1           19494  19666 ;
            RET                         ;7763  c9           19495  19667 ;
                                        ;                   19496  19668 
L07764h:    CALL    L0775Bh             ;7764  cd 5b 77     19497  19669 ;[w
            JP  TOGLE                   ;7767  c3 eb 6b     19498  19670 ;k
B_RAD:      LD  DE,07780h               ;776a  11 80 77     19499  19671 ;w
            JR  L07772h                 ;776d  18 03        19500  19672 ;h
B_PAI:      LD  DE,PAITBL               ;776f  11 78 77     19501  19673 ;xw
L07772h:    PUSH    BC                  ;7772  c5           19502  19674 ;
            CALL    MUL                 ;7773  cd e0 6f     19503  19675 ;o
            POP BC                      ;7776  c1           19504  19676 ;
            RET                         ;7777  c9           19505  19677 ;
PAITBL:                                 ;                   19506  19678 
            DEFB 082h, 049h, 00Fh, 0DAh ;7778  82 49 0f da  19507  19679 
            DEFB 0A2h, 021h, 068h, 0C2h ;777c  a2 21 68 c2  19508  19680 
            DEFB 07Bh, 00Eh, 0FAh, 035h ;7780  7b 0e fa 35  19509  19681 
            DEFB 012h, 094h, 0E9h, 0C9h ;7784  12 94 e9 c9  19510  19682 
                                        ;                   19511  19683 
B_INP:      PUSH    HL                  ;7788  e5           19512  19684 ;
            PUSH    BC                  ;7789  c5           19513  19685 ;
            CALL    HLFLT               ;778a  cd 67 61     19514  19686 ;ga
            LD  B,H                     ;778d  44           19515  19687 ;D
            LD  C,L                     ;778e  4d           19516  19688 ;M
            IN  A,(C)                   ;778f  ed 78        19517  19689 ;x
            LD  E,A                     ;7791  5f           19518  19690 ;_
            LD  D,000h                  ;7792  16 00        19519  19691 ;
            POP BC                      ;7794  c1           19520  19692 ;
            POP HL                      ;7795  e1           19521  19693 ;
            JP  FLTHEX                  ;7796  c3 02 29     19522  19694 ;)
B_RND:      PUSH    BC                  ;7799  c5           19523  19695 ;
            LD  DE,(L077C8h)            ;779a  ed 5b c8 77  19524  19696 ;[w
            LD  A,R                     ;779e  ed 5f        19525  19697 ;_
            XOR D                       ;77a0  aa           19526  19698 ;
            RRC A                       ;77a1  cb 0f        19527  19699 ;
            RRC A                       ;77a3  cb 0f        19528  19700 ;
            RRC A                       ;77a5  cb 0f        19529  19701 ;
            LD  D,A                     ;77a7  57           19530  19702 ;W
            LD  A,R                     ;77a8  ed 5f        19531  19703 ;_
            XOR E                       ;77aa  ab           19532  19704 ;
            RLC A                       ;77ab  cb 07        19533  19705 ;
            RLC A                       ;77ad  cb 07        19534  19706 ;
            LD  E,D                     ;77af  5a           19535  19707 ;Z
            LD  D,A                     ;77b0  57           19536  19708 ;W
            LD  (L077C8h),DE            ;77b1  ed 53 c8 77  19537  19709 ;Sw
            PUSH    HL                  ;77b5  e5           19538  19710 ;
            INC HL                      ;77b6  23           19539  19711 ;#
            RES 7,D                     ;77b7  cb ba        19540  19712 ;
            LD  (HL),D                  ;77b9  72           19541  19713 ;r
            INC HL                      ;77ba  23           19542  19714 ;#
            LD  (HL),E                  ;77bb  73           19543  19715 ;s
            INC HL                      ;77bc  23           19544  19716 ;#
            LD  A,R                     ;77bd  ed 5f        19545  19717 ;_
            LD  (HL),A                  ;77bf  77           19546  19718 ;w
            POP HL                      ;77c0  e1           19547  19719 ;
            LD  (HL),081h               ;77c1  36 81        19548  19720 ;6
            CALL    ONESUB              ;77c3  cd ce 6b     19549  19721 ;k
            POP BC                      ;77c6  c1           19550  19722 ;
            RET                         ;77c7  c9           19551  19723 ;
                                        ;                   19552  19724 
L077C8h:    DEFW 04193h                 ;77c8  93 41        19553  19725 ;      	SUB	E;LD	B,C         
B_EXP:      PUSH    BC                  ;77ca  c5           19554  19726 ;
            LD  A,(HL)                  ;77cb  7e           19555  19727 ;~
            OR  A                       ;77cc  b7           19556  19728 ;
            JP  Z,L07437h               ;77cd  ca 37 74     19557  19729 ;7t
            INC HL                      ;77d0  23           19558  19730 ;#
            LD  A,(HL)                  ;77d1  7e           19559  19731 ;~
            LD  (L07896h+1),A           ;77d2  32 97 78     19560  19732 ;2x
            RES 7,(HL)                  ;77d5  cb be        19561  19733 ;
            DEC HL                      ;77d7  2b           19562  19734 ;+
            LD  DE,07A2Fh               ;77d8  11 2f 7a     19563  19735 ;/z
            CALL    MUL                 ;77db  cd e0 6f     19564  19736 ;o
            PUSH    HL                  ;77de  e5           19565  19737 ;
            CALL    L073B2h             ;77df  cd b2 73     19566  19738 ;s
            PUSH    DE                  ;77e2  d5           19567  19739 ;
            CALL    LDIR8               ;77e3  cd a6 73     19568  19740 ;s
            POP HL                      ;77e6  e1           19569  19741 ;
            CALL    B_FIX               ;77e7  cd 10 60     19570  19742 ;`
            PUSH    HL                  ;77ea  e5           19571  19743 ;
            CALL    HLFLT               ;77eb  cd 67 61     19572  19744 ;ga
            XOR A                       ;77ee  af           19573  19745 ;
            CP  H                       ;77ef  bc           19574  19746 ;
            JP  NZ,OVERFL1              ;77f0  c2 e4 6e     19575  19747 ;n
            LD  A,L                     ;77f3  7d           19576  19748 ;}
            LD  (L0788Bh+1),A           ;77f4  32 8c 78     19577  19749 ;2x
            POP DE                      ;77f7  d1           19578  19750 ;
            POP HL                      ;77f8  e1           19579  19751 ;
            PUSH    HL                  ;77f9  e5           19580  19752 ;
            CALL    SUB                 ;77fa  cd d1 6b     19581  19753 ;k
            PUSH    DE                  ;77fd  d5           19582  19754 ;
            PUSH    HL                  ;77fe  e5           19583  19755 ;
            CALL    LDIR1               ;77ff  cd a3 73     19584  19756 ;s
            POP DE                      ;7802  d1           19585  19757 ;
            POP HL                      ;7803  e1           19586  19758 ;
            DEC (HL)                    ;7804  35           19587  19759 ;5
            EX  DE,HL                   ;7805  eb           19588  19760 ;
            XOR A                       ;7806  af           19589  19761 ;
            LD  B,008h                  ;7807  06 08        19590  19762 ;
L07809h:    PUSH    BC                  ;7809  c5           19591  19763 ;
            PUSH    AF                  ;780a  f5           19592  19764 ;
            CALL    CMP                 ;780b  cd d6 61     19593  19765 ;a
            JR  C,L07817h               ;780e  38 07        19594  19766 ;8
            CALL    SUB                 ;7810  cd d1 6b     19595  19767 ;k
            POP AF                      ;7813  f1           19596  19768 ;
            SET 7,A                     ;7814  cb ff        19597  19769 ;
            PUSH    AF                  ;7816  f5           19598  19770 ;
L07817h:    POP AF                      ;7817  f1           19599  19771 ;
            RLC A                       ;7818  cb 07        19600  19772 ;
            EX  DE,HL                   ;781a  eb           19601  19773 ;
            DEC (HL)                    ;781b  35           19602  19774 ;5
            EX  DE,HL                   ;781c  eb           19603  19775 ;
            POP BC                      ;781d  c1           19604  19776 ;
            DJNZ    L07809h             ;781e  10 e9        19605  19777 ;
            LD  (L07876h+1),A           ;7820  32 77 78     19606  19778 ;2wx
            PUSH    DE                  ;7823  d5           19607  19779 ;
            LD  DE,L07A27h              ;7824  11 27 7a     19608  19780 ;'z
            CALL    MUL                 ;7827  cd e0 6f     19609  19781 ;o
            POP DE                      ;782a  d1           19610  19782 ;
            PUSH    DE                  ;782b  d5           19611  19783 ;
            CALL    LDIR8               ;782c  cd a6 73     19612  19784 ;s
            POP HL                      ;782f  e1           19613  19785 ;
            BIT 3,(IY+0)                ;7830  fd cb 00 5e  19614  19786 ;^
            JP  Z,L078ADh               ;7834  ca ad 78     19615  19787 ;x
            INC (HL)                    ;7837  34           19616  19788 ;4
            LD  DE,FLTEN                ;7838  11 90 62     19617  19789 ;b
            CALL    ADD                 ;783b  cd a6 6c     19618  19790 ;l
            DEC (HL)                    ;783e  35           19619  19791 ;5
            POP DE                      ;783f  d1           19620  19792 ;
L07840h:    PUSH    DE                  ;7840  d5           19621  19793 ;
            CALL    MUL                 ;7841  cd e0 6f     19622  19794 ;o
            LD  DE,FLTEN                ;7844  11 90 62     19623  19795 ;b
            DEC (HL)                    ;7847  35           19624  19796 ;5
            CALL    ADD                 ;7848  cd a6 6c     19625  19797 ;l
            INC (HL)                    ;784b  34           19626  19798 ;4
            POP DE                      ;784c  d1           19627  19799 ;
            PUSH    DE                  ;784d  d5           19628  19800 ;
            CALL    MUL                 ;784e  cd e0 6f     19629  19801 ;o
            LD  DE,L07A1Fh              ;7851  11 1f 7a     19630  19802 ;z
            CALL    MUL                 ;7854  cd e0 6f     19631  19803 ;o
            INC (HL)                    ;7857  34           19632  19804 ;4
            CALL    ONEADD              ;7858  cd ac 73     19633  19805 ;s
            DEC (HL)                    ;785b  35           19634  19806 ;5
            POP DE                      ;785c  d1           19635  19807 ;
            PUSH    DE                  ;785d  d5           19636  19808 ;
            CALL    MUL                 ;785e  cd e0 6f     19637  19809 ;o
            CALL    ONEADD              ;7861  cd ac 73     19638  19810 ;s
            POP DE                      ;7864  d1           19639  19811 ;
            PUSH    DE                  ;7865  d5           19640  19812 ;
            CALL    MUL                 ;7866  cd e0 6f     19641  19813 ;o
L07869h:    CALL    ONEADD              ;7869  cd ac 73     19642  19814 ;s
            EX  (SP),HL                 ;786c  e3           19643  19815 ;
            EX  DE,HL                   ;786d  eb           19644  19816 ;
            PUSH    DE                  ;786e  d5           19645  19817 ;
            CALL    LDIR1               ;786f  cd a3 73     19646  19818 ;s
            POP HL                      ;7872  e1           19647  19819 ;
            LD  DE,LOGTBL1              ;7873  11 9f 79     19648  19820 ;y
L07876h:    LD  A,000h                  ;7876  3e 00        19649  19821 ;>
            LD  B,008h                  ;7878  06 08        19650  19822 ;
L0787Ah:    RLC A                       ;787a  cb 07        19651  19823 ;
            JR  NC,L07885h              ;787c  30 07        19652  19824 ;0
            PUSH    AF                  ;787e  f5           19653  19825 ;
            PUSH    BC                  ;787f  c5           19654  19826 ;
            CALL    MUL                 ;7880  cd e0 6f     19655  19827 ;o
            POP BC                      ;7883  c1           19656  19828 ;
            POP AF                      ;7884  f1           19657  19829 ;
L07885h:    CALL    ADDDEG              ;7885  cd 4a 5b     19658  19830 ;J[
            DJNZ    L0787Ah             ;7888  10 f0        19659  19831 ;
            LD  A,(HL)                  ;788a  7e           19660  19832 ;~
L0788Bh:    ADD A,000h                  ;788b  c6 00        19661  19833 ;
            JP  C,OVERFL1               ;788d  da e4 6e     19662  19834 ;n
            LD  (HL),A                  ;7890  77           19663  19835 ;w
            POP DE                      ;7891  d1           19664  19836 ;
            CALL    MUL                 ;7892  cd e0 6f     19665  19837 ;o
            POP BC                      ;7895  c1           19666  19838 ;
L07896h:    LD  A,000h                  ;7896  3e 00        19667  19839 ;>
            RLC A                       ;7898  cb 07        19668  19840 ;
            RET NC                      ;789a  d0           19669  19841 ;
            PUSH    BC                  ;789b  c5           19670  19842 ;
            PUSH    DE                  ;789c  d5           19671  19843 ;
            PUSH    HL                  ;789d  e5           19672  19844 ;
            CALL    LDIR8               ;789e  cd a6 73     19673  19845 ;s
            POP DE                      ;78a1  d1           19674  19846 ;
            PUSH    DE                  ;78a2  d5           19675  19847 ;
            CALL    LDIR1               ;78a3  cd a3 73     19676  19848 ;s
            POP HL                      ;78a6  e1           19677  19849 ;
            POP DE                      ;78a7  d1           19678  19850 ;
            CALL    DIV                 ;78a8  cd bd 70     19679  19851 ;p
            POP BC                      ;78ab  c1           19680  19852 ;
            RET                         ;78ac  c9           19681  19853 ;
                                        ;                   19682  19854 
L078ADh:    POP DE                      ;78ad  d1           19683  19855 ;
            PUSH    DE                  ;78ae  d5           19684  19856 ;
            CALL    MUL                 ;78af  cd e0 6f     19685  19857 ;o
            LD  A,(HL)                  ;78b2  7e           19686  19858 ;~
            OR  A                       ;78b3  b7           19687  19859 ;
            JR  Z,L078B7h               ;78b4  28 01        19688  19860 ;(
            DEC (HL)                    ;78b6  35           19689  19861 ;5
L078B7h:    CALL    ADD                 ;78b7  cd a6 6c     19690  19862 ;l
            JP  L07869h                 ;78ba  c3 69 78     19691  19863 ;ix
B_LOG:      PUSH    BC                  ;78bd  c5           19692  19864 ;
            INC HL                      ;78be  23           19693  19865 ;#
            LD  A,(HL)                  ;78bf  7e           19694  19866 ;~
            RLC A                       ;78c0  cb 07        19695  19867 ;
            JP  C,IFCALL                ;78c2  da 36 17     19696  19868 ;6
            DEC HL                      ;78c5  2b           19697  19869 ;+
            LD  A,(HL)                  ;78c6  7e           19698  19870 ;~
            OR  A                       ;78c7  b7           19699  19871 ;
            JP  Z,IFCALL                ;78c8  ca 36 17     19700  19872 ;6
            SUB 081h                    ;78cb  d6 81        19701  19873 ;
            LD  (L0790Bh+1),A           ;78cd  32 0c 79     19702  19874 ;2y
            LD  (HL),081h               ;78d0  36 81        19703  19875 ;6
            XOR A                       ;78d2  af           19704  19876 ;
            LD  B,008h                  ;78d3  06 08        19705  19877 ;
            LD  DE,LOGTBL1              ;78d5  11 9f 79     19706  19878 ;y
L078D8h:    PUSH    BC                  ;78d8  c5           19707  19879 ;
            PUSH    AF                  ;78d9  f5           19708  19880 ;
            CALL    CMP                 ;78da  cd d6 61     19709  19881 ;a
            JR  C,L078EEh               ;78dd  38 0f        19710  19882 ;8
            PUSH    HL                  ;78df  e5           19711  19883 ;
            LD  HL,00040h               ;78e0  21 40 00     19712  19884 ;!@
            ADD HL,DE                   ;78e3  19           19713  19885 ;
            EX  DE,HL                   ;78e4  eb           19714  19886 ;
            EX  (SP),HL                 ;78e5  e3           19715  19887 ;
            CALL    MUL                 ;78e6  cd e0 6f     19716  19888 ;o
            POP DE                      ;78e9  d1           19717  19889 ;
            POP AF                      ;78ea  f1           19718  19890 ;
            SET 7,A                     ;78eb  cb ff        19719  19891 ;
            PUSH    AF                  ;78ed  f5           19720  19892 ;
L078EEh:    POP AF                      ;78ee  f1           19721  19893 ;
            RLC A                       ;78ef  cb 07        19722  19894 ;
            CALL    ADDDEG              ;78f1  cd 4a 5b     19723  19895 ;J[
            POP BC                      ;78f4  c1           19724  19896 ;
            DJNZ    L078D8h             ;78f5  10 e1        19725  19897 ;
            LD  (L07943h+1),HL          ;78f7  22 44 79     19726  19898 ;"Dy
            LD  DE,00008h               ;78fa  11 08 00     19727  19899 ;
            ADD HL,DE                   ;78fd  19           19728  19900 ;
            LD  E,A                     ;78fe  5f           19729  19901 ;_
            LD  D,000h                  ;78ff  16 00        19730  19902 ;
            CALL    FLTHEX              ;7901  cd 02 29     19731  19903 ;)
            LD  A,(HL)                  ;7904  7e           19732  19904 ;~
            OR  A                       ;7905  b7           19733  19905 ;
            JR  Z,L0790Bh               ;7906  28 03        19734  19906 ;(
            SUB 008h                    ;7908  d6 08        19735  19907 ;
            LD  (HL),A                  ;790a  77           19736  19908 ;w
L0790Bh:    LD  A,000h                  ;790b  3e 00        19737  19909 ;>
            CP  080h                    ;790d  fe 80        19738  19910 ;
            JR  C,L07913h               ;790f  38 02        19739  19911 ;8
            NEG                         ;7911  ed 44        19740  19912 ;D
L07913h:    PUSH    HL                  ;7913  e5           19741  19913 ;
            LD  DE,00008h               ;7914  11 08 00     19742  19914 ;
            ADD HL,DE                   ;7917  19           19743  19915 ;
            LD  (L07940h+1),HL          ;7918  22 41 79     19744  19916 ;"Ay
            LD  E,A                     ;791b  5f           19745  19917 ;_
            LD  D,000h                  ;791c  16 00        19746  19918 ;
            CALL    FLTHEX              ;791e  cd 02 29     19747  19919 ;)
            LD  A,(L0790Bh+1)           ;7921  3a 0c 79     19748  19920 ;:y
            AND 080h                    ;7924  e6 80        19749  19921 ;
            INC HL                      ;7926  23           19750  19922 ;#
            OR  (HL)                    ;7927  b6           19751  19923 ;
            LD  (HL),A                  ;7928  77           19752  19924 ;w
            DEC HL                      ;7929  2b           19753  19925 ;+
            EX  DE,HL                   ;792a  eb           19754  19926 ;
            POP HL                      ;792b  e1           19755  19927 ;
            CALL    ADD                 ;792c  cd a6 6c     19756  19928 ;l
            LD  A,(IY+0)                ;792f  fd 7e 00     19757  19929 ;~
            LD  DE,L07A37h              ;7932  11 37 7a     19758  19930 ;7z
            CP  004h                    ;7935  fe 04        19759  19931 ;
            JR  Z,L0793Ch               ;7937  28 03        19760  19932 ;(
            LD  DE,L07A27h              ;7939  11 27 7a     19761  19933 ;'z
L0793Ch:    CALL    MUL                 ;793c  cd e0 6f     19762  19934 ;o
            PUSH    HL                  ;793f  e5           19763  19935 ;
L07940h:    LD  DE,00000h               ;7940  11 00 00     19764  19936 ;
L07943h:    LD  HL,00000h               ;7943  21 00 00     19765  19937 ;!
            PUSH    HL                  ;7946  e5           19766  19938 ;
            PUSH    DE                  ;7947  d5           19767  19939 ;
            CALL    LDIR8               ;7948  cd a6 73     19768  19940 ;s
            POP HL                      ;794b  e1           19769  19941 ;
            CALL    ONEADD              ;794c  cd ac 73     19770  19942 ;s
            EX  (SP),HL                 ;794f  e3           19771  19943 ;
            CALL    SUB                 ;7950  cd d1 6b     19772  19944 ;k
            POP DE                      ;7953  d1           19773  19945 ;
            CALL    DIV                 ;7954  cd bd 70     19774  19946 ;p
            PUSH    DE                  ;7957  d5           19775  19947 ;
            CALL    LDIR8               ;7958  cd a6 73     19776  19948 ;s
            POP HL                      ;795b  e1           19777  19949 ;
            PUSH    DE                  ;795c  d5           19778  19950 ;
            LD  E,L                     ;795d  5d           19779  19951 ;]
            LD  D,H                     ;795e  54           19780  19952 ;T
            CALL    MUL                 ;795f  cd e0 6f     19781  19953 ;o
            POP DE                      ;7962  d1           19782  19954 ;
            PUSH    HL                  ;7963  e5           19783  19955 ;
            PUSH    DE                  ;7964  d5           19784  19956 ;
            CALL    LDIR8               ;7965  cd a6 73     19785  19957 ;s
            POP HL                      ;7968  e1           19786  19958 ;
            LD  DE,LOGTBL0              ;7969  11 97 79     19787  19959 ;y
            CALL    ADD                 ;796c  cd a6 6c     19788  19960 ;l
            EX  DE,HL                   ;796f  eb           19789  19961 ;
            POP HL                      ;7970  e1           19790  19962 ;
            CALL    MUL                 ;7971  cd e0 6f     19791  19963 ;o
            LD  DE,FLTEN                ;7974  11 90 62     19792  19964 ;b
            INC (HL)                    ;7977  34           19793  19965 ;4
            CALL    ADD                 ;7978  cd a6 6c     19794  19966 ;l
            DEC (HL)                    ;797b  35           19795  19967 ;5
            EX  DE,HL                   ;797c  eb           19796  19968 ;
            LD  HL,(L07943h+1)          ;797d  2a 44 79     19797  19969 ;*Dy
            CALL    MUL                 ;7980  cd e0 6f     19798  19970 ;o
            LD  DE,LOGTBL               ;7983  11 8f 79     19799  19971 ;y
            CALL    MUL                 ;7986  cd e0 6f     19800  19972 ;o
            POP DE                      ;7989  d1           19801  19973 ;
            CALL    ADD                 ;798a  cd a6 6c     19802  19974 ;l
            POP BC                      ;798d  c1           19803  19975 ;
            RET                         ;798e  c9           19804  19976 ;
LOGTBL:                                 ;                   19805  19977 
            DEFB 07Fh, 04Ch, 0CCh, 0CCh, 0CCh, 0CCh, 0CCh, 0CDh;798f  7f 4c cc cc  19806  19978 
                                        ;7993  cc cc cc cd  19806  19979
LOGTBL0:    DEFB 081h, 055h, 055h, 055h, 055h, 055h, 055h, 055h;7997  81 55 55 55  19807  19980 
                                        ;799b  55 55 55 55  19807  19981
LOGTBL1:    DEFB 081h, 035h, 004h, 0F3h, 033h, 0F9h, 0DEh, 065h;799f  81 35 04 f3  19808  19982 
                                        ;79a3  33 f9 de 65  19808  19983
            DEFB 081h, 018h, 037h, 0F0h, 051h, 08Dh, 0B8h, 0AAh;79a7  81 18 37 f0  19809  19984 
                                        ;79ab  51 8d b8 aa  19809  19985
            DEFB 081h, 00Bh, 095h, 0C1h, 0E3h, 0EAh, 08Bh, 0D7h;79af  81 0b 95 c1  19810  19986 
                                        ;79b3  e3 ea 8b d7  19810  19987
            DEFB 081h, 005h, 0AAh, 0C3h, 067h, 0CCh, 048h, 07Bh;79b7  81 05 aa c3  19811  19988 
                                        ;79bb  67 cc 48 7b  19811  19989
            DEFB 081h, 002h, 0CDh, 086h, 098h, 0ACh, 02Bh, 0A2h;79bf  81 02 cd 86  19812  19990 
                                        ;79c3  98 ac 2b a2  19812  19991
            DEFB 081h, 001h, 064h, 0D1h, 0F3h, 0BCh, 003h, 008h;79c7  81 01 64 d1  19813  19992 
                                        ;79cb  f3 bc 03 08  19813  19993
            DEFB 081h, 000h, 0B1h, 0EDh, 04Fh, 0D9h, 099h, 0ACh;79cf  81 00 b1 ed  19814  19994 
                                        ;79d3  4f d9 99 ac  19814  19995
            DEFB 081h, 000h, 058h, 0D7h, 0D2h, 0D5h, 0E5h, 0F7h;79d7  81 00 58 d7  19815  19996 
                                        ;79db  d2 d5 e5 f7  19815  19997
            DEFB 080h, 035h, 004h, 0F3h, 033h, 0F9h, 0DEh, 065h;79df  80 35 04 f3  19816  19998 
                                        ;79e3  33 f9 de 65  19816  19999
            DEFB 080h, 057h, 044h, 0FCh, 0CAh, 0D6h, 09Dh, 06Bh;79e7  80 57 44 fc  19817  20000 
                                        ;79eb  ca d6 9d 6b  19817  20001
            DEFB 080h, 06Ah, 0C0h, 0C6h, 0E7h, 0DDh, 024h, 03Ah;79ef  80 6a c0 c6  19818  20002 
                                        ;79f3  e7 dd 24 3a  19818  20003
            DEFB 080h, 075h, 025h, 07Dh, 015h, 024h, 086h, 0CDh;79f7  80 75 25 7d  19819  20004 
                                        ;79fb  15 24 86 cd  19819  20005
            DEFB 080h, 07Ah, 083h, 0B2h, 0DBh, 072h, 02Ah, 003h;79ff  80 7a 83 b2  19820  20006 
                                        ;7a03  db 72 2a 03  19820  20007
            DEFB 080h, 07Dh, 03Eh, 00Ch, 00Ch, 0F4h, 086h, 0C1h;7a07  80 7d 3e 0c  19821  20008 
                                        ;7a0b  0c f4 86 c1  19821  20009
            DEFB 080h, 07Eh, 09Eh, 011h, 05Ch, 07Bh, 08Fh, 088h;7a0f  80 7e 9e 11  19822  20010 
                                        ;7a13  5c 7b 8f 88  19822  20011
            DEFB 080h, 07Fh, 04Eh, 0CBh, 059h, 051h, 01Eh, 0C9h;7a17  80 7f 4e cb  19823  20012 
                                        ;7a1b  59 51 1e c9  19823  20013
L07A1Fh:    DEFB 07Ah, 008h, 088h, 088h, 088h, 088h, 088h, 089h;7a1f  7a 08 88 88  19824  20014 
                                        ;7a23  88 88 88 89  19824  20015
L07A27h:    DEFB 080h, 031h, 072h, 017h, 0F7h, 0D1h, 0CFh, 07Ah;7a27  80 31 72 17  19825  20016 
                                        ;7a2b  f7 d1 cf 7a  19825  20017
            DEFB 081h, 038h, 0AAh, 03Bh, 029h, 05Ch, 017h, 0F1h;7a2f  81 38 aa 3b  19826  20018 
                                        ;7a33  29 5c 17 f1  19826  20019
L07A37h:    DEFB 080h, 031h, 072h, 018h ;7a37  80 31 72 18  19827  20020 
                                        ;                   19828  20021 
                                        ;                   19829  20022 ;    ORG 07A3BH
VSTART: DEFW 07C9Dh                     ;7a3b  9d 7c        19830  20023 
STRPTR: DEFW 0                          ;7a3d  00 00        19831  20024 
STKLMT: DEFW 0                          ;7a3f  00 00        19832  20025 
STRTOP: DEFW 0                          ;7a41  00 00        19833  20026 ; EQU  07a41h
INTSSP: DEFW 0                          ;7a43  00 00        19834  20027 
STRBTM: DEFW 0                          ;7a45  00 00        19835  20028 
MEMEND: DEFW 0                          ;7a47  00 00        19836  20029 
MEMMAX: DEFW 0                          ;7a49  00 00        19837  20030 ;  EQU  07a49h
INTFAC: DEFW 0                          ;7a4b  00 00        19838  20031 ;  EQU  07a4bh
        DEFW 0                          ;7a4d  00 00        19839  20032 
IMDBUF  EQU  07b4eh                     ;7b4e               19840  20033 
TEXTST  EQU  07c4eh                     ;7c4e               19841  20034 
                                        ;                   19842  20035 ;	ORG 07A4FH
KEYBUF: DEFB 00Ch                       ;7a4f  0c           19843  20036 
        DEFM 'SAMSUNG HUBASIC V1.0'     ;7a50  53 41 4d 53  19844  20037 
                                        ;7a54  55 4e 47 20  19844  20038
                                        ;7a58  48 55 42 41  19844  20039
                                        ;7a5c  53 49 43 20  19844  20040
                                        ;7a60  56 31 2e 30  19844  20041
        DEFB 00Dh                       ;7a64  0d           19845  20042 
        DEFM 'COPYRIGHT (C) 1982'       ;7a65  43 4f 50 59  19846  20043 
                                        ;7a69  52 49 47 48  19846  20044
                                        ;7a6d  54 20 28 43  19846  20045
                                        ;7a71  29 20 31 39  19846  20046
                                        ;7a75  38 32        19846  20047
        DEFB 00Dh                       ;7a77  0d           19847  20048 
        DEFM '       BY HUDSON SOFT'    ;7a78  20 20 20 20  19848  20049 
                                        ;7a7c  20 20 20 42  19848  20050
                                        ;7a80  59 20 48 55  19848  20051
                                        ;7a84  44 53 4f 4e  19848  20052
                                        ;7a88  20 53 4f 46  19848  20053
                                        ;7a8c  54           19848  20054
        DEFB 00Dh                       ;7a8d  0d           19849  20055 
        DEFS 07B00h-$, 0                ;7a8e               19850  20056 
                                        ;                   19851  20057 
;Z80-Assembler		Release 1.6				Page 2
;Source file: spc-1000_all.asm
;Title:       Symboltable

BOOT     0000	JT1      0000	JT2      0003	JT3      0006	
JT4      0009	JT5      000c	JT6      000f	JT7      0012	
JT8      0015	JT9      0018	JT10     001b	JT11     001e	
JT12     0021	JT13     0024	JT14     0027	JT15     002a	
JT16     002d	JT17     0030	JT18     0033	TICONT   0036	
JT19     0038	JT20     003b	JT21     003e	JT22     0041	
JT23     0044	JT24     0047	MAIN     004a	INITSB   0056	
NOPRET   0061	IO20SB   0062	IO60SB   006b	COUNTR   0074	
FSAVE    0080	FSAVE0   008e	FSAVE1   00ad	MSAVE    00b6	
SAVE     00ce	SAVE1    00d3	SAVE0    00e3	SAVE2    0100	
SAVE4    010c	FLOAD    0110	FLOAD1   011e	MLOAD    0130	
CLOAD    0148	CLOAD7   014d	CLOAD0   0154	CLOAD1   016b	
CLOAD8   0192	CLOAD4   0193	CLOAD2   019b	CLOAD3   01a3	
CLOAD5   01a9	MVRFY    01af	MVRFY1   01d9	MVRFYN   01de	
MVRFY2   01e5	MVRFY3   01f6	MVRFY4   0220	MVRFY5   022b	
MVRFY6   0234	MVRFY7   023f	EDGE     023f	VBLOAD   0259	
VBLOD1   0266	VBLOD2   027c	VBLOD3   0287	MKRD     028b	
MKRD1    029a	MKRD4    02a4	MKRD5    02a7	MKRD2    02b7	
MKRD3    02ca	MOTON    02e0	MOTON1   02ef	MOTON6   02f8	
MOTON4   02f9	MOTON5   02fd	MOTON2   031f	MOTON3   032b	
MOTCH    0344	MOTCH1   0353	MOTCH2   035f	WRITEM   0375	
MBUF6    037e	MBUF6A   0383	MBUF7    038f	CKSUM    039e	
SUM1     03a4	SUM2     03b3	SUM3     03b7	SUM4     03bb	
WAITR    03c4	WAIT2    03c6	WRITES   03cb	WRITEL   03dd	
WRACC    03ef	WRACC1   03f5	WRMRK    0402	WMRK1    0416	
WMRK2    041e	WMRK3    0424	MONOP    0450	MONCOM   0455	
MONINP   045d	MONSTK   0483	MEMWRT   0487	WRTLP    048a	
CALLAD   049e	MEMDMP   04a3	HLSTOK   04b2	MEMDPL   04b6	
HLEND    04bb	MONDPS   04c5	DMPSUB   04c8	LINCNT   04c9	
DMPSB2   04ca	MEMLP2   04cd	SPCSTP   04d3	MONEDT   04e1	
DATAST   04ec	ACCSET   04f6	AHEXIN   0500	HLSET    0509	
HLHOLD   051d	HEX4IN   051f	HEX4ER   052a	HEX2IN   052c	
BHEXIN   0540	DESMAL   0553	HLINDS   055e	HEX2PR   0562	
ASCSET   0578	CRHLDS   0580	MONSAH   058e	MNSHLP   05ae	
HLDECK   05c2	HLDEC1   05c9	HLDEC2   05d2	SCRNBC   05d6	
PATCH4   05ef	SCRNS0   05f3	SCRNTB   0660	SCRN00   0668	
SCRN01   0674	SCRN02   0680	SCRN03   068c	SCRN04   0698	
INPUTF   06a4	INKYLP   06ad	BREAKI   06be	BELL     06ca	
BELL2    06d2	BELL3    06d8	L0715    0715	BELLBF   0740	
BELLTB   0744	BELLT2   0748	BRKJOB   074c	CRJOB2   0751	
INPEND   0757	ACCEND   075a	CRJOB    075f	L0770    0770	
CRJOBL   077e	L0786    0786	CRJOBP   078e	AINBC    0794	
ALPHA    07ab	AINOK    07b5	SEMI6    07b7	BCUYST   07ba	
LPBNST   07be	ECUYST   07c5	ECUYS2   07c8	CUTBHL   07d3	
ATBHL    07d6	CR1DEP   07de	PRTSDC   07e1	PRTSDL   07e8	
PRTSDE   07ef	DEPRT    07f3	DEPRTL   07f5	DEPRTR   07ff	
TABPRT   0802	TABPRL   0819	CR2      0823	CCR2     0833	
CR1      0843	CR1CTM   0858	SPPRT    0862	ACCPRT   0864	
ACCOUS   0870	PRINTR   0887	PSGST    08a9	PRTRDY   08bb	
WAITLP   08c4	ACCOUT   08d9	ACCDIS   08de	ACCOL1   08ef	
ACCOL2   08f6	CTRLM?   0902	PAGE02   0908	SCRLC1   090f	
PAGE04   0915	SCRLC2   091f	CURSE?   092b	CURSET   0934	
ADRCAL   0938	ADRCA2   093b	PAGE05   0946	GACPRT   094f	
ROMACP   095b	GACPR1   0960	GACPRL   0981	SCRLUP   0991	
PAGE11   09b2	BCLDIR   09be	BCLDL1   09c6	BCLDL2   09ce	
BCLDL3   09e1	SCRLDW   09ea	PAGE12   09ee	PAGE14   09f8	
CHRLE2   09fc	PAGE16   0a01	PAGE17   0a07	BCLDDR   0a13	
BCLDD1   0a1b	BCLDD2   0a23	BCLDD3   0a36	BCOUTA   0a3f	
BCOTOK   0a57	SEMIOT   0a63	CTRLSB   0a81	DELETE   0a8e	
DELLP1   0aa9	DELLP2   0acb	CLR2     0ad5	CHRSTA   0ad6	
CLRLP    0add	ATRSTA   0ae6	CHRLEN   0ae9	ATRCLS   0af1	
LINEFR   0afa	PAGE23   0afc	LINCLS   0afe	HOME     0b03	
INST     0b09	INSTL1   0b2a	LOCK     0b3f	LOCKST   0b41	
UNLOCK   0b45	LEFT     0b48	UPCUR    0b53	CTRLM    0b62	
RIGHT    0b6b	DOWNLB   0b76	CURST2   0b83	UP       0b87	
DOWN     0b8c	CTRLG    0b91	CTRLB    0b9c	CTRLB1   0ba5	
CTRLB2   0bab	CTRLF    0bb4	CTRLF1   0bbd	CTRLF2   0bc3	
CBFCEK   0bca	CTRLBF   0bd2	L0BEC    0bec	L0BF4    0bf4	
CTRLY    0bf7	CTRLT    0bfb	CTRLYT   0bfd	CTRLI    0c08	
CTRLE    0c1d	CTRLZ    0c25	CTRLZ1   0c2d	CTRLEZ   0c35	
CTRLZE   0c4c	BRKEY    0c5b	ASCGET   0c62	BUFCEK   0c6c	
GETRET   0c7a	BUFSET   0c7e	FLASHF   0c7f	BRKGTR   0c8b	
KEYGT    0c92	ZERORT   0ca1	ZEROR2   0ca4	FLGET    0ca7	
REPETS   0cb7	KEYBFA   0cbb	KEYBFD   0cbe	NEWKYS   0cc5	
REPTSW   0cc9	KEYST2   0ccb	SETLP1   0cd5	SETPL2   0cdc	
SETPL3   0ce5	SETPL4   0ce9	KYBFSR   0ced	FLASHS   0cf8	
FLASHG   0d14	FLASHA   0d15	FLASHD   0d18	FLASHC   0d1f	
L0D28    0d28	FLASHO   0d2a	FLASHE   0d32	FLSHGT   0d3c	
FLGTLP   0d42	REPETF   0d57	FLSHL3   0d65	FLGTL2   0d68	
FLSHRT   0d71	KEYSEN   0d7a	KEYSN0   0d7d	KEYSN1   0d7f	
KEYSN2   0d8c	KEYSN3   0d96	L0D9D    0d9d	L0DA5    0da5	
L0DB1    0db1	L0DB9    0db9	NEWCEK   0dbb	NEWPL1   0dc3	
SAMECK   0dd1	SAMELP   0dd9	NEWFLG   0de1	FLGLP1   0de9	
FLGLP2   0dff	FLGLP4   0e0c	FLGLP3   0e0e	FLGLP5   0e13	
FLGLP6   0e17	FLGLP9   0e21	FLGLP7   0e25	FLGLP8   0e2c	
KYBFST   0e35	L0E4C    0e4c	CTRLNO   0e5c	SETKY    0e69	
NONKEY   0e6c	NONKE?   0e6f	SETKY2   0e7a	FUNCTN   0e95	
FUNCLP   0ea8	BFSTSB   0eb1	NONSET   0eca	NORET    0ecc	
MUSIC    0ecd	MUSL1    0ece	MUSL2    0ed8	MUSL4    0eda	
MUSL3    0ede	MUSL6    0ee6	MUSL7    0ee9	MUSL5    0eec	
MUSLOP   0eed	SOUSET   0f2e	SOUST2   0f32	VOLST2   0f57	
VOLST    0f59	VOLOK    0f6b	OCTOK    0f7e	OCTOK2   0f81	
OCTNO    0f8d	OCTNOP   0f90	L0F9A    0f9a	OCTNOM   0f9c	
NUMOK    0fa8	OCTDVL   0fc5	OCTDIV   0fcf	SOUON    0fe6	
SOUOFF   100e	SOUOFE   1021	SOUOFS   1029	SOUSTP   103b	
BRKRET   1042	ENDCHK   1052	DELAYS   1077	DELAY1   107a	
DELAY2   107d	LENGSB   1088	XTEMPO   1095	SOUNDS   1099	
SOUND1   10a9	SOUND3   10b9	SOUND5   10cb	SOUND4   10d2	
SOUND2   10ee	MSDT32   10fe	MUSNUL   1100	LENGTB   1101	
LEN?A    110b	DATA?A   110d	OCT?A    1110	LENG?A   1111	
LEN?B    1113	DATA?B   1115	OCT?B    1118	LENG?B   1119	
LEN?C    111b	DATA?C   111d	OCT?C    1120	LENG?C   1121	
NUMTBL   1123	UPTBL    1131	CTRLTB   113f	BELLFG   117f	
COLORF   1180	GCOLOR   1181	SCRLBF   1182	LINEF    11a2	
CKSMF1   11e3	CKSMF2   11e5	MKLEN    11e7	IO6000   11e9	
IO2000   11ea	DISFLG   11eb	PRINTN   11ec	CURX     11ed	
CURY     11ee	OLDBUF   11ef	NEWBUF   11f9	NEWMOD   1202	
LOCKMD   1203	POINT1   1204	POINT2   1205	INKYBF   1206	
TABBUF   1246	FUNBUF   1266	KEYDT1   1306	KEYDT2   134e	
FILMOD   1396	FILNAM   1397	MTBYTE   13a8	MTADRS   13aa	
MTEXEC   13ac	PROTCT   13ae	$BASIC   1418	COLDST   1418	
MESOFF   141d	PATCH1   1425	L0014    142a	L001E    1434	
START    143d	HOTENT   1446	OK       1462	CONTDS   147c	
PATCH6   1485	NMESOK   1488	AUTOBK   148b	KEYINP   1492	
MERGEV   1499	LODVEC   149d	BLNKSK   14a2	L00A5    14bb	
ONELIN   14db	SPCCUT   14df	BREAKJ   14f7	PAUSEP   14fa	
LETDA'   14ff	LETDAI   150e	DAINUE   1514	DAINV'   151b	
DAIMID   152f	DAITRS   1531	DAIRET   1538	INTDAI   153c	
DAISTR   1546	STRMDM   1552	ESKTRS   156e	INPENT   1571	
DAIMD'   158a	LININP   1593	ZEROMK   159d	KBCLLP   15a8	
ENDTXT   15af	OKFVC    15b3	RUN      15c3	RUNBOT   160b	
RUNMID   160e	NXLINE   1611	NXTLPT   1612	TRACEF   1629	
DEBUGR   1631	NXSPL0   1655	NXSPL1   1665	NXSPL2   1679	
NXSPL3   168b	DEBGHL   169f	BREAK$   16a0	BREAK    16a2	
BRDRCT   16b0	LNOPRT   16cb	LNOBUF   16cc	FIVEPR   16e5	
SKIPFZ   16ee	LSTODP   16f6	PRTNUM   16fc	BREAKM   1705	
INMES    170a	CVDSAD   170e	STMNTS   1720	TYPEMS   1732	
IFCALL   1736	SERROR   173a	ERJUMP   173c	FUNCTN1  173f	
MEMDAI   1745	MEMDSE   1747	SKMDAI   1771	NOMDAI   177c	
MIDDAI   177e	MIDRAL   17b5	MDTLLD   17d4	RPSTSW   17ee	
SKIOMR   17fc	LSTRPL   1804	NOEFT2   181c	RETNOE   181d	
NOEFT1   1821	DFLTCL   1824	REM      183a	FILEER   183e	
PRTSTR   1843	RGPRMT   1851	PRINT    1855	PRDVSW   1874	
PRTERM   188a	PRINT'   1891	PRSCRV   1893	RGPRM'   18ca	
SKIPP    18d6	PRTYUI   18d8	SEMIS    18ea	DISCLR   18f4	
CRLFR'   18fa	CRLFRT   18fc	DECBCL   1902	TABOPR   1912	
CRTTAS   192a	TSUBLS   192d	TABPPP   1932	TABPPT   1933	
NOTABO   1939	SPCOPR   1940	CLR      1951	FOR      196f	
FTSKIP   1985	NXTSFT   19a5	FORPUS   19ad	STEPON   19db	
FVTYPE   19f1	FLJPVC   19f9	NXFVAR   19fb	NXWFOR   1a05	
NEXT     1a0a	NEXTAG   1a16	AGINCV   1a1b	SKSTKS   1a27	
NXTNXT   1a4d	NXFPOR   1a5a	DFLTNX   1a62	FPCOMP   1aa3	
OMODED   1aaa	NEXTRT   1ab3	INTFOR   1ac1	MNIFOR   1aec	
INTCMP   1af4	INTCPM   1afd	ICHMNS   1b04	CPRTMY   1b0b	
NCICMT   1b10	ERTEST   1b14	ERRTST   1b19	LET      1b1c	
POKE     1b23	POKELP   1b28	RETIRQ   1b39	CLS      1b42	
CLSSB    1b4c	CLS1LP   1b51	SCREEN   1b59	PATCH5   1b88	
GRAPHI   1b93	GRAPH    1b95	GM2345   1bab	GRAPOK   1bb8	
GSAVES   1bea	GSAVEL   1bf3	GSAVEP   1bf5	GMODEF   1c06	
SCRTAB   1c07	LOCATE   1c25	LCTIFC   1c32	READ     1c45	
DATASK   1c5f	DATAPO   1c60	DATAS'   1c62	MIDDAR   1c78	
DATAFD   1c8a	RESLBL   1c92	RESTOR   1ca5	RESTTT   1cc2	
DATA     1cc8	DATALZ   1cc9	LINCIN   1cd4	LINE     1ce7	
LINPOL   1d05	PMTOUE   1d14	LINPNP   1d1c	LINVEC   1d30	
LINESR   1d38	ESLINE   1d40	IBREAK   1d49	IBREKH   1d4c	
CINP'#   1d51	CIRPUT   1d6c	INPUT    1d74	PMTOUL   1da4	
NPASK?   1db3	PMTASK   1dc2	PMASVC   1dc3	LINEKB   1dc5	
NOPPMT   1dcd	INPLOP   1ddf	DATAV1   1de2	DASKIO   1de8	
DATAFV   1dfc	INNMOK   1e2e	NXTIN?   1e49	PMTERM   1e59	
READVC   1e5a	INITDI   1e5c	STRINP   1e69	SRINPL   1e79	
DATAV2   1e81	ESCINS   1e87	ESCIN'   1e88	DATA22   1e98	
DATADN   1e9c	INSDC    1ea8	INPSDC   1ea9	HMEMCK   1eab	
MEMCHK   1eb0	MCHKMD   1eb6	MCHCKR   1ecf	GETVAC   1ed3	
GETVAB   1ed7	GETVAR   1eda	VARCLP   1eeb	GVARRT   1f01	
SKIPUS   1f04	SKIPVT   1f18	SKIPVU   1f19	SKIPVV   1f1a	
CRNVAR   1f23	LZFIL1   1f2e	ARRAY    1f41	TSALOP   1f4a	
TSFARY   1f6a	ASLOP    1f79	ARSKFN   1f84	ARYATA   1f8c	
MIDNAM   1f9b	NXTVR    1fa1	NXTVR1   1fa2	ARMSN1   1fa7	
ADRCL    1fca	ARBCBF   1ff1	CHALNM   1ff5	DIM      2003	
DASLOP   2020	DRSKFN   202a	DRYATA   2032	DIDNAM   2042	
DXTVR1   2047	DXTVR    2048	MOPDIM   204c	DIMFDD   205d	
ARGLOP   2063	DEFARY   2074	AREPUT   208c	ARYCLL   20c0	
OFF      20da	OFFOFF   20e7	BREAKL   20eb	SORERR   20f5	
NIERRO   20f7	NINS     20fa	VSRTST   20fe	SKIPDM   2115	
CHKTYP   211d	DFLTER   2141	IMUL     214b	IMADL1   2154	
IMNADD   215a	IMADL2   2166	IMNAD1   216c	IMRET    2172	
ERROPR   2175	CURTXT   217b	ERRORV   2183	OMERR    2188	
OMERRE   2188	ERROR    2196	ERRSML   21b7	ERRTCO   21cb	
UNPERR   21d7	ERRLOP   21da	UNPMES   21e5	OKMES    21f7	
SETSSP   21f9	CONT     2207	CONTFG   2208	OKCONT   2211	
BLNOBF   2216	BNXTLP   221c	BTEXTP   2222	SPBUF    2225	
AUTOFF   222a	AUTOVC   2237	AUTOLN   2239	AUTOST   2245	
RESUME   224f	ERRORF   2250	ERNLPT   225f	ERRLNO   2265	
THISLN   2289	RESTXT   228a	RESERR   228d	ERRCOD   2295	
FLEXPR   2299	FLEXP'   229c	MOTEST   22ac	STEXPR   22b2	
STEXP'   22b5	HLEXP    22c7	IHLEXP   22cc	MDLHLE   22cf	
BYTE     22d5	HCHECK   22d8	IBYTE    22df	TYPECS   22e4	
TOOCMP   22ed	EXPRSN   22f2	MEMFAC   22f4	XORAGN   22ff	
EXPPH3   2326	ORAGN    2329	EXPPH4   2350	ANDAGN   2353	
EXPPH5   237b	EXPPH6   239d	LOGLP    23a0	LDGTCM   23b8	
TRUE     23bc	LGBACK   23c9	FALSE    23cc	GTTHAN   23d7	
PORTRU   23dd	EQUALG   23e0	ALGLOG   23eb	GTEQLG   2403	
NOTEQU   2407	EXPR1    240e	EXPR'    2411	EXPRBK   241d	
EXPRBK1  2421	EXADD    2426	TERM     2433	TERM'    2436	
TERMBK   2446	TMDIV    244b	MFACT    245b	MFACT'   245e	
MFACBK   246e	TMMOD    2473	POWZRR   2480	POWAGN   2489	
FACT     248f	MIDFAP   2492	MPOWER   24ac	POWER    24c6	
RPOWER   24dd	IPOWER   24ef	PWCLLP   250c	PWCLL1   252b	
NEXTPL   2537	PSWAP    2542	FACT''   255f	INUSE    2585	
KAKKO    2596	CONDSB   25b1	MOCHCK   25b7	MOPRND   25bf	
BCFTCH   25c4	CONST    25cc	FLTHXB   25db	BCKFTR   25e3	
HXORFL   25e6	LDELNO   25f2	LNOCON   25fa	FLTPNT   2603	
VARFUN   2624	FUNCNS   262f	VARFNE   2637	VARTR#   2651	
RTVARI   2657	STRVAR   265c	INTVAR   2664	FUNGVR   2673	
NFCVAR   2682	EFCT1    2687	VRFLOP   2697	CPIMDP   26ad	
LSTCMP   26b7	CPIMDQ   26ba	FVRFND   26c2	FNBCPT   26c3	
FNLVRS   26d3	FVRFDD   26d6	TSTARG   26e4	FNCGS    26ec	
SNXT2C   2708	SK2C2C   2710	S2C2CL   2716	SK2829   271e	
SK2BLO   2728	SKPSBL   272d	SKSBER   2731	HEXSKS   2745	
DWNERG   274d	DQSKCM   2755	FCTION   2761	FTRMER   276c	
FLFNRT   2781	FNCCON   2789	FUNCT1   278c	SRFNRT   2797	
FUNCT2   279c	SRSRRT   27ba	OTHERF   27c5	LENSUB   27cb	
ASCSUB   27d6	MIDERL   27e8	VALSUB   27f9	VALTRL   280e	
MIDVAL   2814	ZRVALR   2820	NULSDC   2825	INKEY    2828	
NORGET   2854	LSTGET   285c	INKMID   2862	NLINKY   2865	
INKBCK   286c	CHRMIS   286f	CHRSUB   2874	CHRMID   287c	
GETFJP   289c	GETJPA   289f	CLRFAC   28a9	CLFCLP   28ad	
STRFAC   28b5	STRSL    28c3	LENOKS   28cd	CONDSR   28d9	
OKSTTH   28e5	CONDFL   28eb	STFLMK   28fd	STDBL    28fe	
FLTHEX   2902	NORFLH   2919	SFL      291b	FLHXRT   2926	
DEFINT   2930	DEFSTR   2934	DEFSNG   2938	DEFDBL   293c	
CONTDF   293e	CDEFTP   2953	STRMDM2  2968	DFFIL1   296c	
CALLUP   2974	CALUPR   2981	INCHLF   2986	HLFTCH   2987	
INTG     298d	MNINTR   29b6	STRING   29b8	SPCSU'   29e3	
SPCSUB   29e8	SPCSME   29f6	SPCFLL   29fe	FILLCH   29ff	
NULRET   2a03	FRACSB   2a0e	PEEK     2a14	HEXD     2a26	
MIDOCT   2a35	OCTD     2a42	STRSUB   2a53	MIDHEX   2a5a	
MK1      2a75	MKS      2a88	MKD      2a8e	MKHILS   2a92	
INDRCT   2aa3	CVI      2aaa	CVD      2aca	CVS      2acf	
CVMIDE   2ad2	CVTRLP   2ae9	PARI     2af5	SKIMPL   2b0f	
ENTSTR   2b1a	CDBL     2b21	CSNG     2b26	EPREST   2b4b	
CINT     2b5a	INRETY   2b7b	LEFT1    2b80	LFTOLM   2ba9	
LMIDET   2bae	NOLENE   2bc5	RIGHT1   2bd4	NOLSRD   2bfd	
MID      2c0f	MIDALL   2c52	KMIJL    2c70	MNULIS   2c71	
MIDNUL   2c74	INSTR    2c7a	SINSEX   2ca6	INCPL1   2cd9	
INSCPL   2cef	INMTCH   2cf9	INSRET   2d00	INSZR    2d05	
BCPOTR   2d11	INSZR1   2d19	INSZR2   2d1a	INSZR3   2d1b	
FRE      2d1e	FREMID   2d35	VARPTR   2d40	CH28H    2d58	
SERVED   2d5e	CH2CH    2d61	CH29H    2d66	MEM$     2d6b	
HLFLTO   2d97	GETSTR   2d9e	STRTRL   2dd0	NULBCK   2dd7	
NULSTR   2de3	MEMPUR   2de8	MEPDEB   2e1d	PURGE    2e37	
PURAGN   2e41	SPBLTF   2e50	STKBLT   2e55	MIDMPR   2ea0	
BLTAJL   2eaa	BLTRET   2ec0	BLTHLB   2ec1	BLTDEB   2ec4	
BLTBCB   2ec7	BLTRTA   2eca	STRPRG   2ecc	FSTRTP   2ed2	
FDSRTP   2ee5	SPRGLP   2ee8	ESCSPR   2efb	SHORTN   2eff	
SHRTNL   2f00	STRNST   2f14	ADRSFL   2f3d	SREDCK   2f59	
OVERST   2f64	SJPTBL   2f68	FJPTBL   3006	DFTABL   3088	
USRTBL   30a2	ADHLHL   30b6	OVERFL   30b8	CVBCAS   30bd	
CVBABS   30c6	INCRTM   30ce	HEXCUL   30d0	LNOCLP   30d3	
EDITOR   30f2	RSFGLP   310b	DELMIK   3119	IMLSTP   312f	
ENOSLP   3144	IMDENS   3148	EAPEND   315e	RELPTR   3196	
DELETE1  31a5	FSTLOP   31ae	RTDLTE   31b6	POPDLR   31bb	
FDDLST   31be	LNOTBF   31d3	SNDDLP   31dc	DLEFD'   31f2	
DLSTRT   31f4	DRNLOP   3218	SEARCH   322b	SEARC'   323c	
SERVEC   3258	MARDEB   325c	MATLEN   3262	SERRTT   326d	
SERNMT   3272	MATLIS   3277	SERDIS   3278	SERLPP   327a	
ESSRSP   3284	SER0DH   3289	SERINT   328f	SERLEN   3290	
SERDEB   3295	TRACE    329b	TRLTPR   32b9	TRACL0   32c0	
TRACL1   32c6	TRACL2   32cc	TRACL3   32d2	TRACL4   32d8	
TRACLP   32de	TRCOFF   32e4	RTTRAC   32e7	TROFF    32ea	
SWAP     32ef	SWTRL1   3312	NXTSAS   3348	SWAPHL   3349	
NXTSAW   3365	OUT      3367	OPORT    337a	CLOSE    3382	
FILEFG   3383	CLSINP   339d	CLEAR    33ab	MEMSET   33e9	
USING    3410	OKLIOP   3420	USGIFC   3423	IUSGLP   343b	
USNGLP   3442	PUTCHS   346f	USINED   3474	PRTEDF   3475	
ESPUVC   3481	URTVEC   3482	PESCCH   3484	PSFRST   3488	
CHCKRV   34a2	USGCON   34b3	MGFDXZ   34bd	PTPURV   34c2	
USGCMN   34c7	PUCHRA   34d1	PULSC#   34d7	PUSEMR   34dd	
CRRTIR   34e3	PSMIDL   34e9	COUUSP   34eb	ESCCSP   34f9	
ZRPRUS   3506	USGMDL   350b	RETIOE   3512	PRSPNE   351c	
USGMD'   3525	SPACPT   352d	ASTRSK   3534	KIUYTJ   354e	
VENUSG   3559	PLUSUS   356b	PRLEN?   3579	PFLENG   3581	
PULSLS   3589	MIDFUS   358c	PUGTFC   359f	PUCOMP   35b1	
PUAFMO   35c1	PUAFQO   35cb	PUPOIT   35d3	PUPOFC   35da	
PUCOPP   35eb	BEGUSG   35f1	CHEXPU   35f8	NEXPPU   3609	
FRCLEN   3621	PUEXPF   3624	PUCOMF   3631	COMN3D   3643	
COMSK3   3645	PURTJM   3655	ESCPUC   365c	INTLEN   365d	
COMTPU   366d	LADJS1   3674	PUAFMF   3675	NPUSGN   3677	
RPLUSF   367b	FPLUSF   3680	FPUTER   3693	PUPTML   3694	
THISLN1  369f	PTPLS1   36a2	USGSGN   36a3	LADJS2   36ad	
PUYENF   36ae	LSDQW1   36b8	LADJS3   36c4	PUASTF   36c5	
ASTFIL   36ca	LADJ4'   36d5	LADJS4   36d6	LSDVZR   36ea	
PULSTX   36ee	TST2DH   36f3	RETPU$   3701	USGBCB   3702	
USGDEB   3705	AUTO     370f	EDLINE   372a	AUTONE   3732	
AUTNER   3735	AUTOES   3743	LPOS     374a	POS      374f	
POSMID   3752	ERR      3758	MIDERS   375e	ERL      3772	
ADJERL   3778	FLMXD0   3786	DEL      378e	RENUM    37aa	
SKIRE1   37d4	SKMRNU   37e8	RNSTRT   37fa	BEGRNS   3816	
STLNO    3823	BEGREN   3830	NEWNO    3834	REKUML   3836	
ADDNO    3842	RNUMED'  384c	RENOVR   3851	CROPEN   3865	
LODIFC   388d	LDFNTR   3895	LOADST   389e	LFDFNL   38b3	
FLFPRE   38be	LOADFN   38c3	FNCMPL   38cd	LFNLCP   38d9	
LFNOK    38dd	ROPEN    38f4	VERIFY   38fc	MERGE    3919	
LOAD     392c	MRGEVC   3949	TPRDER   3969	BLOAD    3978	
RTBLOD   39a1	MLLOAD   39a4	NEW      39ac	CVLOAD   39b9	
CVLDLP   39bf	ESCCVL   39d1	CVSAVE   39de	CVSVLP   39e4	
CINPUT   39f8	CLDLP1   3a04	MIDCIP   3a09	ABORT    3a1c	
CBREAK   3a26	NRLDED   3a30	LFOUM    3a43	LDINGM   3a49	
WOPEN    3a51	CWOPEN   3a5d	NULSAV   3a7f	WOPIFC   3a81	
SAVEFT   3a92	NULFNM   3a98	SAVE$    3abb	BSAVE    3af6	
CBREA'   3b0b	CBRSHM   3b0e	SAVEM    3b13	SVMNEA   3b3c	
DEFFN    3b4d	FNSERR   3b51	DUPDEF   3b8b	ERJVDE   3b8d	
ILDRCH   3b90	UNDEFN   3b9d	GETFUN   3ba1	GFNLP1   3bb3	
SKIPN1   3bd1	SKIPN2   3be4	SKIPFN   3be6	FNNOTF   3bee	
FNOPR    3bf4	STRFNC   3c06	ARGFUN   3c09	DFLTUF   3c3c	
DEFUSR   3c40	DFLTZR   3c51	USERSE   3c71	USRDFZ   3c74	
USROPR   3c78	USRDZE   3c87	USRBCK   3cbc	TIME$    3cc1	
SCRN$    3cc4	SCRNER   3ccf	SCRIFC   3cd7	SCRNTL   3d0e	
L2900    3d16	DUMP     3d2f	STDPDV   3d3b	DMPLOP   3d42	
ARYSKP   3d54	ARDSLP   3d61	ONLYVR   3d82	STRDMP   3da9	
RALDMP   3dbb	NXTDMP   3dc9	DUMPRT   3de4	PRDMVR   3deb	
NTNULD   3df8	PTVSBL   3e0f	CONSOL   3e1b	KLIST    3e1e	
KLSTLP   3e24	KLTEN    3e30	KLTAB    3e39	KLLP1    3e46	
KLESC    3e4d	CTRLPR   3e59	KEYON    3e6f	KEYOFF   3e72	
KEY      3e75	KIFCVX   3e94	KLNLMT   3eaa	KYPTLP   3eb6	
INDRCT1  3eb9	ESCKPT   3ebc	KBUFST   3ebf	KBUFSL   3ed0	
KBUFLP   3ed2	KEYBCL   3eda	CSRLIN   3ee8	LNOADR   3efd	
RETLNR   3f07	RETLNO   3f0a	MIDRLN   3f12	RTLLOP   3f16	
RETSTL   3f24	CVRTLN   3f32	RETLNV   3f33	RELNVC   3f35	
CVLNAD   3f39	RTLSHM   3f4d	ADRNVC   3f4f	RTRNAD   3f68	
RENNTF   3f6a	UDLBUF   3f82	LNOSER   3f8e	LNOSLP   3f97	
TMPUYS   3f99	NTFRET   3fb8	NOMTCH   3fbb	LMIDET1  3fc4	
GTSTED   3fc7	FSTNUB   3fe7	GSESER   3fe9	NX2C2D   3ff0	
GTNXNM   4005	GTEDNO   4018	EDIT     4022	EDBKLP   4046	
SLIST    4050	CLIST    405e	SDXSET   406a	LIST#    4072	
LIST##   407a	LIST     407e	LIST#E   407f	CLISTM   4091	
LISTLP   409f	LISTSN   40ae	LISTL'   40b9	LISTRT   40bb	
LISTEN   40bc	LISTE'   40c5	LOKJMN   40c7	LZSKL    40e3	
LTSKZR   40eb	LIST0L   40f1	SAVEVC   40f6	COUTCH   40f8	
CRTVEC   40fd	CTIRTR   4100	ESCLOT   4103	LSCRVC   4104	
COUT0D   4106	CRTCR2   410e	LISCRC   4111	LSTCR'   4112	
LISTED   411f	ONELST   4128	ONLZLP   4131	ONLSRT   413c	
UNTIL    413e	UNWTRP   4142	UNTILM   415c	ESCUTL   4170	
RETURN   4178	RTAGPO   417a	RTWGOS   419d	FPOPRT   41a3	
WHILE    41b2	WHNLPT   41d1	WHNLBF   41d7	WEND     41df	
WENDER   41e3	SKIPWH   420b	SKWHEL   421d	REPTON   4236	
REPOFF   423b	REPTST   423e	REPEAT   4244	GOSUB    4263	
GOSNDQ   4280	GOSMID   4284	OGSJMP   429b	LBLGOT   42ab	
LBLLNO   42b7	LBLSER   42be	LBLSLP   42d2	LBLNXT   42d3	
NOTLBL   42ec	LBLLEN   42fd	LBLDEB   430c	LBLMTL   430f	
LBLNMT   4319	ONERRG   431d	OEROF'   4342	ONERDQ   4349	
CURLPT   4353	DQOENB   4360	OEROFF   4366	ON       4372	
OGOSUB   438d	ONLNOS   439e	ODATA    43ab	GOTO     43b1	
IFGOTO   43b4	MIDLAG   43b5	LNSGOT   43bc	SERGOT   43c3	
UDFLNO   43dc	ONGDQT   43e1	LNRGCK   43eb	HLFVEC   43fb	
IFF      4401	ELSEMD   4412	IFALSE   4423	IFSKIP   442d	
IFSKMD   443a	IFSKSB   4440	FUNCRQ   4457	ISKFLT   4459	
IFDQSK   4464	VPUSH    446d	PUSHAG   4476	PUTSTRL  4499	
PUSHL1   44aa	RETVCP   44b0	PUSHJV   44b2	VPOP     44b4	
POPLOP   44bd	POPTRL   44da	INTPOR   44e1	HEXCUL1  44e6	
STKEMP   44f2	INTPOP   44f7	BUFCLR   4511	CTINP    4521	
ADRES    4524	LNG      4527	CTINP1   4547	CTRETN   4551	
CTRET'   4552	CTERR    4554	CTOUT    4558	CTOUT1   457c	
CTCLOS   4586	STREXZ   459b	STREXX   459d	CTBUF    45b1	
USINGB   46b1	DEFCHR   46cb	DEFCHL   4717	SOUND    4722	
BEEPOP   4748	BEEPA    4772	BEEP     4778	PLAY     478c	
KBSTMS   47af	ESCPLY   47bc	TEMPO    47bf	COLOR    47e9	
PRESET   47fa	PSET     4803	L33F0    4806	PSETSB   480c	
CULTBL   481b	CULADR   4823	SCRNYE   4824	SCRNXE   482c	
CULERR   4831	CALADR   4833	CALAD0   4836	CULAD0   484e	
L3445    485b	PATCH2   4860	CALAD1   4875	CALA21   487c	
CULAD1   4893	L348A    48a0	PATCH3   48a5	L349F    48b5	
PRESOK   48c0	CALAD2   48ca	CALAD3   48ca	CULAD3   48da	
CALA31   48e6	CALAD4   48f3	CALAD5   48f3	CULAD5   4905	
L34F6    490c	L34FB    4911	PSTRES   491b	PSETXY   4924	
COLFSL   4944	COLFST   4948	SETXY3   494d	SETXY2   4961	
BCFTC2   4967	EDCEKL   496e	EDCEK    496f	LINE@    4979	
NOMLIN   4992	ENDLIN   49a0	LIMODE   49b0	CHRMD1   49c3	
L35B4    49ca	MDST2    49d3	MDST3    49d7	MDST22   49fa	
BBFLMD   4a12	LINE1    4a1f	LINES1   4a2b	LINEXS   4a3f	
LINEXE   4a44	LINEL0   4a56	LINEYS   4a5c	LINEYE   4a61	
LINEL1   4a73	LNBOXF   4a7a	LINESB   4a7d	LINEL4   4a9d	
LINEL2   4aa4	XMOD     4aa6	YMOD     4aa9	LINELP   4ab5	
LINEMD   4ab8	YINC3    4abe	YINC2    4ac3	YINC1    4aca	
XINC0    4ad1	LINEL3   4ade	LINEL5   4af8	BOX      4b01	
BOXYAD   4b0a	BOXXAD   4b2c	LINEY    4b45	BOXLOP   4b4b	
BOXMD    4b4e	BOXDEC   4b54	XBOXAD   4b55	LINEX    4b56	
BOXFUL   4b5b	FULAD1   4b62	FULAD2   4b6c	FULLOP   4b7e	
LINEBC   4b80	FULINC   4b88	DIVH$D   4b90	DIVLP    4b9e	
DIV01    4bae	TEXTSB   4bc7	CHRCOD   4bd9	CIRCLE   4bde	
CIRRST   4c06	CRRROK   4c0c	SKPCOL   4c3d	POLYE1   4c60	
POLYE2   4c63	POLYE3   4c69	POLYE4   4c6f	POLYE5   4c72	
POLYLN   4c8e	SINSTA   4ca5	CIRCLP   4cac	SIND     4cb9	
SINEND   4cc2	SINXYS   4cd5	L38C6    4cdc	SIN!     4ce1	
L38CE    4ce4	SINOK    4ceb	SIN45    4d10	SIN135   4d18	
SIN225   4d1e	SINOK1   4d24	SINXOK   4d41	SINYOK   4d59	
XMULHI   4d5c	XMULLO   4d60	YMULHI   4d6a	YMULLO   4d6e	
SIN00    4d7a	SIN90    4d7f	SIN180   4d84	SIN270   4d89	
SINJST   4d8c	SINXAD   4d9a	WIDTH3   4d9d	SINSX    4d9e	
SINSY    4da5	SINYAD   4da8	RMULAY   4db0	RMULAX   4dbb	
RMULXY   4dc4	DEHLMX   4dca	SINRX    4dcb	DEHLMY   4dd0	
SINRY    4dd1	DEHLMS   4dd4	MULOP1   4ddd	MULOP2   4df6	
MULOP3   4e01	SINTBL   4e0b	COSTBL   4ebf	PAINT    4ec1	
PACINT   4eda	PACOSL   4ee4	L3AD1    4ee7	PACOLS   4f03	
PACEND   4f1c	PAINTS   4f1f	PAIN01   4f25	PAIN02   4f31	
PAIN03   4f37	PAIN11   4f45	PAIN06   4f58	PAIN05   4f5c	
PAIN07   4f5e	PAIN09   4f6d	PAIN08   4f71	PAIN10   4f73	
PAIN04   4f77	POICEK   4f87	POIZER   4f99	POINRT   4f9a	
POITBL   4f9e	POIST0   4fa6	BTTST1   4fb5	POINCK   4fc1	
POINC1   4fc6	POICKR   4fcc	POIST1   4fcf	BTTST2   4fde	
POIST3   4ff4	POIS3L   4ffc	POIS33   5003	POIST5   500c	
POIS5L   5014	POIS55   5019	PACOLB   501f	PATTEN   5028	
PATOK1   5059	PATSUB   5071	PATX     5072	PATY     5078	
L3C81    5097	PATYLN   509c	PATLP1   509f	PATYAD   50a5	
PATEND   50b8	PATST    50ba	PATSTL   50bf	L3CB2    50c8	
L3CB7    50cd	HCOPY    50d3	COPYGM   50f6	COPYM4   50ff	
HCOPY1   5108	HCOPY2   510d	COPYM2   510f	HCOPY3   5114	
L3D07    511d	L3D0F    5125	L3D17    512d	L3D1F    5135	
COPYM3   514c	COPYGA   516b	COPYTA   516f	COPYTL   5170	
PRTESC   517e	COPYGR   5195	COPYTX   51aa	SUB3L    51bf	
LGR23L   51c9	L3DB7    51cd	LGR223   51cf	LGR22    51d7	
SUB3L1   51d8	LGR232   51ea	ROMTX    51f5	L3DE7    51fd	
RAMTX    5211	TXCULC   5226	SUB3L2   5227	RRCHAS   523d	
L3E2E    5244	CGCHR    524a	$CGBUF   554a	ADDDEG   5b4a	
OCTLER   5b52	HEXPZM   5b5f	MID&OP   5b6b	LOP&OP   5b74	
CHKVEC   5b7b	VECSWT   5b88	MULVEC   5b89	RET&OP   5b96	
CHCKOC   5ba1	CHCKHX   5ba8	OVFLAG   5bb8	ZRSKIP   5bd6	
L008F    5bd9	SKIP2D   5bdf	CHCK26   5be5	FTCHL    5bfd	
MDLAG    5c00	POINTS   5c27	POINT    5c2b	KMYSET   5c49	
PESC     5c51	TST23H   5c59	TST21H   5c70	DGTUPQ   5c78	
SNGCL1   5c84	TST25H   5c91	TSTPRC   5c9d	EXPON?   5ca8	
EXPON!   5caf	DEXPON   5cb6	EXPON    5cbc	EXPCLM   5cc0	
FTREPT   5cce	CBEGIN   5ce1	CLMIDL   5ce4	ESCPER   5d04	
EMLLPO   5d1a	MULLKM   5d1d	EXJPVC   5d22	DIVTEN   5d27	
ADDECK   5d34	ADHLCK   5d38	OVERF'   5d3a	MULDEC   5d3d	
DEFTCH   5d51	CVNMFL   5d58	ONLYZ#   5d62	PLUS     5d68	
ENORLP   5d71	ENORL'   5d74	NORRES   5d7f	NORRE'   5d86	
OKOMTR   5d90	PUTEMK   5d99	EXPPLS   5daa	EXPASC   5dbe	
PUTEXP   5de7	INTPAR   5df2	FRSTCH   5dff	BEGTRS   5e07	
MIDTRS   5e08	CVASFL   5e1a	DBLLCH   5e31	NOEXP    5e3a	
CVCONT   5e67	ESTST'   5e71	DWNERC   5e77	FRACDG   5e7a	
FRCAGN   5e80	BCKSER   5e99	INTDIS   5ea5	LSTASA   5eae	
ASZERO   5eb4	ASCONE   5eba	FRCADM   5ebd	FRCASL   5ec2	
ADDLOP   5ec8	ESCADD   5ed4	USGNCV   5ed6	RPSPAC   5ee3	
EXPUSG   5eee	USNRIW   5ef9	AGNEXP   5f0e	NGPUDS   5f2a	
EXPUBC   5f2d	EXPUHL   5f30	WRITEL1  5f37	NTPT2E   5f3e	
USGC''   5f46	USGCV'   5f4a	USG'''   5f4f	STFLBL   5f5e	
STDGUS   5f69	FRACUS   5f77	AGINFR   5f87	OVERRD   5f9d	
FOVER    5fa6	NOFRAC   5fab	GTESTB   5fbb	GNXDGT   5fbd	
MIDSGN   5fc0	INTGDL   5fca	CPSHIF   5fdd	CONDSF   5fec	
CONDDG   5ffa	INTZRR   6005	INTBCK   600c	INT      6010	
B_FIX    6010	INTSFL   6029	INTSBL   6035	INTBC'   603d	
INTDBL   6042	INDSFL   6054	IDSFBL   606a	MIDERF   607f	
STHLBC   6088	RCHLBC   608e	FRAC     6095	FRAC'    60a7	
FRCSBL   60c0	FRCSB'   60d2	ENDSFR   60df	FRCDBL   60e7	
IDFRBL   60f7	DSFL1'   611a	ESCDFS   6131	MULTEN   6142	
MOD_     614f	HEXFLT   615d	HXZRRT   6162	DLTEN    6167	
HLFLT    6167	NORHLC   6177	TSTRNG   617e	HXFLSL   618b	
STRCMP   6195	NOIV0    61b2	SCMPLP   61c1	SCMPLN   61c9	
PCMPRT   61cf	ONECMP   61d3	CMP      61d6	TSTCMP2  61e6	
TSTCMP   61ec	DCMPLO   61f2	CMPRET   61fa	HMISN    61fe	
CMPRE'   6207	CMPR''   620c	ZFILL    6210	FILL     6211	
FILLOP   6212	FLMAX    6218	CONTBL   6220	SNGMXO   6268	
FLTEN    6290	FLONE    6298	FLLAST   62a0	ASCHL    62a8	
CONV1    62d1	CONV2    62d3	DHLMT    62e6	SHLMT    62ee	
ZFAC     62f2	ZFAC1    62fa	DGBUF    6304	$EDIT    631b	
SMALL    631b	SMALL'   631c	CVIMTX   6325	CPILLP   6327	
NUMJMP   6350	PRTCDE   6355	BACKLP   6357	TREND'   635b	
TREND    635c	STRING1  6360	REMOPR   6367	RMTRLP   636a	
RMTRMD   636d	BACK     6371	STORE'   6374	STORE    6375	
NOSLOP   6382	BACK1    6392	STATE    6395	GETHX    63be	
LNOSLP1  63e3	COMSTR   63f7	LBLGOT1  63fc	LISTER   6412	
LISTRM   6415	AFNUM    642f	ELSEST   6434	DATAST1  643c	
DATAS    6444	DQSTL    644d	LSIT#?   6455	MATCH    6461	
MSTART   6467	TESTMT   646e	SKIPTB   6480	MTCHOK   6487	
NOMTCH1  648c	SHORTN1  6490	NO2EH    6499	DQTSTR   649d	
DQTST'   64a0	SPSTRE   64ad	NUMBER   64b6	SKIPHX   64d5	
NOT26H   64e0	BCKSPS   6504	HEX2     650c	HEX1     6510	
PPOLNO   6513	FLOAT    651b	TSTNDE   652d	TSTNAC   652e	
TREN'    6535	CVTXIM   653a	CVTMLP   6541	CVCPPT   654a	
BCEG     656b	MDLBK    656d	TRASIM   6570	FUNCTR   6589	
TRNUMB   6593	IMHORN   65a0	IMHEX    65a5	IMMID    65b5	
SKZRLP   65c2	ESSKZR   65ca	ZTRLW    65ce	RFLOAT   65d8	
FLTRDL   65e9	PUT23H   6604	PUT21H   6606	TSTED    6608	
FLTRP'   6612	NTPT21   6618	FLTR''   6625	NTPT23   6627	
IMLNO    662d	DTARCL   663d	MIDDST   6642	DTA22S   6650	
DQUAT    665d	DQUATL   6662	REM1     6670	CORON    6674	
INVS     6684	SKIPTR   668a	ASSTR#   6694	OCTALD   66a0	
HEXOCT   66ae	SKHEXP   66be	ESHEXR   66c6	ZTRLWH   66d1	
OCTHL    66db	OCTCOV   66e1	OCTSTO   670b	HEXHL    6712	
HEXCOV   671a	HEXACC   671f	HEXHLF   672c	SKIUTO   6734	
CTBL1    6737	CTBL2    68d3	FIVEBF   69ab	$ERTXT   69b2	
ERRTXT   69b2	UDLMES   6a1f	RESNHL   6bc0	$FLOAT   6bc0	
B_ABS    6bc0	STROMT   6bc5	ONESUB   6bce	SUB      6bd1	
ZERO3    6be5	TOGLE    6beb	CONDM'   6bf2	CONDMZ   6bf6	
RTCDMZ   6c01	MTCHPO   6c04	MIDCMZ   6c05	STROVF   6c1d	
STRADE   6c22	SRADE'   6c44	STRADD   6c47	FSTTRL   6c83	
NXTADS   6c89	SNDTRL   6c97	STRADS   6c9d	ADD      6ca6	
HMINS    6cc3	MINCR    6cd1	MZRT     6cd9	HMDP     6cdb	
DMINS    6ce7	ZRO      6cf2	OKM      6cf5	FADD     6cfc	
ANSHIF   6d1e	FADDS    6d26	STORE1   6d66	HLBUF    6d6a	
FLEXIT   6d78	INST1    6d7c	FADD1    6d7f	JPVEC    6d99	
FADDL1   6d9d	CLR5     6dcd	CLR4     6dce	CLR3     6dcf	
CLR2$    6dd0	CLR1     6dd1	SHIFST   6deb	JPVEC2   6df1	
FSUB     6e04	FSUB1    6e0b	SNSHIF   6e25	DSUB1    6e2d	
CMPCON   6e41	CMPL     6e45	NE_      6e51	DSSFL2   6e86	
MINUS    6ea2	NEGTIV   6ece	TRANS    6ecf	ZERO     6ed8	
ZERO'    6edb	ZFILL0   6edf	OVERFL1  6ee4	SFADD    6eea	
SNSH     6f01	SADD1    6f09	SJVEC    6f21	SCL1     6f36	
SCL0     6f37	SSIFST   6f4e	SJVEC2   6f50	SSTRE    6f74	
SHLBUF   6f79	SSUB     6f83	NSSUB0   6f8a	OSETER   6fa0	
ZFSSUB   6faa	ZFSSU1   6fbb	MUL      6fe0	SML1     7026	
SML2     702f	SMSF     703f	EXPCUL   704c	SPBF     705b	
SMSTS    706e	SMULTS   7077	SMULTP   7079	SMLP1    7094	
UNDRFL   70ab	DVBYZR   70b8	DIV      70bd	SDLOP2   70ee	
SDLOP1   70f2	SDCNT    7129	ADLP     7140	NOSDLP   7153	
SDEXPC   7159	DDTRL    717c	SDTRL    717f	SDMIN    718b	
DMUL     718e	DMULLP   71bf	DMSFL    71d9	DMNOSH   71df	
SMSKP1   7207	DMTRL    7209	BLCKAD   7213	BLCKA1   7216	
BLADLP   721b	DMSKIP   7254	DDIV     7289	DDLOP2   72ab	
DDLOP1   72ae	DDCNT    7328	DDADLP   7352	DDNSLP   7363	
DDEXPC   7369	WRKFC    7393	WRKFC1   739b	LDIR1    73a3	
LDIR8    73a6	ONEADD   73ac	L073B2H  73b2	B_SQR    73b9	
L073D1H  73d1	L073E2H  73e2	L073E4H  73e4	L07401H  7401	
B_SUM    7409	B_FACG   742b	L07437H  7437	L0743FH  743f	
L0745EH  745e	L07473H  7473	L07475H  7475	B_ATN    7477	
L07488H  7488	L074ADH  74ad	L074E1H  74e1	L07501H  7501	
L07509H  7509	B_COS    7545	B_SIN    7557	L0758EH  758e	
L0759EH  759e	L075C8H  75c8	L075D5H  75d5	L075DAH  75da	
L075E2H  75e2	L075F2H  75f2	L07602H  7602	L07613H  7613	
L07617H  7617	L0761BH  761b	L07644H  7644	B_TAN    7646	
L07662H  7662	L0766DH  766d	SINTBL1  767a	SINTBL2  76ba	
L076FAH  76fa	SINTBL3  774a	B_SGN    7752	L0775BH  775b	
L07764H  7764	B_RAD    776a	B_PAI    776f	L07772H  7772	
PAITBL   7778	B_INP    7788	B_RND    7799	L077C8H  77c8	
B_EXP    77ca	L07809H  7809	L07817H  7817	L07840H  7840	
L07869H  7869	L07876H  7876	L0787AH  787a	L07885H  7885	
L0788BH  788b	L07896H  7896	L078ADH  78ad	L078B7H  78b7	
B_LOG    78bd	L078D8H  78d8	L078EEH  78ee	L0790BH  790b	
L07913H  7913	L0793CH  793c	L07940H  7940	L07943H  7943	
LOGTBL   798f	LOGTBL0  7997	LOGTBL1  799f	L07A1FH  7a1f	
L07A27H  7a27	L07A37H  7a37	VSTART   7a3b	STRPTR   7a3d	
STKLMT   7a3f	STRTOP   7a41	INTSSP   7a43	STRBTM   7a45	
MEMEND   7a47	MEMMAX   7a49	INTFAC   7a4b	KEYBUF   7a4f	
IMDBUF   7b4e	TEXTST   7c4e	L0E7CFH  e7cf	ENTRY    fb00	


No undefined symbol.
